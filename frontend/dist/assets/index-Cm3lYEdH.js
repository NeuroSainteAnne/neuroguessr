const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/blosc-E49GQuAK.js","assets/chunk-INHXZS53-D3tQiqtZ.js","assets/lz4-BIGKWw27.js","assets/zstd-IvP746pw.js"])))=>i.map(i=>d[i]);
var SA=Object.defineProperty;var a2=t=>{throw TypeError(t)};var EA=(t,e,i)=>e in t?SA(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i;var X=(t,e,i)=>EA(t,typeof e!="symbol"?e+"":e,i),fh=(t,e,i)=>e.has(t)||a2("Cannot "+i);var Le=(t,e,i)=>(fh(t,e,"read from private field"),i?i.call(t):e.get(t)),Lt=(t,e,i)=>e.has(t)?a2("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,i),wt=(t,e,i,n)=>(fh(t,e,"write to private field"),n?n.call(t,i):e.set(t,i),i),dh=(t,e,i)=>(fh(t,e,"access private method"),i);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function i(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(r){if(r.ep)return;r.ep=!0;const o=i(r);fetch(r.href,o)}})();function TA(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var mh={exports:{}},Ur={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var r2;function MA(){if(r2)return Ur;r2=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function i(n,r,o){var l=null;if(o!==void 0&&(l=""+o),r.key!==void 0&&(l=""+r.key),"key"in r){o={};for(var h in r)h!=="key"&&(o[h]=r[h])}else o=r;return r=o.ref,{$$typeof:t,type:n,key:l,ref:r!==void 0?r:null,props:o}}return Ur.Fragment=e,Ur.jsx=i,Ur.jsxs=i,Ur}var o2;function DA(){return o2||(o2=1,mh.exports=MA()),mh.exports}var L=DA(),gh={exports:{}},Oe={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var l2;function NA(){if(l2)return Oe;l2=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),l=Symbol.for("react.context"),h=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),g=Symbol.iterator;function p(G){return G===null||typeof G!="object"?null:(G=g&&G[g]||G["@@iterator"],typeof G=="function"?G:null)}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},x=Object.assign,w={};function b(G,W,le){this.props=G,this.context=W,this.refs=w,this.updater=le||v}b.prototype.isReactComponent={},b.prototype.setState=function(G,W){if(typeof G!="object"&&typeof G!="function"&&G!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,G,W,"setState")},b.prototype.forceUpdate=function(G){this.updater.enqueueForceUpdate(this,G,"forceUpdate")};function S(){}S.prototype=b.prototype;function C(G,W,le){this.props=G,this.context=W,this.refs=w,this.updater=le||v}var E=C.prototype=new S;E.constructor=C,x(E,b.prototype),E.isPureReactComponent=!0;var T=Array.isArray,D={H:null,A:null,T:null,S:null,V:null},R=Object.prototype.hasOwnProperty;function N(G,W,le,ce,fe,ye){return le=ye.ref,{$$typeof:t,type:G,key:W,ref:le!==void 0?le:null,props:ye}}function M(G,W){return N(G.type,W,void 0,void 0,void 0,G.props)}function V(G){return typeof G=="object"&&G!==null&&G.$$typeof===t}function I(G){var W={"=":"=0",":":"=2"};return"$"+G.replace(/[=:]/g,function(le){return W[le]})}var B=/\/+/g;function U(G,W){return typeof G=="object"&&G!==null&&G.key!=null?I(""+G.key):W.toString(36)}function z(){}function P(G){switch(G.status){case"fulfilled":return G.value;case"rejected":throw G.reason;default:switch(typeof G.status=="string"?G.then(z,z):(G.status="pending",G.then(function(W){G.status==="pending"&&(G.status="fulfilled",G.value=W)},function(W){G.status==="pending"&&(G.status="rejected",G.reason=W)})),G.status){case"fulfilled":return G.value;case"rejected":throw G.reason}}throw G}function K(G,W,le,ce,fe){var ye=typeof G;(ye==="undefined"||ye==="boolean")&&(G=null);var me=!1;if(G===null)me=!0;else switch(ye){case"bigint":case"string":case"number":me=!0;break;case"object":switch(G.$$typeof){case t:case e:me=!0;break;case m:return me=G._init,K(me(G._payload),W,le,ce,fe)}}if(me)return fe=fe(G),me=ce===""?"."+U(G,0):ce,T(fe)?(le="",me!=null&&(le=me.replace(B,"$&/")+"/"),K(fe,W,le,"",function(ze){return ze})):fe!=null&&(V(fe)&&(fe=M(fe,le+(fe.key==null||G&&G.key===fe.key?"":(""+fe.key).replace(B,"$&/")+"/")+me)),W.push(fe)),1;me=0;var He=ce===""?".":ce+":";if(T(G))for(var ve=0;ve<G.length;ve++)ce=G[ve],ye=He+U(ce,ve),me+=K(ce,W,le,ye,fe);else if(ve=p(G),typeof ve=="function")for(G=ve.call(G),ve=0;!(ce=G.next()).done;)ce=ce.value,ye=He+U(ce,ve++),me+=K(ce,W,le,ye,fe);else if(ye==="object"){if(typeof G.then=="function")return K(P(G),W,le,ce,fe);throw W=String(G),Error("Objects are not valid as a React child (found: "+(W==="[object Object]"?"object with keys {"+Object.keys(G).join(", ")+"}":W)+"). If you meant to render a collection of children, use an array instead.")}return me}function _(G,W,le){if(G==null)return G;var ce=[],fe=0;return K(G,ce,"","",function(ye){return W.call(le,ye,fe++)}),ce}function H(G){if(G._status===-1){var W=G._result;W=W(),W.then(function(le){(G._status===0||G._status===-1)&&(G._status=1,G._result=le)},function(le){(G._status===0||G._status===-1)&&(G._status=2,G._result=le)}),G._status===-1&&(G._status=0,G._result=W)}if(G._status===1)return G._result.default;throw G._result}var q=typeof reportError=="function"?reportError:function(G){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var W=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof G=="object"&&G!==null&&typeof G.message=="string"?String(G.message):String(G),error:G});if(!window.dispatchEvent(W))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",G);return}console.error(G)};function se(){}return Oe.Children={map:_,forEach:function(G,W,le){_(G,function(){W.apply(this,arguments)},le)},count:function(G){var W=0;return _(G,function(){W++}),W},toArray:function(G){return _(G,function(W){return W})||[]},only:function(G){if(!V(G))throw Error("React.Children.only expected to receive a single React element child.");return G}},Oe.Component=b,Oe.Fragment=i,Oe.Profiler=r,Oe.PureComponent=C,Oe.StrictMode=n,Oe.Suspense=f,Oe.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=D,Oe.__COMPILER_RUNTIME={__proto__:null,c:function(G){return D.H.useMemoCache(G)}},Oe.cache=function(G){return function(){return G.apply(null,arguments)}},Oe.cloneElement=function(G,W,le){if(G==null)throw Error("The argument must be a React element, but you passed "+G+".");var ce=x({},G.props),fe=G.key,ye=void 0;if(W!=null)for(me in W.ref!==void 0&&(ye=void 0),W.key!==void 0&&(fe=""+W.key),W)!R.call(W,me)||me==="key"||me==="__self"||me==="__source"||me==="ref"&&W.ref===void 0||(ce[me]=W[me]);var me=arguments.length-2;if(me===1)ce.children=le;else if(1<me){for(var He=Array(me),ve=0;ve<me;ve++)He[ve]=arguments[ve+2];ce.children=He}return N(G.type,fe,void 0,void 0,ye,ce)},Oe.createContext=function(G){return G={$$typeof:l,_currentValue:G,_currentValue2:G,_threadCount:0,Provider:null,Consumer:null},G.Provider=G,G.Consumer={$$typeof:o,_context:G},G},Oe.createElement=function(G,W,le){var ce,fe={},ye=null;if(W!=null)for(ce in W.key!==void 0&&(ye=""+W.key),W)R.call(W,ce)&&ce!=="key"&&ce!=="__self"&&ce!=="__source"&&(fe[ce]=W[ce]);var me=arguments.length-2;if(me===1)fe.children=le;else if(1<me){for(var He=Array(me),ve=0;ve<me;ve++)He[ve]=arguments[ve+2];fe.children=He}if(G&&G.defaultProps)for(ce in me=G.defaultProps,me)fe[ce]===void 0&&(fe[ce]=me[ce]);return N(G,ye,void 0,void 0,null,fe)},Oe.createRef=function(){return{current:null}},Oe.forwardRef=function(G){return{$$typeof:h,render:G}},Oe.isValidElement=V,Oe.lazy=function(G){return{$$typeof:m,_payload:{_status:-1,_result:G},_init:H}},Oe.memo=function(G,W){return{$$typeof:u,type:G,compare:W===void 0?null:W}},Oe.startTransition=function(G){var W=D.T,le={};D.T=le;try{var ce=G(),fe=D.S;fe!==null&&fe(le,ce),typeof ce=="object"&&ce!==null&&typeof ce.then=="function"&&ce.then(se,q)}catch(ye){q(ye)}finally{D.T=W}},Oe.unstable_useCacheRefresh=function(){return D.H.useCacheRefresh()},Oe.use=function(G){return D.H.use(G)},Oe.useActionState=function(G,W,le){return D.H.useActionState(G,W,le)},Oe.useCallback=function(G,W){return D.H.useCallback(G,W)},Oe.useContext=function(G){return D.H.useContext(G)},Oe.useDebugValue=function(){},Oe.useDeferredValue=function(G,W){return D.H.useDeferredValue(G,W)},Oe.useEffect=function(G,W,le){var ce=D.H;if(typeof le=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return ce.useEffect(G,W)},Oe.useId=function(){return D.H.useId()},Oe.useImperativeHandle=function(G,W,le){return D.H.useImperativeHandle(G,W,le)},Oe.useInsertionEffect=function(G,W){return D.H.useInsertionEffect(G,W)},Oe.useLayoutEffect=function(G,W){return D.H.useLayoutEffect(G,W)},Oe.useMemo=function(G,W){return D.H.useMemo(G,W)},Oe.useOptimistic=function(G,W){return D.H.useOptimistic(G,W)},Oe.useReducer=function(G,W,le){return D.H.useReducer(G,W,le)},Oe.useRef=function(G){return D.H.useRef(G)},Oe.useState=function(G){return D.H.useState(G)},Oe.useSyncExternalStore=function(G,W,le){return D.H.useSyncExternalStore(G,W,le)},Oe.useTransition=function(){return D.H.useTransition()},Oe.version="19.1.0",Oe}var c2;function $h(){return c2||(c2=1,gh.exports=NA()),gh.exports}var ie=$h(),ph={exports:{}},Ir={},Ah={exports:{}},vh={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var u2;function RA(){return u2||(u2=1,function(t){function e(_,H){var q=_.length;_.push(H);e:for(;0<q;){var se=q-1>>>1,G=_[se];if(0<r(G,H))_[se]=H,_[q]=G,q=se;else break e}}function i(_){return _.length===0?null:_[0]}function n(_){if(_.length===0)return null;var H=_[0],q=_.pop();if(q!==H){_[0]=q;e:for(var se=0,G=_.length,W=G>>>1;se<W;){var le=2*(se+1)-1,ce=_[le],fe=le+1,ye=_[fe];if(0>r(ce,q))fe<G&&0>r(ye,ce)?(_[se]=ye,_[fe]=q,se=fe):(_[se]=ce,_[le]=q,se=le);else if(fe<G&&0>r(ye,q))_[se]=ye,_[fe]=q,se=fe;else break e}}return H}function r(_,H){var q=_.sortIndex-H.sortIndex;return q!==0?q:_.id-H.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var l=Date,h=l.now();t.unstable_now=function(){return l.now()-h}}var f=[],u=[],m=1,g=null,p=3,v=!1,x=!1,w=!1,b=!1,S=typeof setTimeout=="function"?setTimeout:null,C=typeof clearTimeout=="function"?clearTimeout:null,E=typeof setImmediate<"u"?setImmediate:null;function T(_){for(var H=i(u);H!==null;){if(H.callback===null)n(u);else if(H.startTime<=_)n(u),H.sortIndex=H.expirationTime,e(f,H);else break;H=i(u)}}function D(_){if(w=!1,T(_),!x)if(i(f)!==null)x=!0,R||(R=!0,U());else{var H=i(u);H!==null&&K(D,H.startTime-_)}}var R=!1,N=-1,M=5,V=-1;function I(){return b?!0:!(t.unstable_now()-V<M)}function B(){if(b=!1,R){var _=t.unstable_now();V=_;var H=!0;try{e:{x=!1,w&&(w=!1,C(N),N=-1),v=!0;var q=p;try{t:{for(T(_),g=i(f);g!==null&&!(g.expirationTime>_&&I());){var se=g.callback;if(typeof se=="function"){g.callback=null,p=g.priorityLevel;var G=se(g.expirationTime<=_);if(_=t.unstable_now(),typeof G=="function"){g.callback=G,T(_),H=!0;break t}g===i(f)&&n(f),T(_)}else n(f);g=i(f)}if(g!==null)H=!0;else{var W=i(u);W!==null&&K(D,W.startTime-_),H=!1}}break e}finally{g=null,p=q,v=!1}H=void 0}}finally{H?U():R=!1}}}var U;if(typeof E=="function")U=function(){E(B)};else if(typeof MessageChannel<"u"){var z=new MessageChannel,P=z.port2;z.port1.onmessage=B,U=function(){P.postMessage(null)}}else U=function(){S(B,0)};function K(_,H){N=S(function(){_(t.unstable_now())},H)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(_){_.callback=null},t.unstable_forceFrameRate=function(_){0>_||125<_?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):M=0<_?Math.floor(1e3/_):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_next=function(_){switch(p){case 1:case 2:case 3:var H=3;break;default:H=p}var q=p;p=H;try{return _()}finally{p=q}},t.unstable_requestPaint=function(){b=!0},t.unstable_runWithPriority=function(_,H){switch(_){case 1:case 2:case 3:case 4:case 5:break;default:_=3}var q=p;p=_;try{return H()}finally{p=q}},t.unstable_scheduleCallback=function(_,H,q){var se=t.unstable_now();switch(typeof q=="object"&&q!==null?(q=q.delay,q=typeof q=="number"&&0<q?se+q:se):q=se,_){case 1:var G=-1;break;case 2:G=250;break;case 5:G=1073741823;break;case 4:G=1e4;break;default:G=5e3}return G=q+G,_={id:m++,callback:H,priorityLevel:_,startTime:q,expirationTime:G,sortIndex:-1},q>se?(_.sortIndex=q,e(u,_),i(f)===null&&_===i(u)&&(w?(C(N),N=-1):w=!0,K(D,q-se))):(_.sortIndex=G,e(f,_),x||v||(x=!0,R||(R=!0,U()))),_},t.unstable_shouldYield=I,t.unstable_wrapCallback=function(_){var H=p;return function(){var q=p;p=H;try{return _.apply(this,arguments)}finally{p=q}}}}(vh)),vh}var h2;function UA(){return h2||(h2=1,Ah.exports=RA()),Ah.exports}var xh={exports:{}},ii={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var f2;function IA(){if(f2)return ii;f2=1;var t=$h();function e(f){var u="https://react.dev/errors/"+f;if(1<arguments.length){u+="?args[]="+encodeURIComponent(arguments[1]);for(var m=2;m<arguments.length;m++)u+="&args[]="+encodeURIComponent(arguments[m])}return"Minified React error #"+f+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(){}var n={d:{f:i,r:function(){throw Error(e(522))},D:i,C:i,L:i,m:i,X:i,S:i,M:i},p:0,findDOMNode:null},r=Symbol.for("react.portal");function o(f,u,m){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:r,key:g==null?null:""+g,children:f,containerInfo:u,implementation:m}}var l=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function h(f,u){if(f==="font")return"";if(typeof u=="string")return u==="use-credentials"?u:""}return ii.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,ii.createPortal=function(f,u){var m=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!u||u.nodeType!==1&&u.nodeType!==9&&u.nodeType!==11)throw Error(e(299));return o(f,u,null,m)},ii.flushSync=function(f){var u=l.T,m=n.p;try{if(l.T=null,n.p=2,f)return f()}finally{l.T=u,n.p=m,n.d.f()}},ii.preconnect=function(f,u){typeof f=="string"&&(u?(u=u.crossOrigin,u=typeof u=="string"?u==="use-credentials"?u:"":void 0):u=null,n.d.C(f,u))},ii.prefetchDNS=function(f){typeof f=="string"&&n.d.D(f)},ii.preinit=function(f,u){if(typeof f=="string"&&u&&typeof u.as=="string"){var m=u.as,g=h(m,u.crossOrigin),p=typeof u.integrity=="string"?u.integrity:void 0,v=typeof u.fetchPriority=="string"?u.fetchPriority:void 0;m==="style"?n.d.S(f,typeof u.precedence=="string"?u.precedence:void 0,{crossOrigin:g,integrity:p,fetchPriority:v}):m==="script"&&n.d.X(f,{crossOrigin:g,integrity:p,fetchPriority:v,nonce:typeof u.nonce=="string"?u.nonce:void 0})}},ii.preinitModule=function(f,u){if(typeof f=="string")if(typeof u=="object"&&u!==null){if(u.as==null||u.as==="script"){var m=h(u.as,u.crossOrigin);n.d.M(f,{crossOrigin:m,integrity:typeof u.integrity=="string"?u.integrity:void 0,nonce:typeof u.nonce=="string"?u.nonce:void 0})}}else u==null&&n.d.M(f)},ii.preload=function(f,u){if(typeof f=="string"&&typeof u=="object"&&u!==null&&typeof u.as=="string"){var m=u.as,g=h(m,u.crossOrigin);n.d.L(f,m,{crossOrigin:g,integrity:typeof u.integrity=="string"?u.integrity:void 0,nonce:typeof u.nonce=="string"?u.nonce:void 0,type:typeof u.type=="string"?u.type:void 0,fetchPriority:typeof u.fetchPriority=="string"?u.fetchPriority:void 0,referrerPolicy:typeof u.referrerPolicy=="string"?u.referrerPolicy:void 0,imageSrcSet:typeof u.imageSrcSet=="string"?u.imageSrcSet:void 0,imageSizes:typeof u.imageSizes=="string"?u.imageSizes:void 0,media:typeof u.media=="string"?u.media:void 0})}},ii.preloadModule=function(f,u){if(typeof f=="string")if(u){var m=h(u.as,u.crossOrigin);n.d.m(f,{as:typeof u.as=="string"&&u.as!=="script"?u.as:void 0,crossOrigin:m,integrity:typeof u.integrity=="string"?u.integrity:void 0})}else n.d.m(f)},ii.requestFormReset=function(f){n.d.r(f)},ii.unstable_batchedUpdates=function(f,u){return f(u)},ii.useFormState=function(f,u,m){return l.H.useFormState(f,u,m)},ii.useFormStatus=function(){return l.H.useHostTransitionStatus()},ii.version="19.1.0",ii}var d2;function FA(){if(d2)return xh.exports;d2=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),xh.exports=IA(),xh.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var m2;function VA(){if(m2)return Ir;m2=1;var t=UA(),e=$h(),i=FA();function n(s){var a="https://react.dev/errors/"+s;if(1<arguments.length){a+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)a+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+s+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function o(s){var a=s,c=s;if(s.alternate)for(;a.return;)a=a.return;else{s=a;do a=s,(a.flags&4098)!==0&&(c=a.return),s=a.return;while(s)}return a.tag===3?c:null}function l(s){if(s.tag===13){var a=s.memoizedState;if(a===null&&(s=s.alternate,s!==null&&(a=s.memoizedState)),a!==null)return a.dehydrated}return null}function h(s){if(o(s)!==s)throw Error(n(188))}function f(s){var a=s.alternate;if(!a){if(a=o(s),a===null)throw Error(n(188));return a!==s?null:s}for(var c=s,d=a;;){var A=c.return;if(A===null)break;var y=A.alternate;if(y===null){if(d=A.return,d!==null){c=d;continue}break}if(A.child===y.child){for(y=A.child;y;){if(y===c)return h(A),s;if(y===d)return h(A),a;y=y.sibling}throw Error(n(188))}if(c.return!==d.return)c=A,d=y;else{for(var F=!1,O=A.child;O;){if(O===c){F=!0,c=A,d=y;break}if(O===d){F=!0,d=A,c=y;break}O=O.sibling}if(!F){for(O=y.child;O;){if(O===c){F=!0,c=y,d=A;break}if(O===d){F=!0,d=y,c=A;break}O=O.sibling}if(!F)throw Error(n(189))}}if(c.alternate!==d)throw Error(n(190))}if(c.tag!==3)throw Error(n(188));return c.stateNode.current===c?s:a}function u(s){var a=s.tag;if(a===5||a===26||a===27||a===6)return s;for(s=s.child;s!==null;){if(a=u(s),a!==null)return a;s=s.sibling}return null}var m=Object.assign,g=Symbol.for("react.element"),p=Symbol.for("react.transitional.element"),v=Symbol.for("react.portal"),x=Symbol.for("react.fragment"),w=Symbol.for("react.strict_mode"),b=Symbol.for("react.profiler"),S=Symbol.for("react.provider"),C=Symbol.for("react.consumer"),E=Symbol.for("react.context"),T=Symbol.for("react.forward_ref"),D=Symbol.for("react.suspense"),R=Symbol.for("react.suspense_list"),N=Symbol.for("react.memo"),M=Symbol.for("react.lazy"),V=Symbol.for("react.activity"),I=Symbol.for("react.memo_cache_sentinel"),B=Symbol.iterator;function U(s){return s===null||typeof s!="object"?null:(s=B&&s[B]||s["@@iterator"],typeof s=="function"?s:null)}var z=Symbol.for("react.client.reference");function P(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===z?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case x:return"Fragment";case b:return"Profiler";case w:return"StrictMode";case D:return"Suspense";case R:return"SuspenseList";case V:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case v:return"Portal";case E:return(s.displayName||"Context")+".Provider";case C:return(s._context.displayName||"Context")+".Consumer";case T:var a=s.render;return s=s.displayName,s||(s=a.displayName||a.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case N:return a=s.displayName||null,a!==null?a:P(s.type)||"Memo";case M:a=s._payload,s=s._init;try{return P(s(a))}catch{}}return null}var K=Array.isArray,_=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,H=i.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,q={pending:!1,data:null,method:null,action:null},se=[],G=-1;function W(s){return{current:s}}function le(s){0>G||(s.current=se[G],se[G]=null,G--)}function ce(s,a){G++,se[G]=s.current,s.current=a}var fe=W(null),ye=W(null),me=W(null),He=W(null);function ve(s,a){switch(ce(me,a),ce(ye,s),ce(fe,null),a.nodeType){case 9:case 11:s=(s=a.documentElement)&&(s=s.namespaceURI)?F1(s):0;break;default:if(s=a.tagName,a=a.namespaceURI)a=F1(a),s=V1(a,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}le(fe),ce(fe,s)}function ze(){le(fe),le(ye),le(me)}function Ie(s){s.memoizedState!==null&&ce(He,s);var a=fe.current,c=V1(a,s.type);a!==c&&(ce(ye,s),ce(fe,c))}function Je(s){ye.current===s&&(le(fe),le(ye)),He.current===s&&(le(He),Tr._currentValue=q)}var Ve=Object.prototype.hasOwnProperty,Xt=t.unstable_scheduleCallback,ft=t.unstable_cancelCallback,Ui=t.unstable_shouldYield,Te=t.unstable_requestPaint,Xe=t.unstable_now,re=t.unstable_getCurrentPriorityLevel,ui=t.unstable_ImmediatePriority,Ut=t.unstable_UserBlockingPriority,Ii=t.unstable_NormalPriority,$i=t.unstable_LowPriority,us=t.unstable_IdlePriority,on=t.log,Fi=t.unstable_setDisableYieldValue,xi=null,Tt=null;function hi(s){if(typeof on=="function"&&Fi(s),Tt&&typeof Tt.setStrictMode=="function")try{Tt.setStrictMode(xi,s)}catch{}}var It=Math.clz32?Math.clz32:Ne,Vi=Math.log,Zt=Math.LN2;function Ne(s){return s>>>=0,s===0?32:31-(Vi(s)/Zt|0)|0}var Ye=256,pt=4194304;function bt(s){var a=s&42;if(a!==0)return a;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function At(s,a,c){var d=s.pendingLanes;if(d===0)return 0;var A=0,y=s.suspendedLanes,F=s.pingedLanes;s=s.warmLanes;var O=d&134217727;return O!==0?(d=O&~y,d!==0?A=bt(d):(F&=O,F!==0?A=bt(F):c||(c=O&~s,c!==0&&(A=bt(c))))):(O=d&~y,O!==0?A=bt(O):F!==0?A=bt(F):c||(c=d&~s,c!==0&&(A=bt(c)))),A===0?0:a!==0&&a!==A&&(a&y)===0&&(y=A&-A,c=a&-a,y>=c||y===32&&(c&4194048)!==0)?a:A}function qi(s,a){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&a)===0}function Ba(s,a){switch(s){case 1:case 2:case 4:case 8:case 64:return a+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ln(){var s=Ye;return Ye<<=1,(Ye&4194048)===0&&(Ye=256),s}function Bi(){var s=pt;return pt<<=1,(pt&62914560)===0&&(pt=4194304),s}function cn(s){for(var a=[],c=0;31>c;c++)a.push(s);return a}function Ds(s,a){s.pendingLanes|=a,a!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function La(s,a,c,d,A,y){var F=s.pendingLanes;s.pendingLanes=c,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=c,s.entangledLanes&=c,s.errorRecoveryDisabledLanes&=c,s.shellSuspendCounter=0;var O=s.entanglements,Y=s.expirationTimes,$=s.hiddenUpdates;for(c=F&~c;0<c;){var ne=31-It(c),oe=1<<ne;O[ne]=0,Y[ne]=-1;var ee=$[ne];if(ee!==null)for($[ne]=null,ne=0;ne<ee.length;ne++){var te=ee[ne];te!==null&&(te.lane&=-536870913)}c&=~oe}d!==0&&On(s,d,0),y!==0&&A===0&&s.tag!==0&&(s.suspendedLanes|=y&~(F&~a))}function On(s,a,c){s.pendingLanes|=a,s.suspendedLanes&=~a;var d=31-It(a);s.entangledLanes|=a,s.entanglements[d]=s.entanglements[d]|1073741824|c&4194090}function go(s,a){var c=s.entangledLanes|=a;for(s=s.entanglements;c;){var d=31-It(c),A=1<<d;A&a|s[d]&a&&(s[d]|=a),c&=~A}}function kn(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function Ns(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function Pn(){var s=H.p;return s!==0?s:(s=window.event,s===void 0?32:$1(s.type))}function po(s,a){var c=H.p;try{return H.p=s,a()}finally{H.p=c}}var Ki=Math.random().toString(36).slice(2),zt="__reactFiber$"+Ki,Wt="__reactProps$"+Ki,Rs="__reactContainer$"+Ki,zn="__reactEvents$"+Ki,Oa="__reactListeners$"+Ki,pe="__reactHandles$"+Ki,we="__reactResources$"+Ki,De="__reactMarker$"+Ki;function dt(s){delete s[zt],delete s[Wt],delete s[zn],delete s[Oa],delete s[pe]}function vt(s){var a=s[zt];if(a)return a;for(var c=s.parentNode;c;){if(a=c[Rs]||c[zt]){if(c=a.alternate,a.child!==null||c!==null&&c.child!==null)for(s=k1(s);s!==null;){if(c=s[zt])return c;s=k1(s)}return a}s=c,c=s.parentNode}return null}function _t(s){if(s=s[zt]||s[Rs]){var a=s.tag;if(a===5||a===6||a===13||a===26||a===27||a===3)return s}return null}function Ft(s){var a=s.tag;if(a===5||a===26||a===27||a===6)return s.stateNode;throw Error(n(33))}function Ue(s){var a=s[we];return a||(a=s[we]={hoistableStyles:new Map,hoistableScripts:new Map}),a}function Ke(s){s[De]=!0}var xt=new Set,Mt={};function Ct(s,a){yi(s,a),yi(s+"Capture",a)}function yi(s,a){for(Mt[s]=a,s=0;s<a.length;s++)xt.add(a[s])}var ka=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Ao={},hs={};function es(s){return Ve.call(hs,s)?!0:Ve.call(Ao,s)?!1:ka.test(s)?hs[s]=!0:(Ao[s]=!0,!1)}function vo(s,a,c){if(es(a))if(c===null)s.removeAttribute(a);else{switch(typeof c){case"undefined":case"function":case"symbol":s.removeAttribute(a);return;case"boolean":var d=a.toLowerCase().slice(0,5);if(d!=="data-"&&d!=="aria-"){s.removeAttribute(a);return}}s.setAttribute(a,""+c)}}function xo(s,a,c){if(c===null)s.removeAttribute(a);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(a);return}s.setAttribute(a,""+c)}}function fs(s,a,c,d){if(d===null)s.removeAttribute(c);else{switch(typeof d){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(c);return}s.setAttributeNS(a,c,""+d)}}var rc,Tf;function _n(s){if(rc===void 0)try{throw Error()}catch(c){var a=c.stack.trim().match(/\n( *(at )?)/);rc=a&&a[1]||"",Tf=-1<c.stack.indexOf(`
    at`)?" (<anonymous>)":-1<c.stack.indexOf("@")?"@unknown:0:0":""}return`
`+rc+s+Tf}var oc=!1;function lc(s,a){if(!s||oc)return"";oc=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var d={DetermineComponentFrameRoot:function(){try{if(a){var oe=function(){throw Error()};if(Object.defineProperty(oe.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(oe,[])}catch(te){var ee=te}Reflect.construct(s,[],oe)}else{try{oe.call()}catch(te){ee=te}s.call(oe.prototype)}}else{try{throw Error()}catch(te){ee=te}(oe=s())&&typeof oe.catch=="function"&&oe.catch(function(){})}}catch(te){if(te&&ee&&typeof te.stack=="string")return[te.stack,ee.stack]}return[null,null]}};d.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var A=Object.getOwnPropertyDescriptor(d.DetermineComponentFrameRoot,"name");A&&A.configurable&&Object.defineProperty(d.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var y=d.DetermineComponentFrameRoot(),F=y[0],O=y[1];if(F&&O){var Y=F.split(`
`),$=O.split(`
`);for(A=d=0;d<Y.length&&!Y[d].includes("DetermineComponentFrameRoot");)d++;for(;A<$.length&&!$[A].includes("DetermineComponentFrameRoot");)A++;if(d===Y.length||A===$.length)for(d=Y.length-1,A=$.length-1;1<=d&&0<=A&&Y[d]!==$[A];)A--;for(;1<=d&&0<=A;d--,A--)if(Y[d]!==$[A]){if(d!==1||A!==1)do if(d--,A--,0>A||Y[d]!==$[A]){var ne=`
`+Y[d].replace(" at new "," at ");return s.displayName&&ne.includes("<anonymous>")&&(ne=ne.replace("<anonymous>",s.displayName)),ne}while(1<=d&&0<=A);break}}}finally{oc=!1,Error.prepareStackTrace=c}return(c=s?s.displayName||s.name:"")?_n(c):""}function vg(s){switch(s.tag){case 26:case 27:case 5:return _n(s.type);case 16:return _n("Lazy");case 13:return _n("Suspense");case 19:return _n("SuspenseList");case 0:case 15:return lc(s.type,!1);case 11:return lc(s.type.render,!1);case 1:return lc(s.type,!0);case 31:return _n("Activity");default:return""}}function Mf(s){try{var a="";do a+=vg(s),s=s.return;while(s);return a}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}function Li(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function Df(s){var a=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function xg(s){var a=Df(s)?"checked":"value",c=Object.getOwnPropertyDescriptor(s.constructor.prototype,a),d=""+s[a];if(!s.hasOwnProperty(a)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var A=c.get,y=c.set;return Object.defineProperty(s,a,{configurable:!0,get:function(){return A.call(this)},set:function(F){d=""+F,y.call(this,F)}}),Object.defineProperty(s,a,{enumerable:c.enumerable}),{getValue:function(){return d},setValue:function(F){d=""+F},stopTracking:function(){s._valueTracker=null,delete s[a]}}}}function yo(s){s._valueTracker||(s._valueTracker=xg(s))}function Nf(s){if(!s)return!1;var a=s._valueTracker;if(!a)return!0;var c=a.getValue(),d="";return s&&(d=Df(s)?s.checked?"true":"false":s.value),s=d,s!==c?(a.setValue(s),!0):!1}function wo(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var yg=/[\n"\\]/g;function Oi(s){return s.replace(yg,function(a){return"\\"+a.charCodeAt(0).toString(16)+" "})}function cc(s,a,c,d,A,y,F,O){s.name="",F!=null&&typeof F!="function"&&typeof F!="symbol"&&typeof F!="boolean"?s.type=F:s.removeAttribute("type"),a!=null?F==="number"?(a===0&&s.value===""||s.value!=a)&&(s.value=""+Li(a)):s.value!==""+Li(a)&&(s.value=""+Li(a)):F!=="submit"&&F!=="reset"||s.removeAttribute("value"),a!=null?uc(s,F,Li(a)):c!=null?uc(s,F,Li(c)):d!=null&&s.removeAttribute("value"),A==null&&y!=null&&(s.defaultChecked=!!y),A!=null&&(s.checked=A&&typeof A!="function"&&typeof A!="symbol"),O!=null&&typeof O!="function"&&typeof O!="symbol"&&typeof O!="boolean"?s.name=""+Li(O):s.removeAttribute("name")}function Rf(s,a,c,d,A,y,F,O){if(y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"&&(s.type=y),a!=null||c!=null){if(!(y!=="submit"&&y!=="reset"||a!=null))return;c=c!=null?""+Li(c):"",a=a!=null?""+Li(a):c,O||a===s.value||(s.value=a),s.defaultValue=a}d=d??A,d=typeof d!="function"&&typeof d!="symbol"&&!!d,s.checked=O?s.checked:!!d,s.defaultChecked=!!d,F!=null&&typeof F!="function"&&typeof F!="symbol"&&typeof F!="boolean"&&(s.name=F)}function uc(s,a,c){a==="number"&&wo(s.ownerDocument)===s||s.defaultValue===""+c||(s.defaultValue=""+c)}function jn(s,a,c,d){if(s=s.options,a){a={};for(var A=0;A<c.length;A++)a["$"+c[A]]=!0;for(c=0;c<s.length;c++)A=a.hasOwnProperty("$"+s[c].value),s[c].selected!==A&&(s[c].selected=A),A&&d&&(s[c].defaultSelected=!0)}else{for(c=""+Li(c),a=null,A=0;A<s.length;A++){if(s[A].value===c){s[A].selected=!0,d&&(s[A].defaultSelected=!0);return}a!==null||s[A].disabled||(a=s[A])}a!==null&&(a.selected=!0)}}function Uf(s,a,c){if(a!=null&&(a=""+Li(a),a!==s.value&&(s.value=a),c==null)){s.defaultValue!==a&&(s.defaultValue=a);return}s.defaultValue=c!=null?""+Li(c):""}function If(s,a,c,d){if(a==null){if(d!=null){if(c!=null)throw Error(n(92));if(K(d)){if(1<d.length)throw Error(n(93));d=d[0]}c=d}c==null&&(c=""),a=c}c=Li(a),s.defaultValue=c,d=s.textContent,d===c&&d!==""&&d!==null&&(s.value=d)}function Gn(s,a){if(a){var c=s.firstChild;if(c&&c===s.lastChild&&c.nodeType===3){c.nodeValue=a;return}}s.textContent=a}var wg=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Ff(s,a,c){var d=a.indexOf("--")===0;c==null||typeof c=="boolean"||c===""?d?s.setProperty(a,""):a==="float"?s.cssFloat="":s[a]="":d?s.setProperty(a,c):typeof c!="number"||c===0||wg.has(a)?a==="float"?s.cssFloat=c:s[a]=(""+c).trim():s[a]=c+"px"}function Vf(s,a,c){if(a!=null&&typeof a!="object")throw Error(n(62));if(s=s.style,c!=null){for(var d in c)!c.hasOwnProperty(d)||a!=null&&a.hasOwnProperty(d)||(d.indexOf("--")===0?s.setProperty(d,""):d==="float"?s.cssFloat="":s[d]="");for(var A in a)d=a[A],a.hasOwnProperty(A)&&c[A]!==d&&Ff(s,A,d)}else for(var y in a)a.hasOwnProperty(y)&&Ff(s,y,a[y])}function hc(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var bg=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Cg=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function bo(s){return Cg.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}var fc=null;function dc(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var Yn=null,Hn=null;function Bf(s){var a=_t(s);if(a&&(s=a.stateNode)){var c=s[Wt]||null;e:switch(s=a.stateNode,a.type){case"input":if(cc(s,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name),a=c.name,c.type==="radio"&&a!=null){for(c=s;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll('input[name="'+Oi(""+a)+'"][type="radio"]'),a=0;a<c.length;a++){var d=c[a];if(d!==s&&d.form===s.form){var A=d[Wt]||null;if(!A)throw Error(n(90));cc(d,A.value,A.defaultValue,A.defaultValue,A.checked,A.defaultChecked,A.type,A.name)}}for(a=0;a<c.length;a++)d=c[a],d.form===s.form&&Nf(d)}break e;case"textarea":Uf(s,c.value,c.defaultValue);break e;case"select":a=c.value,a!=null&&jn(s,!!c.multiple,a,!1)}}}var mc=!1;function Lf(s,a,c){if(mc)return s(a,c);mc=!0;try{var d=s(a);return d}finally{if(mc=!1,(Yn!==null||Hn!==null)&&(ol(),Yn&&(a=Yn,s=Hn,Hn=Yn=null,Bf(a),s)))for(a=0;a<s.length;a++)Bf(s[a])}}function Pa(s,a){var c=s.stateNode;if(c===null)return null;var d=c[Wt]||null;if(d===null)return null;c=d[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(d=!d.disabled)||(s=s.type,d=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!d;break e;default:s=!1}if(s)return null;if(c&&typeof c!="function")throw Error(n(231,a,typeof c));return c}var ds=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),gc=!1;if(ds)try{var za={};Object.defineProperty(za,"passive",{get:function(){gc=!0}}),window.addEventListener("test",za,za),window.removeEventListener("test",za,za)}catch{gc=!1}var Us=null,pc=null,Co=null;function Of(){if(Co)return Co;var s,a=pc,c=a.length,d,A="value"in Us?Us.value:Us.textContent,y=A.length;for(s=0;s<c&&a[s]===A[s];s++);var F=c-s;for(d=1;d<=F&&a[c-d]===A[y-d];d++);return Co=A.slice(s,1<d?1-d:void 0)}function So(s){var a=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&a===13&&(s=13)):s=a,s===10&&(s=13),32<=s||s===13?s:0}function Eo(){return!0}function kf(){return!1}function fi(s){function a(c,d,A,y,F){this._reactName=c,this._targetInst=A,this.type=d,this.nativeEvent=y,this.target=F,this.currentTarget=null;for(var O in s)s.hasOwnProperty(O)&&(c=s[O],this[O]=c?c(y):y[O]);return this.isDefaultPrevented=(y.defaultPrevented!=null?y.defaultPrevented:y.returnValue===!1)?Eo:kf,this.isPropagationStopped=kf,this}return m(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=Eo)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=Eo)},persist:function(){},isPersistent:Eo}),a}var un={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},To=fi(un),_a=m({},un,{view:0,detail:0}),Sg=fi(_a),Ac,vc,ja,Mo=m({},_a,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:yc,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==ja&&(ja&&s.type==="mousemove"?(Ac=s.screenX-ja.screenX,vc=s.screenY-ja.screenY):vc=Ac=0,ja=s),Ac)},movementY:function(s){return"movementY"in s?s.movementY:vc}}),Pf=fi(Mo),Eg=m({},Mo,{dataTransfer:0}),Tg=fi(Eg),Mg=m({},_a,{relatedTarget:0}),xc=fi(Mg),Dg=m({},un,{animationName:0,elapsedTime:0,pseudoElement:0}),Ng=fi(Dg),Rg=m({},un,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),Ug=fi(Rg),Ig=m({},un,{data:0}),zf=fi(Ig),Fg={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Vg={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Bg={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Lg(s){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(s):(s=Bg[s])?!!a[s]:!1}function yc(){return Lg}var Og=m({},_a,{key:function(s){if(s.key){var a=Fg[s.key]||s.key;if(a!=="Unidentified")return a}return s.type==="keypress"?(s=So(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?Vg[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:yc,charCode:function(s){return s.type==="keypress"?So(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?So(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),kg=fi(Og),Pg=m({},Mo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),_f=fi(Pg),zg=m({},_a,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:yc}),_g=fi(zg),jg=m({},un,{propertyName:0,elapsedTime:0,pseudoElement:0}),Gg=fi(jg),Yg=m({},Mo,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),Hg=fi(Yg),qg=m({},un,{newState:0,oldState:0}),Kg=fi(qg),Qg=[9,13,27,32],wc=ds&&"CompositionEvent"in window,Ga=null;ds&&"documentMode"in document&&(Ga=document.documentMode);var Xg=ds&&"TextEvent"in window&&!Ga,jf=ds&&(!wc||Ga&&8<Ga&&11>=Ga),Gf=" ",Yf=!1;function Hf(s,a){switch(s){case"keyup":return Qg.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function qf(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var qn=!1;function Zg(s,a){switch(s){case"compositionend":return qf(a);case"keypress":return a.which!==32?null:(Yf=!0,Gf);case"textInput":return s=a.data,s===Gf&&Yf?null:s;default:return null}}function Wg(s,a){if(qn)return s==="compositionend"||!wc&&Hf(s,a)?(s=Of(),Co=pc=Us=null,qn=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return jf&&a.locale!=="ko"?null:a.data;default:return null}}var Jg={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Kf(s){var a=s&&s.nodeName&&s.nodeName.toLowerCase();return a==="input"?!!Jg[s.type]:a==="textarea"}function Qf(s,a,c,d){Yn?Hn?Hn.push(d):Hn=[d]:Yn=d,a=dl(a,"onChange"),0<a.length&&(c=new To("onChange","change",null,c,d),s.push({event:c,listeners:a}))}var Ya=null,Ha=null;function $g(s){D1(s,0)}function Do(s){var a=Ft(s);if(Nf(a))return s}function Xf(s,a){if(s==="change")return a}var Zf=!1;if(ds){var bc;if(ds){var Cc="oninput"in document;if(!Cc){var Wf=document.createElement("div");Wf.setAttribute("oninput","return;"),Cc=typeof Wf.oninput=="function"}bc=Cc}else bc=!1;Zf=bc&&(!document.documentMode||9<document.documentMode)}function Jf(){Ya&&(Ya.detachEvent("onpropertychange",$f),Ha=Ya=null)}function $f(s){if(s.propertyName==="value"&&Do(Ha)){var a=[];Qf(a,Ha,s,dc(s)),Lf($g,a)}}function ep(s,a,c){s==="focusin"?(Jf(),Ya=a,Ha=c,Ya.attachEvent("onpropertychange",$f)):s==="focusout"&&Jf()}function tp(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Do(Ha)}function ip(s,a){if(s==="click")return Do(a)}function sp(s,a){if(s==="input"||s==="change")return Do(a)}function np(s,a){return s===a&&(s!==0||1/s===1/a)||s!==s&&a!==a}var wi=typeof Object.is=="function"?Object.is:np;function qa(s,a){if(wi(s,a))return!0;if(typeof s!="object"||s===null||typeof a!="object"||a===null)return!1;var c=Object.keys(s),d=Object.keys(a);if(c.length!==d.length)return!1;for(d=0;d<c.length;d++){var A=c[d];if(!Ve.call(a,A)||!wi(s[A],a[A]))return!1}return!0}function ed(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function td(s,a){var c=ed(s);s=0;for(var d;c;){if(c.nodeType===3){if(d=s+c.textContent.length,s<=a&&d>=a)return{node:c,offset:a-s};s=d}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=ed(c)}}function id(s,a){return s&&a?s===a?!0:s&&s.nodeType===3?!1:a&&a.nodeType===3?id(s,a.parentNode):"contains"in s?s.contains(a):s.compareDocumentPosition?!!(s.compareDocumentPosition(a)&16):!1:!1}function sd(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var a=wo(s.document);a instanceof s.HTMLIFrameElement;){try{var c=typeof a.contentWindow.location.href=="string"}catch{c=!1}if(c)s=a.contentWindow;else break;a=wo(s.document)}return a}function Sc(s){var a=s&&s.nodeName&&s.nodeName.toLowerCase();return a&&(a==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||a==="textarea"||s.contentEditable==="true")}var ap=ds&&"documentMode"in document&&11>=document.documentMode,Kn=null,Ec=null,Ka=null,Tc=!1;function nd(s,a,c){var d=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;Tc||Kn==null||Kn!==wo(d)||(d=Kn,"selectionStart"in d&&Sc(d)?d={start:d.selectionStart,end:d.selectionEnd}:(d=(d.ownerDocument&&d.ownerDocument.defaultView||window).getSelection(),d={anchorNode:d.anchorNode,anchorOffset:d.anchorOffset,focusNode:d.focusNode,focusOffset:d.focusOffset}),Ka&&qa(Ka,d)||(Ka=d,d=dl(Ec,"onSelect"),0<d.length&&(a=new To("onSelect","select",null,a,c),s.push({event:a,listeners:d}),a.target=Kn)))}function hn(s,a){var c={};return c[s.toLowerCase()]=a.toLowerCase(),c["Webkit"+s]="webkit"+a,c["Moz"+s]="moz"+a,c}var Qn={animationend:hn("Animation","AnimationEnd"),animationiteration:hn("Animation","AnimationIteration"),animationstart:hn("Animation","AnimationStart"),transitionrun:hn("Transition","TransitionRun"),transitionstart:hn("Transition","TransitionStart"),transitioncancel:hn("Transition","TransitionCancel"),transitionend:hn("Transition","TransitionEnd")},Mc={},ad={};ds&&(ad=document.createElement("div").style,"AnimationEvent"in window||(delete Qn.animationend.animation,delete Qn.animationiteration.animation,delete Qn.animationstart.animation),"TransitionEvent"in window||delete Qn.transitionend.transition);function fn(s){if(Mc[s])return Mc[s];if(!Qn[s])return s;var a=Qn[s],c;for(c in a)if(a.hasOwnProperty(c)&&c in ad)return Mc[s]=a[c];return s}var rd=fn("animationend"),od=fn("animationiteration"),ld=fn("animationstart"),rp=fn("transitionrun"),op=fn("transitionstart"),lp=fn("transitioncancel"),cd=fn("transitionend"),ud=new Map,Dc="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Dc.push("scrollEnd");function Qi(s,a){ud.set(s,a),Ct(a,[s])}var hd=new WeakMap;function ki(s,a){if(typeof s=="object"&&s!==null){var c=hd.get(s);return c!==void 0?c:(a={value:s,source:a,stack:Mf(a)},hd.set(s,a),a)}return{value:s,source:a,stack:Mf(a)}}var Pi=[],Xn=0,Nc=0;function No(){for(var s=Xn,a=Nc=Xn=0;a<s;){var c=Pi[a];Pi[a++]=null;var d=Pi[a];Pi[a++]=null;var A=Pi[a];Pi[a++]=null;var y=Pi[a];if(Pi[a++]=null,d!==null&&A!==null){var F=d.pending;F===null?A.next=A:(A.next=F.next,F.next=A),d.pending=A}y!==0&&fd(c,A,y)}}function Ro(s,a,c,d){Pi[Xn++]=s,Pi[Xn++]=a,Pi[Xn++]=c,Pi[Xn++]=d,Nc|=d,s.lanes|=d,s=s.alternate,s!==null&&(s.lanes|=d)}function Rc(s,a,c,d){return Ro(s,a,c,d),Uo(s)}function Zn(s,a){return Ro(s,null,null,a),Uo(s)}function fd(s,a,c){s.lanes|=c;var d=s.alternate;d!==null&&(d.lanes|=c);for(var A=!1,y=s.return;y!==null;)y.childLanes|=c,d=y.alternate,d!==null&&(d.childLanes|=c),y.tag===22&&(s=y.stateNode,s===null||s._visibility&1||(A=!0)),s=y,y=y.return;return s.tag===3?(y=s.stateNode,A&&a!==null&&(A=31-It(c),s=y.hiddenUpdates,d=s[A],d===null?s[A]=[a]:d.push(a),a.lane=c|536870912),y):null}function Uo(s){if(50<vr)throw vr=0,Lu=null,Error(n(185));for(var a=s.return;a!==null;)s=a,a=s.return;return s.tag===3?s.stateNode:null}var Wn={};function cp(s,a,c,d){this.tag=s,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=d,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function bi(s,a,c,d){return new cp(s,a,c,d)}function Uc(s){return s=s.prototype,!(!s||!s.isReactComponent)}function ms(s,a){var c=s.alternate;return c===null?(c=bi(s.tag,a,s.key,s.mode),c.elementType=s.elementType,c.type=s.type,c.stateNode=s.stateNode,c.alternate=s,s.alternate=c):(c.pendingProps=a,c.type=s.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=s.flags&65011712,c.childLanes=s.childLanes,c.lanes=s.lanes,c.child=s.child,c.memoizedProps=s.memoizedProps,c.memoizedState=s.memoizedState,c.updateQueue=s.updateQueue,a=s.dependencies,c.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},c.sibling=s.sibling,c.index=s.index,c.ref=s.ref,c.refCleanup=s.refCleanup,c}function dd(s,a){s.flags&=65011714;var c=s.alternate;return c===null?(s.childLanes=0,s.lanes=a,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=c.childLanes,s.lanes=c.lanes,s.child=c.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=c.memoizedProps,s.memoizedState=c.memoizedState,s.updateQueue=c.updateQueue,s.type=c.type,a=c.dependencies,s.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),s}function Io(s,a,c,d,A,y){var F=0;if(d=s,typeof s=="function")Uc(s)&&(F=1);else if(typeof s=="string")F=hA(s,c,fe.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case V:return s=bi(31,c,a,A),s.elementType=V,s.lanes=y,s;case x:return dn(c.children,A,y,a);case w:F=8,A|=24;break;case b:return s=bi(12,c,a,A|2),s.elementType=b,s.lanes=y,s;case D:return s=bi(13,c,a,A),s.elementType=D,s.lanes=y,s;case R:return s=bi(19,c,a,A),s.elementType=R,s.lanes=y,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case S:case E:F=10;break e;case C:F=9;break e;case T:F=11;break e;case N:F=14;break e;case M:F=16,d=null;break e}F=29,c=Error(n(130,s===null?"null":typeof s,"")),d=null}return a=bi(F,c,a,A),a.elementType=s,a.type=d,a.lanes=y,a}function dn(s,a,c,d){return s=bi(7,s,d,a),s.lanes=c,s}function Ic(s,a,c){return s=bi(6,s,null,a),s.lanes=c,s}function Fc(s,a,c){return a=bi(4,s.children!==null?s.children:[],s.key,a),a.lanes=c,a.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},a}var Jn=[],$n=0,Fo=null,Vo=0,zi=[],_i=0,mn=null,gs=1,ps="";function gn(s,a){Jn[$n++]=Vo,Jn[$n++]=Fo,Fo=s,Vo=a}function md(s,a,c){zi[_i++]=gs,zi[_i++]=ps,zi[_i++]=mn,mn=s;var d=gs;s=ps;var A=32-It(d)-1;d&=~(1<<A),c+=1;var y=32-It(a)+A;if(30<y){var F=A-A%5;y=(d&(1<<F)-1).toString(32),d>>=F,A-=F,gs=1<<32-It(a)+A|c<<A|d,ps=y+s}else gs=1<<y|c<<A|d,ps=s}function Vc(s){s.return!==null&&(gn(s,1),md(s,1,0))}function Bc(s){for(;s===Fo;)Fo=Jn[--$n],Jn[$n]=null,Vo=Jn[--$n],Jn[$n]=null;for(;s===mn;)mn=zi[--_i],zi[_i]=null,ps=zi[--_i],zi[_i]=null,gs=zi[--_i],zi[_i]=null}var oi=null,St=null,$e=!1,pn=null,ts=!1,Lc=Error(n(519));function An(s){var a=Error(n(418,""));throw Za(ki(a,s)),Lc}function gd(s){var a=s.stateNode,c=s.type,d=s.memoizedProps;switch(a[zt]=s,a[Wt]=d,c){case"dialog":je("cancel",a),je("close",a);break;case"iframe":case"object":case"embed":je("load",a);break;case"video":case"audio":for(c=0;c<yr.length;c++)je(yr[c],a);break;case"source":je("error",a);break;case"img":case"image":case"link":je("error",a),je("load",a);break;case"details":je("toggle",a);break;case"input":je("invalid",a),Rf(a,d.value,d.defaultValue,d.checked,d.defaultChecked,d.type,d.name,!0),yo(a);break;case"select":je("invalid",a);break;case"textarea":je("invalid",a),If(a,d.value,d.defaultValue,d.children),yo(a)}c=d.children,typeof c!="string"&&typeof c!="number"&&typeof c!="bigint"||a.textContent===""+c||d.suppressHydrationWarning===!0||I1(a.textContent,c)?(d.popover!=null&&(je("beforetoggle",a),je("toggle",a)),d.onScroll!=null&&je("scroll",a),d.onScrollEnd!=null&&je("scrollend",a),d.onClick!=null&&(a.onclick=ml),a=!0):a=!1,a||An(s)}function pd(s){for(oi=s.return;oi;)switch(oi.tag){case 5:case 13:ts=!1;return;case 27:case 3:ts=!0;return;default:oi=oi.return}}function Qa(s){if(s!==oi)return!1;if(!$e)return pd(s),$e=!0,!1;var a=s.tag,c;if((c=a!==3&&a!==27)&&((c=a===5)&&(c=s.type,c=!(c!=="form"&&c!=="button")||Ju(s.type,s.memoizedProps)),c=!c),c&&St&&An(s),pd(s),a===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(n(317));e:{for(s=s.nextSibling,a=0;s;){if(s.nodeType===8)if(c=s.data,c==="/$"){if(a===0){St=Zi(s.nextSibling);break e}a--}else c!=="$"&&c!=="$!"&&c!=="$?"||a++;s=s.nextSibling}St=null}}else a===27?(a=St,Ks(s.type)?(s=ih,ih=null,St=s):St=a):St=oi?Zi(s.stateNode.nextSibling):null;return!0}function Xa(){St=oi=null,$e=!1}function Ad(){var s=pn;return s!==null&&(gi===null?gi=s:gi.push.apply(gi,s),pn=null),s}function Za(s){pn===null?pn=[s]:pn.push(s)}var Oc=W(null),vn=null,As=null;function Is(s,a,c){ce(Oc,a._currentValue),a._currentValue=c}function vs(s){s._currentValue=Oc.current,le(Oc)}function kc(s,a,c){for(;s!==null;){var d=s.alternate;if((s.childLanes&a)!==a?(s.childLanes|=a,d!==null&&(d.childLanes|=a)):d!==null&&(d.childLanes&a)!==a&&(d.childLanes|=a),s===c)break;s=s.return}}function Pc(s,a,c,d){var A=s.child;for(A!==null&&(A.return=s);A!==null;){var y=A.dependencies;if(y!==null){var F=A.child;y=y.firstContext;e:for(;y!==null;){var O=y;y=A;for(var Y=0;Y<a.length;Y++)if(O.context===a[Y]){y.lanes|=c,O=y.alternate,O!==null&&(O.lanes|=c),kc(y.return,c,s),d||(F=null);break e}y=O.next}}else if(A.tag===18){if(F=A.return,F===null)throw Error(n(341));F.lanes|=c,y=F.alternate,y!==null&&(y.lanes|=c),kc(F,c,s),F=null}else F=A.child;if(F!==null)F.return=A;else for(F=A;F!==null;){if(F===s){F=null;break}if(A=F.sibling,A!==null){A.return=F.return,F=A;break}F=F.return}A=F}}function Wa(s,a,c,d){s=null;for(var A=a,y=!1;A!==null;){if(!y){if((A.flags&524288)!==0)y=!0;else if((A.flags&262144)!==0)break}if(A.tag===10){var F=A.alternate;if(F===null)throw Error(n(387));if(F=F.memoizedProps,F!==null){var O=A.type;wi(A.pendingProps.value,F.value)||(s!==null?s.push(O):s=[O])}}else if(A===He.current){if(F=A.alternate,F===null)throw Error(n(387));F.memoizedState.memoizedState!==A.memoizedState.memoizedState&&(s!==null?s.push(Tr):s=[Tr])}A=A.return}s!==null&&Pc(a,s,c,d),a.flags|=262144}function Bo(s){for(s=s.firstContext;s!==null;){if(!wi(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function xn(s){vn=s,As=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function ti(s){return vd(vn,s)}function Lo(s,a){return vn===null&&xn(s),vd(s,a)}function vd(s,a){var c=a._currentValue;if(a={context:a,memoizedValue:c,next:null},As===null){if(s===null)throw Error(n(308));As=a,s.dependencies={lanes:0,firstContext:a},s.flags|=524288}else As=As.next=a;return c}var up=typeof AbortController<"u"?AbortController:function(){var s=[],a=this.signal={aborted:!1,addEventListener:function(c,d){s.push(d)}};this.abort=function(){a.aborted=!0,s.forEach(function(c){return c()})}},hp=t.unstable_scheduleCallback,fp=t.unstable_NormalPriority,Ot={$$typeof:E,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function zc(){return{controller:new up,data:new Map,refCount:0}}function Ja(s){s.refCount--,s.refCount===0&&hp(fp,function(){s.controller.abort()})}var $a=null,_c=0,ea=0,ta=null;function dp(s,a){if($a===null){var c=$a=[];_c=0,ea=Gu(),ta={status:"pending",value:void 0,then:function(d){c.push(d)}}}return _c++,a.then(xd,xd),a}function xd(){if(--_c===0&&$a!==null){ta!==null&&(ta.status="fulfilled");var s=$a;$a=null,ea=0,ta=null;for(var a=0;a<s.length;a++)(0,s[a])()}}function mp(s,a){var c=[],d={status:"pending",value:null,reason:null,then:function(A){c.push(A)}};return s.then(function(){d.status="fulfilled",d.value=a;for(var A=0;A<c.length;A++)(0,c[A])(a)},function(A){for(d.status="rejected",d.reason=A,A=0;A<c.length;A++)(0,c[A])(void 0)}),d}var yd=_.S;_.S=function(s,a){typeof a=="object"&&a!==null&&typeof a.then=="function"&&dp(s,a),yd!==null&&yd(s,a)};var yn=W(null);function jc(){var s=yn.current;return s!==null?s:lt.pooledCache}function Oo(s,a){a===null?ce(yn,yn.current):ce(yn,a.pool)}function wd(){var s=jc();return s===null?null:{parent:Ot._currentValue,pool:s}}var er=Error(n(460)),bd=Error(n(474)),ko=Error(n(542)),Gc={then:function(){}};function Cd(s){return s=s.status,s==="fulfilled"||s==="rejected"}function Po(){}function Sd(s,a,c){switch(c=s[c],c===void 0?s.push(a):c!==a&&(a.then(Po,Po),a=c),a.status){case"fulfilled":return a.value;case"rejected":throw s=a.reason,Td(s),s;default:if(typeof a.status=="string")a.then(Po,Po);else{if(s=lt,s!==null&&100<s.shellSuspendCounter)throw Error(n(482));s=a,s.status="pending",s.then(function(d){if(a.status==="pending"){var A=a;A.status="fulfilled",A.value=d}},function(d){if(a.status==="pending"){var A=a;A.status="rejected",A.reason=d}})}switch(a.status){case"fulfilled":return a.value;case"rejected":throw s=a.reason,Td(s),s}throw tr=a,er}}var tr=null;function Ed(){if(tr===null)throw Error(n(459));var s=tr;return tr=null,s}function Td(s){if(s===er||s===ko)throw Error(n(483))}var Fs=!1;function Yc(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Hc(s,a){s=s.updateQueue,a.updateQueue===s&&(a.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function Vs(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function Bs(s,a,c){var d=s.updateQueue;if(d===null)return null;if(d=d.shared,(tt&2)!==0){var A=d.pending;return A===null?a.next=a:(a.next=A.next,A.next=a),d.pending=a,a=Uo(s),fd(s,null,c),a}return Ro(s,d,a,c),Uo(s)}function ir(s,a,c){if(a=a.updateQueue,a!==null&&(a=a.shared,(c&4194048)!==0)){var d=a.lanes;d&=s.pendingLanes,c|=d,a.lanes=c,go(s,c)}}function qc(s,a){var c=s.updateQueue,d=s.alternate;if(d!==null&&(d=d.updateQueue,c===d)){var A=null,y=null;if(c=c.firstBaseUpdate,c!==null){do{var F={lane:c.lane,tag:c.tag,payload:c.payload,callback:null,next:null};y===null?A=y=F:y=y.next=F,c=c.next}while(c!==null);y===null?A=y=a:y=y.next=a}else A=y=a;c={baseState:d.baseState,firstBaseUpdate:A,lastBaseUpdate:y,shared:d.shared,callbacks:d.callbacks},s.updateQueue=c;return}s=c.lastBaseUpdate,s===null?c.firstBaseUpdate=a:s.next=a,c.lastBaseUpdate=a}var Kc=!1;function sr(){if(Kc){var s=ta;if(s!==null)throw s}}function nr(s,a,c,d){Kc=!1;var A=s.updateQueue;Fs=!1;var y=A.firstBaseUpdate,F=A.lastBaseUpdate,O=A.shared.pending;if(O!==null){A.shared.pending=null;var Y=O,$=Y.next;Y.next=null,F===null?y=$:F.next=$,F=Y;var ne=s.alternate;ne!==null&&(ne=ne.updateQueue,O=ne.lastBaseUpdate,O!==F&&(O===null?ne.firstBaseUpdate=$:O.next=$,ne.lastBaseUpdate=Y))}if(y!==null){var oe=A.baseState;F=0,ne=$=Y=null,O=y;do{var ee=O.lane&-536870913,te=ee!==O.lane;if(te?(Qe&ee)===ee:(d&ee)===ee){ee!==0&&ee===ea&&(Kc=!0),ne!==null&&(ne=ne.next={lane:0,tag:O.tag,payload:O.payload,callback:null,next:null});e:{var Me=s,Ce=O;ee=a;var at=c;switch(Ce.tag){case 1:if(Me=Ce.payload,typeof Me=="function"){oe=Me.call(at,oe,ee);break e}oe=Me;break e;case 3:Me.flags=Me.flags&-65537|128;case 0:if(Me=Ce.payload,ee=typeof Me=="function"?Me.call(at,oe,ee):Me,ee==null)break e;oe=m({},oe,ee);break e;case 2:Fs=!0}}ee=O.callback,ee!==null&&(s.flags|=64,te&&(s.flags|=8192),te=A.callbacks,te===null?A.callbacks=[ee]:te.push(ee))}else te={lane:ee,tag:O.tag,payload:O.payload,callback:O.callback,next:null},ne===null?($=ne=te,Y=oe):ne=ne.next=te,F|=ee;if(O=O.next,O===null){if(O=A.shared.pending,O===null)break;te=O,O=te.next,te.next=null,A.lastBaseUpdate=te,A.shared.pending=null}}while(!0);ne===null&&(Y=oe),A.baseState=Y,A.firstBaseUpdate=$,A.lastBaseUpdate=ne,y===null&&(A.shared.lanes=0),Gs|=F,s.lanes=F,s.memoizedState=oe}}function Md(s,a){if(typeof s!="function")throw Error(n(191,s));s.call(a)}function Dd(s,a){var c=s.callbacks;if(c!==null)for(s.callbacks=null,s=0;s<c.length;s++)Md(c[s],a)}var ia=W(null),zo=W(0);function Nd(s,a){s=Es,ce(zo,s),ce(ia,a),Es=s|a.baseLanes}function Qc(){ce(zo,Es),ce(ia,ia.current)}function Xc(){Es=zo.current,le(ia),le(zo)}var Ls=0,ke=null,st=null,Vt=null,_o=!1,sa=!1,wn=!1,jo=0,ar=0,na=null,gp=0;function Dt(){throw Error(n(321))}function Zc(s,a){if(a===null)return!1;for(var c=0;c<a.length&&c<s.length;c++)if(!wi(s[c],a[c]))return!1;return!0}function Wc(s,a,c,d,A,y){return Ls=y,ke=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,_.H=s===null||s.memoizedState===null?f0:d0,wn=!1,y=c(d,A),wn=!1,sa&&(y=Ud(a,c,d,A)),Rd(s),y}function Rd(s){_.H=Qo;var a=st!==null&&st.next!==null;if(Ls=0,Vt=st=ke=null,_o=!1,ar=0,na=null,a)throw Error(n(300));s===null||jt||(s=s.dependencies,s!==null&&Bo(s)&&(jt=!0))}function Ud(s,a,c,d){ke=s;var A=0;do{if(sa&&(na=null),ar=0,sa=!1,25<=A)throw Error(n(301));if(A+=1,Vt=st=null,s.updateQueue!=null){var y=s.updateQueue;y.lastEffect=null,y.events=null,y.stores=null,y.memoCache!=null&&(y.memoCache.index=0)}_.H=bp,y=a(c,d)}while(sa);return y}function pp(){var s=_.H,a=s.useState()[0];return a=typeof a.then=="function"?rr(a):a,s=s.useState()[0],(st!==null?st.memoizedState:null)!==s&&(ke.flags|=1024),a}function Jc(){var s=jo!==0;return jo=0,s}function $c(s,a,c){a.updateQueue=s.updateQueue,a.flags&=-2053,s.lanes&=~c}function eu(s){if(_o){for(s=s.memoizedState;s!==null;){var a=s.queue;a!==null&&(a.pending=null),s=s.next}_o=!1}Ls=0,Vt=st=ke=null,sa=!1,ar=jo=0,na=null}function di(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Vt===null?ke.memoizedState=Vt=s:Vt=Vt.next=s,Vt}function Bt(){if(st===null){var s=ke.alternate;s=s!==null?s.memoizedState:null}else s=st.next;var a=Vt===null?ke.memoizedState:Vt.next;if(a!==null)Vt=a,st=s;else{if(s===null)throw ke.alternate===null?Error(n(467)):Error(n(310));st=s,s={memoizedState:st.memoizedState,baseState:st.baseState,baseQueue:st.baseQueue,queue:st.queue,next:null},Vt===null?ke.memoizedState=Vt=s:Vt=Vt.next=s}return Vt}function tu(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function rr(s){var a=ar;return ar+=1,na===null&&(na=[]),s=Sd(na,s,a),a=ke,(Vt===null?a.memoizedState:Vt.next)===null&&(a=a.alternate,_.H=a===null||a.memoizedState===null?f0:d0),s}function Go(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return rr(s);if(s.$$typeof===E)return ti(s)}throw Error(n(438,String(s)))}function iu(s){var a=null,c=ke.updateQueue;if(c!==null&&(a=c.memoCache),a==null){var d=ke.alternate;d!==null&&(d=d.updateQueue,d!==null&&(d=d.memoCache,d!=null&&(a={data:d.data.map(function(A){return A.slice()}),index:0})))}if(a==null&&(a={data:[],index:0}),c===null&&(c=tu(),ke.updateQueue=c),c.memoCache=a,c=a.data[a.index],c===void 0)for(c=a.data[a.index]=Array(s),d=0;d<s;d++)c[d]=I;return a.index++,c}function xs(s,a){return typeof a=="function"?a(s):a}function Yo(s){var a=Bt();return su(a,st,s)}function su(s,a,c){var d=s.queue;if(d===null)throw Error(n(311));d.lastRenderedReducer=c;var A=s.baseQueue,y=d.pending;if(y!==null){if(A!==null){var F=A.next;A.next=y.next,y.next=F}a.baseQueue=A=y,d.pending=null}if(y=s.baseState,A===null)s.memoizedState=y;else{a=A.next;var O=F=null,Y=null,$=a,ne=!1;do{var oe=$.lane&-536870913;if(oe!==$.lane?(Qe&oe)===oe:(Ls&oe)===oe){var ee=$.revertLane;if(ee===0)Y!==null&&(Y=Y.next={lane:0,revertLane:0,action:$.action,hasEagerState:$.hasEagerState,eagerState:$.eagerState,next:null}),oe===ea&&(ne=!0);else if((Ls&ee)===ee){$=$.next,ee===ea&&(ne=!0);continue}else oe={lane:0,revertLane:$.revertLane,action:$.action,hasEagerState:$.hasEagerState,eagerState:$.eagerState,next:null},Y===null?(O=Y=oe,F=y):Y=Y.next=oe,ke.lanes|=ee,Gs|=ee;oe=$.action,wn&&c(y,oe),y=$.hasEagerState?$.eagerState:c(y,oe)}else ee={lane:oe,revertLane:$.revertLane,action:$.action,hasEagerState:$.hasEagerState,eagerState:$.eagerState,next:null},Y===null?(O=Y=ee,F=y):Y=Y.next=ee,ke.lanes|=oe,Gs|=oe;$=$.next}while($!==null&&$!==a);if(Y===null?F=y:Y.next=O,!wi(y,s.memoizedState)&&(jt=!0,ne&&(c=ta,c!==null)))throw c;s.memoizedState=y,s.baseState=F,s.baseQueue=Y,d.lastRenderedState=y}return A===null&&(d.lanes=0),[s.memoizedState,d.dispatch]}function nu(s){var a=Bt(),c=a.queue;if(c===null)throw Error(n(311));c.lastRenderedReducer=s;var d=c.dispatch,A=c.pending,y=a.memoizedState;if(A!==null){c.pending=null;var F=A=A.next;do y=s(y,F.action),F=F.next;while(F!==A);wi(y,a.memoizedState)||(jt=!0),a.memoizedState=y,a.baseQueue===null&&(a.baseState=y),c.lastRenderedState=y}return[y,d]}function Id(s,a,c){var d=ke,A=Bt(),y=$e;if(y){if(c===void 0)throw Error(n(407));c=c()}else c=a();var F=!wi((st||A).memoizedState,c);F&&(A.memoizedState=c,jt=!0),A=A.queue;var O=Bd.bind(null,d,A,s);if(or(2048,8,O,[s]),A.getSnapshot!==a||F||Vt!==null&&Vt.memoizedState.tag&1){if(d.flags|=2048,aa(9,Ho(),Vd.bind(null,d,A,c,a),null),lt===null)throw Error(n(349));y||(Ls&124)!==0||Fd(d,a,c)}return c}function Fd(s,a,c){s.flags|=16384,s={getSnapshot:a,value:c},a=ke.updateQueue,a===null?(a=tu(),ke.updateQueue=a,a.stores=[s]):(c=a.stores,c===null?a.stores=[s]:c.push(s))}function Vd(s,a,c,d){a.value=c,a.getSnapshot=d,Ld(a)&&Od(s)}function Bd(s,a,c){return c(function(){Ld(a)&&Od(s)})}function Ld(s){var a=s.getSnapshot;s=s.value;try{var c=a();return!wi(s,c)}catch{return!0}}function Od(s){var a=Zn(s,2);a!==null&&Mi(a,s,2)}function au(s){var a=di();if(typeof s=="function"){var c=s;if(s=c(),wn){hi(!0);try{c()}finally{hi(!1)}}}return a.memoizedState=a.baseState=s,a.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:xs,lastRenderedState:s},a}function kd(s,a,c,d){return s.baseState=c,su(s,st,typeof d=="function"?d:xs)}function Ap(s,a,c,d,A){if(Ko(s))throw Error(n(485));if(s=a.action,s!==null){var y={payload:A,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(F){y.listeners.push(F)}};_.T!==null?c(!0):y.isTransition=!1,d(y),c=a.pending,c===null?(y.next=a.pending=y,Pd(a,y)):(y.next=c.next,a.pending=c.next=y)}}function Pd(s,a){var c=a.action,d=a.payload,A=s.state;if(a.isTransition){var y=_.T,F={};_.T=F;try{var O=c(A,d),Y=_.S;Y!==null&&Y(F,O),zd(s,a,O)}catch($){ru(s,a,$)}finally{_.T=y}}else try{y=c(A,d),zd(s,a,y)}catch($){ru(s,a,$)}}function zd(s,a,c){c!==null&&typeof c=="object"&&typeof c.then=="function"?c.then(function(d){_d(s,a,d)},function(d){return ru(s,a,d)}):_d(s,a,c)}function _d(s,a,c){a.status="fulfilled",a.value=c,jd(a),s.state=c,a=s.pending,a!==null&&(c=a.next,c===a?s.pending=null:(c=c.next,a.next=c,Pd(s,c)))}function ru(s,a,c){var d=s.pending;if(s.pending=null,d!==null){d=d.next;do a.status="rejected",a.reason=c,jd(a),a=a.next;while(a!==d)}s.action=null}function jd(s){s=s.listeners;for(var a=0;a<s.length;a++)(0,s[a])()}function Gd(s,a){return a}function Yd(s,a){if($e){var c=lt.formState;if(c!==null){e:{var d=ke;if($e){if(St){t:{for(var A=St,y=ts;A.nodeType!==8;){if(!y){A=null;break t}if(A=Zi(A.nextSibling),A===null){A=null;break t}}y=A.data,A=y==="F!"||y==="F"?A:null}if(A){St=Zi(A.nextSibling),d=A.data==="F!";break e}}An(d)}d=!1}d&&(a=c[0])}}return c=di(),c.memoizedState=c.baseState=a,d={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Gd,lastRenderedState:a},c.queue=d,c=c0.bind(null,ke,d),d.dispatch=c,d=au(!1),y=hu.bind(null,ke,!1,d.queue),d=di(),A={state:a,dispatch:null,action:s,pending:null},d.queue=A,c=Ap.bind(null,ke,A,y,c),A.dispatch=c,d.memoizedState=s,[a,c,!1]}function Hd(s){var a=Bt();return qd(a,st,s)}function qd(s,a,c){if(a=su(s,a,Gd)[0],s=Yo(xs)[0],typeof a=="object"&&a!==null&&typeof a.then=="function")try{var d=rr(a)}catch(F){throw F===er?ko:F}else d=a;a=Bt();var A=a.queue,y=A.dispatch;return c!==a.memoizedState&&(ke.flags|=2048,aa(9,Ho(),vp.bind(null,A,c),null)),[d,y,s]}function vp(s,a){s.action=a}function Kd(s){var a=Bt(),c=st;if(c!==null)return qd(a,c,s);Bt(),a=a.memoizedState,c=Bt();var d=c.queue.dispatch;return c.memoizedState=s,[a,d,!1]}function aa(s,a,c,d){return s={tag:s,create:c,deps:d,inst:a,next:null},a=ke.updateQueue,a===null&&(a=tu(),ke.updateQueue=a),c=a.lastEffect,c===null?a.lastEffect=s.next=s:(d=c.next,c.next=s,s.next=d,a.lastEffect=s),s}function Ho(){return{destroy:void 0,resource:void 0}}function Qd(){return Bt().memoizedState}function qo(s,a,c,d){var A=di();d=d===void 0?null:d,ke.flags|=s,A.memoizedState=aa(1|a,Ho(),c,d)}function or(s,a,c,d){var A=Bt();d=d===void 0?null:d;var y=A.memoizedState.inst;st!==null&&d!==null&&Zc(d,st.memoizedState.deps)?A.memoizedState=aa(a,y,c,d):(ke.flags|=s,A.memoizedState=aa(1|a,y,c,d))}function Xd(s,a){qo(8390656,8,s,a)}function Zd(s,a){or(2048,8,s,a)}function Wd(s,a){return or(4,2,s,a)}function Jd(s,a){return or(4,4,s,a)}function $d(s,a){if(typeof a=="function"){s=s();var c=a(s);return function(){typeof c=="function"?c():a(null)}}if(a!=null)return s=s(),a.current=s,function(){a.current=null}}function e0(s,a,c){c=c!=null?c.concat([s]):null,or(4,4,$d.bind(null,a,s),c)}function ou(){}function t0(s,a){var c=Bt();a=a===void 0?null:a;var d=c.memoizedState;return a!==null&&Zc(a,d[1])?d[0]:(c.memoizedState=[s,a],s)}function i0(s,a){var c=Bt();a=a===void 0?null:a;var d=c.memoizedState;if(a!==null&&Zc(a,d[1]))return d[0];if(d=s(),wn){hi(!0);try{s()}finally{hi(!1)}}return c.memoizedState=[d,a],d}function lu(s,a,c){return c===void 0||(Ls&1073741824)!==0?s.memoizedState=a:(s.memoizedState=c,s=a1(),ke.lanes|=s,Gs|=s,c)}function s0(s,a,c,d){return wi(c,a)?c:ia.current!==null?(s=lu(s,c,d),wi(s,a)||(jt=!0),s):(Ls&42)===0?(jt=!0,s.memoizedState=c):(s=a1(),ke.lanes|=s,Gs|=s,a)}function n0(s,a,c,d,A){var y=H.p;H.p=y!==0&&8>y?y:8;var F=_.T,O={};_.T=O,hu(s,!1,a,c);try{var Y=A(),$=_.S;if($!==null&&$(O,Y),Y!==null&&typeof Y=="object"&&typeof Y.then=="function"){var ne=mp(Y,d);lr(s,a,ne,Ti(s))}else lr(s,a,d,Ti(s))}catch(oe){lr(s,a,{then:function(){},status:"rejected",reason:oe},Ti())}finally{H.p=y,_.T=F}}function xp(){}function cu(s,a,c,d){if(s.tag!==5)throw Error(n(476));var A=a0(s).queue;n0(s,A,a,q,c===null?xp:function(){return r0(s),c(d)})}function a0(s){var a=s.memoizedState;if(a!==null)return a;a={memoizedState:q,baseState:q,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:xs,lastRenderedState:q},next:null};var c={};return a.next={memoizedState:c,baseState:c,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:xs,lastRenderedState:c},next:null},s.memoizedState=a,s=s.alternate,s!==null&&(s.memoizedState=a),a}function r0(s){var a=a0(s).next.queue;lr(s,a,{},Ti())}function uu(){return ti(Tr)}function o0(){return Bt().memoizedState}function l0(){return Bt().memoizedState}function yp(s){for(var a=s.return;a!==null;){switch(a.tag){case 24:case 3:var c=Ti();s=Vs(c);var d=Bs(a,s,c);d!==null&&(Mi(d,a,c),ir(d,a,c)),a={cache:zc()},s.payload=a;return}a=a.return}}function wp(s,a,c){var d=Ti();c={lane:d,revertLane:0,action:c,hasEagerState:!1,eagerState:null,next:null},Ko(s)?u0(a,c):(c=Rc(s,a,c,d),c!==null&&(Mi(c,s,d),h0(c,a,d)))}function c0(s,a,c){var d=Ti();lr(s,a,c,d)}function lr(s,a,c,d){var A={lane:d,revertLane:0,action:c,hasEagerState:!1,eagerState:null,next:null};if(Ko(s))u0(a,A);else{var y=s.alternate;if(s.lanes===0&&(y===null||y.lanes===0)&&(y=a.lastRenderedReducer,y!==null))try{var F=a.lastRenderedState,O=y(F,c);if(A.hasEagerState=!0,A.eagerState=O,wi(O,F))return Ro(s,a,A,0),lt===null&&No(),!1}catch{}finally{}if(c=Rc(s,a,A,d),c!==null)return Mi(c,s,d),h0(c,a,d),!0}return!1}function hu(s,a,c,d){if(d={lane:2,revertLane:Gu(),action:d,hasEagerState:!1,eagerState:null,next:null},Ko(s)){if(a)throw Error(n(479))}else a=Rc(s,c,d,2),a!==null&&Mi(a,s,2)}function Ko(s){var a=s.alternate;return s===ke||a!==null&&a===ke}function u0(s,a){sa=_o=!0;var c=s.pending;c===null?a.next=a:(a.next=c.next,c.next=a),s.pending=a}function h0(s,a,c){if((c&4194048)!==0){var d=a.lanes;d&=s.pendingLanes,c|=d,a.lanes=c,go(s,c)}}var Qo={readContext:ti,use:Go,useCallback:Dt,useContext:Dt,useEffect:Dt,useImperativeHandle:Dt,useLayoutEffect:Dt,useInsertionEffect:Dt,useMemo:Dt,useReducer:Dt,useRef:Dt,useState:Dt,useDebugValue:Dt,useDeferredValue:Dt,useTransition:Dt,useSyncExternalStore:Dt,useId:Dt,useHostTransitionStatus:Dt,useFormState:Dt,useActionState:Dt,useOptimistic:Dt,useMemoCache:Dt,useCacheRefresh:Dt},f0={readContext:ti,use:Go,useCallback:function(s,a){return di().memoizedState=[s,a===void 0?null:a],s},useContext:ti,useEffect:Xd,useImperativeHandle:function(s,a,c){c=c!=null?c.concat([s]):null,qo(4194308,4,$d.bind(null,a,s),c)},useLayoutEffect:function(s,a){return qo(4194308,4,s,a)},useInsertionEffect:function(s,a){qo(4,2,s,a)},useMemo:function(s,a){var c=di();a=a===void 0?null:a;var d=s();if(wn){hi(!0);try{s()}finally{hi(!1)}}return c.memoizedState=[d,a],d},useReducer:function(s,a,c){var d=di();if(c!==void 0){var A=c(a);if(wn){hi(!0);try{c(a)}finally{hi(!1)}}}else A=a;return d.memoizedState=d.baseState=A,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:A},d.queue=s,s=s.dispatch=wp.bind(null,ke,s),[d.memoizedState,s]},useRef:function(s){var a=di();return s={current:s},a.memoizedState=s},useState:function(s){s=au(s);var a=s.queue,c=c0.bind(null,ke,a);return a.dispatch=c,[s.memoizedState,c]},useDebugValue:ou,useDeferredValue:function(s,a){var c=di();return lu(c,s,a)},useTransition:function(){var s=au(!1);return s=n0.bind(null,ke,s.queue,!0,!1),di().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,a,c){var d=ke,A=di();if($e){if(c===void 0)throw Error(n(407));c=c()}else{if(c=a(),lt===null)throw Error(n(349));(Qe&124)!==0||Fd(d,a,c)}A.memoizedState=c;var y={value:c,getSnapshot:a};return A.queue=y,Xd(Bd.bind(null,d,y,s),[s]),d.flags|=2048,aa(9,Ho(),Vd.bind(null,d,y,c,a),null),c},useId:function(){var s=di(),a=lt.identifierPrefix;if($e){var c=ps,d=gs;c=(d&~(1<<32-It(d)-1)).toString(32)+c,a=""+a+"R"+c,c=jo++,0<c&&(a+="H"+c.toString(32)),a+=""}else c=gp++,a=""+a+"r"+c.toString(32)+"";return s.memoizedState=a},useHostTransitionStatus:uu,useFormState:Yd,useActionState:Yd,useOptimistic:function(s){var a=di();a.memoizedState=a.baseState=s;var c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return a.queue=c,a=hu.bind(null,ke,!0,c),c.dispatch=a,[s,a]},useMemoCache:iu,useCacheRefresh:function(){return di().memoizedState=yp.bind(null,ke)}},d0={readContext:ti,use:Go,useCallback:t0,useContext:ti,useEffect:Zd,useImperativeHandle:e0,useInsertionEffect:Wd,useLayoutEffect:Jd,useMemo:i0,useReducer:Yo,useRef:Qd,useState:function(){return Yo(xs)},useDebugValue:ou,useDeferredValue:function(s,a){var c=Bt();return s0(c,st.memoizedState,s,a)},useTransition:function(){var s=Yo(xs)[0],a=Bt().memoizedState;return[typeof s=="boolean"?s:rr(s),a]},useSyncExternalStore:Id,useId:o0,useHostTransitionStatus:uu,useFormState:Hd,useActionState:Hd,useOptimistic:function(s,a){var c=Bt();return kd(c,st,s,a)},useMemoCache:iu,useCacheRefresh:l0},bp={readContext:ti,use:Go,useCallback:t0,useContext:ti,useEffect:Zd,useImperativeHandle:e0,useInsertionEffect:Wd,useLayoutEffect:Jd,useMemo:i0,useReducer:nu,useRef:Qd,useState:function(){return nu(xs)},useDebugValue:ou,useDeferredValue:function(s,a){var c=Bt();return st===null?lu(c,s,a):s0(c,st.memoizedState,s,a)},useTransition:function(){var s=nu(xs)[0],a=Bt().memoizedState;return[typeof s=="boolean"?s:rr(s),a]},useSyncExternalStore:Id,useId:o0,useHostTransitionStatus:uu,useFormState:Kd,useActionState:Kd,useOptimistic:function(s,a){var c=Bt();return st!==null?kd(c,st,s,a):(c.baseState=s,[s,c.queue.dispatch])},useMemoCache:iu,useCacheRefresh:l0},ra=null,cr=0;function Xo(s){var a=cr;return cr+=1,ra===null&&(ra=[]),Sd(ra,s,a)}function ur(s,a){a=a.props.ref,s.ref=a!==void 0?a:null}function Zo(s,a){throw a.$$typeof===g?Error(n(525)):(s=Object.prototype.toString.call(a),Error(n(31,s==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":s)))}function m0(s){var a=s._init;return a(s._payload)}function g0(s){function a(Z,Q){if(s){var J=Z.deletions;J===null?(Z.deletions=[Q],Z.flags|=16):J.push(Q)}}function c(Z,Q){if(!s)return null;for(;Q!==null;)a(Z,Q),Q=Q.sibling;return null}function d(Z){for(var Q=new Map;Z!==null;)Z.key!==null?Q.set(Z.key,Z):Q.set(Z.index,Z),Z=Z.sibling;return Q}function A(Z,Q){return Z=ms(Z,Q),Z.index=0,Z.sibling=null,Z}function y(Z,Q,J){return Z.index=J,s?(J=Z.alternate,J!==null?(J=J.index,J<Q?(Z.flags|=67108866,Q):J):(Z.flags|=67108866,Q)):(Z.flags|=1048576,Q)}function F(Z){return s&&Z.alternate===null&&(Z.flags|=67108866),Z}function O(Z,Q,J,ae){return Q===null||Q.tag!==6?(Q=Ic(J,Z.mode,ae),Q.return=Z,Q):(Q=A(Q,J),Q.return=Z,Q)}function Y(Z,Q,J,ae){var ge=J.type;return ge===x?ne(Z,Q,J.props.children,ae,J.key):Q!==null&&(Q.elementType===ge||typeof ge=="object"&&ge!==null&&ge.$$typeof===M&&m0(ge)===Q.type)?(Q=A(Q,J.props),ur(Q,J),Q.return=Z,Q):(Q=Io(J.type,J.key,J.props,null,Z.mode,ae),ur(Q,J),Q.return=Z,Q)}function $(Z,Q,J,ae){return Q===null||Q.tag!==4||Q.stateNode.containerInfo!==J.containerInfo||Q.stateNode.implementation!==J.implementation?(Q=Fc(J,Z.mode,ae),Q.return=Z,Q):(Q=A(Q,J.children||[]),Q.return=Z,Q)}function ne(Z,Q,J,ae,ge){return Q===null||Q.tag!==7?(Q=dn(J,Z.mode,ae,ge),Q.return=Z,Q):(Q=A(Q,J),Q.return=Z,Q)}function oe(Z,Q,J){if(typeof Q=="string"&&Q!==""||typeof Q=="number"||typeof Q=="bigint")return Q=Ic(""+Q,Z.mode,J),Q.return=Z,Q;if(typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case p:return J=Io(Q.type,Q.key,Q.props,null,Z.mode,J),ur(J,Q),J.return=Z,J;case v:return Q=Fc(Q,Z.mode,J),Q.return=Z,Q;case M:var ae=Q._init;return Q=ae(Q._payload),oe(Z,Q,J)}if(K(Q)||U(Q))return Q=dn(Q,Z.mode,J,null),Q.return=Z,Q;if(typeof Q.then=="function")return oe(Z,Xo(Q),J);if(Q.$$typeof===E)return oe(Z,Lo(Z,Q),J);Zo(Z,Q)}return null}function ee(Z,Q,J,ae){var ge=Q!==null?Q.key:null;if(typeof J=="string"&&J!==""||typeof J=="number"||typeof J=="bigint")return ge!==null?null:O(Z,Q,""+J,ae);if(typeof J=="object"&&J!==null){switch(J.$$typeof){case p:return J.key===ge?Y(Z,Q,J,ae):null;case v:return J.key===ge?$(Z,Q,J,ae):null;case M:return ge=J._init,J=ge(J._payload),ee(Z,Q,J,ae)}if(K(J)||U(J))return ge!==null?null:ne(Z,Q,J,ae,null);if(typeof J.then=="function")return ee(Z,Q,Xo(J),ae);if(J.$$typeof===E)return ee(Z,Q,Lo(Z,J),ae);Zo(Z,J)}return null}function te(Z,Q,J,ae,ge){if(typeof ae=="string"&&ae!==""||typeof ae=="number"||typeof ae=="bigint")return Z=Z.get(J)||null,O(Q,Z,""+ae,ge);if(typeof ae=="object"&&ae!==null){switch(ae.$$typeof){case p:return Z=Z.get(ae.key===null?J:ae.key)||null,Y(Q,Z,ae,ge);case v:return Z=Z.get(ae.key===null?J:ae.key)||null,$(Q,Z,ae,ge);case M:var Pe=ae._init;return ae=Pe(ae._payload),te(Z,Q,J,ae,ge)}if(K(ae)||U(ae))return Z=Z.get(J)||null,ne(Q,Z,ae,ge,null);if(typeof ae.then=="function")return te(Z,Q,J,Xo(ae),ge);if(ae.$$typeof===E)return te(Z,Q,J,Lo(Q,ae),ge);Zo(Q,ae)}return null}function Me(Z,Q,J,ae){for(var ge=null,Pe=null,be=Q,Ee=Q=0,Yt=null;be!==null&&Ee<J.length;Ee++){be.index>Ee?(Yt=be,be=null):Yt=be.sibling;var Ze=ee(Z,be,J[Ee],ae);if(Ze===null){be===null&&(be=Yt);break}s&&be&&Ze.alternate===null&&a(Z,be),Q=y(Ze,Q,Ee),Pe===null?ge=Ze:Pe.sibling=Ze,Pe=Ze,be=Yt}if(Ee===J.length)return c(Z,be),$e&&gn(Z,Ee),ge;if(be===null){for(;Ee<J.length;Ee++)be=oe(Z,J[Ee],ae),be!==null&&(Q=y(be,Q,Ee),Pe===null?ge=be:Pe.sibling=be,Pe=be);return $e&&gn(Z,Ee),ge}for(be=d(be);Ee<J.length;Ee++)Yt=te(be,Z,Ee,J[Ee],ae),Yt!==null&&(s&&Yt.alternate!==null&&be.delete(Yt.key===null?Ee:Yt.key),Q=y(Yt,Q,Ee),Pe===null?ge=Yt:Pe.sibling=Yt,Pe=Yt);return s&&be.forEach(function(Js){return a(Z,Js)}),$e&&gn(Z,Ee),ge}function Ce(Z,Q,J,ae){if(J==null)throw Error(n(151));for(var ge=null,Pe=null,be=Q,Ee=Q=0,Yt=null,Ze=J.next();be!==null&&!Ze.done;Ee++,Ze=J.next()){be.index>Ee?(Yt=be,be=null):Yt=be.sibling;var Js=ee(Z,be,Ze.value,ae);if(Js===null){be===null&&(be=Yt);break}s&&be&&Js.alternate===null&&a(Z,be),Q=y(Js,Q,Ee),Pe===null?ge=Js:Pe.sibling=Js,Pe=Js,be=Yt}if(Ze.done)return c(Z,be),$e&&gn(Z,Ee),ge;if(be===null){for(;!Ze.done;Ee++,Ze=J.next())Ze=oe(Z,Ze.value,ae),Ze!==null&&(Q=y(Ze,Q,Ee),Pe===null?ge=Ze:Pe.sibling=Ze,Pe=Ze);return $e&&gn(Z,Ee),ge}for(be=d(be);!Ze.done;Ee++,Ze=J.next())Ze=te(be,Z,Ee,Ze.value,ae),Ze!==null&&(s&&Ze.alternate!==null&&be.delete(Ze.key===null?Ee:Ze.key),Q=y(Ze,Q,Ee),Pe===null?ge=Ze:Pe.sibling=Ze,Pe=Ze);return s&&be.forEach(function(CA){return a(Z,CA)}),$e&&gn(Z,Ee),ge}function at(Z,Q,J,ae){if(typeof J=="object"&&J!==null&&J.type===x&&J.key===null&&(J=J.props.children),typeof J=="object"&&J!==null){switch(J.$$typeof){case p:e:{for(var ge=J.key;Q!==null;){if(Q.key===ge){if(ge=J.type,ge===x){if(Q.tag===7){c(Z,Q.sibling),ae=A(Q,J.props.children),ae.return=Z,Z=ae;break e}}else if(Q.elementType===ge||typeof ge=="object"&&ge!==null&&ge.$$typeof===M&&m0(ge)===Q.type){c(Z,Q.sibling),ae=A(Q,J.props),ur(ae,J),ae.return=Z,Z=ae;break e}c(Z,Q);break}else a(Z,Q);Q=Q.sibling}J.type===x?(ae=dn(J.props.children,Z.mode,ae,J.key),ae.return=Z,Z=ae):(ae=Io(J.type,J.key,J.props,null,Z.mode,ae),ur(ae,J),ae.return=Z,Z=ae)}return F(Z);case v:e:{for(ge=J.key;Q!==null;){if(Q.key===ge)if(Q.tag===4&&Q.stateNode.containerInfo===J.containerInfo&&Q.stateNode.implementation===J.implementation){c(Z,Q.sibling),ae=A(Q,J.children||[]),ae.return=Z,Z=ae;break e}else{c(Z,Q);break}else a(Z,Q);Q=Q.sibling}ae=Fc(J,Z.mode,ae),ae.return=Z,Z=ae}return F(Z);case M:return ge=J._init,J=ge(J._payload),at(Z,Q,J,ae)}if(K(J))return Me(Z,Q,J,ae);if(U(J)){if(ge=U(J),typeof ge!="function")throw Error(n(150));return J=ge.call(J),Ce(Z,Q,J,ae)}if(typeof J.then=="function")return at(Z,Q,Xo(J),ae);if(J.$$typeof===E)return at(Z,Q,Lo(Z,J),ae);Zo(Z,J)}return typeof J=="string"&&J!==""||typeof J=="number"||typeof J=="bigint"?(J=""+J,Q!==null&&Q.tag===6?(c(Z,Q.sibling),ae=A(Q,J),ae.return=Z,Z=ae):(c(Z,Q),ae=Ic(J,Z.mode,ae),ae.return=Z,Z=ae),F(Z)):c(Z,Q)}return function(Z,Q,J,ae){try{cr=0;var ge=at(Z,Q,J,ae);return ra=null,ge}catch(be){if(be===er||be===ko)throw be;var Pe=bi(29,be,null,Z.mode);return Pe.lanes=ae,Pe.return=Z,Pe}finally{}}}var oa=g0(!0),p0=g0(!1),ji=W(null),is=null;function Os(s){var a=s.alternate;ce(kt,kt.current&1),ce(ji,s),is===null&&(a===null||ia.current!==null||a.memoizedState!==null)&&(is=s)}function A0(s){if(s.tag===22){if(ce(kt,kt.current),ce(ji,s),is===null){var a=s.alternate;a!==null&&a.memoizedState!==null&&(is=s)}}else ks()}function ks(){ce(kt,kt.current),ce(ji,ji.current)}function ys(s){le(ji),is===s&&(is=null),le(kt)}var kt=W(0);function Wo(s){for(var a=s;a!==null;){if(a.tag===13){var c=a.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||c.data==="$?"||th(c)))return a}else if(a.tag===19&&a.memoizedProps.revealOrder!==void 0){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===s)break;for(;a.sibling===null;){if(a.return===null||a.return===s)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}function fu(s,a,c,d){a=s.memoizedState,c=c(d,a),c=c==null?a:m({},a,c),s.memoizedState=c,s.lanes===0&&(s.updateQueue.baseState=c)}var du={enqueueSetState:function(s,a,c){s=s._reactInternals;var d=Ti(),A=Vs(d);A.payload=a,c!=null&&(A.callback=c),a=Bs(s,A,d),a!==null&&(Mi(a,s,d),ir(a,s,d))},enqueueReplaceState:function(s,a,c){s=s._reactInternals;var d=Ti(),A=Vs(d);A.tag=1,A.payload=a,c!=null&&(A.callback=c),a=Bs(s,A,d),a!==null&&(Mi(a,s,d),ir(a,s,d))},enqueueForceUpdate:function(s,a){s=s._reactInternals;var c=Ti(),d=Vs(c);d.tag=2,a!=null&&(d.callback=a),a=Bs(s,d,c),a!==null&&(Mi(a,s,c),ir(a,s,c))}};function v0(s,a,c,d,A,y,F){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(d,y,F):a.prototype&&a.prototype.isPureReactComponent?!qa(c,d)||!qa(A,y):!0}function x0(s,a,c,d){s=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(c,d),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(c,d),a.state!==s&&du.enqueueReplaceState(a,a.state,null)}function bn(s,a){var c=a;if("ref"in a){c={};for(var d in a)d!=="ref"&&(c[d]=a[d])}if(s=s.defaultProps){c===a&&(c=m({},c));for(var A in s)c[A]===void 0&&(c[A]=s[A])}return c}var Jo=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var a=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(a))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)};function y0(s){Jo(s)}function w0(s){console.error(s)}function b0(s){Jo(s)}function $o(s,a){try{var c=s.onUncaughtError;c(a.value,{componentStack:a.stack})}catch(d){setTimeout(function(){throw d})}}function C0(s,a,c){try{var d=s.onCaughtError;d(c.value,{componentStack:c.stack,errorBoundary:a.tag===1?a.stateNode:null})}catch(A){setTimeout(function(){throw A})}}function mu(s,a,c){return c=Vs(c),c.tag=3,c.payload={element:null},c.callback=function(){$o(s,a)},c}function S0(s){return s=Vs(s),s.tag=3,s}function E0(s,a,c,d){var A=c.type.getDerivedStateFromError;if(typeof A=="function"){var y=d.value;s.payload=function(){return A(y)},s.callback=function(){C0(a,c,d)}}var F=c.stateNode;F!==null&&typeof F.componentDidCatch=="function"&&(s.callback=function(){C0(a,c,d),typeof A!="function"&&(Ys===null?Ys=new Set([this]):Ys.add(this));var O=d.stack;this.componentDidCatch(d.value,{componentStack:O!==null?O:""})})}function Cp(s,a,c,d,A){if(c.flags|=32768,d!==null&&typeof d=="object"&&typeof d.then=="function"){if(a=c.alternate,a!==null&&Wa(a,c,A,!0),c=ji.current,c!==null){switch(c.tag){case 13:return is===null?ku():c.alternate===null&&Et===0&&(Et=3),c.flags&=-257,c.flags|=65536,c.lanes=A,d===Gc?c.flags|=16384:(a=c.updateQueue,a===null?c.updateQueue=new Set([d]):a.add(d),zu(s,d,A)),!1;case 22:return c.flags|=65536,d===Gc?c.flags|=16384:(a=c.updateQueue,a===null?(a={transitions:null,markerInstances:null,retryQueue:new Set([d])},c.updateQueue=a):(c=a.retryQueue,c===null?a.retryQueue=new Set([d]):c.add(d)),zu(s,d,A)),!1}throw Error(n(435,c.tag))}return zu(s,d,A),ku(),!1}if($e)return a=ji.current,a!==null?((a.flags&65536)===0&&(a.flags|=256),a.flags|=65536,a.lanes=A,d!==Lc&&(s=Error(n(422),{cause:d}),Za(ki(s,c)))):(d!==Lc&&(a=Error(n(423),{cause:d}),Za(ki(a,c))),s=s.current.alternate,s.flags|=65536,A&=-A,s.lanes|=A,d=ki(d,c),A=mu(s.stateNode,d,A),qc(s,A),Et!==4&&(Et=2)),!1;var y=Error(n(520),{cause:d});if(y=ki(y,c),Ar===null?Ar=[y]:Ar.push(y),Et!==4&&(Et=2),a===null)return!0;d=ki(d,c),c=a;do{switch(c.tag){case 3:return c.flags|=65536,s=A&-A,c.lanes|=s,s=mu(c.stateNode,d,s),qc(c,s),!1;case 1:if(a=c.type,y=c.stateNode,(c.flags&128)===0&&(typeof a.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(Ys===null||!Ys.has(y))))return c.flags|=65536,A&=-A,c.lanes|=A,A=S0(A),E0(A,s,c,d),qc(c,A),!1}c=c.return}while(c!==null);return!1}var T0=Error(n(461)),jt=!1;function Jt(s,a,c,d){a.child=s===null?p0(a,null,c,d):oa(a,s.child,c,d)}function M0(s,a,c,d,A){c=c.render;var y=a.ref;if("ref"in d){var F={};for(var O in d)O!=="ref"&&(F[O]=d[O])}else F=d;return xn(a),d=Wc(s,a,c,F,y,A),O=Jc(),s!==null&&!jt?($c(s,a,A),ws(s,a,A)):($e&&O&&Vc(a),a.flags|=1,Jt(s,a,d,A),a.child)}function D0(s,a,c,d,A){if(s===null){var y=c.type;return typeof y=="function"&&!Uc(y)&&y.defaultProps===void 0&&c.compare===null?(a.tag=15,a.type=y,N0(s,a,y,d,A)):(s=Io(c.type,null,d,a,a.mode,A),s.ref=a.ref,s.return=a,a.child=s)}if(y=s.child,!bu(s,A)){var F=y.memoizedProps;if(c=c.compare,c=c!==null?c:qa,c(F,d)&&s.ref===a.ref)return ws(s,a,A)}return a.flags|=1,s=ms(y,d),s.ref=a.ref,s.return=a,a.child=s}function N0(s,a,c,d,A){if(s!==null){var y=s.memoizedProps;if(qa(y,d)&&s.ref===a.ref)if(jt=!1,a.pendingProps=d=y,bu(s,A))(s.flags&131072)!==0&&(jt=!0);else return a.lanes=s.lanes,ws(s,a,A)}return gu(s,a,c,d,A)}function R0(s,a,c){var d=a.pendingProps,A=d.children,y=s!==null?s.memoizedState:null;if(d.mode==="hidden"){if((a.flags&128)!==0){if(d=y!==null?y.baseLanes|c:c,s!==null){for(A=a.child=s.child,y=0;A!==null;)y=y|A.lanes|A.childLanes,A=A.sibling;a.childLanes=y&~d}else a.childLanes=0,a.child=null;return U0(s,a,d,c)}if((c&536870912)!==0)a.memoizedState={baseLanes:0,cachePool:null},s!==null&&Oo(a,y!==null?y.cachePool:null),y!==null?Nd(a,y):Qc(),A0(a);else return a.lanes=a.childLanes=536870912,U0(s,a,y!==null?y.baseLanes|c:c,c)}else y!==null?(Oo(a,y.cachePool),Nd(a,y),ks(),a.memoizedState=null):(s!==null&&Oo(a,null),Qc(),ks());return Jt(s,a,A,c),a.child}function U0(s,a,c,d){var A=jc();return A=A===null?null:{parent:Ot._currentValue,pool:A},a.memoizedState={baseLanes:c,cachePool:A},s!==null&&Oo(a,null),Qc(),A0(a),s!==null&&Wa(s,a,d,!0),null}function el(s,a){var c=a.ref;if(c===null)s!==null&&s.ref!==null&&(a.flags|=4194816);else{if(typeof c!="function"&&typeof c!="object")throw Error(n(284));(s===null||s.ref!==c)&&(a.flags|=4194816)}}function gu(s,a,c,d,A){return xn(a),c=Wc(s,a,c,d,void 0,A),d=Jc(),s!==null&&!jt?($c(s,a,A),ws(s,a,A)):($e&&d&&Vc(a),a.flags|=1,Jt(s,a,c,A),a.child)}function I0(s,a,c,d,A,y){return xn(a),a.updateQueue=null,c=Ud(a,d,c,A),Rd(s),d=Jc(),s!==null&&!jt?($c(s,a,y),ws(s,a,y)):($e&&d&&Vc(a),a.flags|=1,Jt(s,a,c,y),a.child)}function F0(s,a,c,d,A){if(xn(a),a.stateNode===null){var y=Wn,F=c.contextType;typeof F=="object"&&F!==null&&(y=ti(F)),y=new c(d,y),a.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,y.updater=du,a.stateNode=y,y._reactInternals=a,y=a.stateNode,y.props=d,y.state=a.memoizedState,y.refs={},Yc(a),F=c.contextType,y.context=typeof F=="object"&&F!==null?ti(F):Wn,y.state=a.memoizedState,F=c.getDerivedStateFromProps,typeof F=="function"&&(fu(a,c,F,d),y.state=a.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof y.getSnapshotBeforeUpdate=="function"||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(F=y.state,typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount(),F!==y.state&&du.enqueueReplaceState(y,y.state,null),nr(a,d,y,A),sr(),y.state=a.memoizedState),typeof y.componentDidMount=="function"&&(a.flags|=4194308),d=!0}else if(s===null){y=a.stateNode;var O=a.memoizedProps,Y=bn(c,O);y.props=Y;var $=y.context,ne=c.contextType;F=Wn,typeof ne=="object"&&ne!==null&&(F=ti(ne));var oe=c.getDerivedStateFromProps;ne=typeof oe=="function"||typeof y.getSnapshotBeforeUpdate=="function",O=a.pendingProps!==O,ne||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(O||$!==F)&&x0(a,y,d,F),Fs=!1;var ee=a.memoizedState;y.state=ee,nr(a,d,y,A),sr(),$=a.memoizedState,O||ee!==$||Fs?(typeof oe=="function"&&(fu(a,c,oe,d),$=a.memoizedState),(Y=Fs||v0(a,c,Y,d,ee,$,F))?(ne||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount()),typeof y.componentDidMount=="function"&&(a.flags|=4194308)):(typeof y.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=d,a.memoizedState=$),y.props=d,y.state=$,y.context=F,d=Y):(typeof y.componentDidMount=="function"&&(a.flags|=4194308),d=!1)}else{y=a.stateNode,Hc(s,a),F=a.memoizedProps,ne=bn(c,F),y.props=ne,oe=a.pendingProps,ee=y.context,$=c.contextType,Y=Wn,typeof $=="object"&&$!==null&&(Y=ti($)),O=c.getDerivedStateFromProps,($=typeof O=="function"||typeof y.getSnapshotBeforeUpdate=="function")||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(F!==oe||ee!==Y)&&x0(a,y,d,Y),Fs=!1,ee=a.memoizedState,y.state=ee,nr(a,d,y,A),sr();var te=a.memoizedState;F!==oe||ee!==te||Fs||s!==null&&s.dependencies!==null&&Bo(s.dependencies)?(typeof O=="function"&&(fu(a,c,O,d),te=a.memoizedState),(ne=Fs||v0(a,c,ne,d,ee,te,Y)||s!==null&&s.dependencies!==null&&Bo(s.dependencies))?($||typeof y.UNSAFE_componentWillUpdate!="function"&&typeof y.componentWillUpdate!="function"||(typeof y.componentWillUpdate=="function"&&y.componentWillUpdate(d,te,Y),typeof y.UNSAFE_componentWillUpdate=="function"&&y.UNSAFE_componentWillUpdate(d,te,Y)),typeof y.componentDidUpdate=="function"&&(a.flags|=4),typeof y.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof y.componentDidUpdate!="function"||F===s.memoizedProps&&ee===s.memoizedState||(a.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||F===s.memoizedProps&&ee===s.memoizedState||(a.flags|=1024),a.memoizedProps=d,a.memoizedState=te),y.props=d,y.state=te,y.context=Y,d=ne):(typeof y.componentDidUpdate!="function"||F===s.memoizedProps&&ee===s.memoizedState||(a.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||F===s.memoizedProps&&ee===s.memoizedState||(a.flags|=1024),d=!1)}return y=d,el(s,a),d=(a.flags&128)!==0,y||d?(y=a.stateNode,c=d&&typeof c.getDerivedStateFromError!="function"?null:y.render(),a.flags|=1,s!==null&&d?(a.child=oa(a,s.child,null,A),a.child=oa(a,null,c,A)):Jt(s,a,c,A),a.memoizedState=y.state,s=a.child):s=ws(s,a,A),s}function V0(s,a,c,d){return Xa(),a.flags|=256,Jt(s,a,c,d),a.child}var pu={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Au(s){return{baseLanes:s,cachePool:wd()}}function vu(s,a,c){return s=s!==null?s.childLanes&~c:0,a&&(s|=Gi),s}function B0(s,a,c){var d=a.pendingProps,A=!1,y=(a.flags&128)!==0,F;if((F=y)||(F=s!==null&&s.memoizedState===null?!1:(kt.current&2)!==0),F&&(A=!0,a.flags&=-129),F=(a.flags&32)!==0,a.flags&=-33,s===null){if($e){if(A?Os(a):ks(),$e){var O=St,Y;if(Y=O){e:{for(Y=O,O=ts;Y.nodeType!==8;){if(!O){O=null;break e}if(Y=Zi(Y.nextSibling),Y===null){O=null;break e}}O=Y}O!==null?(a.memoizedState={dehydrated:O,treeContext:mn!==null?{id:gs,overflow:ps}:null,retryLane:536870912,hydrationErrors:null},Y=bi(18,null,null,0),Y.stateNode=O,Y.return=a,a.child=Y,oi=a,St=null,Y=!0):Y=!1}Y||An(a)}if(O=a.memoizedState,O!==null&&(O=O.dehydrated,O!==null))return th(O)?a.lanes=32:a.lanes=536870912,null;ys(a)}return O=d.children,d=d.fallback,A?(ks(),A=a.mode,O=tl({mode:"hidden",children:O},A),d=dn(d,A,c,null),O.return=a,d.return=a,O.sibling=d,a.child=O,A=a.child,A.memoizedState=Au(c),A.childLanes=vu(s,F,c),a.memoizedState=pu,d):(Os(a),xu(a,O))}if(Y=s.memoizedState,Y!==null&&(O=Y.dehydrated,O!==null)){if(y)a.flags&256?(Os(a),a.flags&=-257,a=yu(s,a,c)):a.memoizedState!==null?(ks(),a.child=s.child,a.flags|=128,a=null):(ks(),A=d.fallback,O=a.mode,d=tl({mode:"visible",children:d.children},O),A=dn(A,O,c,null),A.flags|=2,d.return=a,A.return=a,d.sibling=A,a.child=d,oa(a,s.child,null,c),d=a.child,d.memoizedState=Au(c),d.childLanes=vu(s,F,c),a.memoizedState=pu,a=A);else if(Os(a),th(O)){if(F=O.nextSibling&&O.nextSibling.dataset,F)var $=F.dgst;F=$,d=Error(n(419)),d.stack="",d.digest=F,Za({value:d,source:null,stack:null}),a=yu(s,a,c)}else if(jt||Wa(s,a,c,!1),F=(c&s.childLanes)!==0,jt||F){if(F=lt,F!==null&&(d=c&-c,d=(d&42)!==0?1:kn(d),d=(d&(F.suspendedLanes|c))!==0?0:d,d!==0&&d!==Y.retryLane))throw Y.retryLane=d,Zn(s,d),Mi(F,s,d),T0;O.data==="$?"||ku(),a=yu(s,a,c)}else O.data==="$?"?(a.flags|=192,a.child=s.child,a=null):(s=Y.treeContext,St=Zi(O.nextSibling),oi=a,$e=!0,pn=null,ts=!1,s!==null&&(zi[_i++]=gs,zi[_i++]=ps,zi[_i++]=mn,gs=s.id,ps=s.overflow,mn=a),a=xu(a,d.children),a.flags|=4096);return a}return A?(ks(),A=d.fallback,O=a.mode,Y=s.child,$=Y.sibling,d=ms(Y,{mode:"hidden",children:d.children}),d.subtreeFlags=Y.subtreeFlags&65011712,$!==null?A=ms($,A):(A=dn(A,O,c,null),A.flags|=2),A.return=a,d.return=a,d.sibling=A,a.child=d,d=A,A=a.child,O=s.child.memoizedState,O===null?O=Au(c):(Y=O.cachePool,Y!==null?($=Ot._currentValue,Y=Y.parent!==$?{parent:$,pool:$}:Y):Y=wd(),O={baseLanes:O.baseLanes|c,cachePool:Y}),A.memoizedState=O,A.childLanes=vu(s,F,c),a.memoizedState=pu,d):(Os(a),c=s.child,s=c.sibling,c=ms(c,{mode:"visible",children:d.children}),c.return=a,c.sibling=null,s!==null&&(F=a.deletions,F===null?(a.deletions=[s],a.flags|=16):F.push(s)),a.child=c,a.memoizedState=null,c)}function xu(s,a){return a=tl({mode:"visible",children:a},s.mode),a.return=s,s.child=a}function tl(s,a){return s=bi(22,s,null,a),s.lanes=0,s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},s}function yu(s,a,c){return oa(a,s.child,null,c),s=xu(a,a.pendingProps.children),s.flags|=2,a.memoizedState=null,s}function L0(s,a,c){s.lanes|=a;var d=s.alternate;d!==null&&(d.lanes|=a),kc(s.return,a,c)}function wu(s,a,c,d,A){var y=s.memoizedState;y===null?s.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:d,tail:c,tailMode:A}:(y.isBackwards=a,y.rendering=null,y.renderingStartTime=0,y.last=d,y.tail=c,y.tailMode=A)}function O0(s,a,c){var d=a.pendingProps,A=d.revealOrder,y=d.tail;if(Jt(s,a,d.children,c),d=kt.current,(d&2)!==0)d=d&1|2,a.flags|=128;else{if(s!==null&&(s.flags&128)!==0)e:for(s=a.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&L0(s,c,a);else if(s.tag===19)L0(s,c,a);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===a)break e;for(;s.sibling===null;){if(s.return===null||s.return===a)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}d&=1}switch(ce(kt,d),A){case"forwards":for(c=a.child,A=null;c!==null;)s=c.alternate,s!==null&&Wo(s)===null&&(A=c),c=c.sibling;c=A,c===null?(A=a.child,a.child=null):(A=c.sibling,c.sibling=null),wu(a,!1,A,c,y);break;case"backwards":for(c=null,A=a.child,a.child=null;A!==null;){if(s=A.alternate,s!==null&&Wo(s)===null){a.child=A;break}s=A.sibling,A.sibling=c,c=A,A=s}wu(a,!0,c,null,y);break;case"together":wu(a,!1,null,null,void 0);break;default:a.memoizedState=null}return a.child}function ws(s,a,c){if(s!==null&&(a.dependencies=s.dependencies),Gs|=a.lanes,(c&a.childLanes)===0)if(s!==null){if(Wa(s,a,c,!1),(c&a.childLanes)===0)return null}else return null;if(s!==null&&a.child!==s.child)throw Error(n(153));if(a.child!==null){for(s=a.child,c=ms(s,s.pendingProps),a.child=c,c.return=a;s.sibling!==null;)s=s.sibling,c=c.sibling=ms(s,s.pendingProps),c.return=a;c.sibling=null}return a.child}function bu(s,a){return(s.lanes&a)!==0?!0:(s=s.dependencies,!!(s!==null&&Bo(s)))}function Sp(s,a,c){switch(a.tag){case 3:ve(a,a.stateNode.containerInfo),Is(a,Ot,s.memoizedState.cache),Xa();break;case 27:case 5:Ie(a);break;case 4:ve(a,a.stateNode.containerInfo);break;case 10:Is(a,a.type,a.memoizedProps.value);break;case 13:var d=a.memoizedState;if(d!==null)return d.dehydrated!==null?(Os(a),a.flags|=128,null):(c&a.child.childLanes)!==0?B0(s,a,c):(Os(a),s=ws(s,a,c),s!==null?s.sibling:null);Os(a);break;case 19:var A=(s.flags&128)!==0;if(d=(c&a.childLanes)!==0,d||(Wa(s,a,c,!1),d=(c&a.childLanes)!==0),A){if(d)return O0(s,a,c);a.flags|=128}if(A=a.memoizedState,A!==null&&(A.rendering=null,A.tail=null,A.lastEffect=null),ce(kt,kt.current),d)break;return null;case 22:case 23:return a.lanes=0,R0(s,a,c);case 24:Is(a,Ot,s.memoizedState.cache)}return ws(s,a,c)}function k0(s,a,c){if(s!==null)if(s.memoizedProps!==a.pendingProps)jt=!0;else{if(!bu(s,c)&&(a.flags&128)===0)return jt=!1,Sp(s,a,c);jt=(s.flags&131072)!==0}else jt=!1,$e&&(a.flags&1048576)!==0&&md(a,Vo,a.index);switch(a.lanes=0,a.tag){case 16:e:{s=a.pendingProps;var d=a.elementType,A=d._init;if(d=A(d._payload),a.type=d,typeof d=="function")Uc(d)?(s=bn(d,s),a.tag=1,a=F0(null,a,d,s,c)):(a.tag=0,a=gu(null,a,d,s,c));else{if(d!=null){if(A=d.$$typeof,A===T){a.tag=11,a=M0(null,a,d,s,c);break e}else if(A===N){a.tag=14,a=D0(null,a,d,s,c);break e}}throw a=P(d)||d,Error(n(306,a,""))}}return a;case 0:return gu(s,a,a.type,a.pendingProps,c);case 1:return d=a.type,A=bn(d,a.pendingProps),F0(s,a,d,A,c);case 3:e:{if(ve(a,a.stateNode.containerInfo),s===null)throw Error(n(387));d=a.pendingProps;var y=a.memoizedState;A=y.element,Hc(s,a),nr(a,d,null,c);var F=a.memoizedState;if(d=F.cache,Is(a,Ot,d),d!==y.cache&&Pc(a,[Ot],c,!0),sr(),d=F.element,y.isDehydrated)if(y={element:d,isDehydrated:!1,cache:F.cache},a.updateQueue.baseState=y,a.memoizedState=y,a.flags&256){a=V0(s,a,d,c);break e}else if(d!==A){A=ki(Error(n(424)),a),Za(A),a=V0(s,a,d,c);break e}else{switch(s=a.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(St=Zi(s.firstChild),oi=a,$e=!0,pn=null,ts=!0,c=p0(a,null,d,c),a.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling}else{if(Xa(),d===A){a=ws(s,a,c);break e}Jt(s,a,d,c)}a=a.child}return a;case 26:return el(s,a),s===null?(c=j1(a.type,null,a.pendingProps,null))?a.memoizedState=c:$e||(c=a.type,s=a.pendingProps,d=gl(me.current).createElement(c),d[zt]=a,d[Wt]=s,ei(d,c,s),Ke(d),a.stateNode=d):a.memoizedState=j1(a.type,s.memoizedProps,a.pendingProps,s.memoizedState),null;case 27:return Ie(a),s===null&&$e&&(d=a.stateNode=P1(a.type,a.pendingProps,me.current),oi=a,ts=!0,A=St,Ks(a.type)?(ih=A,St=Zi(d.firstChild)):St=A),Jt(s,a,a.pendingProps.children,c),el(s,a),s===null&&(a.flags|=4194304),a.child;case 5:return s===null&&$e&&((A=d=St)&&(d=Jp(d,a.type,a.pendingProps,ts),d!==null?(a.stateNode=d,oi=a,St=Zi(d.firstChild),ts=!1,A=!0):A=!1),A||An(a)),Ie(a),A=a.type,y=a.pendingProps,F=s!==null?s.memoizedProps:null,d=y.children,Ju(A,y)?d=null:F!==null&&Ju(A,F)&&(a.flags|=32),a.memoizedState!==null&&(A=Wc(s,a,pp,null,null,c),Tr._currentValue=A),el(s,a),Jt(s,a,d,c),a.child;case 6:return s===null&&$e&&((s=c=St)&&(c=$p(c,a.pendingProps,ts),c!==null?(a.stateNode=c,oi=a,St=null,s=!0):s=!1),s||An(a)),null;case 13:return B0(s,a,c);case 4:return ve(a,a.stateNode.containerInfo),d=a.pendingProps,s===null?a.child=oa(a,null,d,c):Jt(s,a,d,c),a.child;case 11:return M0(s,a,a.type,a.pendingProps,c);case 7:return Jt(s,a,a.pendingProps,c),a.child;case 8:return Jt(s,a,a.pendingProps.children,c),a.child;case 12:return Jt(s,a,a.pendingProps.children,c),a.child;case 10:return d=a.pendingProps,Is(a,a.type,d.value),Jt(s,a,d.children,c),a.child;case 9:return A=a.type._context,d=a.pendingProps.children,xn(a),A=ti(A),d=d(A),a.flags|=1,Jt(s,a,d,c),a.child;case 14:return D0(s,a,a.type,a.pendingProps,c);case 15:return N0(s,a,a.type,a.pendingProps,c);case 19:return O0(s,a,c);case 31:return d=a.pendingProps,c=a.mode,d={mode:d.mode,children:d.children},s===null?(c=tl(d,c),c.ref=a.ref,a.child=c,c.return=a,a=c):(c=ms(s.child,d),c.ref=a.ref,a.child=c,c.return=a,a=c),a;case 22:return R0(s,a,c);case 24:return xn(a),d=ti(Ot),s===null?(A=jc(),A===null&&(A=lt,y=zc(),A.pooledCache=y,y.refCount++,y!==null&&(A.pooledCacheLanes|=c),A=y),a.memoizedState={parent:d,cache:A},Yc(a),Is(a,Ot,A)):((s.lanes&c)!==0&&(Hc(s,a),nr(a,null,null,c),sr()),A=s.memoizedState,y=a.memoizedState,A.parent!==d?(A={parent:d,cache:d},a.memoizedState=A,a.lanes===0&&(a.memoizedState=a.updateQueue.baseState=A),Is(a,Ot,d)):(d=y.cache,Is(a,Ot,d),d!==A.cache&&Pc(a,[Ot],c,!0))),Jt(s,a,a.pendingProps.children,c),a.child;case 29:throw a.pendingProps}throw Error(n(156,a.tag))}function bs(s){s.flags|=4}function P0(s,a){if(a.type!=="stylesheet"||(a.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!K1(a)){if(a=ji.current,a!==null&&((Qe&4194048)===Qe?is!==null:(Qe&62914560)!==Qe&&(Qe&536870912)===0||a!==is))throw tr=Gc,bd;s.flags|=8192}}function il(s,a){a!==null&&(s.flags|=4),s.flags&16384&&(a=s.tag!==22?Bi():536870912,s.lanes|=a,ha|=a)}function hr(s,a){if(!$e)switch(s.tailMode){case"hidden":a=s.tail;for(var c=null;a!==null;)a.alternate!==null&&(c=a),a=a.sibling;c===null?s.tail=null:c.sibling=null;break;case"collapsed":c=s.tail;for(var d=null;c!==null;)c.alternate!==null&&(d=c),c=c.sibling;d===null?a||s.tail===null?s.tail=null:s.tail.sibling=null:d.sibling=null}}function yt(s){var a=s.alternate!==null&&s.alternate.child===s.child,c=0,d=0;if(a)for(var A=s.child;A!==null;)c|=A.lanes|A.childLanes,d|=A.subtreeFlags&65011712,d|=A.flags&65011712,A.return=s,A=A.sibling;else for(A=s.child;A!==null;)c|=A.lanes|A.childLanes,d|=A.subtreeFlags,d|=A.flags,A.return=s,A=A.sibling;return s.subtreeFlags|=d,s.childLanes=c,a}function Ep(s,a,c){var d=a.pendingProps;switch(Bc(a),a.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return yt(a),null;case 1:return yt(a),null;case 3:return c=a.stateNode,d=null,s!==null&&(d=s.memoizedState.cache),a.memoizedState.cache!==d&&(a.flags|=2048),vs(Ot),ze(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(s===null||s.child===null)&&(Qa(a)?bs(a):s===null||s.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,Ad())),yt(a),null;case 26:return c=a.memoizedState,s===null?(bs(a),c!==null?(yt(a),P0(a,c)):(yt(a),a.flags&=-16777217)):c?c!==s.memoizedState?(bs(a),yt(a),P0(a,c)):(yt(a),a.flags&=-16777217):(s.memoizedProps!==d&&bs(a),yt(a),a.flags&=-16777217),null;case 27:Je(a),c=me.current;var A=a.type;if(s!==null&&a.stateNode!=null)s.memoizedProps!==d&&bs(a);else{if(!d){if(a.stateNode===null)throw Error(n(166));return yt(a),null}s=fe.current,Qa(a)?gd(a):(s=P1(A,d,c),a.stateNode=s,bs(a))}return yt(a),null;case 5:if(Je(a),c=a.type,s!==null&&a.stateNode!=null)s.memoizedProps!==d&&bs(a);else{if(!d){if(a.stateNode===null)throw Error(n(166));return yt(a),null}if(s=fe.current,Qa(a))gd(a);else{switch(A=gl(me.current),s){case 1:s=A.createElementNS("http://www.w3.org/2000/svg",c);break;case 2:s=A.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;default:switch(c){case"svg":s=A.createElementNS("http://www.w3.org/2000/svg",c);break;case"math":s=A.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;case"script":s=A.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild);break;case"select":s=typeof d.is=="string"?A.createElement("select",{is:d.is}):A.createElement("select"),d.multiple?s.multiple=!0:d.size&&(s.size=d.size);break;default:s=typeof d.is=="string"?A.createElement(c,{is:d.is}):A.createElement(c)}}s[zt]=a,s[Wt]=d;e:for(A=a.child;A!==null;){if(A.tag===5||A.tag===6)s.appendChild(A.stateNode);else if(A.tag!==4&&A.tag!==27&&A.child!==null){A.child.return=A,A=A.child;continue}if(A===a)break e;for(;A.sibling===null;){if(A.return===null||A.return===a)break e;A=A.return}A.sibling.return=A.return,A=A.sibling}a.stateNode=s;e:switch(ei(s,c,d),c){case"button":case"input":case"select":case"textarea":s=!!d.autoFocus;break e;case"img":s=!0;break e;default:s=!1}s&&bs(a)}}return yt(a),a.flags&=-16777217,null;case 6:if(s&&a.stateNode!=null)s.memoizedProps!==d&&bs(a);else{if(typeof d!="string"&&a.stateNode===null)throw Error(n(166));if(s=me.current,Qa(a)){if(s=a.stateNode,c=a.memoizedProps,d=null,A=oi,A!==null)switch(A.tag){case 27:case 5:d=A.memoizedProps}s[zt]=a,s=!!(s.nodeValue===c||d!==null&&d.suppressHydrationWarning===!0||I1(s.nodeValue,c)),s||An(a)}else s=gl(s).createTextNode(d),s[zt]=a,a.stateNode=s}return yt(a),null;case 13:if(d=a.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(A=Qa(a),d!==null&&d.dehydrated!==null){if(s===null){if(!A)throw Error(n(318));if(A=a.memoizedState,A=A!==null?A.dehydrated:null,!A)throw Error(n(317));A[zt]=a}else Xa(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;yt(a),A=!1}else A=Ad(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=A),A=!0;if(!A)return a.flags&256?(ys(a),a):(ys(a),null)}if(ys(a),(a.flags&128)!==0)return a.lanes=c,a;if(c=d!==null,s=s!==null&&s.memoizedState!==null,c){d=a.child,A=null,d.alternate!==null&&d.alternate.memoizedState!==null&&d.alternate.memoizedState.cachePool!==null&&(A=d.alternate.memoizedState.cachePool.pool);var y=null;d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(y=d.memoizedState.cachePool.pool),y!==A&&(d.flags|=2048)}return c!==s&&c&&(a.child.flags|=8192),il(a,a.updateQueue),yt(a),null;case 4:return ze(),s===null&&Ku(a.stateNode.containerInfo),yt(a),null;case 10:return vs(a.type),yt(a),null;case 19:if(le(kt),A=a.memoizedState,A===null)return yt(a),null;if(d=(a.flags&128)!==0,y=A.rendering,y===null)if(d)hr(A,!1);else{if(Et!==0||s!==null&&(s.flags&128)!==0)for(s=a.child;s!==null;){if(y=Wo(s),y!==null){for(a.flags|=128,hr(A,!1),s=y.updateQueue,a.updateQueue=s,il(a,s),a.subtreeFlags=0,s=c,c=a.child;c!==null;)dd(c,s),c=c.sibling;return ce(kt,kt.current&1|2),a.child}s=s.sibling}A.tail!==null&&Xe()>al&&(a.flags|=128,d=!0,hr(A,!1),a.lanes=4194304)}else{if(!d)if(s=Wo(y),s!==null){if(a.flags|=128,d=!0,s=s.updateQueue,a.updateQueue=s,il(a,s),hr(A,!0),A.tail===null&&A.tailMode==="hidden"&&!y.alternate&&!$e)return yt(a),null}else 2*Xe()-A.renderingStartTime>al&&c!==536870912&&(a.flags|=128,d=!0,hr(A,!1),a.lanes=4194304);A.isBackwards?(y.sibling=a.child,a.child=y):(s=A.last,s!==null?s.sibling=y:a.child=y,A.last=y)}return A.tail!==null?(a=A.tail,A.rendering=a,A.tail=a.sibling,A.renderingStartTime=Xe(),a.sibling=null,s=kt.current,ce(kt,d?s&1|2:s&1),a):(yt(a),null);case 22:case 23:return ys(a),Xc(),d=a.memoizedState!==null,s!==null?s.memoizedState!==null!==d&&(a.flags|=8192):d&&(a.flags|=8192),d?(c&536870912)!==0&&(a.flags&128)===0&&(yt(a),a.subtreeFlags&6&&(a.flags|=8192)):yt(a),c=a.updateQueue,c!==null&&il(a,c.retryQueue),c=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(c=s.memoizedState.cachePool.pool),d=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(d=a.memoizedState.cachePool.pool),d!==c&&(a.flags|=2048),s!==null&&le(yn),null;case 24:return c=null,s!==null&&(c=s.memoizedState.cache),a.memoizedState.cache!==c&&(a.flags|=2048),vs(Ot),yt(a),null;case 25:return null;case 30:return null}throw Error(n(156,a.tag))}function Tp(s,a){switch(Bc(a),a.tag){case 1:return s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 3:return vs(Ot),ze(),s=a.flags,(s&65536)!==0&&(s&128)===0?(a.flags=s&-65537|128,a):null;case 26:case 27:case 5:return Je(a),null;case 13:if(ys(a),s=a.memoizedState,s!==null&&s.dehydrated!==null){if(a.alternate===null)throw Error(n(340));Xa()}return s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 19:return le(kt),null;case 4:return ze(),null;case 10:return vs(a.type),null;case 22:case 23:return ys(a),Xc(),s!==null&&le(yn),s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 24:return vs(Ot),null;case 25:return null;default:return null}}function z0(s,a){switch(Bc(a),a.tag){case 3:vs(Ot),ze();break;case 26:case 27:case 5:Je(a);break;case 4:ze();break;case 13:ys(a);break;case 19:le(kt);break;case 10:vs(a.type);break;case 22:case 23:ys(a),Xc(),s!==null&&le(yn);break;case 24:vs(Ot)}}function fr(s,a){try{var c=a.updateQueue,d=c!==null?c.lastEffect:null;if(d!==null){var A=d.next;c=A;do{if((c.tag&s)===s){d=void 0;var y=c.create,F=c.inst;d=y(),F.destroy=d}c=c.next}while(c!==A)}}catch(O){rt(a,a.return,O)}}function Ps(s,a,c){try{var d=a.updateQueue,A=d!==null?d.lastEffect:null;if(A!==null){var y=A.next;d=y;do{if((d.tag&s)===s){var F=d.inst,O=F.destroy;if(O!==void 0){F.destroy=void 0,A=a;var Y=c,$=O;try{$()}catch(ne){rt(A,Y,ne)}}}d=d.next}while(d!==y)}}catch(ne){rt(a,a.return,ne)}}function _0(s){var a=s.updateQueue;if(a!==null){var c=s.stateNode;try{Dd(a,c)}catch(d){rt(s,s.return,d)}}}function j0(s,a,c){c.props=bn(s.type,s.memoizedProps),c.state=s.memoizedState;try{c.componentWillUnmount()}catch(d){rt(s,a,d)}}function dr(s,a){try{var c=s.ref;if(c!==null){switch(s.tag){case 26:case 27:case 5:var d=s.stateNode;break;case 30:d=s.stateNode;break;default:d=s.stateNode}typeof c=="function"?s.refCleanup=c(d):c.current=d}}catch(A){rt(s,a,A)}}function ss(s,a){var c=s.ref,d=s.refCleanup;if(c!==null)if(typeof d=="function")try{d()}catch(A){rt(s,a,A)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof c=="function")try{c(null)}catch(A){rt(s,a,A)}else c.current=null}function G0(s){var a=s.type,c=s.memoizedProps,d=s.stateNode;try{e:switch(a){case"button":case"input":case"select":case"textarea":c.autoFocus&&d.focus();break e;case"img":c.src?d.src=c.src:c.srcSet&&(d.srcset=c.srcSet)}}catch(A){rt(s,s.return,A)}}function Cu(s,a,c){try{var d=s.stateNode;Kp(d,s.type,c,a),d[Wt]=a}catch(A){rt(s,s.return,A)}}function Y0(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&Ks(s.type)||s.tag===4}function Su(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||Y0(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&Ks(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Eu(s,a,c){var d=s.tag;if(d===5||d===6)s=s.stateNode,a?(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c).insertBefore(s,a):(a=c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,a.appendChild(s),c=c._reactRootContainer,c!=null||a.onclick!==null||(a.onclick=ml));else if(d!==4&&(d===27&&Ks(s.type)&&(c=s.stateNode,a=null),s=s.child,s!==null))for(Eu(s,a,c),s=s.sibling;s!==null;)Eu(s,a,c),s=s.sibling}function sl(s,a,c){var d=s.tag;if(d===5||d===6)s=s.stateNode,a?c.insertBefore(s,a):c.appendChild(s);else if(d!==4&&(d===27&&Ks(s.type)&&(c=s.stateNode),s=s.child,s!==null))for(sl(s,a,c),s=s.sibling;s!==null;)sl(s,a,c),s=s.sibling}function H0(s){var a=s.stateNode,c=s.memoizedProps;try{for(var d=s.type,A=a.attributes;A.length;)a.removeAttributeNode(A[0]);ei(a,d,c),a[zt]=s,a[Wt]=c}catch(y){rt(s,s.return,y)}}var Cs=!1,Nt=!1,Tu=!1,q0=typeof WeakSet=="function"?WeakSet:Set,Gt=null;function Mp(s,a){if(s=s.containerInfo,Zu=wl,s=sd(s),Sc(s)){if("selectionStart"in s)var c={start:s.selectionStart,end:s.selectionEnd};else e:{c=(c=s.ownerDocument)&&c.defaultView||window;var d=c.getSelection&&c.getSelection();if(d&&d.rangeCount!==0){c=d.anchorNode;var A=d.anchorOffset,y=d.focusNode;d=d.focusOffset;try{c.nodeType,y.nodeType}catch{c=null;break e}var F=0,O=-1,Y=-1,$=0,ne=0,oe=s,ee=null;t:for(;;){for(var te;oe!==c||A!==0&&oe.nodeType!==3||(O=F+A),oe!==y||d!==0&&oe.nodeType!==3||(Y=F+d),oe.nodeType===3&&(F+=oe.nodeValue.length),(te=oe.firstChild)!==null;)ee=oe,oe=te;for(;;){if(oe===s)break t;if(ee===c&&++$===A&&(O=F),ee===y&&++ne===d&&(Y=F),(te=oe.nextSibling)!==null)break;oe=ee,ee=oe.parentNode}oe=te}c=O===-1||Y===-1?null:{start:O,end:Y}}else c=null}c=c||{start:0,end:0}}else c=null;for(Wu={focusedElem:s,selectionRange:c},wl=!1,Gt=a;Gt!==null;)if(a=Gt,s=a.child,(a.subtreeFlags&1024)!==0&&s!==null)s.return=a,Gt=s;else for(;Gt!==null;){switch(a=Gt,y=a.alternate,s=a.flags,a.tag){case 0:break;case 11:case 15:break;case 1:if((s&1024)!==0&&y!==null){s=void 0,c=a,A=y.memoizedProps,y=y.memoizedState,d=c.stateNode;try{var Me=bn(c.type,A,c.elementType===c.type);s=d.getSnapshotBeforeUpdate(Me,y),d.__reactInternalSnapshotBeforeUpdate=s}catch(Ce){rt(c,c.return,Ce)}}break;case 3:if((s&1024)!==0){if(s=a.stateNode.containerInfo,c=s.nodeType,c===9)eh(s);else if(c===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":eh(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(n(163))}if(s=a.sibling,s!==null){s.return=a.return,Gt=s;break}Gt=a.return}}function K0(s,a,c){var d=c.flags;switch(c.tag){case 0:case 11:case 15:zs(s,c),d&4&&fr(5,c);break;case 1:if(zs(s,c),d&4)if(s=c.stateNode,a===null)try{s.componentDidMount()}catch(F){rt(c,c.return,F)}else{var A=bn(c.type,a.memoizedProps);a=a.memoizedState;try{s.componentDidUpdate(A,a,s.__reactInternalSnapshotBeforeUpdate)}catch(F){rt(c,c.return,F)}}d&64&&_0(c),d&512&&dr(c,c.return);break;case 3:if(zs(s,c),d&64&&(s=c.updateQueue,s!==null)){if(a=null,c.child!==null)switch(c.child.tag){case 27:case 5:a=c.child.stateNode;break;case 1:a=c.child.stateNode}try{Dd(s,a)}catch(F){rt(c,c.return,F)}}break;case 27:a===null&&d&4&&H0(c);case 26:case 5:zs(s,c),a===null&&d&4&&G0(c),d&512&&dr(c,c.return);break;case 12:zs(s,c);break;case 13:zs(s,c),d&4&&Z0(s,c),d&64&&(s=c.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(c=Lp.bind(null,c),eA(s,c))));break;case 22:if(d=c.memoizedState!==null||Cs,!d){a=a!==null&&a.memoizedState!==null||Nt,A=Cs;var y=Nt;Cs=d,(Nt=a)&&!y?_s(s,c,(c.subtreeFlags&8772)!==0):zs(s,c),Cs=A,Nt=y}break;case 30:break;default:zs(s,c)}}function Q0(s){var a=s.alternate;a!==null&&(s.alternate=null,Q0(a)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(a=s.stateNode,a!==null&&dt(a)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var mt=null,mi=!1;function Ss(s,a,c){for(c=c.child;c!==null;)X0(s,a,c),c=c.sibling}function X0(s,a,c){if(Tt&&typeof Tt.onCommitFiberUnmount=="function")try{Tt.onCommitFiberUnmount(xi,c)}catch{}switch(c.tag){case 26:Nt||ss(c,a),Ss(s,a,c),c.memoizedState?c.memoizedState.count--:c.stateNode&&(c=c.stateNode,c.parentNode.removeChild(c));break;case 27:Nt||ss(c,a);var d=mt,A=mi;Ks(c.type)&&(mt=c.stateNode,mi=!1),Ss(s,a,c),br(c.stateNode),mt=d,mi=A;break;case 5:Nt||ss(c,a);case 6:if(d=mt,A=mi,mt=null,Ss(s,a,c),mt=d,mi=A,mt!==null)if(mi)try{(mt.nodeType===9?mt.body:mt.nodeName==="HTML"?mt.ownerDocument.body:mt).removeChild(c.stateNode)}catch(y){rt(c,a,y)}else try{mt.removeChild(c.stateNode)}catch(y){rt(c,a,y)}break;case 18:mt!==null&&(mi?(s=mt,O1(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,c.stateNode),Rr(s)):O1(mt,c.stateNode));break;case 4:d=mt,A=mi,mt=c.stateNode.containerInfo,mi=!0,Ss(s,a,c),mt=d,mi=A;break;case 0:case 11:case 14:case 15:Nt||Ps(2,c,a),Nt||Ps(4,c,a),Ss(s,a,c);break;case 1:Nt||(ss(c,a),d=c.stateNode,typeof d.componentWillUnmount=="function"&&j0(c,a,d)),Ss(s,a,c);break;case 21:Ss(s,a,c);break;case 22:Nt=(d=Nt)||c.memoizedState!==null,Ss(s,a,c),Nt=d;break;default:Ss(s,a,c)}}function Z0(s,a){if(a.memoizedState===null&&(s=a.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{Rr(s)}catch(c){rt(a,a.return,c)}}function Dp(s){switch(s.tag){case 13:case 19:var a=s.stateNode;return a===null&&(a=s.stateNode=new q0),a;case 22:return s=s.stateNode,a=s._retryCache,a===null&&(a=s._retryCache=new q0),a;default:throw Error(n(435,s.tag))}}function Mu(s,a){var c=Dp(s);a.forEach(function(d){var A=Op.bind(null,s,d);c.has(d)||(c.add(d),d.then(A,A))})}function Ci(s,a){var c=a.deletions;if(c!==null)for(var d=0;d<c.length;d++){var A=c[d],y=s,F=a,O=F;e:for(;O!==null;){switch(O.tag){case 27:if(Ks(O.type)){mt=O.stateNode,mi=!1;break e}break;case 5:mt=O.stateNode,mi=!1;break e;case 3:case 4:mt=O.stateNode.containerInfo,mi=!0;break e}O=O.return}if(mt===null)throw Error(n(160));X0(y,F,A),mt=null,mi=!1,y=A.alternate,y!==null&&(y.return=null),A.return=null}if(a.subtreeFlags&13878)for(a=a.child;a!==null;)W0(a,s),a=a.sibling}var Xi=null;function W0(s,a){var c=s.alternate,d=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:Ci(a,s),Si(s),d&4&&(Ps(3,s,s.return),fr(3,s),Ps(5,s,s.return));break;case 1:Ci(a,s),Si(s),d&512&&(Nt||c===null||ss(c,c.return)),d&64&&Cs&&(s=s.updateQueue,s!==null&&(d=s.callbacks,d!==null&&(c=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=c===null?d:c.concat(d))));break;case 26:var A=Xi;if(Ci(a,s),Si(s),d&512&&(Nt||c===null||ss(c,c.return)),d&4){var y=c!==null?c.memoizedState:null;if(d=s.memoizedState,c===null)if(d===null)if(s.stateNode===null){e:{d=s.type,c=s.memoizedProps,A=A.ownerDocument||A;t:switch(d){case"title":y=A.getElementsByTagName("title")[0],(!y||y[De]||y[zt]||y.namespaceURI==="http://www.w3.org/2000/svg"||y.hasAttribute("itemprop"))&&(y=A.createElement(d),A.head.insertBefore(y,A.querySelector("head > title"))),ei(y,d,c),y[zt]=s,Ke(y),d=y;break e;case"link":var F=H1("link","href",A).get(d+(c.href||""));if(F){for(var O=0;O<F.length;O++)if(y=F[O],y.getAttribute("href")===(c.href==null||c.href===""?null:c.href)&&y.getAttribute("rel")===(c.rel==null?null:c.rel)&&y.getAttribute("title")===(c.title==null?null:c.title)&&y.getAttribute("crossorigin")===(c.crossOrigin==null?null:c.crossOrigin)){F.splice(O,1);break t}}y=A.createElement(d),ei(y,d,c),A.head.appendChild(y);break;case"meta":if(F=H1("meta","content",A).get(d+(c.content||""))){for(O=0;O<F.length;O++)if(y=F[O],y.getAttribute("content")===(c.content==null?null:""+c.content)&&y.getAttribute("name")===(c.name==null?null:c.name)&&y.getAttribute("property")===(c.property==null?null:c.property)&&y.getAttribute("http-equiv")===(c.httpEquiv==null?null:c.httpEquiv)&&y.getAttribute("charset")===(c.charSet==null?null:c.charSet)){F.splice(O,1);break t}}y=A.createElement(d),ei(y,d,c),A.head.appendChild(y);break;default:throw Error(n(468,d))}y[zt]=s,Ke(y),d=y}s.stateNode=d}else q1(A,s.type,s.stateNode);else s.stateNode=Y1(A,d,s.memoizedProps);else y!==d?(y===null?c.stateNode!==null&&(c=c.stateNode,c.parentNode.removeChild(c)):y.count--,d===null?q1(A,s.type,s.stateNode):Y1(A,d,s.memoizedProps)):d===null&&s.stateNode!==null&&Cu(s,s.memoizedProps,c.memoizedProps)}break;case 27:Ci(a,s),Si(s),d&512&&(Nt||c===null||ss(c,c.return)),c!==null&&d&4&&Cu(s,s.memoizedProps,c.memoizedProps);break;case 5:if(Ci(a,s),Si(s),d&512&&(Nt||c===null||ss(c,c.return)),s.flags&32){A=s.stateNode;try{Gn(A,"")}catch(te){rt(s,s.return,te)}}d&4&&s.stateNode!=null&&(A=s.memoizedProps,Cu(s,A,c!==null?c.memoizedProps:A)),d&1024&&(Tu=!0);break;case 6:if(Ci(a,s),Si(s),d&4){if(s.stateNode===null)throw Error(n(162));d=s.memoizedProps,c=s.stateNode;try{c.nodeValue=d}catch(te){rt(s,s.return,te)}}break;case 3:if(vl=null,A=Xi,Xi=pl(a.containerInfo),Ci(a,s),Xi=A,Si(s),d&4&&c!==null&&c.memoizedState.isDehydrated)try{Rr(a.containerInfo)}catch(te){rt(s,s.return,te)}Tu&&(Tu=!1,J0(s));break;case 4:d=Xi,Xi=pl(s.stateNode.containerInfo),Ci(a,s),Si(s),Xi=d;break;case 12:Ci(a,s),Si(s);break;case 13:Ci(a,s),Si(s),s.child.flags&8192&&s.memoizedState!==null!=(c!==null&&c.memoizedState!==null)&&(Fu=Xe()),d&4&&(d=s.updateQueue,d!==null&&(s.updateQueue=null,Mu(s,d)));break;case 22:A=s.memoizedState!==null;var Y=c!==null&&c.memoizedState!==null,$=Cs,ne=Nt;if(Cs=$||A,Nt=ne||Y,Ci(a,s),Nt=ne,Cs=$,Si(s),d&8192)e:for(a=s.stateNode,a._visibility=A?a._visibility&-2:a._visibility|1,A&&(c===null||Y||Cs||Nt||Cn(s)),c=null,a=s;;){if(a.tag===5||a.tag===26){if(c===null){Y=c=a;try{if(y=Y.stateNode,A)F=y.style,typeof F.setProperty=="function"?F.setProperty("display","none","important"):F.display="none";else{O=Y.stateNode;var oe=Y.memoizedProps.style,ee=oe!=null&&oe.hasOwnProperty("display")?oe.display:null;O.style.display=ee==null||typeof ee=="boolean"?"":(""+ee).trim()}}catch(te){rt(Y,Y.return,te)}}}else if(a.tag===6){if(c===null){Y=a;try{Y.stateNode.nodeValue=A?"":Y.memoizedProps}catch(te){rt(Y,Y.return,te)}}}else if((a.tag!==22&&a.tag!==23||a.memoizedState===null||a===s)&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===s)break e;for(;a.sibling===null;){if(a.return===null||a.return===s)break e;c===a&&(c=null),a=a.return}c===a&&(c=null),a.sibling.return=a.return,a=a.sibling}d&4&&(d=s.updateQueue,d!==null&&(c=d.retryQueue,c!==null&&(d.retryQueue=null,Mu(s,c))));break;case 19:Ci(a,s),Si(s),d&4&&(d=s.updateQueue,d!==null&&(s.updateQueue=null,Mu(s,d)));break;case 30:break;case 21:break;default:Ci(a,s),Si(s)}}function Si(s){var a=s.flags;if(a&2){try{for(var c,d=s.return;d!==null;){if(Y0(d)){c=d;break}d=d.return}if(c==null)throw Error(n(160));switch(c.tag){case 27:var A=c.stateNode,y=Su(s);sl(s,y,A);break;case 5:var F=c.stateNode;c.flags&32&&(Gn(F,""),c.flags&=-33);var O=Su(s);sl(s,O,F);break;case 3:case 4:var Y=c.stateNode.containerInfo,$=Su(s);Eu(s,$,Y);break;default:throw Error(n(161))}}catch(ne){rt(s,s.return,ne)}s.flags&=-3}a&4096&&(s.flags&=-4097)}function J0(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var a=s;J0(a),a.tag===5&&a.flags&1024&&a.stateNode.reset(),s=s.sibling}}function zs(s,a){if(a.subtreeFlags&8772)for(a=a.child;a!==null;)K0(s,a.alternate,a),a=a.sibling}function Cn(s){for(s=s.child;s!==null;){var a=s;switch(a.tag){case 0:case 11:case 14:case 15:Ps(4,a,a.return),Cn(a);break;case 1:ss(a,a.return);var c=a.stateNode;typeof c.componentWillUnmount=="function"&&j0(a,a.return,c),Cn(a);break;case 27:br(a.stateNode);case 26:case 5:ss(a,a.return),Cn(a);break;case 22:a.memoizedState===null&&Cn(a);break;case 30:Cn(a);break;default:Cn(a)}s=s.sibling}}function _s(s,a,c){for(c=c&&(a.subtreeFlags&8772)!==0,a=a.child;a!==null;){var d=a.alternate,A=s,y=a,F=y.flags;switch(y.tag){case 0:case 11:case 15:_s(A,y,c),fr(4,y);break;case 1:if(_s(A,y,c),d=y,A=d.stateNode,typeof A.componentDidMount=="function")try{A.componentDidMount()}catch($){rt(d,d.return,$)}if(d=y,A=d.updateQueue,A!==null){var O=d.stateNode;try{var Y=A.shared.hiddenCallbacks;if(Y!==null)for(A.shared.hiddenCallbacks=null,A=0;A<Y.length;A++)Md(Y[A],O)}catch($){rt(d,d.return,$)}}c&&F&64&&_0(y),dr(y,y.return);break;case 27:H0(y);case 26:case 5:_s(A,y,c),c&&d===null&&F&4&&G0(y),dr(y,y.return);break;case 12:_s(A,y,c);break;case 13:_s(A,y,c),c&&F&4&&Z0(A,y);break;case 22:y.memoizedState===null&&_s(A,y,c),dr(y,y.return);break;case 30:break;default:_s(A,y,c)}a=a.sibling}}function Du(s,a){var c=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(c=s.memoizedState.cachePool.pool),s=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(s=a.memoizedState.cachePool.pool),s!==c&&(s!=null&&s.refCount++,c!=null&&Ja(c))}function Nu(s,a){s=null,a.alternate!==null&&(s=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==s&&(a.refCount++,s!=null&&Ja(s))}function ns(s,a,c,d){if(a.subtreeFlags&10256)for(a=a.child;a!==null;)$0(s,a,c,d),a=a.sibling}function $0(s,a,c,d){var A=a.flags;switch(a.tag){case 0:case 11:case 15:ns(s,a,c,d),A&2048&&fr(9,a);break;case 1:ns(s,a,c,d);break;case 3:ns(s,a,c,d),A&2048&&(s=null,a.alternate!==null&&(s=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==s&&(a.refCount++,s!=null&&Ja(s)));break;case 12:if(A&2048){ns(s,a,c,d),s=a.stateNode;try{var y=a.memoizedProps,F=y.id,O=y.onPostCommit;typeof O=="function"&&O(F,a.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(Y){rt(a,a.return,Y)}}else ns(s,a,c,d);break;case 13:ns(s,a,c,d);break;case 23:break;case 22:y=a.stateNode,F=a.alternate,a.memoizedState!==null?y._visibility&2?ns(s,a,c,d):mr(s,a):y._visibility&2?ns(s,a,c,d):(y._visibility|=2,la(s,a,c,d,(a.subtreeFlags&10256)!==0)),A&2048&&Du(F,a);break;case 24:ns(s,a,c,d),A&2048&&Nu(a.alternate,a);break;default:ns(s,a,c,d)}}function la(s,a,c,d,A){for(A=A&&(a.subtreeFlags&10256)!==0,a=a.child;a!==null;){var y=s,F=a,O=c,Y=d,$=F.flags;switch(F.tag){case 0:case 11:case 15:la(y,F,O,Y,A),fr(8,F);break;case 23:break;case 22:var ne=F.stateNode;F.memoizedState!==null?ne._visibility&2?la(y,F,O,Y,A):mr(y,F):(ne._visibility|=2,la(y,F,O,Y,A)),A&&$&2048&&Du(F.alternate,F);break;case 24:la(y,F,O,Y,A),A&&$&2048&&Nu(F.alternate,F);break;default:la(y,F,O,Y,A)}a=a.sibling}}function mr(s,a){if(a.subtreeFlags&10256)for(a=a.child;a!==null;){var c=s,d=a,A=d.flags;switch(d.tag){case 22:mr(c,d),A&2048&&Du(d.alternate,d);break;case 24:mr(c,d),A&2048&&Nu(d.alternate,d);break;default:mr(c,d)}a=a.sibling}}var gr=8192;function ca(s){if(s.subtreeFlags&gr)for(s=s.child;s!==null;)e1(s),s=s.sibling}function e1(s){switch(s.tag){case 26:ca(s),s.flags&gr&&s.memoizedState!==null&&dA(Xi,s.memoizedState,s.memoizedProps);break;case 5:ca(s);break;case 3:case 4:var a=Xi;Xi=pl(s.stateNode.containerInfo),ca(s),Xi=a;break;case 22:s.memoizedState===null&&(a=s.alternate,a!==null&&a.memoizedState!==null?(a=gr,gr=16777216,ca(s),gr=a):ca(s));break;default:ca(s)}}function t1(s){var a=s.alternate;if(a!==null&&(s=a.child,s!==null)){a.child=null;do a=s.sibling,s.sibling=null,s=a;while(s!==null)}}function pr(s){var a=s.deletions;if((s.flags&16)!==0){if(a!==null)for(var c=0;c<a.length;c++){var d=a[c];Gt=d,s1(d,s)}t1(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)i1(s),s=s.sibling}function i1(s){switch(s.tag){case 0:case 11:case 15:pr(s),s.flags&2048&&Ps(9,s,s.return);break;case 3:pr(s);break;case 12:pr(s);break;case 22:var a=s.stateNode;s.memoizedState!==null&&a._visibility&2&&(s.return===null||s.return.tag!==13)?(a._visibility&=-3,nl(s)):pr(s);break;default:pr(s)}}function nl(s){var a=s.deletions;if((s.flags&16)!==0){if(a!==null)for(var c=0;c<a.length;c++){var d=a[c];Gt=d,s1(d,s)}t1(s)}for(s=s.child;s!==null;){switch(a=s,a.tag){case 0:case 11:case 15:Ps(8,a,a.return),nl(a);break;case 22:c=a.stateNode,c._visibility&2&&(c._visibility&=-3,nl(a));break;default:nl(a)}s=s.sibling}}function s1(s,a){for(;Gt!==null;){var c=Gt;switch(c.tag){case 0:case 11:case 15:Ps(8,c,a);break;case 23:case 22:if(c.memoizedState!==null&&c.memoizedState.cachePool!==null){var d=c.memoizedState.cachePool.pool;d!=null&&d.refCount++}break;case 24:Ja(c.memoizedState.cache)}if(d=c.child,d!==null)d.return=c,Gt=d;else e:for(c=s;Gt!==null;){d=Gt;var A=d.sibling,y=d.return;if(Q0(d),d===c){Gt=null;break e}if(A!==null){A.return=y,Gt=A;break e}Gt=y}}}var Np={getCacheForType:function(s){var a=ti(Ot),c=a.data.get(s);return c===void 0&&(c=s(),a.data.set(s,c)),c}},Rp=typeof WeakMap=="function"?WeakMap:Map,tt=0,lt=null,_e=null,Qe=0,it=0,Ei=null,js=!1,ua=!1,Ru=!1,Es=0,Et=0,Gs=0,Sn=0,Uu=0,Gi=0,ha=0,Ar=null,gi=null,Iu=!1,Fu=0,al=1/0,rl=null,Ys=null,$t=0,Hs=null,fa=null,da=0,Vu=0,Bu=null,n1=null,vr=0,Lu=null;function Ti(){if((tt&2)!==0&&Qe!==0)return Qe&-Qe;if(_.T!==null){var s=ea;return s!==0?s:Gu()}return Pn()}function a1(){Gi===0&&(Gi=(Qe&536870912)===0||$e?ln():536870912);var s=ji.current;return s!==null&&(s.flags|=32),Gi}function Mi(s,a,c){(s===lt&&(it===2||it===9)||s.cancelPendingCommit!==null)&&(ma(s,0),qs(s,Qe,Gi,!1)),Ds(s,c),((tt&2)===0||s!==lt)&&(s===lt&&((tt&2)===0&&(Sn|=c),Et===4&&qs(s,Qe,Gi,!1)),as(s))}function r1(s,a,c){if((tt&6)!==0)throw Error(n(327));var d=!c&&(a&124)===0&&(a&s.expiredLanes)===0||qi(s,a),A=d?Fp(s,a):Pu(s,a,!0),y=d;do{if(A===0){ua&&!d&&qs(s,a,0,!1);break}else{if(c=s.current.alternate,y&&!Up(c)){A=Pu(s,a,!1),y=!1;continue}if(A===2){if(y=a,s.errorRecoveryDisabledLanes&y)var F=0;else F=s.pendingLanes&-536870913,F=F!==0?F:F&536870912?536870912:0;if(F!==0){a=F;e:{var O=s;A=Ar;var Y=O.current.memoizedState.isDehydrated;if(Y&&(ma(O,F).flags|=256),F=Pu(O,F,!1),F!==2){if(Ru&&!Y){O.errorRecoveryDisabledLanes|=y,Sn|=y,A=4;break e}y=gi,gi=A,y!==null&&(gi===null?gi=y:gi.push.apply(gi,y))}A=F}if(y=!1,A!==2)continue}}if(A===1){ma(s,0),qs(s,a,0,!0);break}e:{switch(d=s,y=A,y){case 0:case 1:throw Error(n(345));case 4:if((a&4194048)!==a)break;case 6:qs(d,a,Gi,!js);break e;case 2:gi=null;break;case 3:case 5:break;default:throw Error(n(329))}if((a&62914560)===a&&(A=Fu+300-Xe(),10<A)){if(qs(d,a,Gi,!js),At(d,0,!0)!==0)break e;d.timeoutHandle=B1(o1.bind(null,d,c,gi,rl,Iu,a,Gi,Sn,ha,js,y,2,-0,0),A);break e}o1(d,c,gi,rl,Iu,a,Gi,Sn,ha,js,y,0,-0,0)}}break}while(!0);as(s)}function o1(s,a,c,d,A,y,F,O,Y,$,ne,oe,ee,te){if(s.timeoutHandle=-1,oe=a.subtreeFlags,(oe&8192||(oe&16785408)===16785408)&&(Er={stylesheets:null,count:0,unsuspend:fA},e1(a),oe=mA(),oe!==null)){s.cancelPendingCommit=oe(m1.bind(null,s,a,y,c,d,A,F,O,Y,ne,1,ee,te)),qs(s,y,F,!$);return}m1(s,a,y,c,d,A,F,O,Y)}function Up(s){for(var a=s;;){var c=a.tag;if((c===0||c===11||c===15)&&a.flags&16384&&(c=a.updateQueue,c!==null&&(c=c.stores,c!==null)))for(var d=0;d<c.length;d++){var A=c[d],y=A.getSnapshot;A=A.value;try{if(!wi(y(),A))return!1}catch{return!1}}if(c=a.child,a.subtreeFlags&16384&&c!==null)c.return=a,a=c;else{if(a===s)break;for(;a.sibling===null;){if(a.return===null||a.return===s)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function qs(s,a,c,d){a&=~Uu,a&=~Sn,s.suspendedLanes|=a,s.pingedLanes&=~a,d&&(s.warmLanes|=a),d=s.expirationTimes;for(var A=a;0<A;){var y=31-It(A),F=1<<y;d[y]=-1,A&=~F}c!==0&&On(s,c,a)}function ol(){return(tt&6)===0?(xr(0),!1):!0}function Ou(){if(_e!==null){if(it===0)var s=_e.return;else s=_e,As=vn=null,eu(s),ra=null,cr=0,s=_e;for(;s!==null;)z0(s.alternate,s),s=s.return;_e=null}}function ma(s,a){var c=s.timeoutHandle;c!==-1&&(s.timeoutHandle=-1,Xp(c)),c=s.cancelPendingCommit,c!==null&&(s.cancelPendingCommit=null,c()),Ou(),lt=s,_e=c=ms(s.current,null),Qe=a,it=0,Ei=null,js=!1,ua=qi(s,a),Ru=!1,ha=Gi=Uu=Sn=Gs=Et=0,gi=Ar=null,Iu=!1,(a&8)!==0&&(a|=a&32);var d=s.entangledLanes;if(d!==0)for(s=s.entanglements,d&=a;0<d;){var A=31-It(d),y=1<<A;a|=s[A],d&=~y}return Es=a,No(),c}function l1(s,a){ke=null,_.H=Qo,a===er||a===ko?(a=Ed(),it=3):a===bd?(a=Ed(),it=4):it=a===T0?8:a!==null&&typeof a=="object"&&typeof a.then=="function"?6:1,Ei=a,_e===null&&(Et=1,$o(s,ki(a,s.current)))}function c1(){var s=_.H;return _.H=Qo,s===null?Qo:s}function u1(){var s=_.A;return _.A=Np,s}function ku(){Et=4,js||(Qe&4194048)!==Qe&&ji.current!==null||(ua=!0),(Gs&134217727)===0&&(Sn&134217727)===0||lt===null||qs(lt,Qe,Gi,!1)}function Pu(s,a,c){var d=tt;tt|=2;var A=c1(),y=u1();(lt!==s||Qe!==a)&&(rl=null,ma(s,a)),a=!1;var F=Et;e:do try{if(it!==0&&_e!==null){var O=_e,Y=Ei;switch(it){case 8:Ou(),F=6;break e;case 3:case 2:case 9:case 6:ji.current===null&&(a=!0);var $=it;if(it=0,Ei=null,ga(s,O,Y,$),c&&ua){F=0;break e}break;default:$=it,it=0,Ei=null,ga(s,O,Y,$)}}Ip(),F=Et;break}catch(ne){l1(s,ne)}while(!0);return a&&s.shellSuspendCounter++,As=vn=null,tt=d,_.H=A,_.A=y,_e===null&&(lt=null,Qe=0,No()),F}function Ip(){for(;_e!==null;)h1(_e)}function Fp(s,a){var c=tt;tt|=2;var d=c1(),A=u1();lt!==s||Qe!==a?(rl=null,al=Xe()+500,ma(s,a)):ua=qi(s,a);e:do try{if(it!==0&&_e!==null){a=_e;var y=Ei;t:switch(it){case 1:it=0,Ei=null,ga(s,a,y,1);break;case 2:case 9:if(Cd(y)){it=0,Ei=null,f1(a);break}a=function(){it!==2&&it!==9||lt!==s||(it=7),as(s)},y.then(a,a);break e;case 3:it=7;break e;case 4:it=5;break e;case 7:Cd(y)?(it=0,Ei=null,f1(a)):(it=0,Ei=null,ga(s,a,y,7));break;case 5:var F=null;switch(_e.tag){case 26:F=_e.memoizedState;case 5:case 27:var O=_e;if(!F||K1(F)){it=0,Ei=null;var Y=O.sibling;if(Y!==null)_e=Y;else{var $=O.return;$!==null?(_e=$,ll($)):_e=null}break t}}it=0,Ei=null,ga(s,a,y,5);break;case 6:it=0,Ei=null,ga(s,a,y,6);break;case 8:Ou(),Et=6;break e;default:throw Error(n(462))}}Vp();break}catch(ne){l1(s,ne)}while(!0);return As=vn=null,_.H=d,_.A=A,tt=c,_e!==null?0:(lt=null,Qe=0,No(),Et)}function Vp(){for(;_e!==null&&!Ui();)h1(_e)}function h1(s){var a=k0(s.alternate,s,Es);s.memoizedProps=s.pendingProps,a===null?ll(s):_e=a}function f1(s){var a=s,c=a.alternate;switch(a.tag){case 15:case 0:a=I0(c,a,a.pendingProps,a.type,void 0,Qe);break;case 11:a=I0(c,a,a.pendingProps,a.type.render,a.ref,Qe);break;case 5:eu(a);default:z0(c,a),a=_e=dd(a,Es),a=k0(c,a,Es)}s.memoizedProps=s.pendingProps,a===null?ll(s):_e=a}function ga(s,a,c,d){As=vn=null,eu(a),ra=null,cr=0;var A=a.return;try{if(Cp(s,A,a,c,Qe)){Et=1,$o(s,ki(c,s.current)),_e=null;return}}catch(y){if(A!==null)throw _e=A,y;Et=1,$o(s,ki(c,s.current)),_e=null;return}a.flags&32768?($e||d===1?s=!0:ua||(Qe&536870912)!==0?s=!1:(js=s=!0,(d===2||d===9||d===3||d===6)&&(d=ji.current,d!==null&&d.tag===13&&(d.flags|=16384))),d1(a,s)):ll(a)}function ll(s){var a=s;do{if((a.flags&32768)!==0){d1(a,js);return}s=a.return;var c=Ep(a.alternate,a,Es);if(c!==null){_e=c;return}if(a=a.sibling,a!==null){_e=a;return}_e=a=s}while(a!==null);Et===0&&(Et=5)}function d1(s,a){do{var c=Tp(s.alternate,s);if(c!==null){c.flags&=32767,_e=c;return}if(c=s.return,c!==null&&(c.flags|=32768,c.subtreeFlags=0,c.deletions=null),!a&&(s=s.sibling,s!==null)){_e=s;return}_e=s=c}while(s!==null);Et=6,_e=null}function m1(s,a,c,d,A,y,F,O,Y){s.cancelPendingCommit=null;do cl();while($t!==0);if((tt&6)!==0)throw Error(n(327));if(a!==null){if(a===s.current)throw Error(n(177));if(y=a.lanes|a.childLanes,y|=Nc,La(s,c,y,F,O,Y),s===lt&&(_e=lt=null,Qe=0),fa=a,Hs=s,da=c,Vu=y,Bu=A,n1=d,(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,kp(Ii,function(){return x1(),null})):(s.callbackNode=null,s.callbackPriority=0),d=(a.flags&13878)!==0,(a.subtreeFlags&13878)!==0||d){d=_.T,_.T=null,A=H.p,H.p=2,F=tt,tt|=4;try{Mp(s,a,c)}finally{tt=F,H.p=A,_.T=d}}$t=1,g1(),p1(),A1()}}function g1(){if($t===1){$t=0;var s=Hs,a=fa,c=(a.flags&13878)!==0;if((a.subtreeFlags&13878)!==0||c){c=_.T,_.T=null;var d=H.p;H.p=2;var A=tt;tt|=4;try{W0(a,s);var y=Wu,F=sd(s.containerInfo),O=y.focusedElem,Y=y.selectionRange;if(F!==O&&O&&O.ownerDocument&&id(O.ownerDocument.documentElement,O)){if(Y!==null&&Sc(O)){var $=Y.start,ne=Y.end;if(ne===void 0&&(ne=$),"selectionStart"in O)O.selectionStart=$,O.selectionEnd=Math.min(ne,O.value.length);else{var oe=O.ownerDocument||document,ee=oe&&oe.defaultView||window;if(ee.getSelection){var te=ee.getSelection(),Me=O.textContent.length,Ce=Math.min(Y.start,Me),at=Y.end===void 0?Ce:Math.min(Y.end,Me);!te.extend&&Ce>at&&(F=at,at=Ce,Ce=F);var Z=td(O,Ce),Q=td(O,at);if(Z&&Q&&(te.rangeCount!==1||te.anchorNode!==Z.node||te.anchorOffset!==Z.offset||te.focusNode!==Q.node||te.focusOffset!==Q.offset)){var J=oe.createRange();J.setStart(Z.node,Z.offset),te.removeAllRanges(),Ce>at?(te.addRange(J),te.extend(Q.node,Q.offset)):(J.setEnd(Q.node,Q.offset),te.addRange(J))}}}}for(oe=[],te=O;te=te.parentNode;)te.nodeType===1&&oe.push({element:te,left:te.scrollLeft,top:te.scrollTop});for(typeof O.focus=="function"&&O.focus(),O=0;O<oe.length;O++){var ae=oe[O];ae.element.scrollLeft=ae.left,ae.element.scrollTop=ae.top}}wl=!!Zu,Wu=Zu=null}finally{tt=A,H.p=d,_.T=c}}s.current=a,$t=2}}function p1(){if($t===2){$t=0;var s=Hs,a=fa,c=(a.flags&8772)!==0;if((a.subtreeFlags&8772)!==0||c){c=_.T,_.T=null;var d=H.p;H.p=2;var A=tt;tt|=4;try{K0(s,a.alternate,a)}finally{tt=A,H.p=d,_.T=c}}$t=3}}function A1(){if($t===4||$t===3){$t=0,Te();var s=Hs,a=fa,c=da,d=n1;(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?$t=5:($t=0,fa=Hs=null,v1(s,s.pendingLanes));var A=s.pendingLanes;if(A===0&&(Ys=null),Ns(c),a=a.stateNode,Tt&&typeof Tt.onCommitFiberRoot=="function")try{Tt.onCommitFiberRoot(xi,a,void 0,(a.current.flags&128)===128)}catch{}if(d!==null){a=_.T,A=H.p,H.p=2,_.T=null;try{for(var y=s.onRecoverableError,F=0;F<d.length;F++){var O=d[F];y(O.value,{componentStack:O.stack})}}finally{_.T=a,H.p=A}}(da&3)!==0&&cl(),as(s),A=s.pendingLanes,(c&4194090)!==0&&(A&42)!==0?s===Lu?vr++:(vr=0,Lu=s):vr=0,xr(0)}}function v1(s,a){(s.pooledCacheLanes&=a)===0&&(a=s.pooledCache,a!=null&&(s.pooledCache=null,Ja(a)))}function cl(s){return g1(),p1(),A1(),x1()}function x1(){if($t!==5)return!1;var s=Hs,a=Vu;Vu=0;var c=Ns(da),d=_.T,A=H.p;try{H.p=32>c?32:c,_.T=null,c=Bu,Bu=null;var y=Hs,F=da;if($t=0,fa=Hs=null,da=0,(tt&6)!==0)throw Error(n(331));var O=tt;if(tt|=4,i1(y.current),$0(y,y.current,F,c),tt=O,xr(0,!1),Tt&&typeof Tt.onPostCommitFiberRoot=="function")try{Tt.onPostCommitFiberRoot(xi,y)}catch{}return!0}finally{H.p=A,_.T=d,v1(s,a)}}function y1(s,a,c){a=ki(c,a),a=mu(s.stateNode,a,2),s=Bs(s,a,2),s!==null&&(Ds(s,2),as(s))}function rt(s,a,c){if(s.tag===3)y1(s,s,c);else for(;a!==null;){if(a.tag===3){y1(a,s,c);break}else if(a.tag===1){var d=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof d.componentDidCatch=="function"&&(Ys===null||!Ys.has(d))){s=ki(c,s),c=S0(2),d=Bs(a,c,2),d!==null&&(E0(c,d,a,s),Ds(d,2),as(d));break}}a=a.return}}function zu(s,a,c){var d=s.pingCache;if(d===null){d=s.pingCache=new Rp;var A=new Set;d.set(a,A)}else A=d.get(a),A===void 0&&(A=new Set,d.set(a,A));A.has(c)||(Ru=!0,A.add(c),s=Bp.bind(null,s,a,c),a.then(s,s))}function Bp(s,a,c){var d=s.pingCache;d!==null&&d.delete(a),s.pingedLanes|=s.suspendedLanes&c,s.warmLanes&=~c,lt===s&&(Qe&c)===c&&(Et===4||Et===3&&(Qe&62914560)===Qe&&300>Xe()-Fu?(tt&2)===0&&ma(s,0):Uu|=c,ha===Qe&&(ha=0)),as(s)}function w1(s,a){a===0&&(a=Bi()),s=Zn(s,a),s!==null&&(Ds(s,a),as(s))}function Lp(s){var a=s.memoizedState,c=0;a!==null&&(c=a.retryLane),w1(s,c)}function Op(s,a){var c=0;switch(s.tag){case 13:var d=s.stateNode,A=s.memoizedState;A!==null&&(c=A.retryLane);break;case 19:d=s.stateNode;break;case 22:d=s.stateNode._retryCache;break;default:throw Error(n(314))}d!==null&&d.delete(a),w1(s,c)}function kp(s,a){return Xt(s,a)}var ul=null,pa=null,_u=!1,hl=!1,ju=!1,En=0;function as(s){s!==pa&&s.next===null&&(pa===null?ul=pa=s:pa=pa.next=s),hl=!0,_u||(_u=!0,zp())}function xr(s,a){if(!ju&&hl){ju=!0;do for(var c=!1,d=ul;d!==null;){if(s!==0){var A=d.pendingLanes;if(A===0)var y=0;else{var F=d.suspendedLanes,O=d.pingedLanes;y=(1<<31-It(42|s)+1)-1,y&=A&~(F&~O),y=y&201326741?y&201326741|1:y?y|2:0}y!==0&&(c=!0,E1(d,y))}else y=Qe,y=At(d,d===lt?y:0,d.cancelPendingCommit!==null||d.timeoutHandle!==-1),(y&3)===0||qi(d,y)||(c=!0,E1(d,y));d=d.next}while(c);ju=!1}}function Pp(){b1()}function b1(){hl=_u=!1;var s=0;En!==0&&(Qp()&&(s=En),En=0);for(var a=Xe(),c=null,d=ul;d!==null;){var A=d.next,y=C1(d,a);y===0?(d.next=null,c===null?ul=A:c.next=A,A===null&&(pa=c)):(c=d,(s!==0||(y&3)!==0)&&(hl=!0)),d=A}xr(s)}function C1(s,a){for(var c=s.suspendedLanes,d=s.pingedLanes,A=s.expirationTimes,y=s.pendingLanes&-62914561;0<y;){var F=31-It(y),O=1<<F,Y=A[F];Y===-1?((O&c)===0||(O&d)!==0)&&(A[F]=Ba(O,a)):Y<=a&&(s.expiredLanes|=O),y&=~O}if(a=lt,c=Qe,c=At(s,s===a?c:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),d=s.callbackNode,c===0||s===a&&(it===2||it===9)||s.cancelPendingCommit!==null)return d!==null&&d!==null&&ft(d),s.callbackNode=null,s.callbackPriority=0;if((c&3)===0||qi(s,c)){if(a=c&-c,a===s.callbackPriority)return a;switch(d!==null&&ft(d),Ns(c)){case 2:case 8:c=Ut;break;case 32:c=Ii;break;case 268435456:c=us;break;default:c=Ii}return d=S1.bind(null,s),c=Xt(c,d),s.callbackPriority=a,s.callbackNode=c,a}return d!==null&&d!==null&&ft(d),s.callbackPriority=2,s.callbackNode=null,2}function S1(s,a){if($t!==0&&$t!==5)return s.callbackNode=null,s.callbackPriority=0,null;var c=s.callbackNode;if(cl()&&s.callbackNode!==c)return null;var d=Qe;return d=At(s,s===lt?d:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),d===0?null:(r1(s,d,a),C1(s,Xe()),s.callbackNode!=null&&s.callbackNode===c?S1.bind(null,s):null)}function E1(s,a){if(cl())return null;r1(s,a,!0)}function zp(){Zp(function(){(tt&6)!==0?Xt(ui,Pp):b1()})}function Gu(){return En===0&&(En=ln()),En}function T1(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:bo(""+s)}function M1(s,a){var c=a.ownerDocument.createElement("input");return c.name=a.name,c.value=a.value,s.id&&c.setAttribute("form",s.id),a.parentNode.insertBefore(c,a),s=new FormData(s),c.parentNode.removeChild(c),s}function _p(s,a,c,d,A){if(a==="submit"&&c&&c.stateNode===A){var y=T1((A[Wt]||null).action),F=d.submitter;F&&(a=(a=F[Wt]||null)?T1(a.formAction):F.getAttribute("formAction"),a!==null&&(y=a,F=null));var O=new To("action","action",null,d,A);s.push({event:O,listeners:[{instance:null,listener:function(){if(d.defaultPrevented){if(En!==0){var Y=F?M1(A,F):new FormData(A);cu(c,{pending:!0,data:Y,method:A.method,action:y},null,Y)}}else typeof y=="function"&&(O.preventDefault(),Y=F?M1(A,F):new FormData(A),cu(c,{pending:!0,data:Y,method:A.method,action:y},y,Y))},currentTarget:A}]})}}for(var Yu=0;Yu<Dc.length;Yu++){var Hu=Dc[Yu],jp=Hu.toLowerCase(),Gp=Hu[0].toUpperCase()+Hu.slice(1);Qi(jp,"on"+Gp)}Qi(rd,"onAnimationEnd"),Qi(od,"onAnimationIteration"),Qi(ld,"onAnimationStart"),Qi("dblclick","onDoubleClick"),Qi("focusin","onFocus"),Qi("focusout","onBlur"),Qi(rp,"onTransitionRun"),Qi(op,"onTransitionStart"),Qi(lp,"onTransitionCancel"),Qi(cd,"onTransitionEnd"),yi("onMouseEnter",["mouseout","mouseover"]),yi("onMouseLeave",["mouseout","mouseover"]),yi("onPointerEnter",["pointerout","pointerover"]),yi("onPointerLeave",["pointerout","pointerover"]),Ct("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ct("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ct("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ct("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ct("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ct("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var yr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Yp=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(yr));function D1(s,a){a=(a&4)!==0;for(var c=0;c<s.length;c++){var d=s[c],A=d.event;d=d.listeners;e:{var y=void 0;if(a)for(var F=d.length-1;0<=F;F--){var O=d[F],Y=O.instance,$=O.currentTarget;if(O=O.listener,Y!==y&&A.isPropagationStopped())break e;y=O,A.currentTarget=$;try{y(A)}catch(ne){Jo(ne)}A.currentTarget=null,y=Y}else for(F=0;F<d.length;F++){if(O=d[F],Y=O.instance,$=O.currentTarget,O=O.listener,Y!==y&&A.isPropagationStopped())break e;y=O,A.currentTarget=$;try{y(A)}catch(ne){Jo(ne)}A.currentTarget=null,y=Y}}}}function je(s,a){var c=a[zn];c===void 0&&(c=a[zn]=new Set);var d=s+"__bubble";c.has(d)||(N1(a,s,2,!1),c.add(d))}function qu(s,a,c){var d=0;a&&(d|=4),N1(c,s,d,a)}var fl="_reactListening"+Math.random().toString(36).slice(2);function Ku(s){if(!s[fl]){s[fl]=!0,xt.forEach(function(c){c!=="selectionchange"&&(Yp.has(c)||qu(c,!1,s),qu(c,!0,s))});var a=s.nodeType===9?s:s.ownerDocument;a===null||a[fl]||(a[fl]=!0,qu("selectionchange",!1,a))}}function N1(s,a,c,d){switch($1(a)){case 2:var A=AA;break;case 8:A=vA;break;default:A=oh}c=A.bind(null,a,c,s),A=void 0,!gc||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(A=!0),d?A!==void 0?s.addEventListener(a,c,{capture:!0,passive:A}):s.addEventListener(a,c,!0):A!==void 0?s.addEventListener(a,c,{passive:A}):s.addEventListener(a,c,!1)}function Qu(s,a,c,d,A){var y=d;if((a&1)===0&&(a&2)===0&&d!==null)e:for(;;){if(d===null)return;var F=d.tag;if(F===3||F===4){var O=d.stateNode.containerInfo;if(O===A)break;if(F===4)for(F=d.return;F!==null;){var Y=F.tag;if((Y===3||Y===4)&&F.stateNode.containerInfo===A)return;F=F.return}for(;O!==null;){if(F=vt(O),F===null)return;if(Y=F.tag,Y===5||Y===6||Y===26||Y===27){d=y=F;continue e}O=O.parentNode}}d=d.return}Lf(function(){var $=y,ne=dc(c),oe=[];e:{var ee=ud.get(s);if(ee!==void 0){var te=To,Me=s;switch(s){case"keypress":if(So(c)===0)break e;case"keydown":case"keyup":te=kg;break;case"focusin":Me="focus",te=xc;break;case"focusout":Me="blur",te=xc;break;case"beforeblur":case"afterblur":te=xc;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":te=Pf;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":te=Tg;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":te=_g;break;case rd:case od:case ld:te=Ng;break;case cd:te=Gg;break;case"scroll":case"scrollend":te=Sg;break;case"wheel":te=Hg;break;case"copy":case"cut":case"paste":te=Ug;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":te=_f;break;case"toggle":case"beforetoggle":te=Kg}var Ce=(a&4)!==0,at=!Ce&&(s==="scroll"||s==="scrollend"),Z=Ce?ee!==null?ee+"Capture":null:ee;Ce=[];for(var Q=$,J;Q!==null;){var ae=Q;if(J=ae.stateNode,ae=ae.tag,ae!==5&&ae!==26&&ae!==27||J===null||Z===null||(ae=Pa(Q,Z),ae!=null&&Ce.push(wr(Q,ae,J))),at)break;Q=Q.return}0<Ce.length&&(ee=new te(ee,Me,null,c,ne),oe.push({event:ee,listeners:Ce}))}}if((a&7)===0){e:{if(ee=s==="mouseover"||s==="pointerover",te=s==="mouseout"||s==="pointerout",ee&&c!==fc&&(Me=c.relatedTarget||c.fromElement)&&(vt(Me)||Me[Rs]))break e;if((te||ee)&&(ee=ne.window===ne?ne:(ee=ne.ownerDocument)?ee.defaultView||ee.parentWindow:window,te?(Me=c.relatedTarget||c.toElement,te=$,Me=Me?vt(Me):null,Me!==null&&(at=o(Me),Ce=Me.tag,Me!==at||Ce!==5&&Ce!==27&&Ce!==6)&&(Me=null)):(te=null,Me=$),te!==Me)){if(Ce=Pf,ae="onMouseLeave",Z="onMouseEnter",Q="mouse",(s==="pointerout"||s==="pointerover")&&(Ce=_f,ae="onPointerLeave",Z="onPointerEnter",Q="pointer"),at=te==null?ee:Ft(te),J=Me==null?ee:Ft(Me),ee=new Ce(ae,Q+"leave",te,c,ne),ee.target=at,ee.relatedTarget=J,ae=null,vt(ne)===$&&(Ce=new Ce(Z,Q+"enter",Me,c,ne),Ce.target=J,Ce.relatedTarget=at,ae=Ce),at=ae,te&&Me)t:{for(Ce=te,Z=Me,Q=0,J=Ce;J;J=Aa(J))Q++;for(J=0,ae=Z;ae;ae=Aa(ae))J++;for(;0<Q-J;)Ce=Aa(Ce),Q--;for(;0<J-Q;)Z=Aa(Z),J--;for(;Q--;){if(Ce===Z||Z!==null&&Ce===Z.alternate)break t;Ce=Aa(Ce),Z=Aa(Z)}Ce=null}else Ce=null;te!==null&&R1(oe,ee,te,Ce,!1),Me!==null&&at!==null&&R1(oe,at,Me,Ce,!0)}}e:{if(ee=$?Ft($):window,te=ee.nodeName&&ee.nodeName.toLowerCase(),te==="select"||te==="input"&&ee.type==="file")var ge=Xf;else if(Kf(ee))if(Zf)ge=sp;else{ge=tp;var Pe=ep}else te=ee.nodeName,!te||te.toLowerCase()!=="input"||ee.type!=="checkbox"&&ee.type!=="radio"?$&&hc($.elementType)&&(ge=Xf):ge=ip;if(ge&&(ge=ge(s,$))){Qf(oe,ge,c,ne);break e}Pe&&Pe(s,ee,$),s==="focusout"&&$&&ee.type==="number"&&$.memoizedProps.value!=null&&uc(ee,"number",ee.value)}switch(Pe=$?Ft($):window,s){case"focusin":(Kf(Pe)||Pe.contentEditable==="true")&&(Kn=Pe,Ec=$,Ka=null);break;case"focusout":Ka=Ec=Kn=null;break;case"mousedown":Tc=!0;break;case"contextmenu":case"mouseup":case"dragend":Tc=!1,nd(oe,c,ne);break;case"selectionchange":if(ap)break;case"keydown":case"keyup":nd(oe,c,ne)}var be;if(wc)e:{switch(s){case"compositionstart":var Ee="onCompositionStart";break e;case"compositionend":Ee="onCompositionEnd";break e;case"compositionupdate":Ee="onCompositionUpdate";break e}Ee=void 0}else qn?Hf(s,c)&&(Ee="onCompositionEnd"):s==="keydown"&&c.keyCode===229&&(Ee="onCompositionStart");Ee&&(jf&&c.locale!=="ko"&&(qn||Ee!=="onCompositionStart"?Ee==="onCompositionEnd"&&qn&&(be=Of()):(Us=ne,pc="value"in Us?Us.value:Us.textContent,qn=!0)),Pe=dl($,Ee),0<Pe.length&&(Ee=new zf(Ee,s,null,c,ne),oe.push({event:Ee,listeners:Pe}),be?Ee.data=be:(be=qf(c),be!==null&&(Ee.data=be)))),(be=Xg?Zg(s,c):Wg(s,c))&&(Ee=dl($,"onBeforeInput"),0<Ee.length&&(Pe=new zf("onBeforeInput","beforeinput",null,c,ne),oe.push({event:Pe,listeners:Ee}),Pe.data=be)),_p(oe,s,$,c,ne)}D1(oe,a)})}function wr(s,a,c){return{instance:s,listener:a,currentTarget:c}}function dl(s,a){for(var c=a+"Capture",d=[];s!==null;){var A=s,y=A.stateNode;if(A=A.tag,A!==5&&A!==26&&A!==27||y===null||(A=Pa(s,c),A!=null&&d.unshift(wr(s,A,y)),A=Pa(s,a),A!=null&&d.push(wr(s,A,y))),s.tag===3)return d;s=s.return}return[]}function Aa(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function R1(s,a,c,d,A){for(var y=a._reactName,F=[];c!==null&&c!==d;){var O=c,Y=O.alternate,$=O.stateNode;if(O=O.tag,Y!==null&&Y===d)break;O!==5&&O!==26&&O!==27||$===null||(Y=$,A?($=Pa(c,y),$!=null&&F.unshift(wr(c,$,Y))):A||($=Pa(c,y),$!=null&&F.push(wr(c,$,Y)))),c=c.return}F.length!==0&&s.push({event:a,listeners:F})}var Hp=/\r\n?/g,qp=/\u0000|\uFFFD/g;function U1(s){return(typeof s=="string"?s:""+s).replace(Hp,`
`).replace(qp,"")}function I1(s,a){return a=U1(a),U1(s)===a}function ml(){}function nt(s,a,c,d,A,y){switch(c){case"children":typeof d=="string"?a==="body"||a==="textarea"&&d===""||Gn(s,d):(typeof d=="number"||typeof d=="bigint")&&a!=="body"&&Gn(s,""+d);break;case"className":xo(s,"class",d);break;case"tabIndex":xo(s,"tabindex",d);break;case"dir":case"role":case"viewBox":case"width":case"height":xo(s,c,d);break;case"style":Vf(s,d,y);break;case"data":if(a!=="object"){xo(s,"data",d);break}case"src":case"href":if(d===""&&(a!=="a"||c!=="href")){s.removeAttribute(c);break}if(d==null||typeof d=="function"||typeof d=="symbol"||typeof d=="boolean"){s.removeAttribute(c);break}d=bo(""+d),s.setAttribute(c,d);break;case"action":case"formAction":if(typeof d=="function"){s.setAttribute(c,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof y=="function"&&(c==="formAction"?(a!=="input"&&nt(s,a,"name",A.name,A,null),nt(s,a,"formEncType",A.formEncType,A,null),nt(s,a,"formMethod",A.formMethod,A,null),nt(s,a,"formTarget",A.formTarget,A,null)):(nt(s,a,"encType",A.encType,A,null),nt(s,a,"method",A.method,A,null),nt(s,a,"target",A.target,A,null)));if(d==null||typeof d=="symbol"||typeof d=="boolean"){s.removeAttribute(c);break}d=bo(""+d),s.setAttribute(c,d);break;case"onClick":d!=null&&(s.onclick=ml);break;case"onScroll":d!=null&&je("scroll",s);break;case"onScrollEnd":d!=null&&je("scrollend",s);break;case"dangerouslySetInnerHTML":if(d!=null){if(typeof d!="object"||!("__html"in d))throw Error(n(61));if(c=d.__html,c!=null){if(A.children!=null)throw Error(n(60));s.innerHTML=c}}break;case"multiple":s.multiple=d&&typeof d!="function"&&typeof d!="symbol";break;case"muted":s.muted=d&&typeof d!="function"&&typeof d!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(d==null||typeof d=="function"||typeof d=="boolean"||typeof d=="symbol"){s.removeAttribute("xlink:href");break}c=bo(""+d),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":d!=null&&typeof d!="function"&&typeof d!="symbol"?s.setAttribute(c,""+d):s.removeAttribute(c);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":d&&typeof d!="function"&&typeof d!="symbol"?s.setAttribute(c,""):s.removeAttribute(c);break;case"capture":case"download":d===!0?s.setAttribute(c,""):d!==!1&&d!=null&&typeof d!="function"&&typeof d!="symbol"?s.setAttribute(c,d):s.removeAttribute(c);break;case"cols":case"rows":case"size":case"span":d!=null&&typeof d!="function"&&typeof d!="symbol"&&!isNaN(d)&&1<=d?s.setAttribute(c,d):s.removeAttribute(c);break;case"rowSpan":case"start":d==null||typeof d=="function"||typeof d=="symbol"||isNaN(d)?s.removeAttribute(c):s.setAttribute(c,d);break;case"popover":je("beforetoggle",s),je("toggle",s),vo(s,"popover",d);break;case"xlinkActuate":fs(s,"http://www.w3.org/1999/xlink","xlink:actuate",d);break;case"xlinkArcrole":fs(s,"http://www.w3.org/1999/xlink","xlink:arcrole",d);break;case"xlinkRole":fs(s,"http://www.w3.org/1999/xlink","xlink:role",d);break;case"xlinkShow":fs(s,"http://www.w3.org/1999/xlink","xlink:show",d);break;case"xlinkTitle":fs(s,"http://www.w3.org/1999/xlink","xlink:title",d);break;case"xlinkType":fs(s,"http://www.w3.org/1999/xlink","xlink:type",d);break;case"xmlBase":fs(s,"http://www.w3.org/XML/1998/namespace","xml:base",d);break;case"xmlLang":fs(s,"http://www.w3.org/XML/1998/namespace","xml:lang",d);break;case"xmlSpace":fs(s,"http://www.w3.org/XML/1998/namespace","xml:space",d);break;case"is":vo(s,"is",d);break;case"innerText":case"textContent":break;default:(!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(c=bg.get(c)||c,vo(s,c,d))}}function Xu(s,a,c,d,A,y){switch(c){case"style":Vf(s,d,y);break;case"dangerouslySetInnerHTML":if(d!=null){if(typeof d!="object"||!("__html"in d))throw Error(n(61));if(c=d.__html,c!=null){if(A.children!=null)throw Error(n(60));s.innerHTML=c}}break;case"children":typeof d=="string"?Gn(s,d):(typeof d=="number"||typeof d=="bigint")&&Gn(s,""+d);break;case"onScroll":d!=null&&je("scroll",s);break;case"onScrollEnd":d!=null&&je("scrollend",s);break;case"onClick":d!=null&&(s.onclick=ml);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Mt.hasOwnProperty(c))e:{if(c[0]==="o"&&c[1]==="n"&&(A=c.endsWith("Capture"),a=c.slice(2,A?c.length-7:void 0),y=s[Wt]||null,y=y!=null?y[c]:null,typeof y=="function"&&s.removeEventListener(a,y,A),typeof d=="function")){typeof y!="function"&&y!==null&&(c in s?s[c]=null:s.hasAttribute(c)&&s.removeAttribute(c)),s.addEventListener(a,d,A);break e}c in s?s[c]=d:d===!0?s.setAttribute(c,""):vo(s,c,d)}}}function ei(s,a,c){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":je("error",s),je("load",s);var d=!1,A=!1,y;for(y in c)if(c.hasOwnProperty(y)){var F=c[y];if(F!=null)switch(y){case"src":d=!0;break;case"srcSet":A=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,a));default:nt(s,a,y,F,c,null)}}A&&nt(s,a,"srcSet",c.srcSet,c,null),d&&nt(s,a,"src",c.src,c,null);return;case"input":je("invalid",s);var O=y=F=A=null,Y=null,$=null;for(d in c)if(c.hasOwnProperty(d)){var ne=c[d];if(ne!=null)switch(d){case"name":A=ne;break;case"type":F=ne;break;case"checked":Y=ne;break;case"defaultChecked":$=ne;break;case"value":y=ne;break;case"defaultValue":O=ne;break;case"children":case"dangerouslySetInnerHTML":if(ne!=null)throw Error(n(137,a));break;default:nt(s,a,d,ne,c,null)}}Rf(s,y,O,Y,$,F,A,!1),yo(s);return;case"select":je("invalid",s),d=F=y=null;for(A in c)if(c.hasOwnProperty(A)&&(O=c[A],O!=null))switch(A){case"value":y=O;break;case"defaultValue":F=O;break;case"multiple":d=O;default:nt(s,a,A,O,c,null)}a=y,c=F,s.multiple=!!d,a!=null?jn(s,!!d,a,!1):c!=null&&jn(s,!!d,c,!0);return;case"textarea":je("invalid",s),y=A=d=null;for(F in c)if(c.hasOwnProperty(F)&&(O=c[F],O!=null))switch(F){case"value":d=O;break;case"defaultValue":A=O;break;case"children":y=O;break;case"dangerouslySetInnerHTML":if(O!=null)throw Error(n(91));break;default:nt(s,a,F,O,c,null)}If(s,d,A,y),yo(s);return;case"option":for(Y in c)if(c.hasOwnProperty(Y)&&(d=c[Y],d!=null))switch(Y){case"selected":s.selected=d&&typeof d!="function"&&typeof d!="symbol";break;default:nt(s,a,Y,d,c,null)}return;case"dialog":je("beforetoggle",s),je("toggle",s),je("cancel",s),je("close",s);break;case"iframe":case"object":je("load",s);break;case"video":case"audio":for(d=0;d<yr.length;d++)je(yr[d],s);break;case"image":je("error",s),je("load",s);break;case"details":je("toggle",s);break;case"embed":case"source":case"link":je("error",s),je("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for($ in c)if(c.hasOwnProperty($)&&(d=c[$],d!=null))switch($){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,a));default:nt(s,a,$,d,c,null)}return;default:if(hc(a)){for(ne in c)c.hasOwnProperty(ne)&&(d=c[ne],d!==void 0&&Xu(s,a,ne,d,c,void 0));return}}for(O in c)c.hasOwnProperty(O)&&(d=c[O],d!=null&&nt(s,a,O,d,c,null))}function Kp(s,a,c,d){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var A=null,y=null,F=null,O=null,Y=null,$=null,ne=null;for(te in c){var oe=c[te];if(c.hasOwnProperty(te)&&oe!=null)switch(te){case"checked":break;case"value":break;case"defaultValue":Y=oe;default:d.hasOwnProperty(te)||nt(s,a,te,null,d,oe)}}for(var ee in d){var te=d[ee];if(oe=c[ee],d.hasOwnProperty(ee)&&(te!=null||oe!=null))switch(ee){case"type":y=te;break;case"name":A=te;break;case"checked":$=te;break;case"defaultChecked":ne=te;break;case"value":F=te;break;case"defaultValue":O=te;break;case"children":case"dangerouslySetInnerHTML":if(te!=null)throw Error(n(137,a));break;default:te!==oe&&nt(s,a,ee,te,d,oe)}}cc(s,F,O,Y,$,ne,y,A);return;case"select":te=F=O=ee=null;for(y in c)if(Y=c[y],c.hasOwnProperty(y)&&Y!=null)switch(y){case"value":break;case"multiple":te=Y;default:d.hasOwnProperty(y)||nt(s,a,y,null,d,Y)}for(A in d)if(y=d[A],Y=c[A],d.hasOwnProperty(A)&&(y!=null||Y!=null))switch(A){case"value":ee=y;break;case"defaultValue":O=y;break;case"multiple":F=y;default:y!==Y&&nt(s,a,A,y,d,Y)}a=O,c=F,d=te,ee!=null?jn(s,!!c,ee,!1):!!d!=!!c&&(a!=null?jn(s,!!c,a,!0):jn(s,!!c,c?[]:"",!1));return;case"textarea":te=ee=null;for(O in c)if(A=c[O],c.hasOwnProperty(O)&&A!=null&&!d.hasOwnProperty(O))switch(O){case"value":break;case"children":break;default:nt(s,a,O,null,d,A)}for(F in d)if(A=d[F],y=c[F],d.hasOwnProperty(F)&&(A!=null||y!=null))switch(F){case"value":ee=A;break;case"defaultValue":te=A;break;case"children":break;case"dangerouslySetInnerHTML":if(A!=null)throw Error(n(91));break;default:A!==y&&nt(s,a,F,A,d,y)}Uf(s,ee,te);return;case"option":for(var Me in c)if(ee=c[Me],c.hasOwnProperty(Me)&&ee!=null&&!d.hasOwnProperty(Me))switch(Me){case"selected":s.selected=!1;break;default:nt(s,a,Me,null,d,ee)}for(Y in d)if(ee=d[Y],te=c[Y],d.hasOwnProperty(Y)&&ee!==te&&(ee!=null||te!=null))switch(Y){case"selected":s.selected=ee&&typeof ee!="function"&&typeof ee!="symbol";break;default:nt(s,a,Y,ee,d,te)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ce in c)ee=c[Ce],c.hasOwnProperty(Ce)&&ee!=null&&!d.hasOwnProperty(Ce)&&nt(s,a,Ce,null,d,ee);for($ in d)if(ee=d[$],te=c[$],d.hasOwnProperty($)&&ee!==te&&(ee!=null||te!=null))switch($){case"children":case"dangerouslySetInnerHTML":if(ee!=null)throw Error(n(137,a));break;default:nt(s,a,$,ee,d,te)}return;default:if(hc(a)){for(var at in c)ee=c[at],c.hasOwnProperty(at)&&ee!==void 0&&!d.hasOwnProperty(at)&&Xu(s,a,at,void 0,d,ee);for(ne in d)ee=d[ne],te=c[ne],!d.hasOwnProperty(ne)||ee===te||ee===void 0&&te===void 0||Xu(s,a,ne,ee,d,te);return}}for(var Z in c)ee=c[Z],c.hasOwnProperty(Z)&&ee!=null&&!d.hasOwnProperty(Z)&&nt(s,a,Z,null,d,ee);for(oe in d)ee=d[oe],te=c[oe],!d.hasOwnProperty(oe)||ee===te||ee==null&&te==null||nt(s,a,oe,ee,d,te)}var Zu=null,Wu=null;function gl(s){return s.nodeType===9?s:s.ownerDocument}function F1(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function V1(s,a){if(s===0)switch(a){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&a==="foreignObject"?0:s}function Ju(s,a){return s==="textarea"||s==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.children=="bigint"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var $u=null;function Qp(){var s=window.event;return s&&s.type==="popstate"?s===$u?!1:($u=s,!0):($u=null,!1)}var B1=typeof setTimeout=="function"?setTimeout:void 0,Xp=typeof clearTimeout=="function"?clearTimeout:void 0,L1=typeof Promise=="function"?Promise:void 0,Zp=typeof queueMicrotask=="function"?queueMicrotask:typeof L1<"u"?function(s){return L1.resolve(null).then(s).catch(Wp)}:B1;function Wp(s){setTimeout(function(){throw s})}function Ks(s){return s==="head"}function O1(s,a){var c=a,d=0,A=0;do{var y=c.nextSibling;if(s.removeChild(c),y&&y.nodeType===8)if(c=y.data,c==="/$"){if(0<d&&8>d){c=d;var F=s.ownerDocument;if(c&1&&br(F.documentElement),c&2&&br(F.body),c&4)for(c=F.head,br(c),F=c.firstChild;F;){var O=F.nextSibling,Y=F.nodeName;F[De]||Y==="SCRIPT"||Y==="STYLE"||Y==="LINK"&&F.rel.toLowerCase()==="stylesheet"||c.removeChild(F),F=O}}if(A===0){s.removeChild(y),Rr(a);return}A--}else c==="$"||c==="$?"||c==="$!"?A++:d=c.charCodeAt(0)-48;else d=0;c=y}while(c);Rr(a)}function eh(s){var a=s.firstChild;for(a&&a.nodeType===10&&(a=a.nextSibling);a;){var c=a;switch(a=a.nextSibling,c.nodeName){case"HTML":case"HEAD":case"BODY":eh(c),dt(c);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(c.rel.toLowerCase()==="stylesheet")continue}s.removeChild(c)}}function Jp(s,a,c,d){for(;s.nodeType===1;){var A=c;if(s.nodeName.toLowerCase()!==a.toLowerCase()){if(!d&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(d){if(!s[De])switch(a){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(y=s.getAttribute("rel"),y==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(y!==A.rel||s.getAttribute("href")!==(A.href==null||A.href===""?null:A.href)||s.getAttribute("crossorigin")!==(A.crossOrigin==null?null:A.crossOrigin)||s.getAttribute("title")!==(A.title==null?null:A.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(y=s.getAttribute("src"),(y!==(A.src==null?null:A.src)||s.getAttribute("type")!==(A.type==null?null:A.type)||s.getAttribute("crossorigin")!==(A.crossOrigin==null?null:A.crossOrigin))&&y&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(a==="input"&&s.type==="hidden"){var y=A.name==null?null:""+A.name;if(A.type==="hidden"&&s.getAttribute("name")===y)return s}else return s;if(s=Zi(s.nextSibling),s===null)break}return null}function $p(s,a,c){if(a==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!c||(s=Zi(s.nextSibling),s===null))return null;return s}function th(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState==="complete"}function eA(s,a){var c=s.ownerDocument;if(s.data!=="$?"||c.readyState==="complete")a();else{var d=function(){a(),c.removeEventListener("DOMContentLoaded",d)};c.addEventListener("DOMContentLoaded",d),s._reactRetry=d}}function Zi(s){for(;s!=null;s=s.nextSibling){var a=s.nodeType;if(a===1||a===3)break;if(a===8){if(a=s.data,a==="$"||a==="$!"||a==="$?"||a==="F!"||a==="F")break;if(a==="/$")return null}}return s}var ih=null;function k1(s){s=s.previousSibling;for(var a=0;s;){if(s.nodeType===8){var c=s.data;if(c==="$"||c==="$!"||c==="$?"){if(a===0)return s;a--}else c==="/$"&&a++}s=s.previousSibling}return null}function P1(s,a,c){switch(a=gl(c),s){case"html":if(s=a.documentElement,!s)throw Error(n(452));return s;case"head":if(s=a.head,!s)throw Error(n(453));return s;case"body":if(s=a.body,!s)throw Error(n(454));return s;default:throw Error(n(451))}}function br(s){for(var a=s.attributes;a.length;)s.removeAttributeNode(a[0]);dt(s)}var Yi=new Map,z1=new Set;function pl(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var Ts=H.d;H.d={f:tA,r:iA,D:sA,C:nA,L:aA,m:rA,X:lA,S:oA,M:cA};function tA(){var s=Ts.f(),a=ol();return s||a}function iA(s){var a=_t(s);a!==null&&a.tag===5&&a.type==="form"?r0(a):Ts.r(s)}var va=typeof document>"u"?null:document;function _1(s,a,c){var d=va;if(d&&typeof a=="string"&&a){var A=Oi(a);A='link[rel="'+s+'"][href="'+A+'"]',typeof c=="string"&&(A+='[crossorigin="'+c+'"]'),z1.has(A)||(z1.add(A),s={rel:s,crossOrigin:c,href:a},d.querySelector(A)===null&&(a=d.createElement("link"),ei(a,"link",s),Ke(a),d.head.appendChild(a)))}}function sA(s){Ts.D(s),_1("dns-prefetch",s,null)}function nA(s,a){Ts.C(s,a),_1("preconnect",s,a)}function aA(s,a,c){Ts.L(s,a,c);var d=va;if(d&&s&&a){var A='link[rel="preload"][as="'+Oi(a)+'"]';a==="image"&&c&&c.imageSrcSet?(A+='[imagesrcset="'+Oi(c.imageSrcSet)+'"]',typeof c.imageSizes=="string"&&(A+='[imagesizes="'+Oi(c.imageSizes)+'"]')):A+='[href="'+Oi(s)+'"]';var y=A;switch(a){case"style":y=xa(s);break;case"script":y=ya(s)}Yi.has(y)||(s=m({rel:"preload",href:a==="image"&&c&&c.imageSrcSet?void 0:s,as:a},c),Yi.set(y,s),d.querySelector(A)!==null||a==="style"&&d.querySelector(Cr(y))||a==="script"&&d.querySelector(Sr(y))||(a=d.createElement("link"),ei(a,"link",s),Ke(a),d.head.appendChild(a)))}}function rA(s,a){Ts.m(s,a);var c=va;if(c&&s){var d=a&&typeof a.as=="string"?a.as:"script",A='link[rel="modulepreload"][as="'+Oi(d)+'"][href="'+Oi(s)+'"]',y=A;switch(d){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":y=ya(s)}if(!Yi.has(y)&&(s=m({rel:"modulepreload",href:s},a),Yi.set(y,s),c.querySelector(A)===null)){switch(d){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(c.querySelector(Sr(y)))return}d=c.createElement("link"),ei(d,"link",s),Ke(d),c.head.appendChild(d)}}}function oA(s,a,c){Ts.S(s,a,c);var d=va;if(d&&s){var A=Ue(d).hoistableStyles,y=xa(s);a=a||"default";var F=A.get(y);if(!F){var O={loading:0,preload:null};if(F=d.querySelector(Cr(y)))O.loading=5;else{s=m({rel:"stylesheet",href:s,"data-precedence":a},c),(c=Yi.get(y))&&sh(s,c);var Y=F=d.createElement("link");Ke(Y),ei(Y,"link",s),Y._p=new Promise(function($,ne){Y.onload=$,Y.onerror=ne}),Y.addEventListener("load",function(){O.loading|=1}),Y.addEventListener("error",function(){O.loading|=2}),O.loading|=4,Al(F,a,d)}F={type:"stylesheet",instance:F,count:1,state:O},A.set(y,F)}}}function lA(s,a){Ts.X(s,a);var c=va;if(c&&s){var d=Ue(c).hoistableScripts,A=ya(s),y=d.get(A);y||(y=c.querySelector(Sr(A)),y||(s=m({src:s,async:!0},a),(a=Yi.get(A))&&nh(s,a),y=c.createElement("script"),Ke(y),ei(y,"link",s),c.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},d.set(A,y))}}function cA(s,a){Ts.M(s,a);var c=va;if(c&&s){var d=Ue(c).hoistableScripts,A=ya(s),y=d.get(A);y||(y=c.querySelector(Sr(A)),y||(s=m({src:s,async:!0,type:"module"},a),(a=Yi.get(A))&&nh(s,a),y=c.createElement("script"),Ke(y),ei(y,"link",s),c.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},d.set(A,y))}}function j1(s,a,c,d){var A=(A=me.current)?pl(A):null;if(!A)throw Error(n(446));switch(s){case"meta":case"title":return null;case"style":return typeof c.precedence=="string"&&typeof c.href=="string"?(a=xa(c.href),c=Ue(A).hoistableStyles,d=c.get(a),d||(d={type:"style",instance:null,count:0,state:null},c.set(a,d)),d):{type:"void",instance:null,count:0,state:null};case"link":if(c.rel==="stylesheet"&&typeof c.href=="string"&&typeof c.precedence=="string"){s=xa(c.href);var y=Ue(A).hoistableStyles,F=y.get(s);if(F||(A=A.ownerDocument||A,F={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},y.set(s,F),(y=A.querySelector(Cr(s)))&&!y._p&&(F.instance=y,F.state.loading=5),Yi.has(s)||(c={rel:"preload",as:"style",href:c.href,crossOrigin:c.crossOrigin,integrity:c.integrity,media:c.media,hrefLang:c.hrefLang,referrerPolicy:c.referrerPolicy},Yi.set(s,c),y||uA(A,s,c,F.state))),a&&d===null)throw Error(n(528,""));return F}if(a&&d!==null)throw Error(n(529,""));return null;case"script":return a=c.async,c=c.src,typeof c=="string"&&a&&typeof a!="function"&&typeof a!="symbol"?(a=ya(c),c=Ue(A).hoistableScripts,d=c.get(a),d||(d={type:"script",instance:null,count:0,state:null},c.set(a,d)),d):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,s))}}function xa(s){return'href="'+Oi(s)+'"'}function Cr(s){return'link[rel="stylesheet"]['+s+"]"}function G1(s){return m({},s,{"data-precedence":s.precedence,precedence:null})}function uA(s,a,c,d){s.querySelector('link[rel="preload"][as="style"]['+a+"]")?d.loading=1:(a=s.createElement("link"),d.preload=a,a.addEventListener("load",function(){return d.loading|=1}),a.addEventListener("error",function(){return d.loading|=2}),ei(a,"link",c),Ke(a),s.head.appendChild(a))}function ya(s){return'[src="'+Oi(s)+'"]'}function Sr(s){return"script[async]"+s}function Y1(s,a,c){if(a.count++,a.instance===null)switch(a.type){case"style":var d=s.querySelector('style[data-href~="'+Oi(c.href)+'"]');if(d)return a.instance=d,Ke(d),d;var A=m({},c,{"data-href":c.href,"data-precedence":c.precedence,href:null,precedence:null});return d=(s.ownerDocument||s).createElement("style"),Ke(d),ei(d,"style",A),Al(d,c.precedence,s),a.instance=d;case"stylesheet":A=xa(c.href);var y=s.querySelector(Cr(A));if(y)return a.state.loading|=4,a.instance=y,Ke(y),y;d=G1(c),(A=Yi.get(A))&&sh(d,A),y=(s.ownerDocument||s).createElement("link"),Ke(y);var F=y;return F._p=new Promise(function(O,Y){F.onload=O,F.onerror=Y}),ei(y,"link",d),a.state.loading|=4,Al(y,c.precedence,s),a.instance=y;case"script":return y=ya(c.src),(A=s.querySelector(Sr(y)))?(a.instance=A,Ke(A),A):(d=c,(A=Yi.get(y))&&(d=m({},c),nh(d,A)),s=s.ownerDocument||s,A=s.createElement("script"),Ke(A),ei(A,"link",d),s.head.appendChild(A),a.instance=A);case"void":return null;default:throw Error(n(443,a.type))}else a.type==="stylesheet"&&(a.state.loading&4)===0&&(d=a.instance,a.state.loading|=4,Al(d,c.precedence,s));return a.instance}function Al(s,a,c){for(var d=c.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),A=d.length?d[d.length-1]:null,y=A,F=0;F<d.length;F++){var O=d[F];if(O.dataset.precedence===a)y=O;else if(y!==A)break}y?y.parentNode.insertBefore(s,y.nextSibling):(a=c.nodeType===9?c.head:c,a.insertBefore(s,a.firstChild))}function sh(s,a){s.crossOrigin==null&&(s.crossOrigin=a.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=a.referrerPolicy),s.title==null&&(s.title=a.title)}function nh(s,a){s.crossOrigin==null&&(s.crossOrigin=a.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=a.referrerPolicy),s.integrity==null&&(s.integrity=a.integrity)}var vl=null;function H1(s,a,c){if(vl===null){var d=new Map,A=vl=new Map;A.set(c,d)}else A=vl,d=A.get(c),d||(d=new Map,A.set(c,d));if(d.has(s))return d;for(d.set(s,null),c=c.getElementsByTagName(s),A=0;A<c.length;A++){var y=c[A];if(!(y[De]||y[zt]||s==="link"&&y.getAttribute("rel")==="stylesheet")&&y.namespaceURI!=="http://www.w3.org/2000/svg"){var F=y.getAttribute(a)||"";F=s+F;var O=d.get(F);O?O.push(y):d.set(F,[y])}}return d}function q1(s,a,c){s=s.ownerDocument||s,s.head.insertBefore(c,a==="title"?s.querySelector("head > title"):null)}function hA(s,a,c){if(c===1||a.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof a.precedence!="string"||typeof a.href!="string"||a.href==="")break;return!0;case"link":if(typeof a.rel!="string"||typeof a.href!="string"||a.href===""||a.onLoad||a.onError)break;switch(a.rel){case"stylesheet":return s=a.disabled,typeof a.precedence=="string"&&s==null;default:return!0}case"script":if(a.async&&typeof a.async!="function"&&typeof a.async!="symbol"&&!a.onLoad&&!a.onError&&a.src&&typeof a.src=="string")return!0}return!1}function K1(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}var Er=null;function fA(){}function dA(s,a,c){if(Er===null)throw Error(n(475));var d=Er;if(a.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(a.state.loading&4)===0){if(a.instance===null){var A=xa(c.href),y=s.querySelector(Cr(A));if(y){s=y._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(d.count++,d=xl.bind(d),s.then(d,d)),a.state.loading|=4,a.instance=y,Ke(y);return}y=s.ownerDocument||s,c=G1(c),(A=Yi.get(A))&&sh(c,A),y=y.createElement("link"),Ke(y);var F=y;F._p=new Promise(function(O,Y){F.onload=O,F.onerror=Y}),ei(y,"link",c),a.instance=y}d.stylesheets===null&&(d.stylesheets=new Map),d.stylesheets.set(a,s),(s=a.state.preload)&&(a.state.loading&3)===0&&(d.count++,a=xl.bind(d),s.addEventListener("load",a),s.addEventListener("error",a))}}function mA(){if(Er===null)throw Error(n(475));var s=Er;return s.stylesheets&&s.count===0&&ah(s,s.stylesheets),0<s.count?function(a){var c=setTimeout(function(){if(s.stylesheets&&ah(s,s.stylesheets),s.unsuspend){var d=s.unsuspend;s.unsuspend=null,d()}},6e4);return s.unsuspend=a,function(){s.unsuspend=null,clearTimeout(c)}}:null}function xl(){if(this.count--,this.count===0){if(this.stylesheets)ah(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var yl=null;function ah(s,a){s.stylesheets=null,s.unsuspend!==null&&(s.count++,yl=new Map,a.forEach(gA,s),yl=null,xl.call(s))}function gA(s,a){if(!(a.state.loading&4)){var c=yl.get(s);if(c)var d=c.get(null);else{c=new Map,yl.set(s,c);for(var A=s.querySelectorAll("link[data-precedence],style[data-precedence]"),y=0;y<A.length;y++){var F=A[y];(F.nodeName==="LINK"||F.getAttribute("media")!=="not all")&&(c.set(F.dataset.precedence,F),d=F)}d&&c.set(null,d)}A=a.instance,F=A.getAttribute("data-precedence"),y=c.get(F)||d,y===d&&c.set(null,A),c.set(F,A),this.count++,d=xl.bind(this),A.addEventListener("load",d),A.addEventListener("error",d),y?y.parentNode.insertBefore(A,y.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(A,s.firstChild)),a.state.loading|=4}}var Tr={$$typeof:E,Provider:null,Consumer:null,_currentValue:q,_currentValue2:q,_threadCount:0};function pA(s,a,c,d,A,y,F,O){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=cn(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=cn(0),this.hiddenUpdates=cn(null),this.identifierPrefix=d,this.onUncaughtError=A,this.onCaughtError=y,this.onRecoverableError=F,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=O,this.incompleteTransitions=new Map}function Q1(s,a,c,d,A,y,F,O,Y,$,ne,oe){return s=new pA(s,a,c,F,O,Y,$,oe),a=1,y===!0&&(a|=24),y=bi(3,null,null,a),s.current=y,y.stateNode=s,a=zc(),a.refCount++,s.pooledCache=a,a.refCount++,y.memoizedState={element:d,isDehydrated:c,cache:a},Yc(y),s}function X1(s){return s?(s=Wn,s):Wn}function Z1(s,a,c,d,A,y){A=X1(A),d.context===null?d.context=A:d.pendingContext=A,d=Vs(a),d.payload={element:c},y=y===void 0?null:y,y!==null&&(d.callback=y),c=Bs(s,d,a),c!==null&&(Mi(c,s,a),ir(c,s,a))}function W1(s,a){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var c=s.retryLane;s.retryLane=c!==0&&c<a?c:a}}function rh(s,a){W1(s,a),(s=s.alternate)&&W1(s,a)}function J1(s){if(s.tag===13){var a=Zn(s,67108864);a!==null&&Mi(a,s,67108864),rh(s,67108864)}}var wl=!0;function AA(s,a,c,d){var A=_.T;_.T=null;var y=H.p;try{H.p=2,oh(s,a,c,d)}finally{H.p=y,_.T=A}}function vA(s,a,c,d){var A=_.T;_.T=null;var y=H.p;try{H.p=8,oh(s,a,c,d)}finally{H.p=y,_.T=A}}function oh(s,a,c,d){if(wl){var A=lh(d);if(A===null)Qu(s,a,d,bl,c),e2(s,d);else if(yA(A,s,a,c,d))d.stopPropagation();else if(e2(s,d),a&4&&-1<xA.indexOf(s)){for(;A!==null;){var y=_t(A);if(y!==null)switch(y.tag){case 3:if(y=y.stateNode,y.current.memoizedState.isDehydrated){var F=bt(y.pendingLanes);if(F!==0){var O=y;for(O.pendingLanes|=2,O.entangledLanes|=2;F;){var Y=1<<31-It(F);O.entanglements[1]|=Y,F&=~Y}as(y),(tt&6)===0&&(al=Xe()+500,xr(0))}}break;case 13:O=Zn(y,2),O!==null&&Mi(O,y,2),ol(),rh(y,2)}if(y=lh(d),y===null&&Qu(s,a,d,bl,c),y===A)break;A=y}A!==null&&d.stopPropagation()}else Qu(s,a,d,null,c)}}function lh(s){return s=dc(s),ch(s)}var bl=null;function ch(s){if(bl=null,s=vt(s),s!==null){var a=o(s);if(a===null)s=null;else{var c=a.tag;if(c===13){if(s=l(a),s!==null)return s;s=null}else if(c===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;s=null}else a!==s&&(s=null)}}return bl=s,null}function $1(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(re()){case ui:return 2;case Ut:return 8;case Ii:case $i:return 32;case us:return 268435456;default:return 32}default:return 32}}var uh=!1,Qs=null,Xs=null,Zs=null,Mr=new Map,Dr=new Map,Ws=[],xA="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function e2(s,a){switch(s){case"focusin":case"focusout":Qs=null;break;case"dragenter":case"dragleave":Xs=null;break;case"mouseover":case"mouseout":Zs=null;break;case"pointerover":case"pointerout":Mr.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":Dr.delete(a.pointerId)}}function Nr(s,a,c,d,A,y){return s===null||s.nativeEvent!==y?(s={blockedOn:a,domEventName:c,eventSystemFlags:d,nativeEvent:y,targetContainers:[A]},a!==null&&(a=_t(a),a!==null&&J1(a)),s):(s.eventSystemFlags|=d,a=s.targetContainers,A!==null&&a.indexOf(A)===-1&&a.push(A),s)}function yA(s,a,c,d,A){switch(a){case"focusin":return Qs=Nr(Qs,s,a,c,d,A),!0;case"dragenter":return Xs=Nr(Xs,s,a,c,d,A),!0;case"mouseover":return Zs=Nr(Zs,s,a,c,d,A),!0;case"pointerover":var y=A.pointerId;return Mr.set(y,Nr(Mr.get(y)||null,s,a,c,d,A)),!0;case"gotpointercapture":return y=A.pointerId,Dr.set(y,Nr(Dr.get(y)||null,s,a,c,d,A)),!0}return!1}function t2(s){var a=vt(s.target);if(a!==null){var c=o(a);if(c!==null){if(a=c.tag,a===13){if(a=l(c),a!==null){s.blockedOn=a,po(s.priority,function(){if(c.tag===13){var d=Ti();d=kn(d);var A=Zn(c,d);A!==null&&Mi(A,c,d),rh(c,d)}});return}}else if(a===3&&c.stateNode.current.memoizedState.isDehydrated){s.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Cl(s){if(s.blockedOn!==null)return!1;for(var a=s.targetContainers;0<a.length;){var c=lh(s.nativeEvent);if(c===null){c=s.nativeEvent;var d=new c.constructor(c.type,c);fc=d,c.target.dispatchEvent(d),fc=null}else return a=_t(c),a!==null&&J1(a),s.blockedOn=c,!1;a.shift()}return!0}function i2(s,a,c){Cl(s)&&c.delete(a)}function wA(){uh=!1,Qs!==null&&Cl(Qs)&&(Qs=null),Xs!==null&&Cl(Xs)&&(Xs=null),Zs!==null&&Cl(Zs)&&(Zs=null),Mr.forEach(i2),Dr.forEach(i2)}function Sl(s,a){s.blockedOn===a&&(s.blockedOn=null,uh||(uh=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,wA)))}var El=null;function s2(s){El!==s&&(El=s,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){El===s&&(El=null);for(var a=0;a<s.length;a+=3){var c=s[a],d=s[a+1],A=s[a+2];if(typeof d!="function"){if(ch(d||c)===null)continue;break}var y=_t(c);y!==null&&(s.splice(a,3),a-=3,cu(y,{pending:!0,data:A,method:c.method,action:d},d,A))}}))}function Rr(s){function a(Y){return Sl(Y,s)}Qs!==null&&Sl(Qs,s),Xs!==null&&Sl(Xs,s),Zs!==null&&Sl(Zs,s),Mr.forEach(a),Dr.forEach(a);for(var c=0;c<Ws.length;c++){var d=Ws[c];d.blockedOn===s&&(d.blockedOn=null)}for(;0<Ws.length&&(c=Ws[0],c.blockedOn===null);)t2(c),c.blockedOn===null&&Ws.shift();if(c=(s.ownerDocument||s).$$reactFormReplay,c!=null)for(d=0;d<c.length;d+=3){var A=c[d],y=c[d+1],F=A[Wt]||null;if(typeof y=="function")F||s2(c);else if(F){var O=null;if(y&&y.hasAttribute("formAction")){if(A=y,F=y[Wt]||null)O=F.formAction;else if(ch(A)!==null)continue}else O=F.action;typeof O=="function"?c[d+1]=O:(c.splice(d,3),d-=3),s2(c)}}}function hh(s){this._internalRoot=s}Tl.prototype.render=hh.prototype.render=function(s){var a=this._internalRoot;if(a===null)throw Error(n(409));var c=a.current,d=Ti();Z1(c,d,s,a,null,null)},Tl.prototype.unmount=hh.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var a=s.containerInfo;Z1(s.current,2,null,s,null,null),ol(),a[Rs]=null}};function Tl(s){this._internalRoot=s}Tl.prototype.unstable_scheduleHydration=function(s){if(s){var a=Pn();s={blockedOn:null,target:s,priority:a};for(var c=0;c<Ws.length&&a!==0&&a<Ws[c].priority;c++);Ws.splice(c,0,s),c===0&&t2(s)}};var n2=e.version;if(n2!=="19.1.0")throw Error(n(527,n2,"19.1.0"));H.findDOMNode=function(s){var a=s._reactInternals;if(a===void 0)throw typeof s.render=="function"?Error(n(188)):(s=Object.keys(s).join(","),Error(n(268,s)));return s=f(a),s=s!==null?u(s):null,s=s===null?null:s.stateNode,s};var bA={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:_,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ml=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ml.isDisabled&&Ml.supportsFiber)try{xi=Ml.inject(bA),Tt=Ml}catch{}}return Ir.createRoot=function(s,a){if(!r(s))throw Error(n(299));var c=!1,d="",A=y0,y=w0,F=b0,O=null;return a!=null&&(a.unstable_strictMode===!0&&(c=!0),a.identifierPrefix!==void 0&&(d=a.identifierPrefix),a.onUncaughtError!==void 0&&(A=a.onUncaughtError),a.onCaughtError!==void 0&&(y=a.onCaughtError),a.onRecoverableError!==void 0&&(F=a.onRecoverableError),a.unstable_transitionCallbacks!==void 0&&(O=a.unstable_transitionCallbacks)),a=Q1(s,1,!1,null,null,c,d,A,y,F,O,null),s[Rs]=a.current,Ku(s),new hh(a)},Ir.hydrateRoot=function(s,a,c){if(!r(s))throw Error(n(299));var d=!1,A="",y=y0,F=w0,O=b0,Y=null,$=null;return c!=null&&(c.unstable_strictMode===!0&&(d=!0),c.identifierPrefix!==void 0&&(A=c.identifierPrefix),c.onUncaughtError!==void 0&&(y=c.onUncaughtError),c.onCaughtError!==void 0&&(F=c.onCaughtError),c.onRecoverableError!==void 0&&(O=c.onRecoverableError),c.unstable_transitionCallbacks!==void 0&&(Y=c.unstable_transitionCallbacks),c.formState!==void 0&&($=c.formState)),a=Q1(s,1,!0,a,c??null,d,A,y,F,O,Y,$),a.context=X1(null),c=a.current,d=Ti(),d=kn(d),A=Vs(d),A.callback=null,Bs(c,A,d),c=d,a.current.lanes=c,Ds(a,c),as(a),s[Rs]=a.current,Ku(s),new Tl(a)},Ir.version="19.1.0",Ir}var g2;function BA(){if(g2)return ph.exports;g2=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),ph.exports=VA(),ph.exports}var LA=BA();function OA({currentLanguage:t,t:e,callback:i,userFirstName:n,userLastName:r}){const[o,l]=ie.useState(!1),h=ie.useRef(null),f=()=>{l(!o)};return ie.useEffect(()=>{const u=m=>{o&&h.current&&!h.current.contains(m.target)&&l(!1)};return document.addEventListener("click",u),()=>{document.removeEventListener("click",u)}},[o]),L.jsxs("div",{id:"user-dropdown-container",className:"user-dropdown-container",ref:h,children:[L.jsxs("button",{id:"user-menu-button",className:"user-menu-button",onClick:()=>f(),children:[L.jsx("img",{src:"assets/interface/user_brain.png",alt:"User Icon",className:"user-icon"}),L.jsx("span",{id:"welcome-username",children:e("welcome_message",{firstname:n})}),L.jsx("i",{className:"fas fa-caret-down dropdown-arrow"})]}),o&&L.jsxs("div",{id:"user-dropdown-menu",className:"user-dropdown-menu",children:[L.jsx("div",{className:"dropdown-header",children:L.jsxs("span",{id:"dropdown-username-header",children:[n," ",r]})}),L.jsxs("button",{id:"config-button-dropdown",className:"dropdown-item",onClick:()=>{i.gotoPage("config"),l(!1)},children:[L.jsx("img",{src:"assets/interface/config.png",alt:"Config icon"}),L.jsx("span",{children:e("config_mode")})]}),L.jsxs("button",{id:"stats-button-dropdown",className:"dropdown-item",onClick:()=>{i.gotoPage("stats"),l(!1)},children:[L.jsx("img",{src:"assets/interface/statistics.png",alt:"Stats icon"})," ",L.jsx("span",{children:e("my_stats")})]}),L.jsxs("div",{className:"language-switcher-dropdown",children:[L.jsx("button",{className:t=="fr"?"lang-icon-btn-dropdown lang-icon-btn-dropdown-active":"lang-icon-btn-dropdown","data-lang":"fr","aria-label":"Franais",onClick:()=>{i.handleChangeLanguage("fr")},children:L.jsx("img",{src:"assets/interface/fr.png",alt:"FR"})}),L.jsx("button",{className:t=="en"?"lang-icon-btn-dropdown lang-icon-btn-dropdown-active":"lang-icon-btn-dropdown","data-lang":"en","aria-label":"English",onClick:()=>{i.handleChangeLanguage("en")},children:L.jsx("img",{src:"assets/interface/en.png",alt:"EN"})})]}),L.jsx("button",{id:"logout-button-dropdown",className:"dropdown-item logout-item",onClick:()=>i.logout(),children:L.jsx("span",{children:e("logout_mode")})})]})]})}const kA=["cortical_regions","subcortical_regions","white_matter_tracts","functional_networks","cerebral_arteries"],Kr={"harvard-oxford":{atlas_category:"cortical_regions",nii:"HarvardOxford-cort-maxprob-thr25-1mm.nii.gz",json:"harvard_oxford.json",name:"Harvard-Oxford",difficulty:1},tissues:{atlas_category:"cortical_regions",nii:"mni152_pveseg.nii.gz",json:"tissue.json",name:"Tissue",difficulty:0},destrieux:{atlas_category:"cortical_regions",nii:"remapped_destrieux_stride_uint.nii.gz",json:"destrieux_new.json",name:"Destrieux",difficulty:3},desikan:{atlas_category:"cortical_regions",nii:"remapped_dk_stride.nii.gz",json:"desikan_new.json",name:"Desikan",difficulty:2},allen:{atlas_category:"cortical_regions",nii:"reconstructed_allen_05mm_uint.nii.gz",json:"allen.json",name:"Allen",difficulty:4},yeo7:{atlas_category:"functional_networks",nii:"Yeo-7-liberal_space-MNI152NLin6_res-1x1x1.nii.gz",json:"yeo7.json",name:"Yeo7",difficulty:1},yeo17:{atlas_category:"functional_networks",nii:"Yeo-17-liberal_space-MNI152NLin6_res-1x1x1.nii.gz",json:"yeo17.json",name:"Yeo17",difficulty:2},subcortical:{atlas_category:"subcortical_regions",nii:"ICBM2009b_asym-SubCorSeg-1mm_nn_regrid.nii.gz",json:"subcortical.json",name:"Subcortical",difficulty:2},cerebellum:{atlas_category:"subcortical_regions",nii:"Cerebellum-MNIfnirt-maxprob-thr25-1mm.nii.gz",json:"cerebellum.json",name:"Cerebellum",difficulty:2},thalamus:{atlas_category:"subcortical_regions",nii:"Thalamus_Nuclei-HCP-MaxProb.nii.gz",json:"thalamus7.json",name:"Thalamus",difficulty:3},HippoAmyg:{atlas_category:"subcortical_regions",nii:"HippoAmyg_web.nii.gz",json:"HippoAmyg_labels.json",name:"Hippocampus & Amygdala",difficulty:3},xtract:{atlas_category:"white_matter_tracts",nii:"xtract_web.nii.gz",json:"xtract_labels.json",name:"White Matter",difficulty:2},JHU:{atlas_category:"white_matter_tracts",nii:"JHU_web.nii.gz",json:"JHU_labels.json",name:"JHU",difficulty:2},territories:{atlas_category:"cerebral_arteries",nii:"ArterialAtlas_stride_round.nii.gz",json:"artery_territories.json",name:"Territories",difficulty:2}};function Sm({t,callback:e,atlasRegions:i}){const n=ie.useRef(null),r=()=>{var f;h(((f=n.current)==null?void 0:f.value)||"")},[o,l]=ie.useState([]);function h(f){const u=f.toLowerCase(),m=i.filter(g=>g.name.toLowerCase().includes(u)).sort((g,p)=>{const v=g.name.toLowerCase().indexOf(u),x=p.name.toLowerCase().indexOf(u);return v!==x?v-x:g.name.length-p.name.length});l(m)}return L.jsx(L.Fragment,{children:L.jsx("div",{className:"search-bar-container-main",children:L.jsxs("div",{className:"search-container main-search",children:[L.jsx("input",{type:"text",id:"atlas-search",className:"search-input",placeholder:t("search_placeholder"),onChange:r,ref:n}),o.length>0&&L.jsx("div",{id:"search-suggestions",className:"search-suggestions",children:o.map(f=>L.jsx("div",{className:"search-suggestion",onClick:()=>{e.openNeurotheka(f),l([])},dangerouslySetInnerHTML:{__html:`${f.name} <span style="color: #808588;">(${f.atlasName})</span>`}},f.atlasName+"_"+f.name+"_"+f.id))})]})})})}function PA({currentPage:t,t:e,callback:i,viewerOptions:n}){const r=o=>{const l={...n,...o};i.setViewerOption(l)};return L.jsx(L.Fragment,{children:L.jsxs("div",{className:"dropdown",children:[L.jsxs("button",{className:"dropbtn",children:[e("view_options"),L.jsx("span",{className:"hamburger",children:L.jsxs("svg",{width:"24",height:"18",viewBox:"0 0 24 18",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[L.jsx("path",{d:"M0 1H24",stroke:"white","stroke-width":"1.5"}),L.jsx("path",{d:"M0 9H24",stroke:"white","stroke-width":"1.5"}),L.jsx("path",{d:"M0 17H24",stroke:"white","stroke-width":"1.5"})]})})]}),L.jsxs("div",{className:"dropdown-content",children:[L.jsx("a",{className:n.displayType=="Axial"?"viewBtn dropdown-item-checked":"viewBtn",onClick:()=>r({displayType:"Axial"}),children:e("axial")}),L.jsx("a",{className:n.displayType=="Sagittal"?"viewBtn dropdown-item-checked":"viewBtn",onClick:()=>r({displayType:"Sagittal"}),children:e("sagittal")}),L.jsx("a",{className:n.displayType=="Coronal"?"viewBtn dropdown-item-checked":"viewBtn",onClick:()=>r({displayType:"Coronal"}),children:e("coronal")}),L.jsx("a",{className:n.displayType=="Render"?"viewBtn dropdown-item-checked":"viewBtn",onClick:()=>r({displayType:"Render"}),children:e("render")}),L.jsx("a",{className:n.displayType=="MultiPlanar"?"viewBtn dropdown-item-checked":"viewBtn",onClick:()=>r({displayType:"MultiPlanar"}),children:e("multiplanar")}),L.jsx("a",{className:n.displayType=="MultiPlanarRender"?"viewBtn dropdown-item-checked":"viewBtn",onClick:()=>r({displayType:"MultiPlanarRender"}),children:e("multiplanar_render")}),L.jsx("a",{className:n.radiologicalOrientation?"viewBtn dropdown-item-checked":"viewBtn",onClick:()=>r({radiologicalOrientation:!n.radiologicalOrientation}),children:e("radiological")}),L.jsx("a",{className:n.displayAtlas?"viewBtn dropdown-item-checked":"viewBtn",onClick:()=>r({displayAtlas:!n.displayAtlas}),children:e("colored_atlas")}),L.jsxs("div",{className:"slider-container",children:[L.jsx("label",{className:"slider-label",htmlFor:"alphaSlider",children:e("atlas_opacity")}),L.jsx("input",{type:"range",min:"0",max:"255",defaultValue:Math.round(n.displayOpacity*255),onChange:o=>{const l=parseInt(o.target.value,10);r({displayOpacity:l/255})},className:"slider",id:"alphaSlider"})]})]})]})})}function zA({currentLanguage:t,currentPage:e,atlasRegions:i,t:n,callback:r,isLoggedIn:o,userFirstName:l,userLastName:h,headerText:f,headerTextMode:u,headerStreak:m,headerTime:g,headerScore:p,headerErrors:v,viewerOptions:x}){return L.jsx(L.Fragment,{children:L.jsx("header",{className:"navbar",children:L.jsxs("div",{className:"navbar-container",children:[L.jsxs("div",{className:"navbar-left logo-title-container-navbar logo-title-container",onClick:()=>{r.gotoPage("welcome")},children:[L.jsx("img",{src:"assets/interface/neuroguessr.png",alt:"NeuroGuessr Logo",className:"logo"}),L.jsx("h1",{children:e=="neurotheka"?n("neuroglossaire_title"):n("app_title")})]}),L.jsxs("div",{className:"navbar-middle",children:[f!=""&&L.jsx("div",{className:"target-label-container",children:L.jsx("p",{id:"target-label",children:L.jsx("span",{className:"target-text",style:(w=>{switch(w){case"success":return{color:"#4ade80",fontWeight:"bold",transition:"all 0.1s ease-in-out"};case"failure":return{color:"#f87171",fontWeight:"bold",transition:"all 0.1s ease-in-out"}}return{}})(u),children:f})})}),e=="neurotheka"&&L.jsx(Sm,{t:n,callback:r,atlasRegions:i}),e=="singleplayer"&&L.jsxs("div",{className:"score-error-container",children:[p&&L.jsx("p",{id:"score-label",children:p}),v&&L.jsxs("p",{id:"error-label",children:[n("errors_label"),": ",v]}),m&&L.jsxs("p",{id:"streak-label",children:[L.jsxs("span",{children:[n("streak_label"),": "]}),L.jsx("span",{id:"streak-value",children:m}),L.jsx("img",{src:"assets/interface/flame.png",alt:"Streak Flame",className:"streak-flame-icon-small"})]}),g&&L.jsxs("p",{id:"time-label",children:[n("time_label"),": ",g]})]})]}),L.jsxs("div",{className:"navbar-right",children:[(e=="neurotheka"||e=="singleplayer")&&L.jsx(PA,{currentPage:e,t:n,callback:r,viewerOptions:x}),!o&&L.jsx("button",{id:"guest-sign-in-button",className:"guest-sign-in-button",onClick:()=>r.gotoPage("login"),children:n("sign_in")}),o&&L.jsx(OA,{currentLanguage:t,t:n,callback:r,userFirstName:l,userLastName:h})]})]})})})}function _A({t,callback:e}){const[i,n]=ie.useState("cortical_regions"),[r,o]=ie.useState(""),[l,h]=ie.useState(""),[f,u]=ie.useState("singleplayer"),m=()=>{f=="singleplayer"&&r&&l&&e.launchSinglePlayerGame(r,l)};return L.jsx(L.Fragment,{children:L.jsxs("div",{className:"centered-container",children:[L.jsxs("div",{className:"player-selection-buttons",children:[L.jsx("button",{id:"single-player-button",className:f=="singleplayer"?"player-mode-button selected":"player-mode-button",onClick:()=>u("singleplayer"),children:t("single_player_button")}),L.jsx("button",{id:"single-player-button",className:f=="multiplayer"?"player-mode-button selected":"player-mode-button",onClick:()=>u("multiplayer"),children:t("multiplayer_button")})]}),f=="singleplayer"&&L.jsxs("div",{id:"single-player-options",className:"single-player-options-container hidden",children:[L.jsxs("section",{className:"atlas-selection",children:[L.jsxs("h2",{children:[L.jsx("img",{src:"assets/interface/numero-1.png",alt:"Atlas Icon"})," ",L.jsx("span",{"data-i18n":"select_atlas",children:"Select Atlas"})]}),L.jsxs("div",{className:"atlas-layout",children:[L.jsx("div",{className:"category-list",children:kA.map(g=>L.jsx("button",{className:i==g?"category-button selected":"category-button",onClick:()=>{n(g)},children:t(g)},g))}),L.jsx("div",{className:"atlas-choices-display",children:Object.entries(Kr).filter(([g,p])=>p.atlas_category==i).sort(([,g],[,p])=>(g.difficulty||0)-(p.difficulty||0)).map(([g,p])=>L.jsxs("button",{className:r==g?"panel-button selected":"panel-button",onClick:()=>o(g),children:[L.jsx("span",{className:"atlas-info",dangerouslySetInnerHTML:{__html:t(g.toLowerCase()+"_info")}}),p.difficulty>0&&L.jsx("span",{className:"difficulty-icons",children:[...Array(p.difficulty)].map((v,x)=>L.jsx("img",{src:"assets/interface/star.png",alt:"Star",className:"star-icon"},x))})]},p.name))})]})]}),L.jsxs("section",{className:"mode-selection",children:[L.jsxs("h2",{children:[L.jsx("img",{src:"assets/interface/numero-2.png",alt:"Game Mode Icon"})," ",L.jsx("span",{"data-i18n":"select_game_mode",children:"Select Game Mode"})]}),L.jsxs("div",{className:"mode-buttons",children:[L.jsxs("button",{className:l=="navigation"?"mode-button selected":"mode-button",onClick:()=>h("navigation"),children:[L.jsx("img",{src:"assets/interface/boussole.png",alt:"Boussole Icon"}),L.jsx("span",{children:t("navigation_mode")}),L.jsx("span",{className:"mode-description",children:t("navigation_description")})]}),L.jsxs("button",{className:l=="practice"?"mode-button selected":"mode-button",onClick:()=>h("practice"),children:[L.jsx("img",{src:"assets/interface/practice.png",alt:"Practice Icon"}),L.jsx("span",{children:t("practice_mode")}),L.jsx("span",{className:"mode-description",children:t("practice_description")})]}),L.jsxs("button",{className:l=="streak"?"mode-button selected":"mode-button",onClick:()=>h("streak"),children:[L.jsx("img",{src:"assets/interface/flame.png",alt:"Flame Icon"}),L.jsx("span",{children:t("streak_mode")}),L.jsx("span",{className:"mode-description",children:t("streak_description")})]}),L.jsxs("button",{className:l=="time-attack"?"mode-button selected":"mode-button",onClick:()=>h("time-attack"),children:[L.jsx("img",{src:"assets/interface/chronometer.png",alt:"Chronometer Icon"}),L.jsx("span",{children:t("time_attack_mode")}),L.jsx("span",{className:"mode-description",children:t("time_attack_description")})]})]}),L.jsx("button",{id:"play-button",className:r==""||l==""?"play-button disabled":"play-button enabled",onClick:()=>m(),children:t("play_button")})]})]}),f=="multiplayer"&&L.jsx("div",{id:"multiplayer-message",className:"hidden",children:L.jsx("p",{"data-i18n":"multiplayer_not_available",children:"Multiplayer not available for now"})})]})})}function jA({t,callback:e,atlasRegions:i}){return L.jsxs(L.Fragment,{children:[i.length>0&&L.jsx(Sm,{t,callback:e,atlasRegions:i}),L.jsx(_A,{t,callback:e})]})}const GA=(t,e,i,n)=>{var o,l,h,f;const r=[i,{code:e,...n||{}}];if((l=(o=t==null?void 0:t.services)==null?void 0:o.logger)!=null&&l.forward)return t.services.logger.forward(r,"warn","react-i18next::",!0);In(r[0])&&(r[0]=`react-i18next:: ${r[0]}`),(f=(h=t==null?void 0:t.services)==null?void 0:h.logger)!=null&&f.warn?t.services.logger.warn(...r):console!=null&&console.warn&&console.warn(...r)},p2={},kh=(t,e,i,n)=>{In(i)&&p2[i]||(In(i)&&(p2[i]=new Date),GA(t,e,i,n))},Em=(t,e)=>()=>{if(t.isInitialized)e();else{const i=()=>{setTimeout(()=>{t.off("initialized",i)},0),e()};t.on("initialized",i)}},Ph=(t,e,i)=>{t.loadNamespaces(e,Em(t,i))},A2=(t,e,i,n)=>{if(In(i)&&(i=[i]),t.options.preload&&t.options.preload.indexOf(e)>-1)return Ph(t,i,n);i.forEach(r=>{t.options.ns.indexOf(r)<0&&t.options.ns.push(r)}),t.loadLanguages(e,Em(t,n))},YA=(t,e,i={})=>!e.languages||!e.languages.length?(kh(e,"NO_LANGUAGES","i18n.languages were undefined or empty",{languages:e.languages}),!0):e.hasLoadedNamespace(t,{lng:i.lng,precheck:(n,r)=>{var o;if(((o=i.bindI18n)==null?void 0:o.indexOf("languageChanging"))>-1&&n.services.backendConnector.backend&&n.isLanguageChangingTo&&!r(n.isLanguageChangingTo,t))return!1}}),In=t=>typeof t=="string",HA=t=>typeof t=="object"&&t!==null,qA=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34|nbsp|#160|copy|#169|reg|#174|hellip|#8230|#x2F|#47);/g,KA={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"',"&nbsp;":" ","&#160;":" ","&copy;":"","&#169;":"","&reg;":"","&#174;":"","&hellip;":"","&#8230;":"","&#x2F;":"/","&#47;":"/"},QA=t=>KA[t],XA=t=>t.replace(qA,QA);let zh={bindI18n:"languageChanged",bindI18nStore:"",transEmptyNodeValue:"",transSupportBasicHtmlNodes:!0,transWrapTextNodes:"",transKeepBasicHtmlNodesFor:["br","strong","i","p"],useSuspense:!0,unescape:XA};const ZA=(t={})=>{zh={...zh,...t}},WA=()=>zh;let Tm;const JA=t=>{Tm=t},$A=()=>Tm,e5={type:"3rdParty",init(t){ZA(t.options.react),JA(t)}},t5=ie.createContext();class i5{constructor(){this.usedNamespaces={}}addUsedNamespaces(e){e.forEach(i=>{this.usedNamespaces[i]||(this.usedNamespaces[i]=!0)})}getUsedNamespaces(){return Object.keys(this.usedNamespaces)}}const s5=(t,e)=>{const i=ie.useRef();return ie.useEffect(()=>{i.current=t},[t,e]),i.current},Mm=(t,e,i,n)=>t.getFixedT(e,i,n),n5=(t,e,i,n)=>ie.useCallback(Mm(t,e,i,n),[t,e,i,n]),a5=(t,e={})=>{var T,D,R,N;const{i18n:i}=e,{i18n:n,defaultNS:r}=ie.useContext(t5)||{},o=i||n||$A();if(o&&!o.reportNamespaces&&(o.reportNamespaces=new i5),!o){kh(o,"NO_I18NEXT_INSTANCE","useTranslation: You will need to pass in an i18next instance by using initReactI18next");const M=(I,B)=>In(B)?B:HA(B)&&In(B.defaultValue)?B.defaultValue:Array.isArray(I)?I[I.length-1]:I,V=[M,{},!1];return V.t=M,V.i18n={},V.ready=!1,V}(T=o.options.react)!=null&&T.wait&&kh(o,"DEPRECATED_OPTION","useTranslation: It seems you are still using the old wait option, you may migrate to the new useSuspense behaviour.");const l={...WA(),...o.options.react,...e},{useSuspense:h,keyPrefix:f}=l;let u=r||((D=o.options)==null?void 0:D.defaultNS);u=In(u)?[u]:u||["translation"],(N=(R=o.reportNamespaces).addUsedNamespaces)==null||N.call(R,u);const m=(o.isInitialized||o.initializedStoreOnce)&&u.every(M=>YA(M,o,l)),g=n5(o,e.lng||null,l.nsMode==="fallback"?u:u[0],f),p=()=>g,v=()=>Mm(o,e.lng||null,l.nsMode==="fallback"?u:u[0],f),[x,w]=ie.useState(p);let b=u.join();e.lng&&(b=`${e.lng}${b}`);const S=s5(b),C=ie.useRef(!0);ie.useEffect(()=>{const{bindI18n:M,bindI18nStore:V}=l;C.current=!0,!m&&!h&&(e.lng?A2(o,e.lng,u,()=>{C.current&&w(v)}):Ph(o,u,()=>{C.current&&w(v)})),m&&S&&S!==b&&C.current&&w(v);const I=()=>{C.current&&w(v)};return M&&(o==null||o.on(M,I)),V&&(o==null||o.store.on(V,I)),()=>{C.current=!1,o&&(M==null||M.split(" ").forEach(B=>o.off(B,I))),V&&o&&V.split(" ").forEach(B=>o.store.off(B,I))}},[o,b]),ie.useEffect(()=>{C.current&&m&&w(p)},[o,f,m]);const E=[x,o,m];if(E.t=x,E.i18n=o,E.ready=m,m||!m&&!h)return E;throw new Promise(M=>{e.lng?A2(o,e.lng,u,()=>M()):Ph(o,u,()=>M())})};var r5=1e-6,Qt=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});function o5(){var t=new Qt(9);return Qt!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function Nn(t,e,i,n,r,o,l,h,f){var u=new Qt(9);return u[0]=t,u[1]=e,u[2]=i,u[3]=n,u[4]=r,u[5]=o,u[6]=l,u[7]=h,u[8]=f,u}function Dm(t,e,i){var n=e[0],r=e[1],o=e[2],l=e[3],h=e[4],f=e[5],u=e[6],m=e[7],g=e[8],p=i[0],v=i[1],x=i[2],w=i[3],b=i[4],S=i[5],C=i[6],E=i[7],T=i[8];return t[0]=p*n+v*l+x*u,t[1]=p*r+v*h+x*m,t[2]=p*o+v*f+x*g,t[3]=w*n+b*l+S*u,t[4]=w*r+b*h+S*m,t[5]=w*o+b*f+S*g,t[6]=C*n+E*l+T*u,t[7]=C*r+E*h+T*m,t[8]=C*o+E*f+T*g,t}function Ge(){var t=new Qt(16);return Qt!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function Rt(t){var e=new Qt(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function l5(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Ri(t,e,i,n,r,o,l,h,f,u,m,g,p,v,x,w){var b=new Qt(16);return b[0]=t,b[1]=e,b[2]=i,b[3]=n,b[4]=r,b[5]=o,b[6]=l,b[7]=h,b[8]=f,b[9]=u,b[10]=m,b[11]=g,b[12]=p,b[13]=v,b[14]=x,b[15]=w,b}function Nm(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Ni(t,e){if(t===e){var i=e[1],n=e[2],r=e[3],o=e[6],l=e[7],h=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=i,t[6]=e[9],t[7]=e[13],t[8]=n,t[9]=o,t[11]=e[14],t[12]=r,t[13]=l,t[14]=h}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function vi(t,e){var i=e[0],n=e[1],r=e[2],o=e[3],l=e[4],h=e[5],f=e[6],u=e[7],m=e[8],g=e[9],p=e[10],v=e[11],x=e[12],w=e[13],b=e[14],S=e[15],C=i*h-n*l,E=i*f-r*l,T=i*u-o*l,D=n*f-r*h,R=n*u-o*h,N=r*u-o*f,M=m*w-g*x,V=m*b-p*x,I=m*S-v*x,B=g*b-p*w,U=g*S-v*w,z=p*S-v*b,P=C*z-E*U+T*B+D*I-R*V+N*M;return P?(P=1/P,t[0]=(h*z-f*U+u*B)*P,t[1]=(r*U-n*z-o*B)*P,t[2]=(w*N-b*R+S*D)*P,t[3]=(p*R-g*N-v*D)*P,t[4]=(f*I-l*z-u*V)*P,t[5]=(i*z-r*I+o*V)*P,t[6]=(b*T-x*N-S*E)*P,t[7]=(m*N-p*T+v*E)*P,t[8]=(l*U-h*I+u*M)*P,t[9]=(n*I-i*U-o*M)*P,t[10]=(x*R-w*T+S*C)*P,t[11]=(g*T-m*R-v*C)*P,t[12]=(h*V-l*B-f*M)*P,t[13]=(i*B-n*V+r*M)*P,t[14]=(w*E-x*D-b*C)*P,t[15]=(m*D-g*E+p*C)*P,t):null}function sn(t,e,i){var n=e[0],r=e[1],o=e[2],l=e[3],h=e[4],f=e[5],u=e[6],m=e[7],g=e[8],p=e[9],v=e[10],x=e[11],w=e[12],b=e[13],S=e[14],C=e[15],E=i[0],T=i[1],D=i[2],R=i[3];return t[0]=E*n+T*h+D*g+R*w,t[1]=E*r+T*f+D*p+R*b,t[2]=E*o+T*u+D*v+R*S,t[3]=E*l+T*m+D*x+R*C,E=i[4],T=i[5],D=i[6],R=i[7],t[4]=E*n+T*h+D*g+R*w,t[5]=E*r+T*f+D*p+R*b,t[6]=E*o+T*u+D*v+R*S,t[7]=E*l+T*m+D*x+R*C,E=i[8],T=i[9],D=i[10],R=i[11],t[8]=E*n+T*h+D*g+R*w,t[9]=E*r+T*f+D*p+R*b,t[10]=E*o+T*u+D*v+R*S,t[11]=E*l+T*m+D*x+R*C,E=i[12],T=i[13],D=i[14],R=i[15],t[12]=E*n+T*h+D*g+R*w,t[13]=E*r+T*f+D*p+R*b,t[14]=E*o+T*u+D*v+R*S,t[15]=E*l+T*m+D*x+R*C,t}function Ta(t,e,i){var n=i[0],r=i[1],o=i[2],l,h,f,u,m,g,p,v,x,w,b,S;return e===t?(t[12]=e[0]*n+e[4]*r+e[8]*o+e[12],t[13]=e[1]*n+e[5]*r+e[9]*o+e[13],t[14]=e[2]*n+e[6]*r+e[10]*o+e[14],t[15]=e[3]*n+e[7]*r+e[11]*o+e[15]):(l=e[0],h=e[1],f=e[2],u=e[3],m=e[4],g=e[5],p=e[6],v=e[7],x=e[8],w=e[9],b=e[10],S=e[11],t[0]=l,t[1]=h,t[2]=f,t[3]=u,t[4]=m,t[5]=g,t[6]=p,t[7]=v,t[8]=x,t[9]=w,t[10]=b,t[11]=S,t[12]=l*n+m*r+x*o+e[12],t[13]=h*n+g*r+w*o+e[13],t[14]=f*n+p*r+b*o+e[14],t[15]=u*n+v*r+S*o+e[15]),t}function v2(t,e,i){var n=i[0],r=i[1],o=i[2];return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Dl(t,e,i){var n=Math.sin(i),r=Math.cos(i),o=e[4],l=e[5],h=e[6],f=e[7],u=e[8],m=e[9],g=e[10],p=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*r+u*n,t[5]=l*r+m*n,t[6]=h*r+g*n,t[7]=f*r+p*n,t[8]=u*r-o*n,t[9]=m*r-l*n,t[10]=g*r-h*n,t[11]=p*r-f*n,t}function Nl(t,e,i){var n=Math.sin(i),r=Math.cos(i),o=e[0],l=e[1],h=e[2],f=e[3],u=e[4],m=e[5],g=e[6],p=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*r+u*n,t[1]=l*r+m*n,t[2]=h*r+g*n,t[3]=f*r+p*n,t[4]=u*r-o*n,t[5]=m*r-l*n,t[6]=g*r-h*n,t[7]=p*r-f*n,t}function c5(t,e,i){var n=i[0],r=i[1],o=i[2],l=Math.hypot(n,r,o),h,f,u;return l<r5?null:(l=1/l,n*=l,r*=l,o*=l,h=Math.sin(e),f=Math.cos(e),u=1-f,t[0]=n*n*u+f,t[1]=r*n*u+o*h,t[2]=o*n*u-r*h,t[3]=0,t[4]=n*r*u-o*h,t[5]=r*r*u+f,t[6]=o*r*u+n*h,t[7]=0,t[8]=n*o*u+r*h,t[9]=r*o*u-n*h,t[10]=o*o*u+f,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function u5(t,e,i,n,r,o,l){var h=1/(e-i),f=1/(n-r),u=1/(o-l);return t[0]=-2*h,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*f,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*u,t[11]=0,t[12]=(e+i)*h,t[13]=(r+n)*f,t[14]=(l+o)*u,t[15]=1,t}var Rl=u5;function h5(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*i,t[9]=e[9]*i,t[10]=e[10]*i,t[11]=e[11]*i,t[12]=e[12]*i,t[13]=e[13]*i,t[14]=e[14]*i,t[15]=e[15]*i,t}var Rm=sn;function ot(){var t=new Qt(3);return Qt!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function jr(t){var e=new Qt(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function rn(t){var e=t[0],i=t[1],n=t[2];return Math.hypot(e,i,n)}function he(t,e,i){var n=new Qt(3);return n[0]=t,n[1]=e,n[2]=i,n}function x2(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function Fn(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t}function ct(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t}function ef(t,e,i){return t[0]=Math.min(e[0],i[0]),t[1]=Math.min(e[1],i[1]),t[2]=Math.min(e[2],i[2]),t}function tf(t,e,i){return t[0]=Math.max(e[0],i[0]),t[1]=Math.max(e[1],i[1]),t[2]=Math.max(e[2],i[2]),t}function f5(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t}function d5(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function Hi(t,e){var i=e[0],n=e[1],r=e[2],o=i*i+n*n+r*r;return o>0&&(o=1/Math.sqrt(o)),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o,t}function m5(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function kl(t,e,i){var n=e[0],r=e[1],o=e[2],l=i[0],h=i[1],f=i[2];return t[0]=r*f-o*h,t[1]=o*l-n*f,t[2]=n*h-r*l,t}function g5(t,e,i,n){var r=e[0],o=e[1],l=e[2];return t[0]=r+n*(i[0]-r),t[1]=o+n*(i[1]-o),t[2]=l+n*(i[2]-l),t}function yh(t,e){var i=t[0],n=t[1],r=t[2],o=e[0],l=e[1],h=e[2],f=Math.sqrt(i*i+n*n+r*r),u=Math.sqrt(o*o+l*l+h*h),m=f*u,g=m&&m5(t,e)/m;return Math.acos(Math.min(Math.max(g,-1),1))}var y2=ct,Qr=rn;(function(){var t=ot();return function(e,i,n,r,o,l){var h,f;for(i||(i=3),n||(n=0),r?f=Math.min(r*i+n,e.length):f=e.length,h=n;h<f;h+=i)t[0]=e[h],t[1]=e[h+1],t[2]=e[h+2],o(t,t,l),e[h]=t[0],e[h+1]=t[1],e[h+2]=t[2];return e}})();function cs(){var t=new Qt(4);return Qt!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function Ms(t){var e=new Qt(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function ut(t,e,i,n){var r=new Qt(4);return r[0]=t,r[1]=e,r[2]=i,r[3]=n,r}function w2(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t[3]=e[3]+i[3],t}function p5(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t[3]=e[3]-i[3],t}function A5(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t}function qt(t,e,i){var n=e[0],r=e[1],o=e[2],l=e[3];return t[0]=i[0]*n+i[4]*r+i[8]*o+i[12]*l,t[1]=i[1]*n+i[5]*r+i[9]*o+i[13]*l,t[2]=i[2]*n+i[6]*r+i[10]*o+i[14]*l,t[3]=i[3]*n+i[7]*r+i[11]*o+i[15]*l,t}var v5=p5;(function(){var t=cs();return function(e,i,n,r,o,l){var h,f;for(i||(i=4),n||(n=0),r?f=Math.min(r*i+n,e.length):f=e.length,h=n;h<f;h+=i)t[0]=e[h],t[1]=e[h+1],t[2]=e[h+2],t[3]=e[h+3],o(t,t,l),e[h]=t[0],e[h+1]=t[1],e[h+2]=t[2],e[h+3]=t[3];return e}})();function x5(){var t=new Qt(2);return Qt!=Float32Array&&(t[0]=0,t[1]=0),t}function b2(t,e){var i=new Qt(2);return i[0]=t,i[1]=e,i}function y5(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t}function C2(t){var e=t[0],i=t[1];return Math.hypot(e,i)}function w5(t,e){var i=e[0],n=e[1],r=i*i+n*n;return r>0&&(r=1/Math.sqrt(r)),t[0]=e[0]*r,t[1]=e[1]*r,t}(function(){var t=x5();return function(e,i,n,r,o,l){var h,f;for(i||(i=2),n||(n=0),r?f=Math.min(r*i+n,e.length):f=e.length,h=n;h<f;h+=i)t[0]=e[h],t[1]=e[h+1],o(t,t,l),e[h]=t[0],e[h+1]=t[1];return e}})();var Rn=256,Pl=[],Ul;for(;Rn--;)Pl[Rn]=(Rn+256).toString(16).substring(1);function _h(){var t=0,e,i="";if(!Ul||Rn+16>256){for(Ul=Array(t=256);t--;)Ul[t]=256*Math.random()|0;t=Rn=0}for(;t<16;t++)e=Ul[Rn+t],t==6?i+=Pl[e&15|64]:t==8?i+=Pl[e&63|128]:i+=Pl[e],t&1&&t>1&&t<11&&(i+="-");return Rn++,i}var wh,S2;function b5(){return S2||(S2=1,wh=function(e,i){var n=e.length;if(e===i)return!0;if(n!==i.length)return!1;for(var r=0;r<n;r++)if(e[r]!==i[r])return!1;return!0}),wh}var C5=b5();const S5=TA(C5),Um=-1,ec=0,Gr=1,Kl=2,sf=3,nf=4,af=5,rf=6,Im=7,Fm=8,E2=typeof self=="object"?self:globalThis,E5=(t,e)=>{const i=(r,o)=>(t.set(o,r),r),n=r=>{if(t.has(r))return t.get(r);const[o,l]=e[r];switch(o){case ec:case Um:return i(l,r);case Gr:{const h=i([],r);for(const f of l)h.push(n(f));return h}case Kl:{const h=i({},r);for(const[f,u]of l)h[n(f)]=n(u);return h}case sf:return i(new Date(l),r);case nf:{const{source:h,flags:f}=l;return i(new RegExp(h,f),r)}case af:{const h=i(new Map,r);for(const[f,u]of l)h.set(n(f),n(u));return h}case rf:{const h=i(new Set,r);for(const f of l)h.add(n(f));return h}case Im:{const{name:h,message:f}=l;return i(new E2[h](f),r)}case Fm:return i(BigInt(l),r);case"BigInt":return i(Object(BigInt(l)),r);case"ArrayBuffer":return i(new Uint8Array(l).buffer,l);case"DataView":{const{buffer:h}=new Uint8Array(l);return i(new DataView(h),l)}}return i(new E2[o](l),r)};return n},T5=t=>E5(new Map,t)(0),wa="",{toString:M5}={},{keys:D5}=Object,Fr=t=>{const e=typeof t;if(e!=="object"||!t)return[ec,e];const i=M5.call(t).slice(8,-1);switch(i){case"Array":return[Gr,wa];case"Object":return[Kl,wa];case"Date":return[sf,wa];case"RegExp":return[nf,wa];case"Map":return[af,wa];case"Set":return[rf,wa];case"DataView":return[Gr,i]}return i.includes("Array")?[Gr,i]:i.includes("Error")?[Im,i]:[Kl,i]},Il=([t,e])=>t===ec&&(e==="function"||e==="symbol"),N5=(t,e,i,n)=>{const r=(l,h)=>{const f=n.push(l)-1;return i.set(h,f),f},o=l=>{if(i.has(l))return i.get(l);let[h,f]=Fr(l);switch(h){case ec:{let m=l;switch(f){case"bigint":h=Fm,m=l.toString();break;case"function":case"symbol":if(t)throw new TypeError("unable to serialize "+f);m=null;break;case"undefined":return r([Um],l)}return r([h,m],l)}case Gr:{if(f){let p=l;return f==="DataView"?p=new Uint8Array(l.buffer):f==="ArrayBuffer"&&(p=new Uint8Array(l)),r([f,[...p]],l)}const m=[],g=r([h,m],l);for(const p of l)m.push(o(p));return g}case Kl:{if(f)switch(f){case"BigInt":return r([f,l.toString()],l);case"Boolean":case"Number":case"String":return r([f,l.valueOf()],l)}if(e&&"toJSON"in l)return o(l.toJSON());const m=[],g=r([h,m],l);for(const p of D5(l))(t||!Il(Fr(l[p])))&&m.push([o(p),o(l[p])]);return g}case sf:return r([h,l.toISOString()],l);case nf:{const{source:m,flags:g}=l;return r([h,{source:m,flags:g}],l)}case af:{const m=[],g=r([h,m],l);for(const[p,v]of l)(t||!(Il(Fr(p))||Il(Fr(v))))&&m.push([o(p),o(v)]);return g}case rf:{const m=[],g=r([h,m],l);for(const p of l)(t||!Il(Fr(p)))&&m.push(o(p));return g}}const{message:u}=l;return r([h,{name:f,message:u}],l)};return o},R5=(t,{json:e,lossy:i}={})=>{const n=[];return N5(!(e||i),!!e,new Map,n)(t),n};var Kt=Uint8Array,Ra=Uint16Array,U5=Int32Array,Vm=new Kt([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Bm=new Kt([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),I5=new Kt([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Lm=function(t,e){for(var i=new Ra(31),n=0;n<31;++n)i[n]=e+=1<<t[n-1];for(var r=new U5(i[30]),n=1;n<30;++n)for(var o=i[n];o<i[n+1];++o)r[o]=o-i[n]<<5|n;return{b:i,r}},Om=Lm(Vm,2),km=Om.b,F5=Om.r;km[28]=258,F5[258]=28;var V5=Lm(Bm,0),B5=V5.b,jh=new Ra(32768);for(var ht=0;ht<32768;++ht){var $s=(ht&43690)>>1|(ht&21845)<<1;$s=($s&52428)>>2|($s&13107)<<2,$s=($s&61680)>>4|($s&3855)<<4,jh[ht]=(($s&65280)>>8|($s&255)<<8)>>1}var Yr=function(t,e,i){for(var n=t.length,r=0,o=new Ra(e);r<n;++r)t[r]&&++o[t[r]-1];var l=new Ra(e);for(r=1;r<e;++r)l[r]=l[r-1]+o[r-1]<<1;var h;if(i){h=new Ra(1<<e);var f=15-e;for(r=0;r<n;++r)if(t[r])for(var u=r<<4|t[r],m=e-t[r],g=l[t[r]-1]++<<m,p=g|(1<<m)-1;g<=p;++g)h[jh[g]>>f]=u}else for(h=new Ra(n),r=0;r<n;++r)t[r]&&(h[r]=jh[l[t[r]-1]++]>>15-t[r]);return h},uo=new Kt(288);for(var ht=0;ht<144;++ht)uo[ht]=8;for(var ht=144;ht<256;++ht)uo[ht]=9;for(var ht=256;ht<280;++ht)uo[ht]=7;for(var ht=280;ht<288;++ht)uo[ht]=8;var Pm=new Kt(32);for(var ht=0;ht<32;++ht)Pm[ht]=5;var L5=Yr(uo,9,1),O5=Yr(Pm,5,1),bh=function(t){for(var e=t[0],i=1;i<t.length;++i)t[i]>e&&(e=t[i]);return e},Wi=function(t,e,i){var n=e/8|0;return(t[n]|t[n+1]<<8)>>(e&7)&i},Ch=function(t,e){var i=e/8|0;return(t[i]|t[i+1]<<8|t[i+2]<<16)>>(e&7)},zm=function(t){return(t+7)/8|0},zl=function(t,e,i){return(e==null||e<0)&&(e=0),(i==null||i>t.length)&&(i=t.length),new Kt(t.subarray(e,i))},k5=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],ci=function(t,e,i){var n=new Error(e||k5[t]);if(n.code=t,Error.captureStackTrace&&Error.captureStackTrace(n,ci),!i)throw n;return n},tc=function(t,e,i,n){var r=t.length,o=0;if(!r||e.f&&!e.l)return i||new Kt(0);var l=!i,h=l||e.i!=2,f=e.i;l&&(i=new Kt(r*3));var u=function(Je){var Ve=i.length;if(Je>Ve){var Xt=new Kt(Math.max(Ve*2,Je));Xt.set(i),i=Xt}},m=e.f||0,g=e.p||0,p=e.b||0,v=e.l,x=e.d,w=e.m,b=e.n,S=r*8;do{if(!v){m=Wi(t,g,1);var C=Wi(t,g+1,3);if(g+=3,C)if(C==1)v=L5,x=O5,w=9,b=5;else if(C==2){var R=Wi(t,g,31)+257,N=Wi(t,g+10,15)+4,M=R+Wi(t,g+5,31)+1;g+=14;for(var V=new Kt(M),I=new Kt(19),B=0;B<N;++B)I[I5[B]]=Wi(t,g+B*3,7);g+=N*3;for(var U=bh(I),z=(1<<U)-1,P=Yr(I,U,1),B=0;B<M;){var K=P[Wi(t,g,z)];g+=K&15;var E=K>>4;if(E<16)V[B++]=E;else{var _=0,H=0;for(E==16?(H=3+Wi(t,g,3),g+=2,_=V[B-1]):E==17?(H=3+Wi(t,g,7),g+=3):E==18&&(H=11+Wi(t,g,127),g+=7);H--;)V[B++]=_}}var q=V.subarray(0,R),se=V.subarray(R);w=bh(q),b=bh(se),v=Yr(q,w,1),x=Yr(se,b,1)}else ci(1);else{var E=zm(g)+4,T=t[E-4]|t[E-3]<<8,D=E+T;if(D>r){f&&ci(0);break}h&&u(p+T),i.set(t.subarray(E,D),p),e.b=p+=T,e.p=g=D*8,e.f=m;continue}if(g>S){f&&ci(0);break}}h&&u(p+131072);for(var G=(1<<w)-1,W=(1<<b)-1,le=g;;le=g){var _=v[Ch(t,g)&G],ce=_>>4;if(g+=_&15,g>S){f&&ci(0);break}if(_||ci(2),ce<256)i[p++]=ce;else if(ce==256){le=g,v=null;break}else{var fe=ce-254;if(ce>264){var B=ce-257,ye=Vm[B];fe=Wi(t,g,(1<<ye)-1)+km[B],g+=ye}var me=x[Ch(t,g)&W],He=me>>4;me||ci(3),g+=me&15;var se=B5[He];if(He>3){var ye=Bm[He];se+=Ch(t,g)&(1<<ye)-1,g+=ye}if(g>S){f&&ci(0);break}h&&u(p+131072);var ve=p+fe;if(p<se){var ze=o-se,Ie=Math.min(se,ve);for(ze+p<0&&ci(3);p<Ie;++p)i[p]=n[ze+p]}for(;p<ve;++p)i[p]=i[p-se]}}e.l=v,e.p=le,e.b=p,e.f=m,v&&(m=1,e.m=w,e.d=x,e.n=b)}while(!m);return p!=i.length&&l?zl(i,0,p):i.subarray(0,p)},P5=new Kt(0),_m=function(t){(t[0]!=31||t[1]!=139||t[2]!=8)&&ci(6,"invalid gzip data");var e=t[3],i=10;e&4&&(i+=(t[10]|t[11]<<8)+2);for(var n=(e>>3&1)+(e>>4&1);n>0;n-=!t[i++]);return i+(e&2)},z5=function(t){var e=t.length;return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0},_5=function(t,e){return((t[0]&15)!=8||t[0]>>4>7||(t[0]<<8|t[1])%31)&&ci(6,"invalid zlib data"),(t[1]>>5&1)==1&&ci(6,"invalid zlib data: "+(t[1]&32?"need":"unexpected")+" dictionary"),(t[1]>>3&4)+2},Sh=function(){function t(e,i){typeof e=="function"&&(i=e,e={}),this.ondata=i;var n=e&&e.dictionary&&e.dictionary.subarray(-32768);this.s={i:0,b:n?n.length:0},this.o=new Kt(32768),this.p=new Kt(0),n&&this.o.set(n)}return t.prototype.e=function(e){if(this.ondata||ci(5),this.d&&ci(4),!this.p.length)this.p=e;else if(e.length){var i=new Kt(this.p.length+e.length);i.set(this.p),i.set(e,this.p.length),this.p=i}},t.prototype.c=function(e){this.s.i=+(this.d=e||!1);var i=this.s.b,n=tc(this.p,this.s,this.o);this.ondata(zl(n,i,this.s.b),this.d),this.o=zl(n,this.s.b-32768),this.s.b=this.o.length,this.p=zl(this.p,this.s.p/8|0),this.s.p&=7},t.prototype.push=function(e,i){this.e(e),this.c(i)},t}();function j5(t,e){return tc(t,{i:2},e,e)}var G5=function(){function t(e,i){this.v=1,this.r=0,Sh.call(this,e,i)}return t.prototype.push=function(e,i){if(Sh.prototype.e.call(this,e),this.r+=e.length,this.v){var n=this.p.subarray(this.v-1),r=n.length>3?_m(n):4;if(r>n.length){if(!i)return}else this.v>1&&this.onmember&&this.onmember(this.r-n.length);this.p=n.subarray(r),this.v=0}Sh.prototype.c.call(this,i),this.s.f&&!this.s.l&&!i&&(this.v=zm(this.s.p)+9,this.s={i:0},this.o=new Kt(0),this.push(new Kt(0),i))},t}();function Y5(t,e){var i=_m(t);return i+8>t.length&&ci(6,"invalid gzip data"),tc(t.subarray(i,-8),{i:2},new Kt(z5(t)),e)}function H5(t,e){return tc(t.subarray(_5(t),-4),{i:2},e,e)}function q5(t,e){return t[0]==31&&t[1]==139&&t[2]==8?Y5(t,e):(t[0]&15)!=8||t[0]>>4>7||(t[0]<<8|t[1])%31?j5(t,e):H5(t,e)}var K5=typeof TextDecoder<"u"&&new TextDecoder,Q5=0;try{K5.decode(P5,{stream:!0}),Q5=1}catch{}class jm{constructor(e,i,n,r){X(this,"esize");X(this,"ecode");X(this,"edata");X(this,"littleEndian");if(e%16!=0)throw new Error("This does not appear to be a NIFTI extension");this.esize=e,this.ecode=i,this.edata=n,this.littleEndian=r}toArrayBuffer(){let e=new Uint8Array(this.esize),i=new Uint8Array(this.edata);e.set(i,8);let n=new DataView(e.buffer);return n.setInt32(0,this.esize,this.littleEndian),n.setInt32(4,this.ecode,this.littleEndian),e.buffer}}const li=class li{static getStringAt(e,i,n){var r="",o,l;for(o=i;o<n;o+=1)l=e.getUint8(o),l!==0&&(r+=String.fromCharCode(l));return r}static getIntAt(e,i,n){return e.getInt32(i,n)}static getFloatAt(e,i,n){return e.getFloat32(i,n)}static getDoubleAt(e,i,n){return e.getFloat64(i,n)}static getInt64At(e,i,n){const r=e.getUint32(i,n),o=e.getInt32(i+4,n);let l;return n?l=o*2**32+r:l=r*2**32+o,o<0&&(l+=-1*2**32*2**32),l}static getUint64At(e,i,n){const r=e.getUint32(i+(n?0:4),n),o=e.getUint32(i+(n?4:0),n);return n?o*2**32+r:r*2**32+o}static getExtensionsAt(e,i,n,r){let o=[],l=i;for(;l<r;){let h=n,f=li.getIntAt(e,l,n);if(!f)break;if(f+l>r&&(h=!h,f=li.getIntAt(e,l,h),f+l>r))throw new Error("This does not appear to be a valid NIFTI extension");if(f%16!=0)throw new Error("This does not appear to be a NIFTI extension");let u=li.getIntAt(e,l+4,h),m=e.buffer.slice(l+8,l+f),g=new jm(f,u,m,h);o.push(g),l+=f}return o}static toArrayBuffer(e){var i,n,r;for(i=new ArrayBuffer(e.length),n=new Uint8Array(i),r=0;r<e.length;r+=1)n[r]=e[r];return i}static isString(e){return typeof e=="string"||e instanceof String}static formatNumber(e,i=void 0){let n;return li.isString(e)?n=Number(e):n=e,i?n=n.toPrecision(5):n=n.toPrecision(7),parseFloat(n)}static makeCRCTable(){let e,i=[];for(var n=0;n<256;n++){e=n;for(var r=0;r<8;r++)e=e&1?3988292384^e>>>1:e>>>1;i[n]=e}return i}static crc32(e){li.crcTable||(li.crcTable=li.makeCRCTable());const i=li.crcTable;let n=-1;for(var r=0;r<e.byteLength;r++)n=n>>>8^i[(n^e.getUint8(r))&255];return(n^-1)>>>0}};X(li,"crcTable",null),X(li,"GUNZIP_MAGIC_COOKIE1",31),X(li,"GUNZIP_MAGIC_COOKIE2",139),X(li,"getByteAt",function(e,i){return e.getUint8(i)}),X(li,"getShortAt",function(e,i,n){return e.getInt16(i,n)});let ue=li;const de=class de{constructor(){X(this,"littleEndian",!1);X(this,"dim_info",0);X(this,"dims",[]);X(this,"intent_p1",0);X(this,"intent_p2",0);X(this,"intent_p3",0);X(this,"intent_code",0);X(this,"datatypeCode",0);X(this,"numBitsPerVoxel",0);X(this,"slice_start",0);X(this,"slice_end",0);X(this,"slice_code",0);X(this,"pixDims",[]);X(this,"vox_offset",0);X(this,"scl_slope",1);X(this,"scl_inter",0);X(this,"xyzt_units",0);X(this,"cal_max",0);X(this,"cal_min",0);X(this,"slice_duration",0);X(this,"toffset",0);X(this,"description","");X(this,"aux_file","");X(this,"intent_name","");X(this,"qform_code",0);X(this,"sform_code",0);X(this,"quatern_a",0);X(this,"quatern_b",0);X(this,"quatern_c",0);X(this,"quatern_d",0);X(this,"qoffset_x",0);X(this,"qoffset_y",0);X(this,"qoffset_z",0);X(this,"affine",[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]]);X(this,"qfac",1);X(this,"quatern_R");X(this,"magic","0");X(this,"isHDR",!1);X(this,"extensionFlag",[0,0,0,0]);X(this,"extensionSize",0);X(this,"extensionCode",0);X(this,"extensions",[]);X(this,"getDatatypeCodeString",function(e){return e===de.TYPE_UINT8?"1-Byte Unsigned Integer":e===de.TYPE_INT16?"2-Byte Signed Integer":e===de.TYPE_INT32?"4-Byte Signed Integer":e===de.TYPE_FLOAT32?"4-Byte Float":e===de.TYPE_FLOAT64?"8-Byte Float":e===de.TYPE_RGB24?"RGB":e===de.TYPE_INT8?"1-Byte Signed Integer":e===de.TYPE_UINT16?"2-Byte Unsigned Integer":e===de.TYPE_UINT32?"4-Byte Unsigned Integer":e===de.TYPE_INT64?"8-Byte Signed Integer":e===de.TYPE_UINT64?"8-Byte Unsigned Integer":"Unknown"});X(this,"getTransformCodeString",function(e){return e===de.XFORM_SCANNER_ANAT?"Scanner":e===de.XFORM_ALIGNED_ANAT?"Aligned":e===de.XFORM_TALAIRACH?"Talairach":e===de.XFORM_MNI_152?"MNI":"Unknown"});X(this,"getUnitsCodeString",function(e){return e===de.UNITS_METER?"Meters":e===de.UNITS_MM?"Millimeters":e===de.UNITS_MICRON?"Microns":e===de.UNITS_SEC?"Seconds":e===de.UNITS_MSEC?"Milliseconds":e===de.UNITS_USEC?"Microseconds":e===de.UNITS_HZ?"Hz":e===de.UNITS_PPM?"PPM":e===de.UNITS_RADS?"Rads":"Unknown"});X(this,"nifti_mat33_mul",function(e,i){var n=[[0,0,0],[0,0,0],[0,0,0]],r,o;for(r=0;r<3;r+=1)for(o=0;o<3;o+=1)n[r][o]=e[r][0]*i[0][o]+e[r][1]*i[1][o]+e[r][2]*i[2][o];return n});X(this,"nifti_mat33_determ",function(e){var i,n,r,o,l,h,f,u,m;return i=e[0][0],n=e[0][1],r=e[0][2],o=e[1][0],l=e[1][1],h=e[1][2],f=e[2][0],u=e[2][1],m=e[2][2],i*l*m-i*u*h-o*n*m+o*u*r+f*n*h-f*l*r})}readHeader(e){var i=new DataView(e),n=ue.getIntAt(i,0,this.littleEndian),r,o,l,h;if(n!==de.MAGIC_COOKIE&&(this.littleEndian=!0,n=ue.getIntAt(i,0,this.littleEndian)),n!==de.MAGIC_COOKIE)throw new Error("This does not appear to be a NIFTI file!");for(this.dim_info=ue.getByteAt(i,39),r=0;r<8;r+=1)h=40+r*2,this.dims[r]=ue.getShortAt(i,h,this.littleEndian);for(this.intent_p1=ue.getFloatAt(i,56,this.littleEndian),this.intent_p2=ue.getFloatAt(i,60,this.littleEndian),this.intent_p3=ue.getFloatAt(i,64,this.littleEndian),this.intent_code=ue.getShortAt(i,68,this.littleEndian),this.datatypeCode=ue.getShortAt(i,70,this.littleEndian),this.numBitsPerVoxel=ue.getShortAt(i,72,this.littleEndian),this.slice_start=ue.getShortAt(i,74,this.littleEndian),r=0;r<8;r+=1)h=76+r*4,this.pixDims[r]=ue.getFloatAt(i,h,this.littleEndian);if(this.vox_offset=ue.getFloatAt(i,108,this.littleEndian),this.scl_slope=ue.getFloatAt(i,112,this.littleEndian),this.scl_inter=ue.getFloatAt(i,116,this.littleEndian),this.slice_end=ue.getShortAt(i,120,this.littleEndian),this.slice_code=ue.getByteAt(i,122),this.xyzt_units=ue.getByteAt(i,123),this.cal_max=ue.getFloatAt(i,124,this.littleEndian),this.cal_min=ue.getFloatAt(i,128,this.littleEndian),this.slice_duration=ue.getFloatAt(i,132,this.littleEndian),this.toffset=ue.getFloatAt(i,136,this.littleEndian),this.description=ue.getStringAt(i,148,228),this.aux_file=ue.getStringAt(i,228,252),this.qform_code=ue.getShortAt(i,252,this.littleEndian),this.sform_code=ue.getShortAt(i,254,this.littleEndian),this.quatern_b=ue.getFloatAt(i,256,this.littleEndian),this.quatern_c=ue.getFloatAt(i,260,this.littleEndian),this.quatern_d=ue.getFloatAt(i,264,this.littleEndian),this.quatern_a=Math.sqrt(1-(Math.pow(this.quatern_b,2)+Math.pow(this.quatern_c,2)+Math.pow(this.quatern_d,2))),this.qoffset_x=ue.getFloatAt(i,268,this.littleEndian),this.qoffset_y=ue.getFloatAt(i,272,this.littleEndian),this.qoffset_z=ue.getFloatAt(i,276,this.littleEndian),this.qform_code<1&&this.sform_code<1&&(this.affine[0][0]=this.pixDims[1],this.affine[1][1]=this.pixDims[2],this.affine[2][2]=this.pixDims[3]),this.qform_code>0&&this.sform_code<this.qform_code){const f=this.quatern_a,u=this.quatern_b,m=this.quatern_c,g=this.quatern_d;for(this.qfac=this.pixDims[0]===0?1:this.pixDims[0],this.quatern_R=[[f*f+u*u-m*m-g*g,2*u*m-2*f*g,2*u*g+2*f*m],[2*u*m+2*f*g,f*f+m*m-u*u-g*g,2*m*g-2*f*u],[2*u*g-2*f*m,2*m*g+2*f*u,f*f+g*g-m*m-u*u]],o=0;o<3;o+=1)for(l=0;l<3;l+=1)this.affine[o][l]=this.quatern_R[o][l]*this.pixDims[l+1],l===2&&(this.affine[o][l]*=this.qfac);this.affine[0][3]=this.qoffset_x,this.affine[1][3]=this.qoffset_y,this.affine[2][3]=this.qoffset_z}else if(this.sform_code>0)for(o=0;o<3;o+=1)for(l=0;l<4;l+=1)h=280+(o*4+l)*4,this.affine[o][l]=ue.getFloatAt(i,h,this.littleEndian);if(this.affine[3][0]=0,this.affine[3][1]=0,this.affine[3][2]=0,this.affine[3][3]=1,this.intent_name=ue.getStringAt(i,328,344),this.magic=ue.getStringAt(i,344,348),this.isHDR=this.magic===String.fromCharCode.apply(null,de.MAGIC_NUMBER2),i.byteLength>de.MAGIC_COOKIE){this.extensionFlag[0]=ue.getByteAt(i,348),this.extensionFlag[1]=ue.getByteAt(i,349),this.extensionFlag[2]=ue.getByteAt(i,350),this.extensionFlag[3]=ue.getByteAt(i,351);let f=!0;!this.isHDR&&this.vox_offset<=352&&(f=!1),i.byteLength<=368&&(f=!1),f&&this.extensionFlag[0]&&(this.extensions=ue.getExtensionsAt(i,this.getExtensionLocation(),this.littleEndian,this.vox_offset),this.extensionSize=this.extensions[0].esize,this.extensionCode=this.extensions[0].ecode)}}toFormattedString(){var e=ue.formatNumber,i="";return i+="Dim Info = "+this.dim_info+`
`,i+="Image Dimensions (1-8): "+this.dims[0]+", "+this.dims[1]+", "+this.dims[2]+", "+this.dims[3]+", "+this.dims[4]+", "+this.dims[5]+", "+this.dims[6]+", "+this.dims[7]+`
`,i+="Intent Parameters (1-3): "+this.intent_p1+", "+this.intent_p2+", "+this.intent_p3+`
`,i+="Intent Code = "+this.intent_code+`
`,i+="Datatype = "+this.datatypeCode+" ("+this.getDatatypeCodeString(this.datatypeCode)+`)
`,i+="Bits Per Voxel = "+this.numBitsPerVoxel+`
`,i+="Slice Start = "+this.slice_start+`
`,i+="Voxel Dimensions (1-8): "+e(this.pixDims[0])+", "+e(this.pixDims[1])+", "+e(this.pixDims[2])+", "+e(this.pixDims[3])+", "+e(this.pixDims[4])+", "+e(this.pixDims[5])+", "+e(this.pixDims[6])+", "+e(this.pixDims[7])+`
`,i+="Image Offset = "+this.vox_offset+`
`,i+="Data Scale:  Slope = "+e(this.scl_slope)+"  Intercept = "+e(this.scl_inter)+`
`,i+="Slice End = "+this.slice_end+`
`,i+="Slice Code = "+this.slice_code+`
`,i+="Units Code = "+this.xyzt_units+" ("+this.getUnitsCodeString(de.SPATIAL_UNITS_MASK&this.xyzt_units)+", "+this.getUnitsCodeString(de.TEMPORAL_UNITS_MASK&this.xyzt_units)+`)
`,i+="Display Range:  Max = "+e(this.cal_max)+"  Min = "+e(this.cal_min)+`
`,i+="Slice Duration = "+this.slice_duration+`
`,i+="Time Axis Shift = "+this.toffset+`
`,i+='Description: "'+this.description+`"
`,i+='Auxiliary File: "'+this.aux_file+`"
`,i+="Q-Form Code = "+this.qform_code+" ("+this.getTransformCodeString(this.qform_code)+`)
`,i+="S-Form Code = "+this.sform_code+" ("+this.getTransformCodeString(this.sform_code)+`)
`,i+="Quaternion Parameters:  b = "+e(this.quatern_b)+"  c = "+e(this.quatern_c)+"  d = "+e(this.quatern_d)+`
`,i+="Quaternion Offsets:  x = "+this.qoffset_x+"  y = "+this.qoffset_y+"  z = "+this.qoffset_z+`
`,i+="S-Form Parameters X: "+e(this.affine[0][0])+", "+e(this.affine[0][1])+", "+e(this.affine[0][2])+", "+e(this.affine[0][3])+`
`,i+="S-Form Parameters Y: "+e(this.affine[1][0])+", "+e(this.affine[1][1])+", "+e(this.affine[1][2])+", "+e(this.affine[1][3])+`
`,i+="S-Form Parameters Z: "+e(this.affine[2][0])+", "+e(this.affine[2][1])+", "+e(this.affine[2][2])+", "+e(this.affine[2][3])+`
`,i+='Intent Name: "'+this.intent_name+`"
`,this.extensionFlag[0]&&(i+="Extension: Size = "+this.extensionSize+"  Code = "+this.extensionCode+`
`),i}getQformMat(){return this.convertNiftiQFormToNiftiSForm(this.quatern_b,this.quatern_c,this.quatern_d,this.qoffset_x,this.qoffset_y,this.qoffset_z,this.pixDims[1],this.pixDims[2],this.pixDims[3],this.pixDims[0])}convertNiftiQFormToNiftiSForm(e,i,n,r,o,l,h,f,u,m){var g=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],p,v=e,x=i,w=n,b,S,C;return g[3][0]=g[3][1]=g[3][2]=0,g[3][3]=1,p=1-(v*v+x*x+w*w),p<1e-7?(p=1/Math.sqrt(v*v+x*x+w*w),v*=p,x*=p,w*=p,p=0):p=Math.sqrt(p),b=h>0?h:1,S=f>0?f:1,C=u>0?u:1,m<0&&(C=-C),g[0][0]=(p*p+v*v-x*x-w*w)*b,g[0][1]=2*(v*x-p*w)*S,g[0][2]=2*(v*w+p*x)*C,g[1][0]=2*(v*x+p*w)*b,g[1][1]=(p*p+x*x-v*v-w*w)*S,g[1][2]=2*(x*w-p*v)*C,g[2][0]=2*(v*w-p*x)*b,g[2][1]=2*(x*w+p*v)*S,g[2][2]=(p*p+w*w-x*x-v*v)*C,g[0][3]=r,g[1][3]=o,g[2][3]=l,g}convertNiftiSFormToNEMA(e){var i,n,r,o,l,h,f,u,m,g,p,v,x,w,b,S,C,E,T,D,R,N,M,V,I,B,U,z,P,K,_,H,q,se;if(b=0,U=[[0,0,0],[0,0,0],[0,0,0]],z=[[0,0,0],[0,0,0],[0,0,0]],i=e[0][0],n=e[0][1],r=e[0][2],o=e[1][0],l=e[1][1],h=e[1][2],f=e[2][0],u=e[2][1],m=e[2][2],g=Math.sqrt(i*i+o*o+f*f),g===0||(i/=g,o/=g,f/=g,g=Math.sqrt(n*n+l*l+u*u),g===0))return null;if(n/=g,l/=g,u/=g,g=i*n+o*l+f*u,Math.abs(g)>1e-4){if(n-=g*i,l-=g*o,u-=g*f,g=Math.sqrt(n*n+l*l+u*u),g===0)return null;n/=g,l/=g,u/=g}if(g=Math.sqrt(r*r+h*h+m*m),g===0?(r=o*u-f*l,h=f*n-u*i,m=i*l-o*n):(r/=g,h/=g,m/=g),g=i*r+o*h+f*m,Math.abs(g)>1e-4){if(r-=g*i,h-=g*o,m-=g*f,g=Math.sqrt(r*r+h*h+m*m),g===0)return null;r/=g,h/=g,m/=g}if(g=n*r+l*h+u*m,Math.abs(g)>1e-4){if(r-=g*n,h-=g*l,m-=g*u,g=Math.sqrt(r*r+h*h+m*m),g===0)return null;r/=g,h/=g,m/=g}if(U[0][0]=i,U[0][1]=n,U[0][2]=r,U[1][0]=o,U[1][1]=l,U[1][2]=h,U[2][0]=f,U[2][1]=u,U[2][2]=m,p=this.nifti_mat33_determ(U),p===0)return null;for(B=-666,T=N=M=V=1,D=2,R=3,x=1;x<=3;x+=1)for(w=1;w<=3;w+=1)if(x!==w){for(b=1;b<=3;b+=1)if(!(x===b||w===b))for(z[0][0]=z[0][1]=z[0][2]=z[1][0]=z[1][1]=z[1][2]=z[2][0]=z[2][1]=z[2][2]=0,S=-1;S<=1;S+=2)for(C=-1;C<=1;C+=2)for(E=-1;E<=1;E+=2)z[0][x-1]=S,z[1][w-1]=C,z[2][b-1]=E,v=this.nifti_mat33_determ(z),v*p>0&&(I=this.nifti_mat33_mul(z,U),g=I[0][0]+I[1][1]+I[2][2],g>B&&(B=g,T=x,D=w,R=b,N=S,M=C,V=E))}switch(P=K=_=H=q=se="",T*N){case 1:P="X",H="+";break;case-1:P="X",H="-";break;case 2:P="Y",H="+";break;case-2:P="Y",H="-";break;case 3:P="Z",H="+";break;case-3:P="Z",H="-";break}switch(D*M){case 1:K="X",q="+";break;case-1:K="X",q="-";break;case 2:K="Y",q="+";break;case-2:K="Y",q="-";break;case 3:K="Z",q="+";break;case-3:K="Z",q="-";break}switch(R*V){case 1:_="X",se="+";break;case-1:_="X",se="-";break;case 2:_="Y",se="+";break;case-2:_="Y",se="-";break;case 3:_="Z",se="+";break;case-3:_="Z",se="-";break}return P+K+_+H+q+se}getExtensionLocation(){return de.MAGIC_COOKIE+4}getExtensionSize(e){return ue.getIntAt(e,this.getExtensionLocation(),this.littleEndian)}getExtensionCode(e){return ue.getIntAt(e,this.getExtensionLocation()+4,this.littleEndian)}addExtension(e,i=-1){i==-1?this.extensions.push(e):this.extensions.splice(i,0,e),this.vox_offset+=e.esize}removeExtension(e){let i=this.extensions[e];i&&(this.vox_offset-=i.esize),this.extensions.splice(e,1)}toArrayBuffer(e=!1){let r=352;if(e)for(let f of this.extensions)r+=f.esize;let o=new Uint8Array(r),l=new DataView(o.buffer);l.setInt32(0,348,this.littleEndian),l.setUint8(39,this.dim_info);for(let f=0;f<8;f++)l.setUint16(40+2*f,this.dims[f],this.littleEndian);l.setFloat32(56,this.intent_p1,this.littleEndian),l.setFloat32(60,this.intent_p2,this.littleEndian),l.setFloat32(64,this.intent_p3,this.littleEndian),l.setInt16(68,this.intent_code,this.littleEndian),l.setInt16(70,this.datatypeCode,this.littleEndian),l.setInt16(72,this.numBitsPerVoxel,this.littleEndian),l.setInt16(74,this.slice_start,this.littleEndian);for(let f=0;f<8;f++)l.setFloat32(76+4*f,this.pixDims[f],this.littleEndian);l.setFloat32(108,this.vox_offset,this.littleEndian),l.setFloat32(112,this.scl_slope,this.littleEndian),l.setFloat32(116,this.scl_inter,this.littleEndian),l.setInt16(120,this.slice_end,this.littleEndian),l.setUint8(122,this.slice_code),l.setUint8(123,this.xyzt_units),l.setFloat32(124,this.cal_max,this.littleEndian),l.setFloat32(128,this.cal_min,this.littleEndian),l.setFloat32(132,this.slice_duration,this.littleEndian),l.setFloat32(136,this.toffset,this.littleEndian),o.set(new TextEncoder().encode(this.description),148),o.set(new TextEncoder().encode(this.aux_file),228),l.setInt16(252,this.qform_code,this.littleEndian),l.setInt16(254,this.sform_code,this.littleEndian),l.setFloat32(256,this.quatern_b,this.littleEndian),l.setFloat32(260,this.quatern_c,this.littleEndian),l.setFloat32(264,this.quatern_d,this.littleEndian),l.setFloat32(268,this.qoffset_x,this.littleEndian),l.setFloat32(272,this.qoffset_y,this.littleEndian),l.setFloat32(276,this.qoffset_z,this.littleEndian);const h=this.affine.flat();for(let f=0;f<12;f++)l.setFloat32(280+4*f,h[f],this.littleEndian);if(o.set(new TextEncoder().encode(this.intent_name),328),o.set(new TextEncoder().encode(this.magic),344),e){o.set(Uint8Array.from([1,0,0,0]),348);let f=this.getExtensionLocation();for(const u of this.extensions)l.setInt32(f,u.esize,u.littleEndian),l.setInt32(f+4,u.ecode,u.littleEndian),o.set(new Uint8Array(u.edata),f+8),f+=u.esize}else o.set(new Uint8Array(4).fill(0),348);return o.buffer}};X(de,"TYPE_NONE",0),X(de,"TYPE_BINARY",1),X(de,"TYPE_UINT8",2),X(de,"TYPE_INT16",4),X(de,"TYPE_INT32",8),X(de,"TYPE_FLOAT32",16),X(de,"TYPE_COMPLEX64",32),X(de,"TYPE_FLOAT64",64),X(de,"TYPE_RGB24",128),X(de,"TYPE_INT8",256),X(de,"TYPE_UINT16",512),X(de,"TYPE_UINT32",768),X(de,"TYPE_INT64",1024),X(de,"TYPE_UINT64",1280),X(de,"TYPE_FLOAT128",1536),X(de,"TYPE_COMPLEX128",1792),X(de,"TYPE_COMPLEX256",2048),X(de,"XFORM_UNKNOWN",0),X(de,"XFORM_SCANNER_ANAT",1),X(de,"XFORM_ALIGNED_ANAT",2),X(de,"XFORM_TALAIRACH",3),X(de,"XFORM_MNI_152",4),X(de,"SPATIAL_UNITS_MASK",7),X(de,"TEMPORAL_UNITS_MASK",56),X(de,"UNITS_UNKNOWN",0),X(de,"UNITS_METER",1),X(de,"UNITS_MM",2),X(de,"UNITS_MICRON",3),X(de,"UNITS_SEC",8),X(de,"UNITS_MSEC",16),X(de,"UNITS_USEC",24),X(de,"UNITS_HZ",32),X(de,"UNITS_PPM",40),X(de,"UNITS_RADS",48),X(de,"MAGIC_COOKIE",348),X(de,"STANDARD_HEADER_SIZE",348),X(de,"MAGIC_NUMBER_LOCATION",344),X(de,"MAGIC_NUMBER",[110,43,49]),X(de,"MAGIC_NUMBER2",[110,105,49]),X(de,"EXTENSION_HEADER_SIZE",8);let Be=de;const os=class os{constructor(){X(this,"littleEndian",!1);X(this,"dim_info",0);X(this,"dims",[]);X(this,"intent_p1",0);X(this,"intent_p2",0);X(this,"intent_p3",0);X(this,"intent_code",0);X(this,"datatypeCode",0);X(this,"numBitsPerVoxel",0);X(this,"slice_start",0);X(this,"slice_end",0);X(this,"slice_code",0);X(this,"pixDims",[]);X(this,"vox_offset",0);X(this,"scl_slope",1);X(this,"scl_inter",0);X(this,"xyzt_units",0);X(this,"cal_max",0);X(this,"cal_min",0);X(this,"slice_duration",0);X(this,"toffset",0);X(this,"description","");X(this,"aux_file","");X(this,"intent_name","");X(this,"qform_code",0);X(this,"sform_code",0);X(this,"quatern_b",0);X(this,"quatern_c",0);X(this,"quatern_d",0);X(this,"qoffset_x",0);X(this,"qoffset_y",0);X(this,"qoffset_z",0);X(this,"affine",[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]]);X(this,"magic","0");X(this,"extensionFlag",[0,0,0,0]);X(this,"extensions",[]);X(this,"extensionSize",0);X(this,"extensionCode",0);X(this,"getExtensionLocation",function(){return os.MAGIC_COOKIE+4});X(this,"getExtensionSize",Be.prototype.getExtensionSize);X(this,"getExtensionCode",Be.prototype.getExtensionCode);X(this,"addExtension",Be.prototype.addExtension);X(this,"removeExtension",Be.prototype.removeExtension);X(this,"getDatatypeCodeString",Be.prototype.getDatatypeCodeString);X(this,"getTransformCodeString",Be.prototype.getTransformCodeString);X(this,"getUnitsCodeString",Be.prototype.getUnitsCodeString);X(this,"getQformMat",Be.prototype.getQformMat);X(this,"convertNiftiQFormToNiftiSForm",Be.prototype.convertNiftiQFormToNiftiSForm);X(this,"convertNiftiSFormToNEMA",Be.prototype.convertNiftiSFormToNEMA);X(this,"nifti_mat33_mul",Be.prototype.nifti_mat33_mul);X(this,"nifti_mat33_determ",Be.prototype.nifti_mat33_determ)}readHeader(e){var i=new DataView(e),n=ue.getIntAt(i,0,this.littleEndian),r,o,l,h;if(n!==os.MAGIC_COOKIE&&(this.littleEndian=!0,n=ue.getIntAt(i,0,this.littleEndian)),n!==os.MAGIC_COOKIE)throw new Error("This does not appear to be a NIFTI file!");for(this.magic=ue.getStringAt(i,4,12),this.datatypeCode=ue.getShortAt(i,12,this.littleEndian),this.numBitsPerVoxel=ue.getShortAt(i,14,this.littleEndian),r=0;r<8;r+=1)h=16+r*8,this.dims[r]=ue.getInt64At(i,h,this.littleEndian);for(this.intent_p1=ue.getDoubleAt(i,80,this.littleEndian),this.intent_p2=ue.getDoubleAt(i,88,this.littleEndian),this.intent_p3=ue.getDoubleAt(i,96,this.littleEndian),r=0;r<8;r+=1)h=104+r*8,this.pixDims[r]=ue.getDoubleAt(i,h,this.littleEndian);for(this.vox_offset=ue.getInt64At(i,168,this.littleEndian),this.scl_slope=ue.getDoubleAt(i,176,this.littleEndian),this.scl_inter=ue.getDoubleAt(i,184,this.littleEndian),this.cal_max=ue.getDoubleAt(i,192,this.littleEndian),this.cal_min=ue.getDoubleAt(i,200,this.littleEndian),this.slice_duration=ue.getDoubleAt(i,208,this.littleEndian),this.toffset=ue.getDoubleAt(i,216,this.littleEndian),this.slice_start=ue.getInt64At(i,224,this.littleEndian),this.slice_end=ue.getInt64At(i,232,this.littleEndian),this.description=ue.getStringAt(i,240,320),this.aux_file=ue.getStringAt(i,320,344),this.qform_code=ue.getIntAt(i,344,this.littleEndian),this.sform_code=ue.getIntAt(i,348,this.littleEndian),this.quatern_b=ue.getDoubleAt(i,352,this.littleEndian),this.quatern_c=ue.getDoubleAt(i,360,this.littleEndian),this.quatern_d=ue.getDoubleAt(i,368,this.littleEndian),this.qoffset_x=ue.getDoubleAt(i,376,this.littleEndian),this.qoffset_y=ue.getDoubleAt(i,384,this.littleEndian),this.qoffset_z=ue.getDoubleAt(i,392,this.littleEndian),o=0;o<3;o+=1)for(l=0;l<4;l+=1)h=400+(o*4+l)*8,this.affine[o][l]=ue.getDoubleAt(i,h,this.littleEndian);this.affine[3][0]=0,this.affine[3][1]=0,this.affine[3][2]=0,this.affine[3][3]=1,this.slice_code=ue.getIntAt(i,496,this.littleEndian),this.xyzt_units=ue.getIntAt(i,500,this.littleEndian),this.intent_code=ue.getIntAt(i,504,this.littleEndian),this.intent_name=ue.getStringAt(i,508,524),this.dim_info=ue.getByteAt(i,524),i.byteLength>os.MAGIC_COOKIE&&(this.extensionFlag[0]=ue.getByteAt(i,540),this.extensionFlag[1]=ue.getByteAt(i,541),this.extensionFlag[2]=ue.getByteAt(i,542),this.extensionFlag[3]=ue.getByteAt(i,543),this.extensionFlag[0]&&(this.extensions=ue.getExtensionsAt(i,this.getExtensionLocation(),this.littleEndian,this.vox_offset),this.extensionSize=this.extensions[0].esize,this.extensionCode=this.extensions[0].ecode))}toFormattedString(){var e=ue.formatNumber,i="";return i+="Datatype = "+ +this.datatypeCode+" ("+this.getDatatypeCodeString(this.datatypeCode)+`)
`,i+="Bits Per Voxel =  = "+this.numBitsPerVoxel+`
`,i+="Image Dimensions (1-8): "+this.dims[0]+", "+this.dims[1]+", "+this.dims[2]+", "+this.dims[3]+", "+this.dims[4]+", "+this.dims[5]+", "+this.dims[6]+", "+this.dims[7]+`
`,i+="Intent Parameters (1-3): "+this.intent_p1+", "+this.intent_p2+", "+this.intent_p3+`
`,i+="Voxel Dimensions (1-8): "+e(this.pixDims[0])+", "+e(this.pixDims[1])+", "+e(this.pixDims[2])+", "+e(this.pixDims[3])+", "+e(this.pixDims[4])+", "+e(this.pixDims[5])+", "+e(this.pixDims[6])+", "+e(this.pixDims[7])+`
`,i+="Image Offset = "+this.vox_offset+`
`,i+="Data Scale:  Slope = "+e(this.scl_slope)+"  Intercept = "+e(this.scl_inter)+`
`,i+="Display Range:  Max = "+e(this.cal_max)+"  Min = "+e(this.cal_min)+`
`,i+="Slice Duration = "+this.slice_duration+`
`,i+="Time Axis Shift = "+this.toffset+`
`,i+="Slice Start = "+this.slice_start+`
`,i+="Slice End = "+this.slice_end+`
`,i+='Description: "'+this.description+`"
`,i+='Auxiliary File: "'+this.aux_file+`"
`,i+="Q-Form Code = "+this.qform_code+" ("+this.getTransformCodeString(this.qform_code)+`)
`,i+="S-Form Code = "+this.sform_code+" ("+this.getTransformCodeString(this.sform_code)+`)
`,i+="Quaternion Parameters:  b = "+e(this.quatern_b)+"  c = "+e(this.quatern_c)+"  d = "+e(this.quatern_d)+`
`,i+="Quaternion Offsets:  x = "+this.qoffset_x+"  y = "+this.qoffset_y+"  z = "+this.qoffset_z+`
`,i+="S-Form Parameters X: "+e(this.affine[0][0])+", "+e(this.affine[0][1])+", "+e(this.affine[0][2])+", "+e(this.affine[0][3])+`
`,i+="S-Form Parameters Y: "+e(this.affine[1][0])+", "+e(this.affine[1][1])+", "+e(this.affine[1][2])+", "+e(this.affine[1][3])+`
`,i+="S-Form Parameters Z: "+e(this.affine[2][0])+", "+e(this.affine[2][1])+", "+e(this.affine[2][2])+", "+e(this.affine[2][3])+`
`,i+="Slice Code = "+this.slice_code+`
`,i+="Units Code = "+this.xyzt_units+" ("+this.getUnitsCodeString(Be.SPATIAL_UNITS_MASK&this.xyzt_units)+", "+this.getUnitsCodeString(Be.TEMPORAL_UNITS_MASK&this.xyzt_units)+`)
`,i+="Intent Code = "+this.intent_code+`
`,i+='Intent Name: "'+this.intent_name+`"
`,i+="Dim Info = "+this.dim_info+`
`,i}toArrayBuffer(e=!1){let r=544;if(e)for(let f of this.extensions)r+=f.esize;let o=new Uint8Array(r),l=new DataView(o.buffer);l.setInt32(0,540,this.littleEndian),o.set(new TextEncoder().encode(this.magic),4),l.setInt16(12,this.datatypeCode,this.littleEndian),l.setInt16(14,this.numBitsPerVoxel,this.littleEndian);for(let f=0;f<8;f++)l.setBigInt64(16+8*f,BigInt(this.dims[f]),this.littleEndian);l.setFloat64(80,this.intent_p1,this.littleEndian),l.setFloat64(88,this.intent_p2,this.littleEndian),l.setFloat64(96,this.intent_p3,this.littleEndian);for(let f=0;f<8;f++)l.setFloat64(104+8*f,this.pixDims[f],this.littleEndian);l.setBigInt64(168,BigInt(this.vox_offset),this.littleEndian),l.setFloat64(176,this.scl_slope,this.littleEndian),l.setFloat64(184,this.scl_inter,this.littleEndian),l.setFloat64(192,this.cal_max,this.littleEndian),l.setFloat64(200,this.cal_min,this.littleEndian),l.setFloat64(208,this.slice_duration,this.littleEndian),l.setFloat64(216,this.toffset,this.littleEndian),l.setBigInt64(224,BigInt(this.slice_start),this.littleEndian),l.setBigInt64(232,BigInt(this.slice_end),this.littleEndian),o.set(new TextEncoder().encode(this.description),240),o.set(new TextEncoder().encode(this.aux_file),320),l.setInt32(344,this.qform_code,this.littleEndian),l.setInt32(348,this.sform_code,this.littleEndian),l.setFloat64(352,this.quatern_b,this.littleEndian),l.setFloat64(360,this.quatern_c,this.littleEndian),l.setFloat64(368,this.quatern_d,this.littleEndian),l.setFloat64(376,this.qoffset_x,this.littleEndian),l.setFloat64(384,this.qoffset_y,this.littleEndian),l.setFloat64(392,this.qoffset_z,this.littleEndian);const h=this.affine.flat();for(let f=0;f<12;f++)l.setFloat64(400+8*f,h[f],this.littleEndian);if(l.setInt32(496,this.slice_code,this.littleEndian),l.setInt32(500,this.xyzt_units,this.littleEndian),l.setInt32(504,this.intent_code,this.littleEndian),o.set(new TextEncoder().encode(this.intent_name),508),l.setUint8(524,this.dim_info),e){o.set(Uint8Array.from([1,0,0,0]),540);let f=this.getExtensionLocation();for(const u of this.extensions)l.setInt32(f,u.esize,u.littleEndian),l.setInt32(f+4,u.ecode,u.littleEndian),o.set(new Uint8Array(u.edata),f+8),f+=u.esize}else o.set(new Uint8Array(4).fill(0),540);return o.buffer}};X(os,"MAGIC_COOKIE",540),X(os,"MAGIC_NUMBER_LOCATION",4),X(os,"MAGIC_NUMBER",[110,43,50,0,13,10,26,10]),X(os,"MAGIC_NUMBER2",[110,105,50,0,13,10,26,10]);let Ai=os;function X5(t,e=!1){var i,n,r,o;return t.byteLength<Be.STANDARD_HEADER_SIZE?!1:(i=new DataView(t),i&&(n=i.getUint8(Be.MAGIC_NUMBER_LOCATION)),r=i.getUint8(Be.MAGIC_NUMBER_LOCATION+1),o=i.getUint8(Be.MAGIC_NUMBER_LOCATION+2),e&&n===Be.MAGIC_NUMBER2[0]&&r===Be.MAGIC_NUMBER2[1]&&o===Be.MAGIC_NUMBER2[2]?!0:n===Be.MAGIC_NUMBER[0]&&r===Be.MAGIC_NUMBER[1]&&o===Be.MAGIC_NUMBER[2])}function Z5(t,e=!1){var i,n,r,o;return t.byteLength<Be.STANDARD_HEADER_SIZE?!1:(i=new DataView(t),n=i.getUint8(Ai.MAGIC_NUMBER_LOCATION),r=i.getUint8(Ai.MAGIC_NUMBER_LOCATION+1),o=i.getUint8(Ai.MAGIC_NUMBER_LOCATION+2),e&&n===Ai.MAGIC_NUMBER2[0]&&r===Ai.MAGIC_NUMBER2[1]&&o===Ai.MAGIC_NUMBER2[2]?!0:n===Ai.MAGIC_NUMBER[0]&&r===Ai.MAGIC_NUMBER[1]&&o===Ai.MAGIC_NUMBER[2])}function of(t){var e,i,n;return!!(t&&(e=new DataView(t),i=e.getUint8(0),n=e.getUint8(1),i===ue.GUNZIP_MAGIC_COOKIE1||n===ue.GUNZIP_MAGIC_COOKIE2))}function W5(t){return q5(new Uint8Array(t)).buffer}async function J5(t){const e=new Uint8Array(t),i=e[0]===31&&e[1]===139&&e[2]===8?"gzip":e[0]===120&&(e[1]===1||e[1]===94||e[1]===156||e[1]===218)?"deflate":"deflate-raw",n=new DecompressionStream(i),r=n.writable.getWriter();r.write(e).catch(console.error);const o=r.close().catch(console.error),h=await new Response(n.readable).arrayBuffer();return await o,h}async function T2(t,e=1/0){const i=v=>v[0]===31&&v[1]===139&&v[2]===8?"gzip":v[0]===120&&[1,94,156,218].includes(v[1])?"deflate":"deflate-raw",n=new Uint8Array(t),r=i(n),o=new DecompressionStream(r),l=new TransformStream({transform(v,x){x.enqueue(v)},flush(v){v.terminate()}}),{readable:h,writable:f}=o,u=f.getWriter(),m=h.pipeThrough(l).getReader();u.write(n).catch(v=>{v instanceof Error&&v.name==="AbortError"||console.error("Error during write:",v)});const g=[];let p=0;try{for(;p<e;){const{done:v,value:x}=await m.read();if(v)break;const w=e-p,b=x.subarray(0,Math.min(x.length,w));if(g.push(b),p+=b.length,p>=e){await Promise.all([m.cancel().catch(()=>{}),u.abort().catch(()=>{})]);break}}}catch(v){v instanceof Error&&v.name==="AbortError"||console.error("Error during decompression:",v)}finally{await Promise.allSettled([m.cancel().catch(()=>{}),u.close().catch(()=>{})])}return g.length===1?g[0].buffer:g.reduce((v,x)=>{const w=new Uint8Array(v.byteLength+x.byteLength);return w.set(new Uint8Array(v),0),w.set(x,v.byteLength),w.buffer},new ArrayBuffer(0))}function $5(t,e=!1){let i=null;if(of(t)&&(t=W5(t)),X5(t,e)?i=new Be:Z5(t,e)&&(i=new Ai),i)i.readHeader(t);else throw new Error("That file does not appear to be NIFTI!");return i}async function Pr(t,e=!1){if(!of(t))return $5(t,e);let i=null,n=await T2(t,540),r=!0,o=!0;var l=new DataView(n);const h=l.getInt32(0,!0),f=l.getInt32(0,!1);if(h!==348)if(f===348)r=!1;else if(h===540)o=!1;else if(f===540)o=!1,r=!1;else throw new Error("That file does not appear to be NIFTI!");let u=Math.round(l.getFloat32(108,r));return Ai&&(u=ue.getUint64At(l,168,r)),u>n.byteLength&&(n=await T2(t,u)),o?i=new Be:i=new Ai,i.readHeader(n),i}function ev(t,e){var i=t.vox_offset,n=1,r=1;t.dims[4]&&(n=t.dims[4]),t.dims[5]&&(r=t.dims[5]);var o=t.dims[1]*t.dims[2]*t.dims[3]*n*r*(t.numBitsPerVoxel/8);return e.slice(i,i+o)}class ho extends Error{constructor(e,i={}){super(`Node not found: ${e}`,i),this.name="NodeNotFoundError"}}class lf extends Error{constructor(e){super(`Missing key: ${e}`),this.name="KeyError"}}var Di;class Gm{constructor(e,i,n){Lt(this,Di);typeof e=="number"?wt(this,Di,new Uint8Array(e)):e instanceof ArrayBuffer?wt(this,Di,new Uint8Array(e,i,n)):wt(this,Di,new Uint8Array(Array.from(e,r=>r?1:0)))}get BYTES_PER_ELEMENT(){return 1}get byteOffset(){return Le(this,Di).byteOffset}get byteLength(){return Le(this,Di).byteLength}get buffer(){return Le(this,Di).buffer}get length(){return Le(this,Di).length}get(e){let i=Le(this,Di)[e];return typeof i=="number"?i!==0:i}set(e,i){Le(this,Di)[e]=i?1:0}fill(e){Le(this,Di).fill(e?1:0)}*[Symbol.iterator](){for(let e=0;e<this.length;e++)yield this.get(e)}}Di=new WeakMap;var Ia;class cf{constructor(e,i,n,r){X(this,"_data");X(this,"chars");Lt(this,Ia);if(this.chars=e,wt(this,Ia,new TextEncoder),typeof i=="number")this._data=new Uint8Array(i*e);else if(i instanceof ArrayBuffer)r&&(r=r*e),this._data=new Uint8Array(i,n,r);else{let o=Array.from(i);this._data=new Uint8Array(o.length*e);for(let l=0;l<o.length;l++)this.set(l,o[l])}}get BYTES_PER_ELEMENT(){return this.chars}get byteOffset(){return this._data.byteOffset}get byteLength(){return this._data.byteLength}get buffer(){return this._data.buffer}get length(){return this.byteLength/this.BYTES_PER_ELEMENT}get(e){const i=new Uint8Array(this.buffer,this.byteOffset+this.chars*e,this.chars);return new TextDecoder().decode(i).replace(/\x00/g,"")}set(e,i){const n=new Uint8Array(this.buffer,this.byteOffset+this.chars*e,this.chars);n.fill(0),n.set(Le(this,Ia).encode(i))}fill(e){const i=Le(this,Ia).encode(e);for(let n=0;n<this.length;n++)this._data.set(i,n*this.chars)}*[Symbol.iterator](){for(let e=0;e<this.length;e++)yield this.get(e)}}Ia=new WeakMap;var ai;const wf=class wf{constructor(e,i,n,r){Lt(this,ai);X(this,"chars");if(this.chars=e,typeof i=="number")wt(this,ai,new Int32Array(i*e));else if(i instanceof ArrayBuffer)r&&(r*=e),wt(this,ai,new Int32Array(i,n,r));else{const o=i,l=new wf(e,1);wt(this,ai,new Int32Array(function*(){for(let h of o)l.set(0,h),yield*Le(l,ai)}()))}}get BYTES_PER_ELEMENT(){return Le(this,ai).BYTES_PER_ELEMENT*this.chars}get byteLength(){return Le(this,ai).byteLength}get byteOffset(){return Le(this,ai).byteOffset}get buffer(){return Le(this,ai).buffer}get length(){return Le(this,ai).length/this.chars}get(e){const i=this.chars*e;let n="";for(let r=0;r<this.chars;r++)n+=String.fromCodePoint(Le(this,ai)[i+r]);return n.replace(/\u0000/g,"")}set(e,i){const n=this.chars*e,r=Le(this,ai).subarray(n,n+this.chars);r.fill(0);for(let o=0;o<this.chars;o++)r[o]=i.codePointAt(o)??0}fill(e){this.set(0,e);let i=Le(this,ai).subarray(0,this.chars);for(let n=1;n<this.length;n++)Le(this,ai).set(i,n*this.chars)}*[Symbol.iterator](){for(let e=0;e<this.length;e++)yield this.get(e)}};ai=new WeakMap;let Xr=wf;const tv="modulepreload",iv=function(t){return"/"+t},M2={},Eh=function(e,i,n){let r=Promise.resolve();if(i&&i.length>0){let l=function(u){return Promise.all(u.map(m=>Promise.resolve(m).then(g=>({status:"fulfilled",value:g}),g=>({status:"rejected",reason:g}))))};document.getElementsByTagName("link");const h=document.querySelector("meta[property=csp-nonce]"),f=(h==null?void 0:h.nonce)||(h==null?void 0:h.getAttribute("nonce"));r=l(i.map(u=>{if(u=iv(u),u in M2)return;M2[u]=!0;const m=u.endsWith(".css"),g=m?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${g}`))return;const p=document.createElement("link");if(p.rel=m?"stylesheet":tv,m||(p.as="script"),p.crossOrigin="",p.href=u,f&&p.setAttribute("nonce",f),document.head.appendChild(p),m)return new Promise((v,x)=>{p.addEventListener("load",v),p.addEventListener("error",()=>x(new Error(`Unable to preload CSS for ${u}`)))})}))}function o(l){const h=new Event("vite:preloadError",{cancelable:!0});if(h.payload=l,window.dispatchEvent(h),!h.defaultPrevented)throw l}return r.then(l=>{for(const h of l||[])h.status==="rejected"&&o(h.reason);return e().catch(o)})};function fo(t){const e=new TextDecoder().decode(t);return JSON.parse(e)}function D2(t,e){const i=e/2,n=e-1;let r=0;for(let o=0;o<t.length;o+=e)for(let l=0;l<i;l+=1)r=t[o+l],t[o+l]=t[o+n-l],t[o+n-l]=r}function Ym(t){if(t==="v2:object")return globalThis.Array;let e=t.match(/v2:([US])(\d+)/);if(e){let[,n,r]=e;return(n==="U"?Xr:cf).bind(null,Number(r))}let i={int8:Int8Array,int16:Int16Array,int32:Int32Array,int64:globalThis.BigInt64Array,uint8:Uint8Array,uint16:Uint16Array,uint32:Uint32Array,uint64:globalThis.BigUint64Array,float16:globalThis.Float16Array,float32:Float32Array,float64:Float64Array,bool:Gm}[t];return Pt(i,`Unknown or unsupported data_type: ${t}`),i}function Vn(t,e){const i=t.length;typeof e=="string"&&(e=e==="C"?Array.from({length:i},(o,l)=>l):Array.from({length:i},(o,l)=>i-1-l)),Pt(i===e.length,"Order length must match the number of dimensions.");let n=1,r=new Array(i);for(let o=e.length-1;o>=0;o--)r[e[o]]=n,n*=t[e[o]];return r}function sv({name:t,configuration:e}){if(t==="default"){const i=(e==null?void 0:e.separator)??"/";return n=>["c",...n].join(i)}if(t==="v2"){const i=(e==null?void 0:e.separator)??".";return n=>n.join(i)||"0"}throw new Error(`Unknown chunk key encoding: ${t}`)}function nv(t){if(t==="|O")return{data_type:"v2:object"};let e=t.match(/^([<|>])(.*)$/);Pt(e,`Invalid dtype: ${t}`);let[,i,n]=e,r={b1:"bool",i1:"int8",u1:"uint8",i2:"int16",u2:"uint16",i4:"int32",u4:"uint32",i8:"int64",u8:"uint64",f2:"float16",f4:"float32",f8:"float64"}[n]??(n.startsWith("S")||n.startsWith("U")?`v2:${n}`:void 0);return Pt(r,`Unsupported or unknown dtype: ${t}`),i==="|"?{data_type:r}:{data_type:r,endian:i==="<"?"little":"big"}}function av(t,e={}){let i=[],n=nv(t.dtype);t.order==="F"&&i.push({name:"transpose",configuration:{order:"F"}}),"endian"in n&&n.endian==="big"&&i.push({name:"bytes",configuration:{endian:"big"}});for(let{id:r,...o}of t.filters??[])i.push({name:r,configuration:o});if(t.compressor){let{id:r,...o}=t.compressor;i.push({name:r,configuration:o})}return{zarr_format:3,node_type:"array",shape:t.shape,data_type:n.data_type,chunk_grid:{name:"regular",configuration:{chunk_shape:t.chunks}},chunk_key_encoding:{name:"v2",configuration:{separator:t.dimension_separator??"."}},codecs:i,fill_value:t.fill_value,attributes:e}}function rv(t,e={}){return{zarr_format:3,node_type:"group",attributes:e}}function ov(t,e){if(e!=="number"&&e!=="bigint"&&e!=="boolean"&&e!=="object"&&e!=="string")return t===e;let i=t==="bool";if(e==="boolean")return i;let n=t.startsWith("v2:U")||t.startsWith("v2:S");if(e==="string")return n;let r=t==="int64"||t==="uint64";if(e==="bigint")return r;let o=t==="v2:object";return e==="object"?o:!n&&!r&&!i&&!o}function lv(t){return(t==null?void 0:t.name)==="sharding_indexed"}function Hm(t){return(t.data_type==="uint64"||t.data_type==="int64")&&t.fill_value!=null?BigInt(t.fill_value):t.fill_value}function qm(t,...e){if(!e.some(i=>t instanceof i))throw t}function Pt(t,e=""){if(!t)throw new Error(e)}async function Km(t,{format:e,signal:i}){const n=t instanceof Response?t:new Response(t);Pt(n.body,"Response does not contain body.");try{return await new Response(n.body.pipeThrough(new DecompressionStream(e),{signal:i})).arrayBuffer()}catch{throw i==null||i.throwIfAborted(),new Error(`Failed to decode ${e}`)}}class uf{constructor(e,i){X(this,"kind","array_to_array");Pt(e.keepbits>=0,"keepbits must be zero or positive")}static fromConfig(e,i){return new uf(e,i)}encode(e){throw new Error("`BitroundCodec.encode` is not implemented. Please open an issue at https://github.com/manzt/zarrita.js/issues.")}decode(e){return e}}const N2=cv();function cv(){const t=new Uint32Array([305419896]);return new Uint8Array(t.buffer,t.byteOffset,t.byteLength)[0]!==18}function R2(t){return"BYTES_PER_ELEMENT"in t?t.BYTES_PER_ELEMENT:4}var Jr,nn,$r,eo,Fa;const bf=class bf{constructor(e,i){X(this,"kind","array_to_bytes");Lt(this,Jr);Lt(this,nn);Lt(this,$r);Lt(this,eo);Lt(this,Fa);wt(this,Fa,e==null?void 0:e.endian),wt(this,nn,Ym(i.data_type)),wt(this,eo,i.shape),wt(this,Jr,Vn(i.shape,"C"));const n=new(Le(this,nn))(0);wt(this,$r,n.BYTES_PER_ELEMENT)}static fromConfig(e,i){return new bf(e,i)}encode(e){let i=new Uint8Array(e.data.buffer);return N2&&Le(this,Fa)==="big"&&D2(i,R2(Le(this,nn))),i}decode(e){return N2&&Le(this,Fa)==="big"&&D2(e,R2(Le(this,nn))),{data:new(Le(this,nn))(e.buffer,e.byteOffset,e.byteLength/Le(this,$r)),shape:Le(this,eo),stride:Le(this,Jr)}}};Jr=new WeakMap,nn=new WeakMap,$r=new WeakMap,eo=new WeakMap,Fa=new WeakMap;let Ql=bf;class hf{constructor(){X(this,"kind","bytes_to_bytes")}static fromConfig(){return new hf}encode(e){throw new Error("Not implemented")}decode(e){return new Uint8Array(e.buffer,e.byteOffset,e.byteLength-4)}}class ff{constructor(){X(this,"kind","bytes_to_bytes")}static fromConfig(e){return new ff}encode(e){throw new Error("Gzip encoding is not enabled by default. Please register a custom codec with `numcodecs/gzip`.")}async decode(e){const i=await Km(e,{format:"gzip"});return new Uint8Array(i)}}function uv(t,e){return Pt(!Number.isNaN(e),"JsonCodec allow_nan is false but NaN was encountered during encoding."),Pt(e!==Number.POSITIVE_INFINITY,"JsonCodec allow_nan is false but Infinity was encountered during encoding."),Pt(e!==Number.NEGATIVE_INFINITY,"JsonCodec allow_nan is false but -Infinity was encountered during encoding."),e}function hv(t,e){return e instanceof Object&&!Array.isArray(e)?Object.keys(e).sort().reduce((i,n)=>(i[n]=e[n],i),{}):e}var to,io;const Cf=class Cf{constructor(e={}){X(this,"configuration");X(this,"kind","array_to_bytes");Lt(this,to);Lt(this,io);this.configuration=e;const{encoding:i="utf-8",skipkeys:n=!1,ensure_ascii:r=!0,check_circular:o=!0,allow_nan:l=!0,sort_keys:h=!0,indent:f,strict:u=!0}=e;let m=e.separators;m||(f?m=[", ",": "]:m=[",",":"]),wt(this,to,{encoding:i,skipkeys:n,ensure_ascii:r,check_circular:o,allow_nan:l,indent:f,separators:m,sort_keys:h}),wt(this,io,{strict:u})}static fromConfig(e){return new Cf(e)}encode(e){const{indent:i,encoding:n,ensure_ascii:r,check_circular:o,allow_nan:l,sort_keys:h}=Le(this,to);Pt(n==="utf-8","JsonCodec does not yet support non-utf-8 encoding.");const f=[];Pt(o,"JsonCodec does not yet support skipping the check for circular references during encoding."),l||f.push(uv),h&&f.push(hv);const u=Array.from(e.data);u.push("|O"),u.push(e.shape);let m;f.length&&(m=(p,v)=>{let x=v;for(let w of f)x=w(p,x);return x});let g=JSON.stringify(u,m,i);return r&&(g=g.replace(/[\u007F-\uFFFF]/g,p=>{const v=`0000${p.charCodeAt(0).toString(16)}`;return`\\u${v.substring(v.length-4)}`})),new TextEncoder().encode(g)}decode(e){const{strict:i}=Le(this,io);Pt(i,"JsonCodec does not yet support non-strict decoding.");const n=fo(e),r=n.pop();n.pop(),Pt(r,"0D not implemented for JsonCodec.");const o=Vn(r,"C");return{data:n,shape:r,stride:o}}};to=new WeakMap,io=new WeakMap;let Gh=Cf;function U2(t){return t instanceof Gm||t instanceof cf||t instanceof Xr?new Proxy(t,{get(i,n){return i.get(Number(n))},set(i,n,r){return i.set(Number(n),r),!0}}):t}function fv(t,e){let i;return t.data instanceof cf||t.data instanceof Xr?i=new t.constructor(t.data.length,t.data.chars):i=new t.constructor(t.data.length),{data:i,shape:t.shape,stride:Vn(t.shape,e)}}function dv(t,e){let i=fv(t,e),n=t.shape.length,r=t.data.length,o=Array(n).fill(0),l=U2(t.data),h=U2(i.data);for(let f=0;f<r;f++){let u=0;for(let m=0;m<n;m++)u+=o[m]*i.stride[m];h[u]=l[f],o[0]+=1;for(let m=0;m<n;m++)if(o[m]===t.shape[m]){if(m+1===n)break;o[m]=0,o[m+1]+=1}}return i}function mv(t){let e=t.shape.length;return Pt(e===t.stride.length,"Shape and stride must have the same length."),t.stride.map((i,n)=>({stride:i,index:n})).sort((i,n)=>n.stride-i.stride).map(i=>i.index)}function gv(t,e){let i=mv(t);return Pt(i.length===e.length,"Orders must match"),i.every((n,r)=>n===e[r])}var so,Va;const Sf=class Sf{constructor(e,i){X(this,"kind","array_to_array");Lt(this,so);Lt(this,Va);let n=e.order??"C",r=i.shape.length,o=new Array(r),l=new Array(r);if(n==="C")for(let h=0;h<r;++h)o[h]=h,l[h]=h;else if(n==="F")for(let h=0;h<r;++h)o[h]=r-h-1,l[h]=r-h-1;else o=n,o.forEach((h,f)=>{Pt(l[h]===void 0,`Invalid permutation: ${JSON.stringify(n)}`),l[h]=f});wt(this,so,o),wt(this,Va,l)}static fromConfig(e,i){return new Sf(e,i)}encode(e){return gv(e,Le(this,Va))?e:dv(e,Le(this,Va))}decode(e){return{data:e.data,shape:e.shape,stride:Vn(e.shape,Le(this,so))}}};so=new WeakMap,Va=new WeakMap;let Yh=Sf;var no,ao;const Ef=class Ef{constructor(e){X(this,"kind","array_to_bytes");Lt(this,no);Lt(this,ao);wt(this,no,e),wt(this,ao,Vn(e,"C"))}static fromConfig(e,i){return new Ef(i.shape)}encode(e){throw new Error("Method not implemented.")}decode(e){let i=new TextDecoder,n=new DataView(e.buffer),r=Array(n.getUint32(0,!0)),o=4;for(let l=0;l<r.length;l++){let h=n.getUint32(o,!0);o+=4,r[l]=i.decode(e.buffer.slice(o,o+h)),o+=h}return{data:r,shape:Le(this,no),stride:Le(this,ao)}}};no=new WeakMap,ao=new WeakMap;let Hh=Ef;class df{constructor(){X(this,"kind","bytes_to_bytes")}static fromConfig(e){return new df}encode(e){throw new Error("Zlib encoding is not enabled by default. Please register a codec with `numcodecs/zlib`.")}async decode(e){const i=await Km(e,{format:"deflate"});return new Uint8Array(i)}}function pv(){return new Map().set("blosc",()=>Eh(()=>import("./blosc-E49GQuAK.js"),__vite__mapDeps([0,1])).then(t=>t.default)).set("lz4",()=>Eh(()=>import("./lz4-BIGKWw27.js"),__vite__mapDeps([2,1])).then(t=>t.default)).set("zstd",()=>Eh(()=>import("./zstd-IvP746pw.js"),__vite__mapDeps([3,1])).then(t=>t.default)).set("gzip",()=>ff).set("zlib",()=>df).set("transpose",()=>Yh).set("bytes",()=>Ql).set("crc32c",()=>hf).set("vlen-utf8",()=>Hh).set("json2",()=>Gh).set("bitround",()=>uf)}const Av=pv();function qh(t){let e;return{async encode(i){e||(e=await I2(t));for(const r of e.array_to_array)i=await r.encode(i);let n=await e.array_to_bytes.encode(i);for(const r of e.bytes_to_bytes)n=await r.encode(n);return n},async decode(i){e||(e=await I2(t));for(let r=e.bytes_to_bytes.length-1;r>=0;r--)i=await e.bytes_to_bytes[r].decode(i);let n=await e.array_to_bytes.decode(i);for(let r=e.array_to_array.length-1;r>=0;r--)n=await e.array_to_array[r].decode(n);return n}}}async function I2(t){let e=t.codecs.map(async o=>{var h;let l=await((h=Av.get(o.name))==null?void 0:h());return Pt(l,`Unknown codec: ${o.name}`),{Codec:l,meta:o}}),i=[],n,r=[];for await(let{Codec:o,meta:l}of e){let h=o.fromConfig(l.configuration,t);switch(h.kind){case"array_to_array":i.push(h);break;case"array_to_bytes":n=h;break;default:r.push(h)}}return n||(Pt(vv(t),`Cannot encode ${t.data_type} to bytes without a codec`),n=Ql.fromConfig({endian:"little"},t)),{array_to_array:i,array_to_bytes:n,bytes_to_bytes:r}}function vv(t){return t.data_type!=="v2:object"}const F2=18446744073709551615n;function xv(t,e,i,n){Pt(t.store.getRange,"Store does not support range requests");let r=t.store.getRange.bind(t.store),o=e.map((f,u)=>f/n.chunk_shape[u]),l=qh({data_type:"uint64",shape:[...o,2],codecs:n.index_codecs}),h={};return async f=>{let u=f.map((C,E)=>Math.floor(C/o[E])),m=t.resolve(i(u)).path,g;if(m in h)g=h[m];else{let C=4,E=16*o.reduce((D,R)=>D*R,1),T=await r(m,{suffixLength:E+C});g=h[m]=T?await l.decode(T):null}if(g===null)return;let{data:p,shape:v,stride:x}=g,w=f.map((C,E)=>C%v[E]).reduce((C,E,T)=>C+E*x[T],0),b=p[w],S=p[w+1];if(!(b===F2&&S===F2))return r(m,{offset:Number(b),length:Number(S)})}}class Ln{constructor(e,i="/"){X(this,"store");X(this,"path");this.store=e,this.path=i}resolve(e){let i=new URL(`file://${this.path.endsWith("/")?this.path:`${this.path}/`}`);return new Ln(this.store,new URL(e,i).pathname)}}function yv(t){return new Ln(t??new Map)}var ro;class mf extends Ln{constructor(i,n,r){super(i,n);X(this,"kind","group");Lt(this,ro);wt(this,ro,r)}get attrs(){return Le(this,ro).attributes}}ro=new WeakMap;function V2(t){var i;const e=t.find(n=>n.name==="transpose");return((i=e==null?void 0:e.configuration)==null?void 0:i.order)??"C"}const zr=Symbol("zarrita.context");function wv(t){return t[zr]}function bv(t,e){let{configuration:i}=e.codecs.find(lv)??{},n={encode_chunk_key:sv(e.chunk_key_encoding),TypedArray:Ym(e.data_type),fill_value:e.fill_value};if(i){let o=V2(i.codecs);return{...n,kind:"sharded",chunk_shape:i.chunk_shape,codec:qh({data_type:e.data_type,shape:i.chunk_shape,codecs:i.codecs}),get_strides(l){return Vn(l,o)},get_chunk_bytes:xv(t,e.chunk_grid.configuration.chunk_shape,n.encode_chunk_key,i)}}let r=V2(e.codecs);return{...n,kind:"regular",chunk_shape:e.chunk_grid.configuration.chunk_shape,codec:qh({data_type:e.data_type,shape:e.chunk_grid.configuration.chunk_shape,codecs:e.codecs}),get_strides(o){return Vn(o,r)},async get_chunk_bytes(o,l){let h=n.encode_chunk_key(o),f=t.resolve(h).path;return t.store.get(f,l)}}}var wm,bm,Un,Cm;let Xl=(Cm=class extends(bm=Ln,wm=zr,bm){constructor(i,n,r){super(i,n);X(this,"kind","array");Lt(this,Un);X(this,wm);wt(this,Un,{...r,fill_value:Hm(r)}),this[zr]=bv(this,r)}get attrs(){return Le(this,Un).attributes}get shape(){return Le(this,Un).shape}get chunks(){return this[zr].chunk_shape}get dtype(){return Le(this,Un).data_type}async getChunk(i,n){let r=this[zr],o=await r.get_chunk_bytes(i,n);if(!o){let l=r.chunk_shape.reduce((f,u)=>f*u,1),h=new r.TypedArray(l);return h.fill(r.fill_value),{data:h,shape:r.chunk_shape,stride:r.get_strides(r.chunk_shape)}}return r.codec.decode(o)}is(i){return ov(this.dtype,i)}},Un=new WeakMap,Cm),ic=Cv();function Cv(){let t=new WeakMap;function e(i){let n=t.get(i)??{v2:0,v3:0};return t.set(i,n),n}return{increment(i,n){e(i)[n]+=1},version_max(i){let n=e(i);return n.v3>n.v2?"v3":"v2"}}}async function Sv(t){let e=await t.store.get(t.resolve(".zattrs").path);return e?fo(e):{}}async function Ev(t,e={}){let i="store"in t?t:new Ln(t),n={};return(e.attrs??!0)&&(n=await Sv(i)),e.kind==="array"?B2(i,n):e.kind==="group"?L2(i,n):B2(i,n).catch(r=>(qm(r,ho),L2(i,n)))}async function B2(t,e){let{path:i}=t.resolve(".zarray"),n=await t.store.get(i);if(!n)throw new ho("v2 array",{cause:new lf(i)});return ic.increment(t.store,"v2"),new Xl(t.store,t.path,av(fo(n),e))}async function L2(t,e){let{path:i}=t.resolve(".zgroup"),n=await t.store.get(i);if(!n)throw new ho("v2 group",{cause:new lf(i)});return ic.increment(t.store,"v2"),new mf(t.store,t.path,rv(fo(n),e))}async function Tv(t){let{store:e,path:i}=t.resolve("zarr.json"),n=await t.store.get(i);if(!n)throw new ho("v3 array or group",{cause:new lf(i)});let r=fo(n);return r.node_type==="array"&&(r.fill_value=Hm(r)),r.node_type==="array"?new Xl(e,t.path,r):new mf(e,t.path,r)}async function Mv(t,e={}){let i="store"in t?t:new Ln(t),n=await Tv(i);if(ic.increment(i.store,"v3"),e.kind===void 0||e.kind==="array"&&n instanceof Xl||e.kind==="group"&&n instanceof mf)return n;let r=n instanceof Xl?"array":"group";throw new Error(`Expected node of kind ${e.kind}, found ${r}.`)}async function an(t,e={}){let i="store"in t?t.store:t,n=ic.version_max(i),r=n==="v2"?an.v2:an.v3,o=n==="v2"?an.v3:an.v2;return r(t,e).catch(l=>(qm(l,ho),o(t,e)))}an.v2=Ev;an.v3=Mv;function*Dv(t,e,i=1){e===void 0&&(e=t,t=0);for(let n=t;n<e;n+=i)yield n}function*Nv(...t){if(t.length===0)return;const e=t.map(n=>n[Symbol.iterator]()),i=e.map(n=>n.next());if(i.some(n=>n.done))throw new Error("Input contains an empty iterator.");for(let n=0;;){if(i[n].done){if(e[n]=t[n][Symbol.iterator](),i[n]=e[n].next(),++n>=e.length)return}else yield i.map(({value:r})=>r),n=0;i[n]=e[n].next()}}function Rv({start:t,stop:e,step:i},n){if(i===0)throw new Error("slice step cannot be zero");i=i??1;const r=i<0,[o,l]=r?[-1,n-1]:[0,n];return t===null?t=r?l:o:t<0?(t+=n,t<o&&(t=o)):t>l&&(t=l),e===null?e=r?o:l:e<0?(e+=n,e<o&&(e=o)):e>l&&(e=l),[t,e,i]}function Hr(t,e,i=null){return e===void 0&&(e=t,t=null),{start:t,stop:e,step:i}}function Uv(){const t=[];return{add:e=>t.push(e()),onIdle:()=>Promise.all(t)}}class gf extends Error{constructor(e){super(e),this.name="IndexError"}}function Iv(t,e){throw new gf(`too many indicies for array; expected ${e.length}, got ${t.length}`)}function Fv(t){throw new gf(`index out of bounds for dimension with length ${t}`)}function Vv(){throw new gf("only slices with step >= 1 are supported")}function Bv(t,e){t.length>e.length&&Iv(t,e)}function Lv(t,e){return t=Math.trunc(t),t<0&&(t=e+t),(t>=e||t<0)&&Fv(e),t}class Ov{constructor({dim_sel:e,dim_len:i,dim_chunk_len:n}){X(this,"dim_sel");X(this,"dim_len");X(this,"dim_chunk_len");X(this,"nitems");e=Lv(e,i),this.dim_sel=e,this.dim_len=i,this.dim_chunk_len=n,this.nitems=1}*[Symbol.iterator](){const e=Math.floor(this.dim_sel/this.dim_chunk_len),i=e*this.dim_chunk_len,n=this.dim_sel-i;yield{dim_chunk_ix:e,dim_chunk_sel:n}}}class O2{constructor({dim_sel:e,dim_len:i,dim_chunk_len:n}){X(this,"start");X(this,"stop");X(this,"step");X(this,"dim_len");X(this,"dim_chunk_len");X(this,"nitems");X(this,"nchunks");const[r,o,l]=Rv(e,i);this.start=r,this.stop=o,this.step=l,this.step<1&&Vv(),this.dim_len=i,this.dim_chunk_len=n,this.nitems=Math.max(0,Math.ceil((this.stop-this.start)/this.step)),this.nchunks=Math.ceil(this.dim_len/this.dim_chunk_len)}*[Symbol.iterator](){const e=Math.floor(this.start/this.dim_chunk_len),i=Math.ceil(this.stop/this.dim_chunk_len);for(const n of Dv(e,i)){const r=n*this.dim_chunk_len,o=Math.min(this.dim_len,(n+1)*this.dim_chunk_len),l=o-r;let h=0,f=0;if(this.start<r){const v=(r-this.start)%this.step;v&&(f+=this.step-v),h=Math.ceil((r-this.start)/this.step)}else f=this.start-r;const u=this.stop>o?l:this.stop-r,m=[f,u,this.step],g=Math.ceil((u-f)/this.step),p=[h,h+g,1];yield{dim_chunk_ix:n,dim_chunk_sel:m,dim_out_sel:p}}}}function kv(t,e){let i=[];return t===null?i=e.map(n=>Hr(null)):Array.isArray(t)&&(i=t.map(n=>n??Hr(null))),Bv(i,e),i}class Pv{constructor({selection:e,shape:i,chunk_shape:n}){X(this,"dim_indexers");X(this,"shape");this.dim_indexers=kv(e,i).map((r,o)=>new(typeof r=="number"?Ov:O2)({dim_sel:r,dim_len:i[o],dim_chunk_len:n[o]})),this.shape=this.dim_indexers.filter(r=>r instanceof O2).map(r=>r.nitems)}*[Symbol.iterator](){for(const e of Nv(...this.dim_indexers)){const i=e.map(r=>r.dim_chunk_ix),n=e.map(r=>"dim_out_sel"in r?{from:r.dim_chunk_sel,to:r.dim_out_sel}:{from:r.dim_chunk_sel,to:null});yield{chunk_coords:i,mapping:n}}}}function zv(t,e){return"get"in t?t.get(e):t[e]}async function _v(t,e,i,n){var f;let r=wv(t),o=new Pv({selection:e,shape:t.shape,chunk_shape:t.chunks}),l=n.prepare(new r.TypedArray(o.shape.reduce((u,m)=>u*m,1)),o.shape,r.get_strides(o.shape)),h=((f=i.create_queue)==null?void 0:f.call(i))??Uv();for(const{chunk_coords:u,mapping:m}of o)h.add(async()=>{let{data:g,shape:p,stride:v}=await t.getChunk(u,i.opts),x=n.prepare(g,p,v);n.set_from_chunk(l,x,m)});return await h.onIdle(),o.shape.length===0?zv(l.data,0):l}function pf(t,e=0,i){let n=i??t.length-e;return{length:n,subarray(r,o=n){return pf(t,e+r,o-r)},set(r,o=0){for(let l=0;l<r.length;l++)t[e+o+l]=r.get(l)},get(r){return t[e+r]}}}function Th(t){return globalThis.Array.isArray(t.data)?{data:pf(t.data),stride:t.stride,bytes_per_element:1}:{data:new Uint8Array(t.data.buffer,t.data.byteOffset,t.data.byteLength),stride:t.stride,bytes_per_element:t.data.BYTES_PER_ELEMENT}}function jv(t){return"chars"in t?t.constructor.bind(null,t.chars):t.constructor}function Gv(t,e){if(globalThis.Array.isArray(t.data))return pf([e]);let i=jv(t.data),n=new i([e]);return new Uint8Array(n.buffer,n.byteOffset,n.byteLength)}const Yv={prepare(t,e,i){return{data:t,shape:e,stride:i}},set_scalar(t,e,i){let n=Th(t);Kh(n,e,Gv(t,i),n.bytes_per_element)},set_from_chunk(t,e,i){let n=Th(t);_l(n,Th(e),n.bytes_per_element,i)}};async function k2(t,e=null,i={}){return _v(t,e,i,Yv)}function Qm(t,e,i){return i<0&&e<t?Math.floor((t-e-1)/-i)+1:t<e?Math.floor((e-t-1)/i)+1:0}function Kh(t,e,i,n){if(e.length===0){t.data.set(i,0);return}const[r,...o]=e,[l,...h]=t.stride;if(typeof r=="number"){const p=t.data.subarray(l*r*n);Kh({data:p,stride:h},o,i,n);return}const[f,u,m]=r,g=Qm(f,u,m);if(o.length===0){for(let p=0;p<g;p++)t.data.set(i,l*(f+m*p)*n);return}for(let p=0;p<g;p++){const v=t.data.subarray(l*(f+m*p)*n);Kh({data:v,stride:h},o,i,n)}}function _l(t,e,i,n){const[r,...o]=n,[l,...h]=t.stride,[f,...u]=e.stride;if(r.from===null){if(o.length===0){t.data.set(e.data.subarray(0,i),r.to*i);return}_l({data:t.data.subarray(l*r.to*i),stride:h},e,i,o);return}if(r.to===null){if(o.length===0){let S=r.from*i;t.data.set(e.data.subarray(S,S+i),0);return}_l(t,{data:e.data.subarray(f*r.from*i),stride:u},i,o);return}const[m,g,p]=r.to,[v,x,w]=r.from,b=Qm(m,g,p);if(o.length===0){if(p===1&&w===1&&l===1&&f===1){let S=v*i,C=b*i;t.data.set(e.data.subarray(S,S+C),m*i);return}for(let S=0;S<b;S++){let C=f*(v+w*S)*i;t.data.set(e.data.subarray(C,C+i),l*(m+p*S)*i)}return}for(let S=0;S<b;S++)_l({data:t.data.subarray(l*(m+S*p)*i),stride:h},{data:e.data.subarray(f*(v+S*w)*i),stride:u},i,o)}function Xm(t,e,i,n={}){return e!==void 0&&i!==void 0&&(n={...n,headers:{...n.headers,Range:`bytes=${e}-${e+i-1}`}}),fetch(t,n)}function Hv(t,e){return{...t,...e,headers:{...t.headers,...e.headers}}}function P2(t,e){const i=typeof t=="string"?new URL(t):t;i.pathname.endsWith("/")||(i.pathname+="/");const n=new URL(e.slice(1),i);return n.search=i.search,n}async function z2(t){if(t.status!==404){if(t.status===200||t.status===206)return new Uint8Array(await t.arrayBuffer());throw new Error(`Unexpected response status ${t.status} ${t.statusText}`)}}async function qv(t,e,i,n){if(n)return fetch(t,{...i,headers:{...i.headers,Range:`bytes=-${e}`}});let r=await fetch(t,{...i,method:"HEAD"});if(!r.ok)return r;let o=r.headers.get("Content-Length"),l=Number(o);return Xm(t,l-e,l,i)}var oo,lo,co,Qh;class Kv{constructor(e,i={}){Lt(this,co);X(this,"url");Lt(this,oo);Lt(this,lo);this.url=e,wt(this,oo,i.overrides??{}),wt(this,lo,i.useSuffixRequest??!1)}async get(e,i={}){let n=P2(this.url,e).href,r=await fetch(n,dh(this,co,Qh).call(this,i));return z2(r)}async getRange(e,i,n={}){let r=P2(this.url,e),o=dh(this,co,Qh).call(this,n),l;return"suffixLength"in i?l=await qv(r,i.suffixLength,o,Le(this,lo)):l=await Xm(r,i.offset,i.length,o),z2(l)}}oo=new WeakMap,lo=new WeakMap,co=new WeakSet,Qh=function(e){return Hv(Le(this,oo),e)};var Zm=Object.defineProperty,Wm=t=>{throw TypeError(t)},Qv=(t,e,i)=>e in t?Zm(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i,sc=(t,e)=>{for(var i in e)Zm(t,i,{get:e[i],enumerable:!0})},k=(t,e,i)=>Qv(t,typeof e!="symbol"?e+"":e,i),Jm=(t,e,i)=>e.has(t)||Wm("Cannot "+i),xe=(t,e,i)=>(Jm(t,e,"read from private field"),i?i.call(t):e.get(t)),Vr=(t,e,i)=>e.has(t)?Wm("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,i),ba=(t,e,i,n)=>(Jm(t,e,"write to private field"),e.set(t,i),i),_2="0.57.0",$m=class Ji{constructor({name:e="niivue",level:i="info"}={}){k(this,"level"),k(this,"name"),this.name=`${e}`,this.level=i}debug(...e){Ji.levels[this.level]>Ji.levels.debug||console.debug(`${this.name}-debug`,...e)}info(...e){Ji.levels[this.level]>Ji.levels.info||console.info(`${this.name}-info`,...e)}warn(...e){Ji.levels[this.level]>Ji.levels.warn||console.warn(`${this.name}-warn`,...e)}error(...e){Ji.levels[this.level]>Ji.levels.error||console.error(`${this.name}-error`,...e)}fatal(...e){Ji.levels[this.level]>Ji.levels.fatal||console.error(`${this.name}-fatal`,...e)}setLogLevel(e){this.level=e}setName(e){this.name=e}};k($m,"levels",{debug:0,info:1,warn:2,error:3,fatal:4,silent:1/0});var Xv=$m,j=new Xv({name:"niivue",level:"info"}),Zv=function(t,e,i){const n=t.createShader(t.VERTEX_SHADER);t.shaderSource(n,e),t.compileShader(n);const r=t.createShader(t.FRAGMENT_SHADER);t.shaderSource(r,i),t.compileShader(r);const o=t.createProgram();if(t.attachShader(o,n),t.attachShader(o,r),t.linkProgram(o),!t.getProgramParameter(o,t.LINK_STATUS))throw console.log(t.getProgramInfoLog(o)),t.getShaderParameter(n,t.COMPILE_STATUS)||console.log("Vertex shader compilation error:",t.getShaderInfoLog(n)),t.getShaderParameter(r,t.COMPILE_STATUS)||console.log("Fragment shader compilation error:",t.getShaderInfoLog(r)),j.error(t.getProgramInfoLog(o)),new Error("Shader failed to link, see console for log");return o},qe=class{constructor(t,e,i){k(this,"program"),k(this,"uniforms",{}),k(this,"isMatcap"),this.program=Zv(t,e,i);const n=/uniform[^;]+[ ](\w+);/g,r=/uniform[^;]+[ ](\w+);/,o=e.match(n),l=i.match(n);o&&o.forEach(h=>{const f=h.match(r);this.uniforms[f[1]]=-1}),l&&l.forEach(h=>{const f=h.match(r);this.uniforms[f[1]]=-1});for(const h in this.uniforms)this.uniforms[h]=t.getUniformLocation(this.program,h)}use(t){t.useProgram(this.program)}},Br=`#version 300 es
#line 4
layout(location=0) in vec3 pos;
layout(location=1) in vec3 texCoords;
uniform mat4 mvpMtx;
out vec3 vColor;
void main(void) {
	gl_Position = mvpMtx * vec4(pos, 1.0);
	vColor = texCoords;
}`,Af=`
	vec4 drawColor(float scalar, float drawOpacity) {
		float nlayer = float(textureSize(colormap, 0).y);
		float layer = (nlayer - 0.5) / nlayer;
		vec4 dcolor = texture(colormap, vec2((scalar * 255.0)/256.0 + 0.5/256.0, layer)).rgba;
		dcolor.a *= drawOpacity;
		return dcolor;
}`,mo=`vec3 GetBackPosition(vec3 startPositionTex) {
	vec3 startPosition = startPositionTex * volScale;
	vec3 invR = 1.0 / rayDir;
	vec3 tbot = invR * (vec3(0.0)-startPosition);
	vec3 ttop = invR * (volScale-startPosition);
	vec3 tmax = max(ttop, tbot);
	vec2 t = min(tmax.xx, tmax.yz);
	vec3 endPosition = startPosition + (rayDir * min(t.x, t.y));
	//convert world position back to texture position:
	endPosition = endPosition / volScale;
	return endPosition;
}

vec4 applyClip (vec3 dir, inout vec4 samplePos, inout float len, inout bool isClip) {
	float cdot = dot(dir,clipPlane.xyz);
	isClip = false;
	if  ((clipPlane.a > 1.0) || (cdot == 0.0)) return samplePos;
	bool frontface = (cdot > 0.0);
	float dis = (-clipPlane.a - dot(clipPlane.xyz, samplePos.xyz-0.5)) / cdot;
	float thick = clipThick;
	if (thick <= 0.0) thick = 2.0;
	float  disBackFace = (-(clipPlane.a-thick) - dot(clipPlane.xyz, samplePos.xyz-0.5)) / cdot;
	if (((frontface) && (dis >= len)) || ((!frontface) && (dis <= 0.0))) {
		samplePos.a = len + 1.0;
		return samplePos;
	}
	if (frontface) {
		dis = max(0.0, dis);
		samplePos = vec4(samplePos.xyz+dir * dis, dis);
		if (dis > 0.0) isClip = true;
		len = min(disBackFace, len);
	}
	if (!frontface) {
		len = min(dis, len);
		disBackFace = max(0.0, disBackFace);
		if (len == dis) isClip = true;
		samplePos = vec4(samplePos.xyz+dir * disBackFace, disBackFace);
	}
	return samplePos;
}

void clipVolume(inout vec3 startPos, inout vec3 backPos, int dim, float frac, bool isLo) {
	vec3 dir = backPos - startPos;
	float len = length(dir);
	dir = normalize(dir);
	// Discard if both startPos and backPos are outside the clipping plane
	if (isLo && startPos[dim] < frac && backPos[dim] < frac) {
		discard;
	}
	if (!isLo && startPos[dim] > frac && backPos[dim] > frac) {
		discard;
	}
	vec4 plane = vec4(0.0, 0.0, 0.0, 0.5 - frac);
	plane[dim] = 1.0;
	float cdot = dot(dir, plane.xyz);
	float dis = (-plane.w - dot(plane.xyz, startPos - vec3(0.5))) / cdot;
	// Adjust startPos or backPos based on the intersection with the plane
	bool isFrontFace = (cdot > 0.0);
	if (!isLo)
		isFrontFace = !isFrontFace;
	if (dis > 0.0) {
		if (isFrontFace) {
				if (dis <= len) {
					startPos = startPos + dir * dis;
				}
		} else {
			if (dis < len) {
				backPos = startPos + dir * dis;
			}
		}
	}
}

void clipVolumeStart (inout vec3 startPos, inout vec3 backPos) {
	// vec3 clipLo = vec3(0.1, 0.2, 0.4);
	// vec3 clipHi = vec3(0.8, 0.7, 0.7);
	for (int i = 0; i < 3; i++) {
		if (clipLo[i] > 0.0)
			clipVolume(startPos, backPos, i, clipLo[i], true);
	}
	for (int i = 0; i < 3; i++) {
		if (clipHi[i] < 1.0)
			clipVolume(startPos, backPos, i, clipHi[i], false);
	}
}

float frac2ndc(vec3 frac) {
//https://stackoverflow.com/questions/7777913/how-to-render-depth-linearly-in-modern-opengl-with-gl-fragcoord-z-in-fragment-sh
	vec4 pos = vec4(frac.xyz, 1.0); //fraction
	vec4 dim = vec4(vec3(textureSize(volume, 0)), 1.0);
	pos = pos * dim;
	vec4 shim = vec4(-0.5, -0.5, -0.5, 0.0);
	pos += shim;
	vec4 mm = transpose(matRAS) * pos;
	float z_ndc = (mvpMtx * vec4(mm.xyz, 1.0)).z;
	return (z_ndc + 1.0) / 2.0;
}`+Af,vf=`void main() {
	if (fColor.x > 2.0) {
		fColor = vec4(1.0, 0.0, 0.0, 0.5);
		return;
	}
	fColor = vec4(0.0,0.0,0.0,0.0);
	vec4 clipPlaneColorX = clipPlaneColor;
	//if (clipPlaneColor.a < 0.0)
	//	clipPlaneColorX.a = - 1.0;
	bool isColorPlaneInVolume = false;
	if (clipPlaneColorX.a < 0.0) {
		isColorPlaneInVolume = true;
		clipPlaneColorX.a = 0.0;
	}
	//fColor = vec4(vColor.rgb, 1.0); return;
	vec3 start = vColor;
	gl_FragDepth = 0.0;
	vec3 backPosition = GetBackPosition(start);
	// fColor = vec4(backPosition, 1.0); return;
	vec3 dir = normalize(backPosition - start);
	clipVolumeStart(start, backPosition);
	dir = normalize(dir);
	float len = length(backPosition - start);
	float lenVox = length((texVox * start) - (texVox * backPosition));
	if ((lenVox < 0.5) || (len > 3.0)) { //length limit for parallel rays
		return;
	}
	float sliceSize = len / lenVox; //e.g. if ray length is 1.0 and traverses 50 voxels, each voxel is 0.02 in unit cube
	float stepSize = sliceSize; //quality: larger step is faster traversal, but fewer samples
	float opacityCorrection = stepSize/sliceSize;
	vec4 deltaDir = vec4(dir.xyz * stepSize, stepSize);
	vec4 samplePos = vec4(start.xyz, 0.0); //ray position
	float lenNoClip = len;
	bool isClip = false;
	vec4 clipPos = applyClip(dir, samplePos, len, isClip);
	//if ((clipPos.a != samplePos.a) && (len < 3.0)) {
	//start: OPTIONAL fast pass: rapid traversal until first hit
	float stepSizeFast = sliceSize * 1.9;
	vec4 deltaDirFast = vec4(dir.xyz * stepSizeFast, stepSizeFast);
	while (samplePos.a <= len) {
		float val = texture(volume, samplePos.xyz).a;
		if (val > 0.01)
			break;
		samplePos += deltaDirFast; //advance ray position
	}
	float drawOpacityA = renderDrawAmbientOcclusionXY.y;
	if ((samplePos.a >= len) && (((overlays < 1.0) && (drawOpacityA <= 0.0) ) || (backgroundMasksOverlays > 0)))  {
		if (isClip)
			fColor += clipPlaneColorX;
		return;
	}
	fColor = vec4(1.0, 1.0, 1.0, 1.0);
	//gl_FragDepth = frac2ndc(samplePos.xyz); //crude due to fast pass resolution
	samplePos -= deltaDirFast;
	if (samplePos.a < 0.0)
		vec4 samplePos = vec4(start.xyz, 0.0); //ray position
	//end: fast pass
	vec4 colAcc = vec4(0.0,0.0,0.0,0.0);
	vec4 firstHit = vec4(0.0,0.0,0.0,2.0 * lenNoClip);
	const float earlyTermination = 0.95;
	float backNearest = len; //assume no hit
	float ran = fract(sin(gl_FragCoord.x * 12.9898 + gl_FragCoord.y * 78.233) * 43758.5453);
	samplePos += deltaDir * ran; //jitter ray
`,nc=`
	if (firstHit.a < len)
		gl_FragDepth = frac2ndc(firstHit.xyz);
	colAcc.a = (colAcc.a / earlyTermination) * backOpacity;
	fColor = colAcc;
	//if (isClip) //CR
	if ((isColorPlaneInVolume) && (clipPos.a != samplePos.a) && (abs(firstHit.a - clipPos.a) < deltaDir.a))
		fColor.rgb = mix(fColor.rgb, clipPlaneColorX.rgb, abs(clipPlaneColor.a));
		//fColor.rgb = mix(fColor.rgb, clipPlaneColorX.rgb, clipPlaneColorX.a * 0.65);
	float renderDrawAmbientOcclusionX = renderDrawAmbientOcclusionXY.x;
	float drawOpacity = renderDrawAmbientOcclusionXY.y;
	if ((overlays < 1.0) && (drawOpacity <= 0.0))
		return;
	//overlay pass
	len = lenNoClip;
	samplePos = vec4(start.xyz, 0.0); //ray position
	//start: OPTIONAL fast pass: rapid traversal until first hit
	stepSizeFast = sliceSize * 1.0;
	deltaDirFast = vec4(dir.xyz * stepSizeFast, stepSizeFast);
	while (samplePos.a <= len) {
		float val = texture(overlay, samplePos.xyz).a;
		if (drawOpacity > 0.0)
			val = max(val, texture(drawing, samplePos.xyz).r);
		if (val > 0.001)
			break;
		samplePos += deltaDirFast; //advance ray position
	}
	if (samplePos.a >= len) {
		if (isClip && (fColor.a == 0.0))
				fColor += clipPlaneColorX;
			return;
	}
	samplePos -= deltaDirFast;
	if (samplePos.a < 0.0)
		vec4 samplePos = vec4(start.xyz, 0.0); //ray position
	//end: fast pass
	float overFarthest = len;
	colAcc = vec4(0.0, 0.0, 0.0, 0.0);

	samplePos += deltaDir * ran; //jitter ray
	vec4 overFirstHit = vec4(0.0,0.0,0.0,2.0 * len);
	if (backgroundMasksOverlays > 0)
		samplePos = firstHit;
	bool firstDraw = true;
	while (samplePos.a <= len) {
		vec4 colorSample = texture(overlay, samplePos.xyz);
		if ((colorSample.a < 0.01) && (drawOpacity > 0.0)) {
			float val = texture(drawing, samplePos.xyz).r;
			vec4 draw = drawColor(val, drawOpacity);
			if ((draw.a > 0.0) && (firstDraw)) {
				firstDraw = false;
				float sum = 0.0;
				const float mn = 1.0 / 256.0;
				const float sampleRadius = 1.1;
				float dx = sliceSize * sampleRadius;
				vec3 center = samplePos.xyz;
				//six neighbors that share a face
				sum += min(texture(drawing, center.xyz + cross(vec3(0.0,0.0,+dx), dir)).r, mn);
				sum += min(texture(drawing, center.xyz + cross(vec3(0.0,0.0,-dx), dir)).r, mn);
				sum += min(texture(drawing, center.xyz + cross(vec3(0.0,+dx,0.0), dir)).r, mn);
				sum += min(texture(drawing, center.xyz + cross(vec3(0.0,-dx,0.0), dir)).r, mn);
				sum += min(texture(drawing, center.xyz + cross(vec3(+dx,0.0,0.0), dir)).r, mn);
				sum += min(texture(drawing, center.xyz + cross(vec3(-dx,0.0,0.0), dir)).r, mn);
				//float proportion = (sum / mn) / 6.0;
				
				//12 neighbors that share an edge
				dx = sliceSize * sampleRadius * sqrt(2.0) * 0.5;
				sum += min(texture(drawing, center.xyz + cross(vec3(0.0,+dx,+dx), dir)).r, mn);
				sum += min(texture(drawing, center.xyz + cross(vec3(+dx,0.0,+dx), dir)).r, mn);
				sum += min(texture(drawing, center.xyz + cross(vec3(+dx,+dx,0.0), dir)).r, mn);
				sum += min(texture(drawing, center.xyz + cross(vec3(0.0,-dx,-dx), dir)).r, mn);
				sum += min(texture(drawing, center.xyz + cross(vec3(-dx,0.0,-dx), dir)).r, mn);
				sum += min(texture(drawing, center.xyz + cross(vec3(-dx,-dx,0.0), dir)).r, mn);

				sum += min(texture(drawing, center.xyz + cross(vec3(0.0,+dx,-dx), dir)).r, mn);
				sum += min(texture(drawing, center.xyz + cross(vec3(+dx,0.0,-dx), dir)).r, mn);
				sum += min(texture(drawing, center.xyz + cross(vec3(+dx,-dx,0.0), dir)).r, mn);
				
				sum += min(texture(drawing, center.xyz + cross(vec3(0.0,-dx,+dx), dir)).r, mn);
				sum += min(texture(drawing, center.xyz + cross(vec3(-dx,0.0,+dx), dir)).r, mn);
				sum += min(texture(drawing, center.xyz + cross(vec3(-dx,+dx,0.0), dir)).r, mn);
				float proportion = (sum / mn) / 18.0; //proportion of six neighbors is non-zero
				
				//a high proportion of hits means crevice
				//since the AO term adds shadows that darken most voxels, it will result in dark surfaces
				//the term brighten adds a little illumination to balance this
				// without brighten, only the most extreme ridges will not be darker
				const float brighten = 1.2;
				vec3 ao = draw.rgb * (1.0 - proportion) * brighten;
				draw.rgb = mix (draw.rgb, ao , renderDrawAmbientOcclusionX);
			}
			colorSample = draw;
		}
		samplePos += deltaDir; //advance ray position
		if (colorSample.a >= 0.01) {
			if (overFirstHit.a > len)
				overFirstHit = samplePos;
			colorSample.a *= renderOverlayBlend;
			colorSample.a = 1.0-pow((1.0 - colorSample.a), opacityCorrection);
			colorSample.rgb *= colorSample.a;
			colAcc= (1.0 - colAcc.a) * colorSample + colAcc;
			overFarthest = samplePos.a;
			if ( colAcc.a > earlyTermination )
				break;
		}
	}
	//if (samplePos.a >= len) {
	if (colAcc.a <= 0.0) {
		if (isClip && (fColor.a == 0.0))
			fColor += clipPlaneColorX;
		return;
	}
	if (overFirstHit.a < firstHit.a)
		gl_FragDepth = frac2ndc(overFirstHit.xyz);
	float overMix = colAcc.a;
	float overlayDepth = 0.3;
	if (fColor.a <= 0.0)
		overMix = 1.0;
	else if (((overFarthest) > backNearest)) {
		float dx = (overFarthest - backNearest)/1.73;
		dx = fColor.a * pow(dx, overlayDepth);
		overMix *= 1.0 - dx;
	}
	fColor.rgb = mix(fColor.rgb, colAcc.rgb, overMix);
	fColor.a = max(fColor.a, colAcc.a);
}`,Wv=`#version 300 es
#line 215
precision highp int;
precision highp float;
uniform vec3 rayDir;
uniform vec3 texVox;
uniform int backgroundMasksOverlays;
uniform vec3 volScale;
uniform vec4 clipPlane;
uniform highp sampler3D volume, overlay;
uniform float overlays;
uniform float clipThick;
uniform vec3 clipLo;
uniform vec3 clipHi;
uniform float backOpacity;
uniform mat4 mvpMtx;
uniform mat4 matRAS;
uniform vec4 clipPlaneColor;
uniform float renderOverlayBlend;
uniform highp sampler3D drawing;
uniform highp sampler2D colormap;
uniform vec2 renderDrawAmbientOcclusionXY;
in vec3 vColor;
out vec4 fColor;
`+mo+`
	void main() {
	vec3 start = vColor;
	gl_FragDepth = 0.0;
	vec3 backPosition = GetBackPosition(start);
	vec3 dir = normalize(backPosition - start);
	clipVolumeStart(start, backPosition);
	float len = length(backPosition - start);
	float lenVox = length((texVox * start) - (texVox * backPosition));
	if ((lenVox < 0.5) || (len > 3.0)) { //length limit for parallel rays
		fColor = vec4(0.0,0.0,0.0,0.0);
		return;
	}
	float sliceSize = len / lenVox; //e.g. if ray length is 1.0 and traverses 50 voxels, each voxel is 0.02 in unit cube
	float stepSize = sliceSize; //quality: larger step is faster traversal, but fewer samples
	float opacityCorrection = stepSize/sliceSize;
	vec4 deltaDir = vec4(dir.xyz * stepSize, stepSize);
	vec4 samplePos = vec4(start.xyz, 0.0); //ray position
	vec4 colAcc = vec4(0.0,0.0,0.0,0.0);
	vec4 firstHit = vec4(0.0,0.0,0.0,2.0 * len);
	const float earlyTermination = 0.95;
	float backNearest = len; //assume no hit
	float dis = len;
	//check if axial plane is closest
	vec4 aClip = vec4(0.0, 0.0, 1.0, (1.0- clipPlane.z) - 0.5);
	float adis = (-aClip.a - dot(aClip.xyz, samplePos.xyz-0.5)) / dot(dir,aClip.xyz);
	if (adis > 0.0)
		dis = min(adis, dis);
	//check of coronal plane is closest
	vec4 cClip = vec4(0.0, 1.0, 0.0, (1.0- clipPlane.y) - 0.5);
	float cdis = (-cClip.a - dot(cClip.xyz, samplePos.xyz-0.5)) / dot(dir,cClip.xyz);
	if (cdis > 0.0)
		dis = min(cdis, dis);
	//check if coronal slice is closest
	vec4 sClip = vec4(1.0, 0.0, 0.0, (1.0- clipPlane.x) - 0.5);
	float sdis = (-sClip.a - dot(sClip.xyz, samplePos.xyz-0.5)) / dot(dir,sClip.xyz);
	if (sdis > 0.0)
		dis = min(sdis, dis);
	if ((dis > 0.0) && (dis < len)) {
		samplePos = vec4(samplePos.xyz+dir * dis, dis);
		colAcc = texture(volume, samplePos.xyz);
		colAcc.a = earlyTermination;
		firstHit = samplePos;
		backNearest = min(backNearest, samplePos.a);
	}
	//the following are only used by overlays
	vec4 clipPlaneColorX = clipPlaneColor;
	bool isColorPlaneInVolume = false;
	float lenNoClip = len;
	bool isClip = false;
	vec4 clipPos = applyClip(dir, samplePos, len, isClip);
	float stepSizeFast = sliceSize * 1.9;
	vec4 deltaDirFast = vec4(dir.xyz * stepSizeFast, stepSizeFast);
	if (samplePos.a < 0.0)
		vec4 samplePos = vec4(start.xyz, 0.0); //ray position
	float ran = fract(sin(gl_FragCoord.x * 12.9898 + gl_FragCoord.y * 78.233) * 43758.5453);
	samplePos += deltaDir * ran; //jitter ray
`+nc,Jv=`#version 300 es
#line 215
precision highp int;
precision highp float;
uniform vec3 rayDir;
uniform vec3 texVox;
uniform int backgroundMasksOverlays;
uniform vec3 volScale;
uniform vec4 clipPlane;
uniform highp sampler3D volume, overlay;
uniform float overlays;
uniform float clipThick;
uniform vec3 clipLo;
uniform vec3 clipHi;
uniform float backOpacity;
uniform mat4 mvpMtx;
uniform mat4 matRAS;
uniform vec4 clipPlaneColor;
uniform float renderOverlayBlend;
uniform highp sampler3D drawing;
uniform highp sampler2D colormap;
uniform vec2 renderDrawAmbientOcclusionXY;
in vec3 vColor;
out vec4 fColor;
`+mo+vf+`while (samplePos.a <= len) {
		vec4 colorSample = texture(volume, samplePos.xyz);
		samplePos += deltaDir; //advance ray position
		if (colorSample.a >= 0.01) {
			if (firstHit.a > lenNoClip)
				firstHit = samplePos;
			backNearest = min(backNearest, samplePos.a);
			colorSample.a = 1.0-pow((1.0 - colorSample.a), opacityCorrection);
			colorSample.rgb *= colorSample.a;
			colAcc= (1.0 - colAcc.a) * colorSample + colAcc;
			if ( colAcc.a > earlyTermination )
				break;
		}
	}
`+nc,eg=`#version 300 es
#line 215
precision highp int;
precision highp float;
uniform vec3 rayDir;
uniform vec3 texVox;
uniform int backgroundMasksOverlays;
uniform vec3 volScale;
uniform vec4 clipPlane;
uniform highp sampler3D volume, overlay;
uniform float overlays;
uniform float clipThick;
uniform vec3 clipLo;
uniform vec3 clipHi;
uniform float backOpacity;
uniform mat4 mvpMtx;
uniform mat4 normMtx;
uniform mat4 matRAS;
uniform vec4 clipPlaneColor;
uniform float renderOverlayBlend;
uniform highp sampler3D drawing, gradient;
uniform highp sampler2D colormap;
uniform highp sampler2D matCap;
uniform vec2 renderDrawAmbientOcclusionXY;
uniform float gradientAmount;
uniform float silhouettePower;
uniform float gradientOpacity[256];
in vec3 vColor;
out vec4 fColor;
`,$v=eg+mo+vf+`
	float startPos = samplePos.a;
	float clipClose = clipPos.a + 3.0 * deltaDir.a; //do not apply gradients near clip plane
	float brighten = 2.0; //modulating makes average intensity darker 0.5 * 0.5 = 0.25
	//vec4 prevGrad = vec4(0.0);
	float silhouetteThreshold = 1.0 - silhouettePower;
	while (samplePos.a <= len) {
		vec4 colorSample = texture(volume, samplePos.xyz);
		if (colorSample.a >= 0.0) {
			vec4 grad = texture(gradient, samplePos.xyz);
			grad.rgb = normalize(grad.rgb*2.0 - 1.0);
			//if (grad.a < prevGrad.a)
			//	grad.rgb = prevGrad.rgb;
			//prevGrad = grad;
			vec3 n = mat3(normMtx) * grad.rgb;
			n.y = - n.y;
			vec4 mc = vec4(texture(matCap, n.xy * 0.5 + 0.5).rgb, 1.0) * brighten;
			mc = mix(vec4(1.0), mc, gradientAmount);
			if (samplePos.a > clipClose)
				colorSample.rgb *= mc.rgb;
			if (firstHit.a > lenNoClip)
				firstHit = samplePos;
			backNearest = min(backNearest, samplePos.a);
			colorSample.a = 1.0-pow((1.0 - colorSample.a), opacityCorrection);
			int gradIdx = int(grad.a * 255.0);
			colorSample.a *= gradientOpacity[gradIdx];
			float lightNormDot = dot(grad.rgb, rayDir);
			// n.b. "lightNormDor" is cosTheta, "silhouettePower" is Fresnel effect exponent
 			colorSample.a *= pow(1.0 - abs(lightNormDot), silhouettePower);
 			float viewAlign = abs(lightNormDot); // 0 = perpendicular, 1 = aligned
 			// linearly map silhouettePower (0..1) to a threshold range, e.g., [1.0, 0.0]
 			// Cull voxels that are too aligned with the view direction
 			if (viewAlign > silhouetteThreshold)
 				colorSample.a = 0.0;
			colorSample.rgb *= colorSample.a;
			colAcc= (1.0 - colAcc.a) * colorSample + colAcc;
			if ( colAcc.a > earlyTermination )
				break;
		}
		samplePos += deltaDir; //advance ray position
	}
`+nc,e3=eg+mo+vf+`
	float startPos = samplePos.a;
	float clipClose = clipPos.a + 3.0 * deltaDir.a; //do not apply gradients near clip plane
	float brighten = 2.0; //modulating makes average intensity darker 0.5 * 0.5 = 0.25
	//vec4 prevGrad = vec4(0.0);
	while (samplePos.a <= len) {
		vec4 colorSample = texture(volume, samplePos.xyz);
		if (colorSample.a >= 0.0) {
			vec4 grad = texture(gradient, samplePos.xyz);
			colorSample.rgb = abs(normalize(grad.rgb*2.0 - 1.0));
			if (firstHit.a > lenNoClip)
				firstHit = samplePos;
			backNearest = min(backNearest, samplePos.a);
			colorSample.a = 1.0-pow((1.0 - colorSample.a), opacityCorrection);
			colorSample.rgb *= colorSample.a;
			colAcc= (1.0 - colAcc.a) * colorSample + colAcc;
			if ( colAcc.a > earlyTermination )
				break;
		}
		samplePos += deltaDir; //advance ray position
	}
`+nc,Mh=`#version 300 es
#line 392
layout(location=0) in vec3 pos;
uniform int axCorSag;
uniform mat4 mvpMtx;
uniform mat4 frac2mm;
uniform float slice;
out vec3 texPos;
void main(void) {
	texPos = vec3(pos.x, pos.y, slice);
	if (axCorSag > 1)
		texPos = vec3(slice, pos.x, pos.y);
	else if (axCorSag > 0)
		texPos = vec3(pos.x, slice, pos.y);
	vec4 mm = frac2mm * vec4(texPos, 1.0);
	gl_Position = mvpMtx * mm;
}`,tg=`#version 300 es
#line 411
precision highp int;
precision highp float;
uniform highp sampler3D volume, overlay;
uniform int backgroundMasksOverlays;
uniform float overlayOutlineWidth;
uniform float overlayAlphaShader;
uniform int axCorSag;
uniform float overlays;
uniform float opacity;
uniform float drawOpacity;
uniform bool isAlphaClipDark;
uniform highp sampler3D drawing;
uniform highp sampler2D colormap;
in vec3 texPos;
out vec4 color;`+Af+`void main() {
	//color = vec4(1.0, 0.0, 1.0, 1.0);return;
	vec4 background = texture(volume, texPos);
	color = vec4(background.rgb, opacity);
	if ((isAlphaClipDark) && (background.a == 0.0)) color.a = 0.0; //FSLeyes clipping range
	vec4 ocolor = vec4(0.0);
	float overlayAlpha = overlayAlphaShader;
	if (overlays > 0.0) {
		ocolor = texture(overlay, texPos);
		//dFdx for "boxing" issue 435 has aliasing on some implementations (coarse vs fine)
		//however, this only identifies 50% of the edges due to aliasing effects
		// http://www.aclockworkberry.com/shader-derivative-functions/
		// https://bgolus.medium.com/distinctive-derivative-differences-cce38d36797b
		//if ((ocolor.a >= 1.0) && ((dFdx(ocolor.a) != 0.0) || (dFdy(ocolor.a) != 0.0)  ))
		//	ocolor.rbg = vec3(0.0, 0.0, 0.0);
		bool isOutlineBelowNotAboveThreshold = true;
		if (isOutlineBelowNotAboveThreshold) {
			if ((overlayOutlineWidth > 0.0) && (ocolor.a < 1.0)) { //check voxel neighbors for edge
				vec3 vx = (overlayOutlineWidth ) / vec3(textureSize(overlay, 0));
				//6 voxel neighbors that share a face
				vec3 vxR = vec3(texPos.x+vx.x, texPos.y, texPos.z);
				vec3 vxL = vec3(texPos.x-vx.x, texPos.y, texPos.z);
				vec3 vxA = vec3(texPos.x, texPos.y+vx.y, texPos.z);
				vec3 vxP = vec3(texPos.x, texPos.y-vx.y, texPos.z);
				vec3 vxS = vec3(texPos.x, texPos.y, texPos.z+vx.z);
				vec3 vxI = vec3(texPos.x, texPos.y, texPos.z-vx.z);
				float a = 0.0;
				if (axCorSag != 2) {
					a = max(a, texture(overlay, vxR).a);
					a = max(a, texture(overlay, vxL).a);
				}
				if (axCorSag != 1) {
					a = max(a, texture(overlay, vxA).a);
					a = max(a, texture(overlay, vxP).a);
				}
				if (axCorSag != 0) {
					a = max(a, texture(overlay, vxS).a);
					a = max(a, texture(overlay, vxI).a);
				}
				bool isCheckCorners = true;
				if (isCheckCorners) {
					//12 voxel neighbors that share an edge
					vec3 vxRA = vec3(texPos.x+vx.x, texPos.y+vx.y, texPos.z);
					vec3 vxLA = vec3(texPos.x-vx.x, texPos.y+vx.y, texPos.z);
					vec3 vxRP = vec3(texPos.x+vx.x, texPos.y-vx.y, texPos.z);
					vec3 vxLP = vec3(texPos.x-vx.x, texPos.y-vx.y, texPos.z);
					vec3 vxRS = vec3(texPos.x+vx.x, texPos.y, texPos.z+vx.z);
					vec3 vxLS = vec3(texPos.x-vx.x, texPos.y, texPos.z+vx.z);
					vec3 vxRI = vec3(texPos.x+vx.x, texPos.y, texPos.z-vx.z);
					vec3 vxLI = vec3(texPos.x-vx.x, texPos.y, texPos.z-vx.z);
					vec3 vxAS = vec3(texPos.x, texPos.y+vx.y, texPos.z+vx.z);
					vec3 vxPS = vec3(texPos.x, texPos.y-vx.y, texPos.z+vx.z);
					vec3 vxAI = vec3(texPos.x, texPos.y+vx.y, texPos.z-vx.z);
					vec3 vxPI = vec3(texPos.x, texPos.y-vx.y, texPos.z-vx.z);

					if (axCorSag == 0) { //axial corners
						a = max(a, texture(overlay, vxRA).a);
						a = max(a, texture(overlay, vxLA).a);
						a = max(a, texture(overlay, vxRP).a);
						a = max(a, texture(overlay, vxLP).a);
					}
					if (axCorSag == 1) { //coronal corners
						a = max(a, texture(overlay, vxRS).a);
						a = max(a, texture(overlay, vxLS).a);
						a = max(a, texture(overlay, vxRI).a);
						a = max(a, texture(overlay, vxLI).a);
					}
					if (axCorSag == 2) { //sagittal corners
						a = max(a, texture(overlay, vxAS).a);
						a = max(a, texture(overlay, vxPS).a);
						a = max(a, texture(overlay, vxAI).a);
						a = max(a, texture(overlay, vxPI).a);
					}
				}
				if (a >= 1.0) {
					ocolor = vec4(0.0, 0.0, 0.0, 1.0);
					overlayAlpha = 1.0;
				}
			}

		} else {
			if ((overlayOutlineWidth > 0.0) && (ocolor.a >= 1.0)) { //check voxel neighbors for edge
				vec3 vx = (overlayOutlineWidth ) / vec3(textureSize(overlay, 0));
				vec3 vxR = vec3(texPos.x+vx.x, texPos.y, texPos.z);
				vec3 vxL = vec3(texPos.x-vx.x, texPos.y, texPos.z);
				vec3 vxA = vec3(texPos.x, texPos.y+vx.y, texPos.z);
				vec3 vxP = vec3(texPos.x, texPos.y-vx.y, texPos.z);
				vec3 vxS = vec3(texPos.x, texPos.y, texPos.z+vx.z);
				vec3 vxI = vec3(texPos.x, texPos.y, texPos.z-vx.z);
				float a = 1.0;
				if (axCorSag != 2) {
					a = min(a, texture(overlay, vxR).a);
					a = min(a, texture(overlay, vxL).a);
				}
				if (axCorSag != 1) {
					a = min(a, texture(overlay, vxA).a);
					a = min(a, texture(overlay, vxP).a);
				}
				if (axCorSag != 0) {
					a = min(a, texture(overlay, vxS).a);
					a = min(a, texture(overlay, vxI).a);
				}
				if (a < 1.0) {
					ocolor = vec4(0.0, 0.0, 0.0, 1.0);
					overlayAlpha = 1.0;
				}
			}
		} //outline above threshold
	}

`,t3=`#version 300 es
#line 411
precision highp int;
precision highp float;
uniform highp sampler2D volume, overlay;
uniform int backgroundMasksOverlays;
uniform float overlayOutlineWidth;
uniform float overlayAlphaShader;
uniform int axCorSag;
uniform float overlays;
uniform float opacity;
uniform float drawOpacity;
uniform bool isAlphaClipDark;
uniform highp sampler2D drawing;
uniform highp sampler2D colormap;
in vec3 texPos;
out vec4 color;`+Af+`void main() {
	//color = vec4(1.0, 0.0, 1.0, 1.0);return;
	vec4 background = texture(volume, texPos.xy);
	color = vec4(background.rgb, opacity);
	if ((isAlphaClipDark) && (background.a == 0.0)) color.a = 0.0; //FSLeyes clipping range
	vec4 dcolor = drawColor(texture(drawing, texPos.xy).r, drawOpacity);
	if (dcolor.a > 0.0) {
		color.rgb = mix(color.rgb, dcolor.rgb, dcolor.a);
		color.a = max(drawOpacity, color.a);
	}
}`,ig=`	ocolor.a *= overlayAlpha;
	vec4 dcolor = drawColor(texture(drawing, texPos).r, drawOpacity);
	if (dcolor.a > 0.0) {
		color.rgb = mix(color.rgb, dcolor.rgb, dcolor.a);
		color.a = max(drawOpacity, color.a);
	}
	if ((backgroundMasksOverlays > 0) && (background.a == 0.0))
		return;
	float a = color.a + ocolor.a * (1.0 - color.a); // premultiplied alpha
	if (a == 0.0) return;
	color.rgb = mix(color.rgb, ocolor.rgb, ocolor.a / a);
	color.a = a;
}`,i3=tg+ig,s3=tg+`	if (ocolor.a > 0.0) {
		//https://gamedev.stackexchange.com/questions/102889/is-it-possible-to-convert-vec4-to-int-in-glsl-using-opengl-es
		uint alpha = uint(ocolor.a * 255.0);
		vec3 xyzFlip = vec3(float((uint(1) & alpha) > uint(0)), float((uint(2) & alpha) > uint(0)), float((uint(4) & alpha) > uint(0)));
		//convert from 0 and 1 to -1 and 1
		xyzFlip = (xyzFlip * 2.0) - 1.0;
		//https://math.stackexchange.com/questions/1905533/find-perpendicular-distance-from-point-to-line-in-3d
		//v1 principle direction of tensor for this voxel
		vec3 v1 = ocolor.rgb;
		//flips encode polarity to convert from 0..1 to -1..1 (27 bits vs 24 bit precision)
		v1 = normalize( v1 * xyzFlip);
		vec3 vxl = fract(texPos * vec3(textureSize(volume, 0))) - 0.5;
		//vxl coordinates now -0.5..+0.5 so 0,0,0 is origin
		vxl.x = -vxl.x;
		float t = dot(vxl,v1);
		vec3 P = t * v1;
		float dx = length(P-vxl);
		ocolor.a = 1.0 - smoothstep(0.2,0.25, dx);
		//if modulation was applied, use that to scale alpha not color:
		ocolor.a *= length(ocolor.rgb);
		ocolor.rgb = normalize(ocolor.rgb);
		//compute distance one half voxel closer to viewer:
		float pan = 0.5;
		if (axCorSag == 0)
			vxl.z -= pan;
		if (axCorSag == 1)
			vxl.y -= pan;
		if (axCorSag == 2)
			vxl.x += pan;
		t = dot(vxl,v1);
		P = t * v1;
		float dx2 = length(P-vxl);
		ocolor.rgb += (dx2-dx-(0.5 * pan)) * 1.0;
	}
`+ig,Dh=`#version 300 es
#line 480
precision highp int;
precision highp float;
uniform vec4 lineColor;
out vec4 color;
void main() {
	color = lineColor;
}`,n3=`#version 300 es
#line 723
precision highp int;
precision highp float;

uniform vec4 lineColor;
uniform vec4 leftTopWidthHeight;
uniform float thickness; // line thickness in pixels
uniform vec2 canvasWidthHeight;

out vec4 color;

void main() {
    // fragment position in screen coordinates
    vec2 fragCoord = gl_FragCoord.xy;

    // canvas height
    float canvasHeight = canvasWidthHeight.y;

    // 'top' and 'bottom' to match gl_FragCoord.y coordinate system
    float top = canvasHeight - leftTopWidthHeight.y;
    float bottom = top - leftTopWidthHeight.w;

    // left and right edges
    float left = leftTopWidthHeight.x;
    float right = left + leftTopWidthHeight.z;

    bool withinLeft = fragCoord.x >= left && fragCoord.x <= left + thickness;
    bool withinRight = fragCoord.x <= right && fragCoord.x >= right - thickness;
    bool withinTop = fragCoord.y <= top && fragCoord.y >= top - thickness;
    bool withinBottom = fragCoord.y >= bottom && fragCoord.y <= bottom + thickness;

    bool isOutline = withinLeft || withinRight || withinTop || withinBottom;

    if (isOutline) {
        color = lineColor;
    } else {
        discard; 
    }
}`,a3=`#version 300 es
#line 490
layout(location=0) in vec3 pos;
uniform vec2 canvasWidthHeight;
uniform vec4 leftTopWidthHeight;
out vec2 vColor;
void main(void) {
	//convert pixel x,y space 1..canvasWidth,1..canvasHeight to WebGL 1..-1,-1..1
	vec2 frac;
	frac.x = (leftTopWidthHeight.x + (pos.x * leftTopWidthHeight.z)) / canvasWidthHeight.x; //0..1
	frac.y = 1.0 - ((leftTopWidthHeight.y + ((1.0 - pos.y) * leftTopWidthHeight.w)) / canvasWidthHeight.y); //1..0
	frac = (frac * 2.0) - 1.0;
	gl_Position = vec4(frac, 0.0, 1.0);
	vColor = pos.xy;
}`,r3=`#version 300 es
#line 506
precision highp int;
precision highp float;
uniform highp sampler2D colormap;
uniform float layer;
in vec2 vColor;
out vec4 color;
void main() {
	float nlayer = float(textureSize(colormap, 0).y);
	float fmap = (0.5 + layer) / nlayer;
	color = vec4(texture(colormap, vec2(vColor.x, fmap)).rgb, 1.0);
}`,j2=`#version 300 es
#line 520
layout(location=0) in vec3 pos;
uniform vec2 canvasWidthHeight;
uniform vec4 leftTopWidthHeight;
void main(void) {
	//convert pixel x,y space 1..canvasWidth,1..canvasHeight to WebGL 1..-1,-1..1
	vec2 frac;
	frac.x = (leftTopWidthHeight.x + (pos.x * leftTopWidthHeight.z)) / canvasWidthHeight.x; //0..1
	frac.y = 1.0 - ((leftTopWidthHeight.y + ((1.0 - pos.y) * leftTopWidthHeight.w)) / canvasWidthHeight.y); //1..0
	frac = (frac * 2.0) - 1.0;
	gl_Position = vec4(frac, 0.0, 1.0);
}`,o3=`#version 300 es
#line 534
layout(location=0) in vec3 pos;
uniform vec2 canvasWidthHeight;
uniform float thickness;
uniform vec4 startXYendXY;
void main(void) {
	vec2 posXY = mix(startXYendXY.xy, startXYendXY.zw, pos.x);
	vec2 dir = normalize(startXYendXY.xy - startXYendXY.zw);
	posXY += vec2(-dir.y, dir.x) * thickness * (pos.y - 0.5);
	posXY.x = (posXY.x) / canvasWidthHeight.x; //0..1
	posXY.y = 1.0 - (posXY.y / canvasWidthHeight.y); //1..0
	gl_Position = vec4((posXY * 2.0) - 1.0, 0.0, 1.0);
}`,l3=`#version 300 es
#line 534
layout(location=0) in vec3 pos;
uniform vec2 canvasWidthHeight;
uniform float thickness;
uniform vec2 startXY;
uniform vec3 endXYZ; // transformed XYZ point
void main(void) {	
	vec2 posXY = mix(startXY.xy, endXYZ.xy, pos.x);
	vec2 startDiff = endXYZ.xy - startXY.xy;
	float startDistance = length(startDiff);
	vec2 diff = endXYZ.xy - posXY;
	float currentDistance = length(diff);
	vec2 dir = normalize(startXY.xy - endXYZ.xy);
	posXY += vec2(-dir.y, dir.x) * thickness * (pos.y - 0.5);
	posXY.x = (posXY.x) / canvasWidthHeight.x; //0..1
	posXY.y = 1.0 - (posXY.y / canvasWidthHeight.y); //1..0	
	float z = endXYZ.z * ( 1.0 - abs(currentDistance/startDistance)); 
	gl_Position = vec4((posXY * 2.0) - 1.0, z, 1.0);
}`,c3=`#version 300 es
#line 549
layout(location=0) in vec3 pos;
uniform vec2 canvasWidthHeight;
uniform vec4 leftTopWidthHeight;
out vec2 vUV;
void main(void) {
	//convert pixel x,y space 1..canvasWidth,1..canvasHeight to WebGL 1..-1,-1..1
	vec2 frac;
	frac.x = (leftTopWidthHeight.x + (pos.x * leftTopWidthHeight.z)) / canvasWidthHeight.x; //0..1
	frac.y = 1.0 - ((leftTopWidthHeight.y + ((1.0 - pos.y) * leftTopWidthHeight.w)) / canvasWidthHeight.y); //1..0
	frac = (frac * 2.0) - 1.0;
	gl_Position = vec4(frac, 0.0, 1.0);
	vUV = vec2(pos.x, 1.0 - pos.y);
}`,u3=`#version 300 es
#line 565
precision highp int;
precision highp float;
uniform highp sampler2D bmpTexture;
in vec2 vUV;
out vec4 color;
void main() {
	color = texture(bmpTexture, vUV);
}`,h3=`#version 300 es
#line 576
layout(location=0) in vec3 pos;
uniform vec2 canvasWidthHeight;
uniform vec4 leftTopWidthHeight;
uniform vec4 uvLeftTopWidthHeight;
out vec2 vUV;
void main(void) {
	//convert pixel x,y space 1..canvasWidth,1..canvasHeight to WebGL 1..-1,-1..1
	vec2 frac;
	frac.x = (leftTopWidthHeight.x + (pos.x * leftTopWidthHeight.z)) / canvasWidthHeight.x; //0..1
	frac.y = 1.0 - ((leftTopWidthHeight.y + ((1.0 - pos.y) * leftTopWidthHeight.w)) / canvasWidthHeight.y); //1..0
	frac = (frac * 2.0) - 1.0;
	gl_Position = vec4(frac, 0.0, 1.0);
	vUV = vec2(uvLeftTopWidthHeight.x + (pos.x * uvLeftTopWidthHeight.z), uvLeftTopWidthHeight.y  + ((1.0 - pos.y) * uvLeftTopWidthHeight.w) );
}`,f3=`#version 300 es
#line 593
precision highp int;
precision highp float;
uniform highp sampler2D fontTexture;
uniform vec4 fontColor;
uniform float screenPxRange;
in vec2 vUV;
out vec4 color;
float median(float r, float g, float b) {
	return max(min(r, g), min(max(r, g), b));
}
void main() {
	vec3 msd = texture(fontTexture, vUV).rgb;
	float sd = median(msd.r, msd.g, msd.b);
	float screenPxDistance = screenPxRange*(sd - 0.5);
	float opacity = clamp(screenPxDistance + 0.5, 0.0, 1.0);
	color = vec4(fontColor.rgb , fontColor.a * opacity);
}`,d3=`#version 300 es
layout(location=0) in vec3 pos;
uniform vec2 canvasWidthHeight;
uniform vec4 leftTopWidthHeight;
uniform vec4 uvLeftTopWidthHeight;
out vec2 vUV;
void main(void) {
	//convert pixel x,y space 1..canvasWidth,1..canvasHeight to WebGL 1..-1,-1..1
	vec2 frac;
	frac.x = (leftTopWidthHeight.x + (pos.x * leftTopWidthHeight.z)) / canvasWidthHeight.x; //0..1
	frac.y = 1.0 - ((leftTopWidthHeight.y + ((1.0 - pos.y) * leftTopWidthHeight.w)) / canvasWidthHeight.y); //1..0
	frac = (frac * 2.0) - 1.0;
	gl_Position = vec4(frac, 0.0, 1.0);
	vUV = pos.xy;
}`,m3=`#version 300 es
precision highp int;
precision highp float;
uniform vec4 circleColor;
uniform float fillPercent;
in vec2 vUV;
out vec4 color;
void main() {
	/* Check if the pixel is inside the circle
		 and color it with a gradient. Otherwise, color it 
		 transparent   */
	float distance = length(vUV-vec2(0.5,0.5));
	if ( distance < 0.5 && distance >= (1.0 - fillPercent) / 2.0){
			color = vec4(circleColor.r,circleColor.g,circleColor.b,circleColor.a) ;			
	}else{
			color = vec4(0.0,0.0,0.0,0.0);
	}
}
`,Ca=`#version 300 es
#line 613
precision highp int;
precision highp float;
in vec3 vPos;
out vec2 TexCoord;
void main() {
	TexCoord = vPos.xy;
	gl_Position = vec4( (vPos.xy-vec2(0.5,0.5)) * 2.0, 0.0, 1.0);
}`,Nh=`#version 300 es
uniform highp usampler3D intensityVol;
`,G2=`#version 300 es
uniform highp isampler3D intensityVol;
`,g3=`#version 300 es
uniform highp sampler3D intensityVol;
`,Y2=`#line 636
precision highp int;
precision highp float;
in vec2 TexCoord;
out vec4 FragColor;
uniform float coordZ;
uniform float layer;
uniform highp sampler2D colormap;
uniform lowp sampler3D blend3D;
uniform float opacity;
uniform vec4 xyzaFrac;
uniform mat4 mtx;
void main(void) {
	vec4 vx = vec4(TexCoord.x, TexCoord.y, coordZ, 1.0) * mtx;
	uint idx = uint(texture(intensityVol, vx.xyz).r);
	FragColor = vec4(0.0, 0.0, 0.0, 0.0);
	if (idx == uint(0))
		return;
	//idx = ((idx - uint(1)) % uint(100))+uint(1);
	float textureWidth = float(textureSize(colormap, 0).x);
	float fx = (float(idx)+0.5) / textureWidth;
	float nlayer = float(textureSize(colormap, 0).y);
	float y = ((2.0 * layer) + 1.5)/nlayer;
	FragColor = texture(colormap, vec2(fx, y)).rgba;
	float alpha = FragColor.a;
	FragColor.a *= opacity;
	if (xyzaFrac.a > 0.0) { //outline
		vx = vec4(TexCoord.x+xyzaFrac.x, TexCoord.y, coordZ, 1.0) * mtx;
		uint R = uint(texture(intensityVol, vx.xyz).r);
		vx = vec4(TexCoord.x-xyzaFrac.x, TexCoord.y, coordZ, 1.0) * mtx;
		uint L = uint(texture(intensityVol, vx.xyz).r);
		vx = vec4(TexCoord.x, TexCoord.y+xyzaFrac.y, coordZ, 1.0) * mtx;
		uint A = uint(texture(intensityVol, vx.xyz).r);
		vx = vec4(TexCoord.x, TexCoord.y-xyzaFrac.y, coordZ, 1.0) * mtx;
		uint P = uint(texture(intensityVol, vx.xyz).r);
		vx = vec4(TexCoord.x, TexCoord.y, coordZ+xyzaFrac.z, 1.0) * mtx;
		uint S = uint(texture(intensityVol, vx.xyz).r);
		vx = vec4(TexCoord.x, TexCoord.y, coordZ-xyzaFrac.z, 1.0) * mtx;
		uint I = uint(texture(intensityVol, vx.xyz).r);
		if ((idx != R) || (idx != L) || (idx != A) || (idx != P) || (idx != S) || (idx != I))
			FragColor.a = alpha * xyzaFrac.a;
	}
}`,Rh=`#line 691
precision highp int;
precision highp float;
in vec2 TexCoord;
out vec4 FragColor;
uniform float coordZ;
uniform float layer;
uniform float scl_slope;
uniform float scl_inter;
uniform float cal_max;
uniform float cal_min;
uniform float cal_maxNeg;
uniform float cal_minNeg;
uniform bool isAlphaThreshold;
uniform bool isColorbarFromZero;
uniform bool isAdditiveBlend;
uniform highp sampler2D colormap;
uniform lowp sampler3D blend3D;
uniform int modulation;
uniform highp sampler3D modulationVol;
uniform float opacity;
uniform mat4 mtx;
void main(void) {
	vec4 vx = vec4(TexCoord.xy, coordZ, 1.0) * mtx;
	if ((vx.x < 0.0) || (vx.x > 1.0) || (vx.y < 0.0) || (vx.y > 1.0) || (vx.z < 0.0) || (vx.z > 1.0)) {
		//set transparent if out of range
		//https://webglfundamentals.org/webgl/webgl-3d-textures-repeat-clamp.html
		FragColor = texture(blend3D, vec3(TexCoord.xy, coordZ));
		return;
	}
	float f = (scl_slope * float(texture(intensityVol, vx.xyz).r)) + scl_inter;
	float mn = cal_min;
	float mx = cal_max;
	if ((isAlphaThreshold) || (isColorbarFromZero))
		mn = 0.0;
	float r = max(0.00001, abs(mx - mn));
	mn = min(mn, mx);
	float txl = mix(0.0, 1.0, (f - mn) / r);
	if (f > mn) { //issue1139: survives threshold, so round up to opaque voxel
		txl = max(txl, 2.0/256.0);
	}
	//https://stackoverflow.com/questions/5879403/opengl-texture-coordinates-in-pixel-space
	float nlayer = float(textureSize(colormap, 0).y);
	//each volume has two color maps:
	// (layer*2) = negative and (layer * 2) + 1 = positive
	float y = ((2.0 * layer) + 1.5)/nlayer;
	FragColor = texture(colormap, vec2(txl, y)).rgba;
	//negative colors
	mn = cal_minNeg;
	mx = cal_maxNeg;
	if ((isAlphaThreshold) || (isColorbarFromZero))
		mx = 0.0;
	//if ((!isnan(cal_minNeg)) && ( f < mx)) {
	if ((cal_minNeg < cal_maxNeg) && ( f < mx)) {
		r = max(0.00001, abs(mx - mn));
		mn = min(mn, mx);
		txl = 1.0 - mix(0.0, 1.0, (f - mn) / r);
		//issue1139: survives threshold, so round up to opaque voxel
		txl = max(txl, 2.0/256.0);
		y = ((2.0 * layer) + 0.5)/nlayer;
		FragColor = texture(colormap, vec2(txl, y));
	}
	if (layer > 0.7)
		FragColor.a = step(0.00001, FragColor.a);
	//if (modulation > 10)
	//	FragColor.a *= texture(modulationVol, vx.xyz).r;
	//	FragColor.rgb *= texture(modulationVol, vx.xyz).r;
	if (isAlphaThreshold) {
		if ((cal_minNeg != cal_maxNeg) && ( f < 0.0) && (f > cal_maxNeg))
			FragColor.a = pow(-f / -cal_maxNeg, 2.0);
		else if ((f > 0.0) && (cal_min > 0.0))
			FragColor.a *= pow(f / cal_min, 2.0); //issue435:  A = (V/X)**2
		//FragColor.g = 0.0;
	} else if (isColorbarFromZero) {
		if ((cal_minNeg != cal_maxNeg) && ( f < 0.0) && (f > cal_maxNeg))
			FragColor.a = 0.0;
		else if ((f > 0.0) && (cal_min > 0.0) && (f < cal_min))
			FragColor.a *= 0.0;

	}
	if (modulation == 1) {
		FragColor.rgb *= texture(modulationVol, vx.xyz).r;
	} else if (modulation == 2) {
		FragColor.a = texture(modulationVol, vx.xyz).r;
	}
	FragColor.a *= opacity;
	if (layer < 1.0) return;
	vec4 prevColor = texture(blend3D, vec3(TexCoord.xy, coordZ));
	// https://en.wikipedia.org/wiki/Alpha_compositing
	float aout = FragColor.a + (1.0 - FragColor.a) * prevColor.a;
	if (aout <= 0.0) return;
	if (isAdditiveBlend)
		FragColor.rgb = ((FragColor.rgb * FragColor.a) + (prevColor.rgb * prevColor.a)) / aout;
	else
		FragColor.rgb = ((FragColor.rgb * FragColor.a) + (prevColor.rgb * prevColor.a * (1.0 - FragColor.a))) / aout;
	FragColor.a = aout;
}`,p3=`#line 773
precision highp int;
precision highp float;
in vec2 TexCoord;
out vec4 FragColor;
uniform float coordZ;
uniform float layer;
uniform float scl_slope;
uniform float scl_inter;
uniform float cal_max;
uniform float cal_min;
uniform highp sampler2D colormap;
uniform lowp sampler3D blend3D;
uniform float opacity;
uniform mat4 mtx;
uniform bool hasAlpha;
uniform int modulation;
uniform highp sampler3D modulationVol;
void main(void) {
	vec4 vx = vec4(TexCoord.xy, coordZ, 1.0) * mtx;
	uvec4 aColor = texture(intensityVol, vx.xyz);
	FragColor = vec4(float(aColor.r) / 255.0, float(aColor.g) / 255.0, float(aColor.b) / 255.0, float(aColor.a) / 255.0);
	if (modulation == 1)
		FragColor.rgb *= texture(modulationVol, vx.xyz).r;
	if (!hasAlpha) {
		FragColor.a = (FragColor.r * 0.21 + FragColor.g * 0.72 + FragColor.b * 0.07);
		//next line: we could binarize alpha, but see rendering of visible human
		//FragColor.a = step(0.01, FragColor.a);
	}
	if (modulation == 2)
		FragColor.a = texture(modulationVol, vx.xyz).r;
	FragColor.a *= opacity;
}`,A3=`#version 300 es
#line 808
precision highp int;
precision highp float;
in vec3 vPos;
out vec2 TexCoord;
void main() {
	TexCoord = vPos.xy;
	gl_Position = vec4((vPos.x - 0.5) * 2.0, (vPos.y - 0.5) * 2.0, 0.0, 1.0);
}`,v3=`#version 300 es
#line 829
	precision highp float;
	precision highp int;
	precision highp isampler3D;
	layout(location = 0) out int label;
	layout(location = 1) out int strength;
	in vec2 TexCoord;
	uniform int finalPass;
	uniform float coordZ;
	uniform lowp sampler3D in3D;
	uniform highp isampler3D backTex; // background
	uniform highp isampler3D labelTex; // label
	uniform highp isampler3D strengthTex; // strength
void main(void) {
	vec3 interpolatedTextureCoordinate = vec3(TexCoord.xy, coordZ);
	ivec3 size = textureSize(backTex, 0);
	ivec3 texelIndex = ivec3(floor(interpolatedTextureCoordinate * vec3(size)));
	int background = texelFetch(backTex, texelIndex, 0).r;
	label = texelFetch(labelTex, texelIndex, 0).r;
	strength = texelFetch(strengthTex, texelIndex, 0).r;
	for (int k = -1; k <= 1; k++) {
		for (int j = -1; j <= 1; j++) {
			for (int i = -1; i <= 1; i++) {
				if (i != 0 && j != 0 && k != 0) {
					ivec3 neighborIndex = texelIndex + ivec3(i,j,k);
					int neighborBackground = texelFetch(backTex, neighborIndex, 0).r;
					int neighborStrength = texelFetch(strengthTex, neighborIndex, 0).r;
					int strengthCost = abs(neighborBackground - background);
					int takeoverStrength = neighborStrength - strengthCost;
					if (takeoverStrength > strength) {
						strength = takeoverStrength;
						label = texelFetch(labelTex, neighborIndex, 0).r;
					}
				}
			}
		}
	}
	if (finalPass < 1)
		return;
	int ok = 1;
	ivec4 labelCount = ivec4(0,0,0,0);
	for (int k = -1; k <= 1; k++)
		for (int j = -1; j <= 1; j++)
			for (int i = -1; i <= 1; i++) {
				ivec3 neighborIndex = texelIndex + ivec3(i,j,k);
				int ilabel = texelFetch(labelTex, neighborIndex, 0).r;
				if ((ilabel < 0) || (ilabel > 3))
					ok = 0;
				else
					labelCount[ilabel]++;
			}
	if (ok != 1) {
		return;
	}
	int maxIdx = 0;
	for (int i = 1; i < 4; i++) {
		if (labelCount[i] > labelCount[maxIdx])
			maxIdx = i;
	}
	label = maxIdx;
}`,x3=`#version 300 es
layout(location=0) in vec3 pos;
uniform mat4 mvpMtx;
void main(void) {
	gl_Position = mvpMtx * vec4(pos, 1.0);
}`,y3=`#version 300 es
precision highp int;
precision highp float;
uniform vec4 surfaceColor;
out vec4 color;
void main() {
	color = surfaceColor;
}`,w3=`#version 300 es
layout(location=0) in vec3 pos;
layout(location=1) in vec4 clr;
out vec4 vClr;
uniform mat4 mvpMtx;
void main(void) {
	gl_Position = mvpMtx * vec4(pos, 1.0);
	vClr = clr;
}`,b3=`#version 300 es
precision highp int;
precision highp float;
in vec4 vClr;
out vec4 color;
uniform float opacity;
void main() {
	color = vec4(vClr.rgb, opacity);
}`,Uh=`#version 300 es
layout(location=0) in vec3 pos;
layout(location=1) in vec4 norm;
layout(location=2) in vec4 clr;
uniform mat4 mvpMtx;
//uniform mat4 modelMtx;
uniform mat4 normMtx;
out vec4 vClr;
out vec3 vN;
out vec4 vP;
out vec4 vPc;
void main(void) {
	vec3 lightPosition = vec3(0.0, 0.0, -10.0);
	vP = vec4(pos, 1.0);
	vPc = mvpMtx * vec4(pos, 1.0);
	gl_Position = vPc;
	vN = normalize((normMtx * vec4(norm.xyz,1.0)).xyz);
	//vV = -vec3(modelMtx*vec4(pos,1.0));
	vClr = clr;
}`,C3=`#version 300 es
precision highp int;
precision highp float;
uniform float opacity;
out vec4 color;
vec4 packFloatToVec4i(const float value) {
	const vec4 bitSh = vec4(256.0*256.0*256.0, 256.0*256.0, 256.0, 1.0);
	const vec4 bitMsk = vec4(0.0, 1.0/256.0, 1.0/256.0, 1.0/256.0);
	vec4 res = fract(value * bitSh);
	res -= res.xxyz * bitMsk;
	return res;
}
void main() {
	color = packFloatToVec4i(gl_FragCoord.z);
}`,S3=`#version 300 es
precision highp int;
precision highp float;
uniform float opacity;
in vec4 vClr;
in vec3 vN;
out vec4 color;
float stepmix(float edge0, float edge1, float E, float x){
	float T = clamp(0.5 * (x - edge0 + E) / E, 0.0, 1.0);
	return mix(edge0, edge1, T);
}
void main() {
	vec3 r = vec3(0.0, 0.0, 1.0);
	float ambient = 0.3;
	float diffuse = 0.6;
	float specular = 0.5;
	float shininess = 50.0;
	vec3 n = normalize(vN);
	vec3 lightPosition = vec3(0.0, 10.0, -5.0);
	vec3 l = normalize(lightPosition);
	float df = max(0.0, dot(n, l));
	float sf = pow(max(dot(reflect(l, n), r), 0.0), shininess);
	const float A = 0.1;
	const float B = 0.3;
	const float C = 0.6;
	const float D = 1.0;
	float E = fwidth(df);
	if (df > A - E && df < A + E) df = stepmix(A, B, E, df);
	else if (df > B - E && df < B + E) df = stepmix(B, C, E, df);
	else if (df > C - E && df < C + E) df = stepmix(C, D, E, df);
	else if (df < A) df = 0.0;
	else if (df < B) df = B;
	else if (df < C) df = C;
	else df = D;
	E = fwidth(sf);
	if (sf > 0.5 - E && sf < 0.5 + E)
		sf = smoothstep(0.5 - E, 0.5 + E, sf);
	else
		sf = step(0.5, sf);
	vec3 a = vClr.rgb * ambient;
	vec3 d = max(df, 0.0) * vClr.rgb * diffuse;
	color.rgb = a + d + (specular * sf);
	color.a = opacity;
}`,E3=`#version 300 es
precision highp int;
precision highp float;
uniform float opacity;
in vec4 vClr;
in vec3 vN;
out vec4 color;
void main() {
	vec3 r = vec3(0.0, 0.0, 1.0); //rayDir: for orthographic projections moving in Z direction (no need for normal matrix)
	float ambient = 0.3;
	float diffuse = 0.6;
	float specular = 0.25;
	float shininess = 10.0;
	float PenWidth = 0.6;
	vec3 n = normalize(vN);
	vec3 lightPosition = vec3(0.0, 10.0, -5.0);
	vec3 l = normalize(lightPosition);
	float lightNormDot = dot(n, l);
	float view = abs(dot(n,r)); //with respect to viewer
	if (PenWidth < view) discard;
	vec3 a = vClr.rgb * ambient;
	vec3 d = max(lightNormDot, 0.0) * vClr.rgb * diffuse;
	float s = specular * pow(max(dot(reflect(l, n), r), 0.0), shininess);
	color.rgb = a + d + s;
	color.a = opacity;
}`,T3=`#version 300 es
precision highp int;
precision highp float;
uniform float opacity;
in vec4 vClr;
in vec3 vN;
out vec4 color;
void main() {
	const float thresh = 0.4;
	const vec3 viewDir = vec3(0.0, 0.0, -1.0);
	vec3 n = normalize(vN);
	// use abs() for two-sided lighting, max() for one sided
	float cosTheta = abs(dot(n, viewDir));
	// float cosTheta = max(dot(n, viewDir), 0.0);
	// optional fresnel equation - adjust exponent
	// cosTheta = 1.0 - pow(1.0 - cosTheta, 2.0);
	// use step for binary edges, smoothstep for feathered edges
	// vec3 d = step(thresh, cosTheta) * vClr.rgb;
	vec3 d = smoothstep(thresh - 0.05, thresh + 0.05, cosTheta) * vClr.rgb;
	color = vec4(d, opacity);
}`,M3=`#version 300 es
precision highp int;
precision highp float;
uniform float opacity;
in vec4 vClr;
in vec3 vN;
out vec4 color;
void main() {
  const float edge0 = 0.1;
  const float edge1 = 0.25;
  const vec3 viewDir = vec3(0.0, 0.0, -1.0);
  vec3 n = normalize(vN);
  float cosTheta = abs(dot(n, viewDir));
  float alpha = 1.0 - smoothstep(edge0, edge1, cosTheta);
  if (alpha <= 0.0) {
    discard;
  }
  color = vec4(0.0, 0.0, 0.0, opacity * alpha);
}`,D3=`#version 300 es
precision highp int;
precision highp float;
uniform float opacity;
in vec4 vClr;
in vec3 vN;
out vec4 color;
void main() {
	vec3 r = vec3(0.0, 0.0, 1.0); //rayDir: for orthographic projections moving in Z direction (no need for normal matrix)
	float diffuse = 1.0;
	float specular = 0.2;
	float shininess = 10.0;
	vec3 n = normalize(vN);
	vec3 lightPosition = vec3(0.0, 0.0, -5.0);
	vec3 l = normalize(lightPosition);
	float lightNormDot = max(dot(n, l), 0.0);
	vec3 d = lightNormDot * vClr.rgb * diffuse;
	float s = specular * pow(max(dot(reflect(l, n), r), 0.0), shininess);
	color = vec4(d + s, opacity);
}`,N3=`#version 300 es
precision highp int;
precision highp float;
uniform float opacity;
in vec4 vClr;
in vec3 vN;
out vec4 color;
void main() {
	float diffuse = 1.4;
	vec3 l = vec3(0.0, 0.0, -1.0);
	float lightNormDot = max(dot(normalize(vN), l), 0.0);
	color = vec4(lightNormDot * vClr.rgb * diffuse, opacity);
}`,R3=`#version 300 es
precision highp int;
precision highp float;
uniform float opacity;
in vec4 vClr;
in vec3 vN;
out vec4 color;
void main() {
	float specularRGB = 0.7;
	float specularWhite = 0.3;
	float shininess = 10.0;
	float diffuse = 1.0;
	vec3 r = vec3(0.0, 0.0, 1.0); //rayDir: for orthographic projections moving in Z direction (no need for normal matrix)
	vec3 n = normalize(vN);
	vec3 l = vec3(0.0, 0.0, -1.0);
	float lightNormDot = max(dot(n, l), 0.0);
	vec3 d3 = lightNormDot * vClr.rgb * diffuse;
	float s = pow(max(dot(reflect(l, n), r), 0.0), shininess);
	vec3 s3 = specularRGB * s * vClr.rgb;
	s *= specularWhite;
	color = vec4(d3 + s3 + s, opacity);
}`,U3=`#version 300 es
precision highp int;
precision highp float;
uniform float opacity;
in vec4 vClr;
in vec3 vN;
in vec4 vPc;
out vec4 color;
void main() {
	vec3 n = normalize(vN);
	// Compute curvature
	vec3 dx = dFdx(n);
	vec3 dy = dFdy(n);
	vec3 xneg = n - dx;
	vec3 xpos = n + dx;
	vec3 yneg = n - dy;
	vec3 ypos = n + dy;
	float depth = length(vPc.xyz);
	float curv = (cross(xneg, xpos).y - cross(yneg, ypos).x) / depth;
	//at this stage 0.5 for flat, with valleys dark and ridges bright
	curv = 1.0 - (curv + 0.5);
	//clamp
	curv =  min(max(curv, 0.0), 1.0);
	// easing function
	curv = pow(curv, 0.5);
	//modulate ambient and diffuse with curvature
	vec3 r = vec3(0.0, 0.0, 1.0); //rayDir: for orthographic projections moving in Z direction (no need for normal matrix)
	float ambient = 0.6;
	float diffuse = 0.6;
	float specular = 0.2;
	float shininess = 10.0;
	vec3 lightPosition = vec3(0.0, 10.0, -2.0);
	vec3 l = normalize(lightPosition);
	float lightNormDot = dot(n, l);
	vec3 a = vClr.rgb * ambient * curv;
	vec3 d = max(lightNormDot, 0.0) * vClr.rgb * diffuse;
	float s = specular * pow(max(dot(reflect(l, n), r), 0.0), shininess);
	color = vec4(a + d + s, opacity);
}`,I3=`#version 300 es
precision highp int;
precision highp float;
uniform float opacity;
in vec4 vClr;
in vec3 vN;
out vec4 color;
void main() {
	vec3 r = vec3(0.0, 0.0, 1.0); //rayDir: for orthographic projections moving in Z direction (no need for normal matrix)
	float ambient = 0.35;
	float diffuse = 0.5;
	float specular = 0.2;
	float shininess = 10.0;
	vec3 n = normalize(vN);
	vec3 lightPosition = vec3(0.0, 10.0, -5.0);
	vec3 l = normalize(lightPosition);
	float lightNormDot = dot(n, l);
	vec3 a = vClr.rgb * ambient;
	vec3 d = max(lightNormDot, 0.0) * vClr.rgb * diffuse;
	float s = specular * pow(max(dot(reflect(l, n), r), 0.0), shininess);
	color = vec4(a + d + s, opacity);
}`,F3=`#version 300 es
precision highp int;
precision highp float;
uniform float opacity;
in vec4 vClr;
in vec3 vN;
uniform sampler2D matCap;
out vec4 color;
void main() {
	vec3 n = normalize(vN);
	vec2 uv = n.xy * 0.5 + 0.5;
	uv.y = 1.0 - uv.y;
	vec3 clr = texture(matCap,uv.xy).rgb * vClr.rgb;
	color = vec4(clr, opacity);
}`,V3=`#version 300 es
precision highp int;
precision highp float;
uniform float opacity;
in vec4 vClr;
in vec3 vN;
out vec4 color;
void main() {
	float ambient = 0.35;
	float diffuse = 0.6;
	vec3 n = normalize(vN);
	vec3 lightPosition = vec3(0.0, 10.0, -5.0);
	vec3 l = normalize(lightPosition);
	float lightNormDot = dot(n, l);
	vec3 a = vClr.rgb * ambient;
	vec3 d = max(lightNormDot, 0.0) * vClr.rgb * diffuse;
	color = vec4(a + d, opacity);
}`,B3=`#version 300 es
precision highp int;
precision highp float;
uniform float opacity;
in vec4 vClr;
in vec3 vN;
out vec4 color;
void main() {
	vec3 r = vec3(0.0, 0.0, 1.0); //rayDir: for orthographic projections moving in Z direction (no need for normal matrix)
	float ambient = 0.35;
	float diffuse = 0.5;
	float specular = 0.2;
	float shininess = 10.0;
	vec3 n = normalize(vN);
	vec3 lightPosition = vec3(0.0, 10.0, -5.0);
	vec3 l = normalize(lightPosition);
	float lightNormDot = dot(n, l);
	vec3 up = vec3(0.0, 1.0, 0.0);
	float ax = dot(n, up) * 0.5 + 0.5;  //Shreiner et al. (2013) OpenGL Programming Guide, 8th Ed., p 388. ISBN-10: 0321773039
	vec3 upClr = vec3(1.0, 1.0, 0.95);
	vec3 downClr = vec3(0.4, 0.4, 0.6);
	vec3 a = vClr.rgb * ambient;
	a *= mix(downClr, upClr, ax);
	vec3 d = max(lightNormDot, 0.0) * vClr.rgb * diffuse;
	float s = specular * pow(max(dot(reflect(l, n), r), 0.0), shininess);
	color = vec4(a + d + s, opacity);
}`,L3=`#version 300 es
precision highp int;
precision highp float;
uniform float opacity;
in vec4 vClr;
in vec3 vN;
out vec4 color;
//Spherical harmonics constants
const float C1 = 0.429043;
const float C2 = 0.511664;
const float C3 = 0.743125;
const float C4 = 0.886227;
const float C5 = 0.247708;
//Spherical harmonics coefficients
// Ramamoorthi, R., and P. Hanrahan. 2001b. "An Efficient Representation for Irradiance Environment Maps." In Proceedings of SIGGRAPH 2001, pp. 497500.
// https://github.com/eskimoblood/processingSketches/blob/master/data/shader/shinyvert.glsl
// https://github.com/eskimoblood/processingSketches/blob/master/data/shader/shinyvert.glsl
// Constants for Eucalyptus Grove lighting
const vec3 L00  = vec3( 0.3783264,  0.4260425,  0.4504587);
const vec3 L1m1 = vec3( 0.2887813,  0.3586803,  0.4147053);
const vec3 L10  = vec3( 0.0379030,  0.0295216,  0.0098567);
const vec3 L11  = vec3(-0.1033028, -0.1031690, -0.0884924);
const vec3 L2m2 = vec3(-0.0621750, -0.0554432, -0.0396779);
const vec3 L2m1 = vec3( 0.0077820, -0.0148312, -0.0471301);
const vec3 L20  = vec3(-0.0935561, -0.1254260, -0.1525629);
const vec3 L21  = vec3(-0.0572703, -0.0502192, -0.0363410);
const vec3 L22  = vec3( 0.0203348, -0.0044201, -0.0452180);
vec3 SH(vec3 vNormal) {
	vNormal = vec3(vNormal.x,vNormal.z,vNormal.y);
	vec3 diffuseColor = C1 * L22 * (vNormal.x * vNormal.x - vNormal.y * vNormal.y) +
	C3 * L20 * vNormal.z * vNormal.z +
	C4 * L00 -
	C5 * L20 +
	2.0 * C1 * L2m2 * vNormal.x * vNormal.y +
	2.0 * C1 * L21  * vNormal.x * vNormal.z +
	2.0 * C1 * L2m1 * vNormal.y * vNormal.z +
	2.0 * C2 * L11  * vNormal.x +
	2.0 * C2 * L1m1 * vNormal.y +
	2.0 * C2 * L10  * vNormal.z;
	return diffuseColor;
}
void main() {
	vec3 r = vec3(0.0, 0.0, 1.0); //rayDir: for orthographic projections moving in Z direction (no need for normal matrix)
	float ambient = 0.3;
	float diffuse = 0.6;
	float specular = 0.1;
	float shininess = 10.0;
	vec3 n = normalize(vN);
	vec3 lightPosition = vec3(0.0, 10.0, -5.0);
	vec3 l = normalize(lightPosition);
	float s = specular * pow(max(dot(reflect(l, n), r), 0.0), shininess);
	vec3 a = vClr.rgb * ambient;
	vec3 d = vClr.rgb * diffuse * SH(-reflect(n, vec3(l.x, l.y, -l.z)) );
	color = vec4(a + d + s, opacity);
}`,O3=`#version 300 es
layout(location=0) in vec3 pos;
layout(location=1) in vec4 norm;
layout(location=2) in vec4 clr;
uniform mat4 mvpMtx;
//uniform mat4 modelMtx;
uniform mat4 normMtx;
out vec4 vClr;
flat out vec3 vN;
void main(void) {
	gl_Position = mvpMtx * vec4(pos, 1.0);
	vN = normalize((normMtx * vec4(norm.xyz,1.0)).xyz);
	//vV = -vec3(modelMtx*vec4(pos,1.0));
	vClr = clr;
}`,H2=`#version 300 es
precision highp int;
precision highp float;
uniform float opacity;
in vec4 vClr;
flat in vec3 vN;
out vec4 color;
void main() {
	vec3 r = vec3(0.0, 0.0, 1.0); //rayDir: for orthographic projections moving in Z direction (no need for normal matrix)
	float ambient = 0.35;
	float diffuse = 0.5;
	float specular = 0.2;
	float shininess = 10.0;
	vec3 n = normalize(vN);
	vec3 lightPosition = vec3(0.0, 10.0, -5.0);
	vec3 l = normalize(lightPosition);
	float lightNormDot = dot(n, l);
	vec3 a = vClr.rgb * ambient;
	vec3 d = max(lightNormDot, 0.0) * vClr.rgb * diffuse;
	float s = specular * pow(max(dot(reflect(l, n), r), 0.0), shininess);
	color = vec4(a + d + s, opacity);
}`,k3=`#version 300 es
#line 1260
//precision highp int;
precision highp float;
uniform vec3 rayDir;
uniform vec3 volScale;
uniform vec3 texVox;
uniform vec4 clipPlane;
uniform highp sampler3D volume, overlay;
uniform float overlays;
uniform float clipThick;
uniform vec3 clipLo;
uniform vec3 clipHi;
uniform mat4 matRAS;
uniform mat4 mvpMtx;
uniform float drawOpacity, renderOverlayBlend;
uniform highp sampler3D drawing;
uniform highp sampler2D colormap;
uniform int backgroundMasksOverlays;
in vec3 vColor;
out vec4 fColor;
`+mo+`
void main() {
	int id = 254;
	vec3 start = vColor;
	gl_FragDepth = 0.0;
	fColor = vec4(0.0, 0.0, 0.0, 0.0); //assume no hit: ID = 0
	float fid = float(id & 255)/ 255.0;
	vec3 backPosition = GetBackPosition(start);
	vec3 dir = normalize(backPosition - start);
	clipVolumeStart(start, backPosition);
	float len = length(backPosition - start);
	float lenVox = length((texVox * start) - (texVox * backPosition));
	if ((lenVox < 0.5) || (len > 3.0)) return;//discard; //length limit for parallel rays
	float sliceSize = len / lenVox; //e.g. if ray length is 1.0 and traverses 50 voxels, each voxel is 0.02 in unit cube
	float stepSize = sliceSize; //quality: larger step is faster traversal, but fewer samples
	float opacityCorrection = stepSize/sliceSize;
	dir = normalize(dir);
	vec4 samplePos = vec4(start.xyz, 0.0); //ray position
	float lenNoClip = len;
	bool isClip = false;
	vec4 clipPos = applyClip(dir, samplePos, len, isClip);
	if (isClip) fColor = vec4(samplePos.xyz, 253.0 / 255.0); //assume no hit: ID = 0
	//start: OPTIONAL fast pass: rapid traversal until first hit
	float stepSizeFast = sliceSize * 1.9;
	vec4 deltaDirFast = vec4(dir.xyz * stepSizeFast, stepSizeFast);
	while (samplePos.a <= len) {
		float val = texture(volume, samplePos.xyz).a;
		if (val > 0.01) {
			fColor = vec4(samplePos.rgb, fid);
			gl_FragDepth = frac2ndc(samplePos.xyz);
			break;
		}
		samplePos += deltaDirFast; //advance ray position
	}
	//end: fast pass
	if ((overlays < 1.0) || (backgroundMasksOverlays > 0)) {
		return; //background hit, no overlays
	}
	//overlay pass
	len = min(lenNoClip, samplePos.a); //only find overlay closer than background
	samplePos = vec4(start.xyz, 0.0); //ray position
	while (samplePos.a <= len) {
		float val = texture(overlay, samplePos.xyz).a;
		if (val > 0.01) {
			fColor = vec4(samplePos.rgb, fid);
			gl_FragDepth = frac2ndc(samplePos.xyz);
			return;
		}
		samplePos += deltaDirFast; //advance ray position
	}
	//if (fColor.a == 0.0) discard; //no hit in either background or overlays
	//you only get here if there is a hit with the background that is closer than any overlay
}`,P3=`#version 300 es
// an attribute is an input (in) to a vertex shader.
// It will receive data from a buffer
layout(location=0)  in vec3 a_position;
layout(location=1)  in vec3 a_color;
// A matrix to transform the positions by
uniform mat4 u_matrix;
out vec3 vColor;
// all shaders have a main function
void main() {
	// Multiply the position by the matrix.
	vec4 pos = vec4(a_position, 1.0);
	gl_Position = u_matrix * vec4(pos);
	vColor = a_color;
}
`,z3=`#version 300 es
precision highp float;
uniform vec4 u_color;
in vec3 vColor;
out vec4 outColor;
void main() {
	outColor = vec4(vColor, 1.0);
}`,_3=`#version 300 es
#line 1359
precision highp int;
precision highp float;
in vec3 vPos;
out vec2 TexCoord;
void main() {
	TexCoord = vPos.xy;
	vec2 viewCoord = (vPos.xy - 0.5) * 2.0;
	gl_Position = vec4((vPos.xy - 0.5) * 2.0, 0.0, 1.0);
}`,j3=`#version 300 es
precision highp int;
precision highp float;
in vec2 TexCoord;
out vec4 FragColor;
uniform float coordZ;
uniform lowp sampler3D in3D;
void main(void) {
 FragColor = texture(in3D, vec3(TexCoord.xy, coordZ));
}`,Fl=`#version 300 es
#line 286
precision highp int;
precision highp float;
in vec3 vPos;
out vec2 TexCoord;
void main() {
    TexCoord = vPos.xy;
    gl_Position = vec4( (vPos.xy-vec2(0.5,0.5))* 2.0, 0.0, 1.0);
}`,G3=`#version 300 es
#line 298
precision highp int;
precision highp float;
in vec2 TexCoord;
out vec4 FragColor;
uniform float coordZ;
uniform float dX;
uniform float dY;
uniform float dZ;
uniform highp sampler3D intensityVol;
void main(void) {
 vec3 vx = vec3(TexCoord.xy, coordZ);
 vec4 samp = texture(intensityVol,vx+vec3(+dX,+dY,+dZ));
 samp += texture(intensityVol,vx+vec3(+dX,+dY,-dZ));
 samp += texture(intensityVol,vx+vec3(+dX,-dY,+dZ));
 samp += texture(intensityVol,vx+vec3(+dX,-dY,-dZ));
 samp += texture(intensityVol,vx+vec3(-dX,+dY,+dZ));
 samp += texture(intensityVol,vx+vec3(-dX,+dY,-dZ));
 samp += texture(intensityVol,vx+vec3(-dX,-dY,+dZ));
 samp += texture(intensityVol,vx+vec3(-dX,-dY,-dZ));
 FragColor = samp*0.125;
}`,Y3=`#version 300 es
#line 298
precision highp int;
precision highp float;
in vec2 TexCoord;
out vec4 FragColor;
uniform float coordZ;
uniform float dX;
uniform float dY;
uniform float dZ;
uniform highp sampler3D intensityVol;
void main(void) {
 vec3 vx = vec3(TexCoord.xy, coordZ);
 vec4 XYZ = texture(intensityVol,vx+vec3(+dX,+dY,+dZ));
 vec4 OYZ = texture(intensityVol,vx+vec3(0.0,+dY,+dZ));
 vec4 xYZ = texture(intensityVol,vx+vec3(-dX,+dY,+dZ));
 vec4 XOZ = texture(intensityVol,vx+vec3(+dX,0.0,+dZ));
 vec4 OOZ = texture(intensityVol,vx+vec3(0.0,0.0,+dZ));
 vec4 xOZ = texture(intensityVol,vx+vec3(-dX,0.0,+dZ));
 vec4 XyZ = texture(intensityVol,vx+vec3(+dX,-dY,+dZ));
 vec4 OyZ = texture(intensityVol,vx+vec3(0.0,-dY,+dZ));
 vec4 xyZ = texture(intensityVol,vx+vec3(-dX,-dY,+dZ));

 vec4 XYO = texture(intensityVol,vx+vec3(+dX,+dY,0.0));
 vec4 OYO = texture(intensityVol,vx+vec3(0.0,+dY,0.0));
 vec4 xYO = texture(intensityVol,vx+vec3(-dX,+dY,0.0));
 vec4 XOO = texture(intensityVol,vx+vec3(+dX,0.0,0.0));
 vec4 OOO = texture(intensityVol,vx+vec3(0.0,0.0,0.0));
 vec4 xOO = texture(intensityVol,vx+vec3(-dX,0.0,0.0));
 vec4 XyO = texture(intensityVol,vx+vec3(+dX,-dY,0.0));
 vec4 OyO = texture(intensityVol,vx+vec3(0.0,-dY,0.0));
 vec4 xyO = texture(intensityVol,vx+vec3(-dX,-dY,0.0));

 vec4 XYz = texture(intensityVol,vx+vec3(+dX,+dY,-dZ));
 vec4 OYz = texture(intensityVol,vx+vec3(0.0,+dY,-dZ));
 vec4 xYz = texture(intensityVol,vx+vec3(-dX,+dY,-dZ));
 vec4 XOz = texture(intensityVol,vx+vec3(+dX,0.0,-dZ));
 vec4 OOz = texture(intensityVol,vx+vec3(0.0,0.0,-dZ));
 vec4 xOz = texture(intensityVol,vx+vec3(-dX,0.0,-dZ));
 vec4 Xyz = texture(intensityVol,vx+vec3(+dX,-dY,-dZ));
 vec4 Oyz = texture(intensityVol,vx+vec3(0.0,-dY,-dZ));
 vec4 xyz = texture(intensityVol,vx+vec3(-dX,-dY,-dZ));

 vec4 blurred = vec4 (0.0, 0.0, 0.0, 0.0);
 blurred.r = 2.0*(xOz.r +xOZ.r +xyO.r +xYO.r +xOO.r +XOz.r +XOZ.r +XyO.r +XYO.r +XOO.r) +xyz.r +xyZ.r +xYz.r +xYZ.r +Xyz.r +XyZ.r +XYz.r +XYZ.r;
 blurred.g = 2.0*(Oyz.r +OyZ.r +xyO.r +XyO.r +OyO.r +OYz.r +OYZ.r +xYO.r +XYO.r +OYO.r) +xyz.r +Xyz.r +xyZ.r +XyZ.r +xYz.r +XYz.r +xYZ.r +XYZ.r;
 blurred.b = 2.0*(Oyz.r +OYz.r +xOz.r +XOz.r +OOz.r +OyZ.r +OYZ.r +xOZ.r +XOZ.r +OOZ.r) +xyz.r +Xyz.r +xYz.r +XYz.r +xyZ.r +XyZ.r +XyZ.r +XYZ.r;
 blurred.a = 0.32*(abs(blurred.r)+abs(blurred.g)+abs(blurred.b));
 // 0.0357 = 1/28 to account for weights, rescale to 2**16,
 FragColor = 0.0357*blurred;
}`,sg=`
  gradientSample.a = log2(gradientSample.r*gradientSample.r + gradientSample.g*gradientSample.g + gradientSample.b*gradientSample.b + 1.922337562475971e-06) + 18.988706873717717;
`,H3=`#version 300 es
#line 323
precision highp int;
precision highp float;
in vec2 TexCoord;
out vec4 FragColor;
uniform float coordZ;
uniform float dX;
uniform float dY;
uniform float dZ;
uniform highp sampler3D intensityVol;
void main(void) {
  vec3 vx = vec3(TexCoord.xy, coordZ);
  //Neighboring voxels 'T'op/'B'ottom, 'A'nterior/'P'osterior, 'R'ight/'L'eft
  float TAR = texture(intensityVol,vx+vec3(+dX,+dY,+dZ)).r;
  float TAL = texture(intensityVol,vx+vec3(+dX,+dY,-dZ)).r;
  float TPR = texture(intensityVol,vx+vec3(+dX,-dY,+dZ)).r;
  float TPL = texture(intensityVol,vx+vec3(+dX,-dY,-dZ)).r;
  float BAR = texture(intensityVol,vx+vec3(-dX,+dY,+dZ)).r;
  float BAL = texture(intensityVol,vx+vec3(-dX,+dY,-dZ)).r;
  float BPR = texture(intensityVol,vx+vec3(-dX,-dY,+dZ)).r;
  float BPL = texture(intensityVol,vx+vec3(-dX,-dY,-dZ)).r;
  vec4 gradientSample = vec4 (0.0, 0.0, 0.0, 0.0);
  gradientSample.r = BAR+BAL+BPR+BPL -TAR-TAL-TPR-TPL;
  gradientSample.g = TPR+TPL+BPR+BPL -TAR-TAL-BAR-BAL;
  gradientSample.b = TAL+TPL+BAL+BPL -TAR-TPR-BAR-BPR;
${sg}
	// 0.04242020977371934 = 1/(log2(3*8) - log2(1/(255**2*8))) // 3*8 -> max for 1st order gradient
	gradientSample.a *= 0.04242020977371934;
  gradientSample.rgb = normalize(gradientSample.rgb);
  gradientSample.rgb = (gradientSample.rgb * 0.5)+0.5;
  FragColor = gradientSample;
}`,q3=`#version 300 es
#line 323
precision highp int;
precision highp float;
in vec2 TexCoord;
out vec4 FragColor;
uniform float coordZ;
uniform float dX;
uniform float dY;
uniform float dZ;
uniform float dX2;
uniform float dY2;
uniform float dZ2;
uniform highp sampler3D intensityVol;
void main(void) {
  vec3 vx = vec3(TexCoord.xy, coordZ);
  //Neighboring voxels 'T'op/'B'ottom, 'A'nterior/'P'osterior, 'R'ight/'L'eft
  vec4 TAR = texture(intensityVol,vx+vec3(+dX,+dY,+dZ));
  vec4 TAL = texture(intensityVol,vx+vec3(+dX,+dY,-dZ));
  vec4 TPR = texture(intensityVol,vx+vec3(+dX,-dY,+dZ));
  vec4 TPL = texture(intensityVol,vx+vec3(+dX,-dY,-dZ));
  vec4 BAR = texture(intensityVol,vx+vec3(-dX,+dY,+dZ));
  vec4 BAL = texture(intensityVol,vx+vec3(-dX,+dY,-dZ));
  vec4 BPR = texture(intensityVol,vx+vec3(-dX,-dY,+dZ));
  vec4 BPL = texture(intensityVol,vx+vec3(-dX,-dY,-dZ));
  vec4 T = texture(intensityVol,vx+vec3(+dX2,0.0,0.0));
  vec4 A = texture(intensityVol,vx+vec3(0.0,+dY2,0.0));
  vec4 R = texture(intensityVol,vx+vec3(0.0,0.0,+dZ2));
  vec4 B = texture(intensityVol,vx+vec3(-dX2,0.0,0.0));
  vec4 P = texture(intensityVol,vx+vec3(0.0,-dY2,0.0));
  vec4 L = texture(intensityVol,vx+vec3(0.0,0.0,-dZ2));
  vec4 gradientSample = vec4 (0.0, 0.0, 0.0, 0.0);
  gradientSample.r = -4.0*B.r +8.0*(BAR.r+BAL.r+BPR.r+BPL.r) -8.0*(TAR.r+TAL.r+TPR.r+TPL.r) +4.0*T.r;
  gradientSample.g = -4.0*P.g +8.0*(TPR.g+TPL.g+BPR.g+BPL.g) -8.0*(TAR.g+TAL.g+BAR.g+BAL.g) +4.0*A.g;
  gradientSample.b = -4.0*L.b +8.0*(TAL.b+TPL.b+BAL.b+BPL.b) -8.0*(TAR.b+TPR.b+BAR.b+BPR.b) +4.0*R.b;
${sg}
	gradientSample.a *= 0.0325;
  gradientSample.rgb = normalize(gradientSample.rgb);
  gradientSample.rgb =  (gradientSample.rgb * 0.5)+0.5;
  FragColor = gradientSample;
}`,K3=new Float32Array([-1,-1,-1,.28,.28,.28,-1,-1,-1,.28,.28,.28,-1,1,-1,.28,.28,.28,1,-1,-1,.28,.28,.28,1,1,-1,.28,.28,.28,1,1,-1,.28,.28,.28,-1,-1,1,.8,.8,.8,-1,-1,1,.8,.8,.8,1,-1,1,.8,.8,.8,-1,1,1,.8,.8,.8,1,1,1,.8,.8,.8,1,1,1,.8,.8,.8,-1,1,-1,0,0,.74,-1,1,-1,0,0,.74,-1,1,1,0,0,.74,1,1,-1,0,0,.74,1,1,1,0,0,.74,1,1,1,0,0,.74,-1,-1,-1,.42,0,.42,-1,-1,-1,.42,0,.42,1,-1,-1,.42,0,.42,-1,-1,1,.42,0,.42,1,-1,1,.42,0,.42,1,-1,1,.42,0,.42,-1,-1,-1,.64,0,0,-1,-1,-1,.64,0,0,-1,-1,1,.64,0,0,-1,1,-1,.64,0,0,-1,1,1,.64,0,0,-1,1,1,.64,0,0,1,-1,-1,0,.5,0,1,-1,-1,0,.5,0,1,1,-1,0,.5,0,1,-1,1,0,.5,0,1,1,1,0,.5,0,1,1,1,0,.5,0,-.45,1,-.8,0,0,0,-.45,1,-.8,0,0,0,-.45,1,.8,0,0,0,-.25,1,-.8,0,0,0,-.25,1,.8,0,0,0,-.25,1,.8,0,0,0,-.25,1,.6,0,0,0,-.25,1,.6,0,0,0,-.25,1,.8,0,0,0,.45,1,.6,0,0,0,.25,1,.8,0,0,0,.25,1,.8,0,0,0,.25,1,.1,0,0,0,.25,1,.1,0,0,0,.25,1,.6,0,0,0,.45,1,.1,0,0,0,.45,1,.6,0,0,0,.45,1,.6,0,0,0,-.25,1,-.1,0,0,0,-.25,1,-.1,0,0,0,-.25,1,.1,0,0,0,.25,1,-.1,0,0,0,.45,1,.1,0,0,0,.45,1,.1,0,0,0,.45,-1,-.8,0,0,0,.45,-1,-.8,0,0,0,.05,-1,.8,0,0,0,.25,-1,-.8,0,0,0,-.15,-1,.8,0,0,0,-.15,-1,.8,0,0,0,-.25,-1,-.8,0,0,0,-.25,-1,-.8,0,0,0,.05,-1,.8,0,0,0,-.45,-1,-.8,0,0,0,-.15,-1,.8,0,0,0,-.15,-1,.8,0,0,0,.13,-1,-.3,0,0,0,.13,-1,-.3,0,0,0,.07,-1,-.1,0,0,0,-.33,-1,-.3,0,0,0,-.27,-1,-.1,0,0,0,-.27,-1,-.1,0,0,0,-.45,.6,1,0,0,0,-.45,.6,1,0,0,0,-.45,.4,1,0,0,0,-.25,.8,1,0,0,0,-.25,.4,1,0,0,0,-.25,.4,1,0,0,0,-.25,.8,1,0,0,0,-.25,.8,1,0,0,0,-.25,.6,1,0,0,0,.25,.8,1,0,0,0,.45,.6,1,0,0,0,.45,.6,1,0,0,0,.25,.8,1,0,0,0,.25,.8,1,0,0,0,.25,-.1,1,0,0,0,.45,.6,1,0,0,0,.45,.1,1,0,0,0,.45,.1,1,0,0,0,-.25,.1,1,0,0,0,-.25,.1,1,0,0,0,-.45,-.1,1,0,0,0,.25,.1,1,0,0,0,.25,-.1,1,0,0,0,.25,-.1,1,0,0,0,-.45,-.1,1,0,0,0,-.45,-.1,1,0,0,0,-.45,-.6,1,0,0,0,-.25,-.1,1,0,0,0,-.25,-.8,1,0,0,0,-.25,-.8,1,0,0,0,-.25,-.6,1,0,0,0,-.25,-.6,1,0,0,0,-.25,-.8,1,0,0,0,.45,-.6,1,0,0,0,.25,-.8,1,0,0,0,.25,-.8,1,0,0,0,.25,-.4,1,0,0,0,.25,-.4,1,0,0,0,.25,-.6,1,0,0,0,.45,-.4,1,0,0,0,.45,-.6,1,0,0,0,.45,-.6,1,0,0,0,-.1,-.8,-1,0,0,0,-.1,-.8,-1,0,0,0,-.1,.8,-1,0,0,0,.1,-.8,-1,0,0,0,.1,.8,-1,0,0,0,.1,.8,-1,0,0,0,-1,-.45,-.8,0,0,0,-1,-.45,-.8,0,0,0,-1,-.45,.8,0,0,0,-1,-.25,-.8,0,0,0,-1,-.25,.8,0,0,0,-1,-.25,.8,0,0,0,-1,-.25,-.8,0,0,0,-1,-.25,-.8,0,0,0,-1,-.25,-.6,0,0,0,-1,.45,-.8,0,0,0,-1,.45,-.6,0,0,0,-1,.45,-.6,0,0,0,1,.45,-.8,0,0,0,1,.45,-.8,0,0,0,1,.45,.8,0,0,0,1,.25,-.8,0,0,0,1,.25,.8,0,0,0,1,.25,.8,0,0,0,1,.25,.6,0,0,0,1,.25,.6,0,0,0,1,.25,.8,0,0,0,1,-.45,.6,0,0,0,1,-.25,.8,0,0,0,1,-.25,.8,0,0,0,1,-.25,.1,0,0,0,1,-.25,.1,0,0,0,1,-.25,.6,0,0,0,1,-.45,.1,0,0,0,1,-.45,.6,0,0,0,1,-.45,.6,0,0,0,1,.25,-.1,0,0,0,1,.25,-.1,0,0,0,1,.25,.1,0,0,0,1,-.25,-.1,0,0,0,1,-.45,.1,0,0,0,1,-.45,.1,0,0,0,1,-.25,-.8,0,0,0,1,-.25,-.8,0,0,0,1,-.05,-.1,0,0,0,1,-.45,-.8,0,0,0,1,-.25,-.1,0,0,0,1,-.25,-.1,0,0,0]),We=class{constructor(e,i,n,r,o=null,l=null){k(this,"sphereIdx",[]),k(this,"sphereVtx",[]),k(this,"renderShaders",[]),k(this,"isVisible",!0),k(this,"isPickable",!0),k(this,"vertexBuffer"),k(this,"indexCount"),k(this,"indexBuffer"),k(this,"vao"),k(this,"mode"),k(this,"glFlags",0),k(this,"id"),k(this,"colorId"),k(this,"modelMatrix",Ge()),k(this,"scale",[1,1,1]),k(this,"position",[0,0,0]),k(this,"rotation",[0,0,0]),k(this,"rotationRadians",0),k(this,"extentsMin",[]),k(this,"extentsMax",[]),k(this,"furthestVertexFromOrigin"),k(this,"originNegate"),k(this,"fieldOfViewDeObliqueMM"),k(this,"mm"),this.vertexBuffer=i,this.indexCount=r,this.indexBuffer=o,this.vao=l,this.mode=n,this.id=e,this.colorId=[(e>>0&255)/255,(e>>8&255)/255,(e>>16&255)/255,(e>>24&255)/255]}};k(We,"BLEND",1);k(We,"CULL_FACE",2);k(We,"CULL_FRONT",4);k(We,"CULL_BACK",8);k(We,"ENABLE_DEPTH_TEST",16);k(We,"generateCrosshairs",function(t,e,i,n,r,o,l=20,h=0){const f=We.generateCrosshairsGeometry(t,i,n,r,o,l,h);return new We(e,f.vertexBuffer,t.TRIANGLES,f.indexCount,f.indexBuffer,f.vao)});k(We,"generateCrosshairsGeometry",function(t,e,i,n,r,o=20,l=0){const h=[],f=[],u=r*l;if(u<=0){let v=he(i[0],e[1],e[2]),x=he(n[0],e[1],e[2]);We.makeCylinder(h,f,v,x,r,o),v=he(e[0],i[1],e[2]),x=he(e[0],n[1],e[2]),We.makeCylinder(h,f,v,x,r,o),v=he(e[0],e[1],i[2]),x=he(e[0],e[1],n[2]),We.makeCylinder(h,f,v,x,r,o)}else{let v=he(i[0],e[1],e[2]),x=he(e[0]-u,e[1],e[2]);We.makeCylinder(h,f,v,x,r,o,!1),v=he(e[0]+u,e[1],e[2]),x=he(n[0],e[1],e[2]),We.makeCylinder(h,f,v,x,r,o,!1),v=he(e[0],i[1],e[2]),x=he(e[0],e[1]-u,e[2]),We.makeCylinder(h,f,v,x,r,o,!1),v=he(e[0],e[1]+u,e[2]),x=he(e[0],n[1],e[2]),We.makeCylinder(h,f,v,x,r,o,!1),v=he(e[0],e[1],i[2]),x=he(e[0],e[1],e[2]-u),We.makeCylinder(h,f,v,x,r,o,!1),v=he(e[0],e[1],e[2]+u),x=he(e[0],e[1],n[2]),We.makeCylinder(h,f,v,x,r,o,!1)}const m=t.createBuffer();if(m===null)throw new Error("could not instantiate vertex buffer");t.bindBuffer(t.ARRAY_BUFFER,m),t.bufferData(t.ARRAY_BUFFER,new Float32Array(h),t.STATIC_DRAW);const g=t.createBuffer();if(g===null)throw new Error("could not instantiate index buffer");t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,g),t.bufferData(t.ELEMENT_ARRAY_BUFFER,new Uint32Array(f),t.STATIC_DRAW);const p=t.createVertexArray();return t.bindVertexArray(p),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,g),t.bindBuffer(t.ARRAY_BUFFER,m),t.enableVertexAttribArray(0),t.vertexAttribPointer(0,3,t.FLOAT,!1,0,0),t.bindVertexArray(null),{vertexBuffer:m,indexBuffer:g,indexCount:f.length,vao:p}});k(We,"getFirstPerpVector",function(t){const e=he(0,0,0);return t[0]===0?e[0]=1:t[1]===0?e[1]=1:t[2]===0?e[2]=1:(e[0]=t[2],e[1]=t[2],e[2]=-(t[0]+t[1]),Hi(e,e)),e});k(We,"subdivide",function(t,e){let i=t.length/3,n=e.length/3;const r=n,o=ot(),l=ot();for(let h=0;h<r;h++){const f=e[h*3+0],u=e[h*3+1],m=e[h*3+2],g=he(t[f*3+0],t[f*3+1],t[f*3+2]),p=he(t[u*3+0],t[u*3+1],t[u*3+2]),v=he(t[m*3+0],t[m*3+1],t[m*3+2]);Fn(o,g,p),Hi(l,o),t.push(...l),Fn(o,p,v),Hi(l,o),t.push(...l),Fn(o,g,v),Hi(l,o),t.push(...l);let x=[i,i+1,i+2];e.push(...x),x=[f,i,i+2],e.push(...x),x=[i,u,i+1],e.push(...x),e[h*3+0]=i+2,e[h*3+1]=i+1,e[h*3+2]=m,n=n+3,i=i+3}});k(We,"weldVertices",function(t,e){const i=t.length/3;let n=0;const r=new Int32Array(i);for(let h=0;h<i-1;h++){if(r[h]!==0)continue;r[h]=n;let f=h*3;const u=t[f],m=t[f+1],g=t[f+2];for(let p=h+1;p<i;p++)f+=3,u===t[f]&&m===t[f+1]&&g===t[f+2]&&(r[p]=n);n++}if(n===i)return t;const o=e.length;for(let h=0;h<o;h++)e[h]=r[e[h]];const l=t.slice(0,n*3-1);for(let h=0;h<i-1;h++){const f=h*3,u=r[h]*3;l[u]=t[f],l[u+1]=t[f+1],l[u+2]=t[f+2]}return l});k(We,"makeSphere",function(t,e,i,n=[0,0,0]){let r=[0,0,1,.894,0,.447,.276,.851,.447,-.724,.526,.447,-.724,-.526,.447,.276,-.851,.447,.724,.526,-.447,-.276,.851,-.447,-.894,0,-.447,-.276,-.851,-.447,.724,-.526,-.447,0,0,-1];const o=[0,1,2,0,2,3,0,3,4,0,4,5,0,5,1,7,6,11,8,7,11,9,8,11,10,9,11,6,10,11,6,2,1,7,3,2,8,4,3,9,5,4,10,1,5,6,7,2,7,8,3,8,9,4,9,10,5,10,6,1];We.subdivide(r,o),We.subdivide(r,o),r=We.weldVertices(r,o);for(let u=0;u<r.length;u++)r[u]=r[u]*i;const l=r.length/3;let h=0;for(let u=0;u<l;u++)r[h]=r[h]+n[0],h++,r[h]=r[h]+n[1],h++,r[h]=r[h]+n[2],h++;const f=Math.floor(t.length/3);for(let u=0;u<o.length;u++)o[u]=o[u]+f;e.push(...o),t.push(...r)});k(We,"makeCylinder",function(t,e,i,n,r,o=20,l=!0){o<3&&(o=3);const h=ot();ct(h,n,i),Hi(h,h);const f=We.getFirstPerpVector(h),u=ot();kl(u,h,f),Hi(u,u);let m=2*o,g=2*o;l&&(g+=2*o,m+=2);const p=Math.floor(t.length/3),v=new Uint32Array(g*3),x=new Float32Array(m*3);function w(D,R){x[D*3+0]=R[0],x[D*3+1]=R[1],x[D*3+2]=R[2]}function b(D,R,N,M){v[D*3+0]=R+p,v[D*3+1]=N+p,v[D*3+2]=M+p}const S=2*o,C=S+1;l&&(w(S,i),w(C,n));const E=ot(),T=ot();for(let D=0;D<o;D++){const R=Math.cos(D/o*2*Math.PI),N=Math.sin(D/o*2*Math.PI);E[0]=r*(R*f[0]+N*u[0]),E[1]=r*(R*f[1]+N*u[1]),E[2]=r*(R*f[2]+N*u[2]),Fn(T,i,E),w(D,T),Fn(T,n,E),w(D+o,T);let M=0;D<o-1&&(M=D+1),b(D*2,D,M,D+o),b(D*2+1,M,M+o,D+o),l&&(b(o*2+D,D,S,M),b(o*2+D+o,C,D+o,M+o))}e.push(...v),t.push(...x)});k(We,"makeColoredCylinder",function(t,e,i,n,r,o,l=[192,0,0,255],h=20,f=!1){let u=t.length/3;We.makeCylinder(t,e,n,r,o,h,f),u=t.length/3-u;const m=[];for(let g=0;g<u*4-1;g+=4)m[g]=l[0],m[g+1]=l[1],m[g+2]=l[2],m[g+3]=l[3];i.push(...m)});k(We,"makeColoredSphere",function(t,e,i,n,r=[0,0,0],o=[0,0,192,255]){let l=t.length/3;We.makeSphere(t,e,n,r),l=t.length/3-l;const h=[];for(let f=0;f<l*4-1;f+=4)h[f]=o[0],h[f+1]=o[1],h[f+2]=o[2],h[f+3]=o[3];i.push(...h)});var Bn=We,jl={};sc(jl,{$itksnap:()=>Q3,$slicer3d:()=>X3,actc:()=>Z3,afni_blues_inv:()=>cx,afni_reds_inv:()=>ux,batlow:()=>W3,bcgwhw:()=>$3,bcgwhw_dark:()=>J3,blue:()=>n4,blue2cyan:()=>i4,blue2magenta:()=>t4,blue2red:()=>e4,bluegrn:()=>s4,bone:()=>a4,bronze:()=>r4,cet_l17:()=>o4,cividis:()=>l4,cool:()=>c4,copper:()=>h4,copper2:()=>u4,ct_airways:()=>f4,ct_artery:()=>d4,ct_bones:()=>m4,ct_brain:()=>p4,ct_brain_gray:()=>g4,ct_cardiac:()=>A4,ct_head:()=>v4,ct_kidneys:()=>x4,ct_liver:()=>y4,ct_muscles:()=>w4,ct_scalp:()=>b4,ct_skull:()=>C4,ct_soft:()=>S4,ct_soft_tissue:()=>E4,ct_surface:()=>T4,ct_vessels:()=>M4,ct_w_contrast:()=>D4,cubehelix:()=>N4,electric_blue:()=>R4,freesurfer:()=>U4,ge_color:()=>I4,gold:()=>F4,gray:()=>V4,green:()=>B4,green2cyan:()=>L4,green2orange:()=>O4,hot:()=>P4,hotiron:()=>k4,hsv:()=>z4,inferno:()=>_4,jet:()=>j4,kry:()=>G4,linspecer:()=>Y4,lipari:()=>H4,magma:()=>q4,mako:()=>K4,navia:()=>Q4,nih:()=>X4,plasma:()=>Z4,random:()=>W4,red:()=>J4,redyell:()=>$4,rocket:()=>ex,roi_i256:()=>hx,surface:()=>tx,thermal:()=>ix,turbo:()=>sx,violet:()=>nx,viridis:()=>ax,warm:()=>rx,winter:()=>ox,x_rain:()=>lx});var Q3={R:[0,255,0,0,255,0,255,255,0,205,210,102,0,0,46,255,106,221,233,165,255,147,218,75,255,60,255,255,218,0,188,255,255,222,127,139,124,255,70,0,238,238,240,245,184,32,255,25,112,34,248,245,255,144,173,65,255,250,128,50,244,255,123,255,173,255,127,255,143,220,253,255,0,0,128,255,250,148,178,255,135,100,240,250,255,107,135,0,139,245,186,255,255,0,210,255,47,72,175,128,176,255,139,240,255,216,119,219,72,255,199,154,189,240,230,0,85,64,153,205,250,95,0,255,224,176,138,30,240,152,160],G:[0,0,255,0,255,255,0,239,0,133,180,205,0,139,139,228,90,160,150,42,250,112,112,0,182,179,235,228,165,128,143,105,218,184,255,69,252,255,130,100,130,232,255,222,134,178,20,25,128,139,248,255,160,238,255,105,99,240,0,205,164,255,104,165,216,192,255,140,188,20,245,250,206,255,0,250,128,0,34,127,206,149,230,235,245,142,206,0,0,245,85,228,222,191,105,248,79,61,238,128,224,240,0,255,215,191,136,112,209,0,21,205,183,248,230,250,107,224,50,92,250,158,128,69,255,196,43,144,128,251,82],B:[0,0,0,255,0,255,255,213,205,63,140,170,128,139,87,225,205,221,122,42,250,219,214,130,193,113,205,196,32,128,143,180,185,135,0,19,0,224,180,0,238,170,240,179,11,170,147,112,144,34,255,250,122,144,47,225,71,230,0,50,96,240,238,0,230,203,212,0,143,60,230,240,209,127,128,205,114,211,34,80,235,237,140,215,238,35,250,139,139,220,211,181,173,255,30,220,79,139,238,0,230,245,0,255,0,216,153,147,204,255,133,50,107,255,250,154,47,208,204,92,210,160,0,0,255,222,226,255,128,152,45],A:[0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255],I:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130]},X3={labels:["background","tissue","bone","skin","connective tissue","blood","organ","mass","muscle","foreign object","waste","teeth","fat","gray matter","white matter","nerve","vein","artery","capillary","ligament","tendon","cartilage","meniscus","lymph node","lymphatic vessel","cerebro-spinal fluid","bile","urine","feces","gas","fluid","edema","bleeding","necrosis","clot","embolism","head","central nervous system","brain","gray matter of brain","telencephalon","cerebral cortex","right frontal lobe","left frontal lobe","right temporal lobe","left temporal lobe","right parietal lobe","left parietal lobe","right occipital lobe","left occipital lobe","right insular lobe","left insular lobe","right limbic lobe","left limbic lobe","right striatum","left striatum","right caudate nucleus","left caudate nucleus","right putamen","left putamen","right pallidum","left pallidum","right amygdaloid complex","left amygdaloid complex","diencephalon","thalamus","right thalamus","left thalamus","pineal gland","midbrain","substantia nigra","right substantia nigra","left substantia nigra","cerebral white matter","right superior longitudinal fasciculus","left superior longitudinal fasciculus","right inferior longitudinal fasciculus","left inferior longitudinal fasciculus","right arcuate fasciculus","left arcuate fasciculus","right uncinate fasciculus","left uncinate fasciculus","right cingulum bundle","left cingulum bundle","projection fibers","right corticospinal tract","left corticospinal tract","right optic radiation","left optic radiation","right medial lemniscus","left medial lemniscus","right superior cerebellar peduncle","left superior cerebellar peduncle","right middle cerebellar peduncle","left middle cerebellar peduncle","right inferior cerebellar peduncle","left inferior cerebellar peduncle","optic chiasm","right optic tract","left optic tract","right fornix","left fornix","commissural fibers","corpus callosum","posterior commissure","cerebellar white matter","CSF space","ventricles of brain","right lateral ventricle","left lateral ventricle","right third ventricle","left third ventricle","cerebral aqueduct","fourth ventricle","subarachnoid space","spinal cord","gray matter of spinal cord","white matter of spinal cord","endocrine system of brain","pituitary gland","adenohypophysis","neurohypophysis","meninges","dura mater","arachnoid","pia mater","muscles of head","salivary glands","lips","nose","tongue","soft palate","right inner ear","left inner ear","right external ear","left external ear","right middle ear","left middle ear","right eyeball","left eyeball","skull","right frontal bone","left frontal bone","right parietal bone","left parietal bone","right temporal bone","left temporal bone","right sphenoid bone","left sphenoid bone","right ethmoid bone","left ethmoid bone","occipital bone","maxilla","right zygomatic bone","right lacrimal bone","vomer bone","right palatine bone","left palatine bone","mandible","neck","muscles of neck","pharynx","larynx","thyroid gland","right parathyroid glands","left parathyroid glands","skeleton of neck","hyoid bone","cervical vertebral column","thorax","trachea","bronchi","right lung","left lung","superior lobe of right lung","superior lobe of left lung","middle lobe of right lung","inferior lobe of right lung","inferior lobe of left lung","pleura","heart","right atrium","left atrium","atrial septum","ventricular septum","right ventricle of heart","left ventricle of heart","mitral valve","tricuspid valve","aortic valve","pulmonary valve","aorta","pericardium","pericardial cavity","esophagus","thymus","mediastinum","skin of thoracic wall","muscles of thoracic wall","skeleton of thorax","thoracic vertebral column","ribs","sternum","right clavicle","left clavicle","abdominal cavity","abdomen","peritoneum","omentum","peritoneal cavity","retroperitoneal space","stomach","duodenum","small bowel","colon","anus","liver","biliary tree","gallbladder","pancreas","spleen","urinary system","right kidney","left kidney","right ureter","left ureter","urinary bladder","urethra","right adrenal gland","left adrenal gland","female internal genitalia","uterus","right fallopian tube","left fallopian tube","right ovary","left ovary","vagina","male internal genitalia","prostate","right seminal vesicle","left seminal vesicle","right deferent duct","left deferent duct","skin of abdominal wall","muscles of abdominal wall","skeleton of abdomen","lumbar vertebral column","female external genitalia","male external genitalia","skeleton of upper limb","muscles of upper limb","right upper limb","left upper limb","right shoulder","left shoulder","right arm"],R:[0,128,241,177,111,216,221,144,192,220,78,255,230,200,250,244,0,216,183,183,152,111,178,68,111,85,0,214,78,218,170,140,188,216,145,150,177,244,250,200,68,128,83,83,162,162,141,141,182,182,188,188,154,154,177,177,30,30,210,210,48,48,98,98,69,166,122,122,253,145,46,0,0,250,127,127,159,159,125,125,106,106,154,154,126,201,201,78,78,174,174,139,139,148,148,186,186,99,156,156,64,64,138,97,126,194,85,88,88,88,88,88,88,88,88,244,200,250,82,57,60,92,255,255,255,255,201,70,188,177,166,182,229,229,174,174,201,201,194,194,241,203,203,229,229,255,255,209,209,248,248,255,196,255,255,255,242,242,222,177,213,184,150,62,62,62,242,250,255,177,182,175,197,197,172,172,202,224,224,255,206,210,203,233,195,181,152,159,166,218,225,224,255,184,211,47,255,173,188,255,226,253,244,205,205,186,177,255,234,204,180,216,255,205,204,255,221,0,139,249,157,203,185,185,247,247,222,124,249,249,244,255,255,227,213,213,193,216,230,245,245,241,241,177,171,217,212,185,185,198,194,177,177,177,177,177],G:[0,174,214,122,184,101,130,238,104,245,63,250,220,200,250,214,151,101,156,214,189,184,212,172,197,188,145,230,63,255,250,224,65,191,60,98,122,214,250,200,131,174,146,146,115,115,93,93,166,166,135,135,150,150,140,140,111,111,157,157,129,129,153,153,110,113,101,101,135,92,101,108,108,250,150,150,116,116,102,102,174,174,146,146,126,160,160,152,152,140,140,126,126,120,120,135,135,106,171,171,123,123,95,113,161,195,188,106,106,106,106,106,106,106,106,214,200,250,174,157,143,162,244,244,244,244,121,163,91,122,84,105,147,147,122,122,112,112,142,142,213,179,179,204,204,243,243,185,185,223,223,230,172,255,250,237,217,217,198,122,124,105,208,162,162,162,206,210,255,122,228,216,165,165,138,138,164,186,186,245,110,115,108,138,100,85,55,63,70,123,130,97,244,122,171,150,244,121,95,239,202,232,217,179,179,124,122,255,234,142,119,132,253,167,168,224,130,145,150,180,108,136,102,102,182,182,154,186,186,186,170,181,190,153,141,141,123,146,158,172,172,172,172,124,85,198,188,135,135,175,98,122,122,122,122,122],B:[0,128,145,101,210,79,101,144,88,20,0,220,70,235,210,49,206,79,220,211,207,210,242,100,131,255,30,130,0,255,250,228,28,216,66,83,101,49,225,215,98,128,164,164,105,105,137,137,110,110,166,166,201,201,190,190,85,85,166,166,126,126,112,112,53,137,38,38,192,109,131,112,112,225,88,88,163,163,154,154,155,155,83,83,55,133,133,141,141,103,103,177,177,72,72,135,135,24,108,108,147,147,74,158,197,164,255,215,215,215,215,215,215,215,215,49,215,225,128,110,83,109,209,209,209,209,77,117,95,101,94,107,118,118,90,90,73,73,0,0,144,77,77,109,109,152,152,85,85,131,131,138,68,167,160,145,123,123,101,101,109,108,243,114,114,114,142,139,207,101,255,244,145,145,115,115,140,162,162,217,84,89,81,112,73,57,13,27,38,97,104,76,209,154,143,103,209,88,76,172,134,158,154,108,108,161,101,220,194,178,153,105,229,142,143,199,101,30,98,111,162,116,83,83,164,164,132,223,150,150,147,158,165,130,113,113,103,127,140,147,147,151,151,92,68,131,102,134,134,125,79,101,101,101,101,101],A:[0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255],I:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255]},Z3={R:[0,0,24,248,255],G:[0,0,177,254,0],B:[0,136,0,0,0],A:[0,32,64,78,128],I:[0,64,128,156,255]},W3={R:[1,10,15,17,21,27,36,49,65,82,99,118,140,161,183,203,222,238,248,253,253,253,252,250],G:[25,42,56,68,79,88,97,105,111,116,122,127,133,138,142,146,150,155,162,170,178,186,195,204],B:[89,92,95,96,98,98,96,91,83,74,64,55,46,43,49,62,79,100,126,151,175,199,223,250],A:[0,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64],I:[0,11,22,33,44,55,66,77,88,99,110,121,133,144,155,166,177,188,199,210,221,232,243,255]},J3={R:[0,248,242,235,229,222,212,202,193,183,173,145,117,78,39,0,0,0,0,0,0,64,128,191,255,255,255,255,255,238,221,204,214,224,235,245,255,249,242,236,229,223,217,210,204,197,191,184,176,169,161,154,146,139,132,124,117,109,102,0],G:[0,251,247,243,239,235,235,235,235,235,235,216,197,174,150,127,153,178,204,229,255,255,255,255,255,220,185,150,115,77,38,0,31,61,92,122,153,138,122,107,92,77,61,46,31,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0],B:[0,254,253,252,251,250,251,252,253,254,255,226,198,132,66,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,40,80,120,160,200,199,198,197,196,196,195,194,193,192,191,184,176,169,161,154,146,139,132,124,117,109,102,0],A:[256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256],I:[0,4,8,12,16,20,24,28,32,36,40,44,48,52,56,60,64,68,72,76,80,84,88,92,96,100,104,108,112,116,120,124,128,132,136,140,144,148,152,156,160,164,168,172,176,180,184,188,192,196,200,204,208,212,216,220,224,228,232,236,240,244,248,255]},$3={R:[255,248,242,235,229,222,212,202,193,183,173,145,117,78,39,0,0,0,0,0,0,64,128,191,255,255,255,255,255,238,221,204,214,224,235,245,255,249,242,236,229,223,217,210,204,197,191,184,176,169,161,154,146,139,132,124,117,109,102,0],G:[255,251,247,243,239,235,235,235,235,235,235,216,197,174,150,127,153,178,204,229,255,255,255,255,255,220,185,150,115,77,38,0,31,61,92,122,153,138,122,107,92,77,61,46,31,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0],B:[255,254,253,252,251,250,251,252,253,254,255,226,198,132,66,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,40,80,120,160,200,199,198,197,196,196,195,194,193,192,191,184,176,169,161,154,146,139,132,124,117,109,102,0],A:[256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256],I:[0,4,8,12,16,20,24,28,32,36,40,44,48,52,56,60,64,68,72,76,80,84,88,92,96,100,104,108,112,116,120,124,128,132,136,140,144,148,152,156,160,164,168,172,176,180,184,188,192,196,200,204,208,212,216,220,224,228,232,236,240,244,248,255]},e4={R:[0,0,0,0,196,255],G:[0,32,128,128,128,32],B:[0,255,196,0,0,0],A:[0,128,64,64,64,128],I:[0,1,64,128,192,255]},t4={R:[0,255],G:[0,0],B:[255,255],A:[0,128],I:[0,255]},i4={R:[0,0],G:[0,255],B:[255,255],A:[0,128],I:[0,255]},s4={R:[0,0,0,0],G:[0,1,128,255],B:[0,222,127,32],A:[0,0,64,128],I:[0,1,128,255]},n4={R:[0,0,0],G:[0,0,0],B:[0,128,255],A:[0,64,128],I:[0,128,255]},a4={R:[0,103,255],G:[0,126,255],B:[0,165,255],A:[0,76,128],I:[0,153,255]},r4={R:[0,43,103,199,216,255],G:[0,0,37,155,213,255],B:[0,0,20,97,201,255],A:[0,44,48,54,56,56],I:[0,64,128,196,240,255]},o4={R:[0,9,24,33,40,46,52,57,62,66,70,74,78,81,85,88,91,94,98,101,103,106,109,112,114,117,119,121,124,126,128,130,133,135,137,139,141,143,145,147,149,151,153,155,157,159,161,163,164,166,168,169,171,172,174,175,177,178,180,181,183,184,186,187,189,190,191,193,194,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,222,223,224,224,225,226,226,227,228,228,229,229,230,231,231,232,233,233,234,234,235,235,236,236,236,237,237,237,238,238,238,239,239,239,240,240,240,241,241,241,242,242,242,243,243,243,243,243,243,243,243,244,244,244,244,244,244,244,244,244,244,244,245,245,245,245,245,245,245,245,245,245,245,245,245,245,245,245,244,244,244,244,244,244,244,244,244,244,244,244,244,244,244,243,243,243,243,243,243,243,243,243,243,243,243,242,242,242,242,242,242,242,242,241,242,242,242,242,242,242,242,242,242,242,242,242,242,242,242,242,242,242,242,242,242,242,242,243,243,244,244,245,246,246,247,247,248,249,249,250,250,251,251,252,252,253,253,254,254,254],G:[42,41,41,41,40,40,40,39,39,39,38,38,37,37,36,36,35,35,34,34,33,32,32,31,30,30,30,30,29,29,29,29,28,28,28,27,27,27,26,26,26,25,25,25,24,24,24,24,24,25,25,26,27,27,28,28,29,30,30,31,31,32,33,33,34,34,35,36,36,37,38,39,40,42,43,44,45,47,48,49,50,51,53,54,55,56,57,58,59,60,62,63,64,65,66,68,69,71,72,73,75,76,77,79,80,81,83,84,85,87,88,89,90,92,93,94,95,97,98,100,101,102,104,105,107,108,109,111,112,113,115,116,117,119,120,121,122,124,125,126,128,129,130,132,133,134,136,137,138,140,141,142,144,145,146,147,149,150,151,153,154,155,156,158,159,160,161,163,164,165,167,168,169,170,172,173,174,175,176,178,179,180,181,183,184,185,186,187,189,190,191,192,193,194,196,197,198,199,200,201,203,204,205,206,207,208,209,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,228,229,230,231,232,233,234,235,236,237,238,238,239,240,241,241,242,243,244,244,245,246,247,248,248,249,250,251,251,252,253,254,255],B:[167,167,166,166,166,165,165,165,164,164,164,163,163,162,162,162,161,161,161,160,160,160,159,159,158,158,157,157,156,155,155,154,154,153,153,152,151,151,150,150,149,149,148,147,147,146,146,145,144,144,143,143,142,141,141,140,139,139,138,137,137,136,135,135,134,133,133,132,131,131,130,130,129,128,128,127,127,126,125,125,124,124,123,123,122,121,121,120,119,119,118,118,117,116,116,116,115,115,114,114,113,113,113,112,112,111,111,110,110,109,109,109,108,108,107,107,106,106,106,106,106,105,105,105,105,105,105,105,104,104,104,104,104,103,103,103,103,103,102,102,102,103,103,103,103,104,104,104,104,104,105,105,105,105,106,106,106,106,106,107,107,107,107,108,108,109,110,111,111,112,113,113,114,115,115,116,117,117,118,119,120,120,121,122,122,123,124,125,126,128,129,130,131,132,134,135,136,137,138,140,141,142,143,144,146,147,148,149,150,152,153,155,157,158,160,162,163,165,167,168,170,172,173,175,177,178,180,182,183,185,187,188,190,193,196,199,201,204,207,210,212,215,218,221,224,226,229,232,235,238,240,243,246,249,252,255],A:[0,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64],I:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255]},l4={R:[0,86,166,255],G:[32,92,156,233],B:[76,108,117,69],A:[0,56,80,88],I:[0,64,192,255]},c4={R:[0,0,0],G:[127,196,254],B:[255,255,255],A:[0,64,128],I:[0,128,255]},u4={R:[0,61,122,183,244,255],G:[0,41,81,122,163,255],B:[0,25,51,76,102,255],A:[0,25,51,71,102,128],I:[0,51,102,153,204,255]},h4={R:[0,61,122,183,244,255],G:[0,41,81,122,163,203],B:[0,25,51,76,102,127],A:[0,25,51,71,102,128],I:[0,51,102,153,204,255]},f4={min:-643,max:-235,R:[0,0,0],G:[154,154,154],B:[179,179,101],A:[0,32,0],I:[0,163,255]},d4={min:114,max:800,R:[0,255,255,255],G:[0,0,129,255],B:[0,0,0,255],A:[0,64,88,228],I:[0,80,160,255]},m4={min:180,max:600,R:[0,0,113,255],G:[0,0,109,250],B:[0,0,101,245],A:[0,0,100,160],I:[0,1,128,255]},g4={min:-10,max:110,R:[0,127,255],G:[0,127,255],B:[0,127,255],A:[0,48,128],I:[0,124,255]},p4={min:-10,max:110,R:[0,199,255],G:[0,127,255],B:[0,127,255],A:[0,48,128],I:[0,124,255]},A4={min:-80,max:1e3,R:[0,189,150,150,150,150,255],G:[0,169,54,54,54,54,240],B:[0,153,52,52,52,52,242],A:[0,32,64,0,0,64,64],I:[0,1,82,92,234,242,255]},v4={min:-590,max:600,R:[0,241,241,248,248,178,178,232,255,255,255],G:[0,156,156,222,222,36,36,51,255,255,255],B:[0,130,130,169,169,24,24,37,255,255,255],A:[0,8,0,0,0,64,64,0,0,222,222],I:[0,2,3,64,122,142,172,182,252,253,255]},x4={min:114,max:302,R:[0,255,255],G:[0,129,255],B:[0,0,255],A:[0,88,228],I:[0,103,255]},y4={min:-23,max:246,R:[0,44,255,255,255],G:[0,128,90,255,255],B:[0,0,70,0,255],A:[0,0,82,184,228],I:[0,64,131,196,255]},w4={min:-100,max:246,R:[0,128,159,255,255,255,255],G:[0,0,56,90,0,255,255],B:[0,0,41,70,0,0,255],A:[0,63,105,135,167,184,228],I:[0,100,128,155,180,209,255]},b4={min:-590,max:600,R:[0,241,241,248,248,178,232,255,255],G:[0,156,156,222,222,36,51,255,255],B:[0,130,130,169,169,24,37,255,255],A:[0,63,105,135,167,184,228,228,228],I:[0,1,52,127,137,162,172,252,255]},C4={min:140,max:1024,R:[0,2,113,255],G:[0,1,109,250],B:[0,1,101,245],A:[0,1,96,168],I:[0,1,128,255]},S4={min:-923,max:679,R:[0,0,0,0,0,255,255,255],G:[154,154,154,154,0,0,254,255],B:[179,179,179,179,0,0,0,255],A:[0,3,8,0,0,10,15,20],I:[0,30,62,88,170,200,232,255]},E4={min:-10,max:110,R:[0,199,255],G:[0,127,255],B:[0,127,255],A:[0,48,128],I:[0,124,255]},T4={min:-600,max:100,R:[0,134,255],G:[0,109,250],B:[0,101,245],A:[0,60,148],I:[0,128,255]},M4={min:114,max:246,R:[0,255,255],G:[0,128,255],B:[0,128,255],A:[0,64,96],I:[0,87,255]},D4={min:50,max:1e3,R:[98,210,169,128,255],G:[94,26,77,128,255],B:[45,21,74,128,255],A:[0,25,0,4,168],I:[0,41,87,154,255]},N4={R:[0,13,21,26,27,25,22,21,22,28,39,54,75,98,124,148,171,189,202,210,213,211,206,200,195,193,195,201,211,225,240,255],G:[0,5,11,20,31,44,58,72,86,99,109,116,120,122,122,122,121,121,124,129,137,147,161,175,190,205,218,229,238,245,251,255],B:[0,14,30,46,61,71,77,78,75,68,60,52,48,47,53,65,83,105,131,157,183,205,222,235,241,243,242,240,239,240,245,255],A:[0,4,8,12,17,21,25,29,33,37,41,45,50,54,58,62,66,70,74,78,83,87,91,95,99,103,107,111,116,120,124,128],I:[0,8,16,25,33,41,49,58,66,74,82,90,99,107,115,123,132,140,148,156,165,173,181,189,197,206,214,222,230,239,247,255]},R4={R:[0,10,136,255],G:[0,39,220,255],B:[0,223,253,255],A:[0,48,64,70],I:[0,92,192,255]},U4={R:[0,245,205,120,196,220,230,0,122,236,12,204,42,119,220,103,60,255,165,160,0,245,205,120,196,220,230,0,122,236,13,220,103,255,165,160,0,120,200,255,255,164,164,164,234,0,0,0,0,0],G:[0,245,62,18,58,248,148,118,186,13,48,182,204,159,216,255,60,165,42,32,200,245,62,18,58,248,148,118,186,13,48,216,255,165,42,32,200,190,70,148,148,108,108,108,169,0,0,0,0,0],B:[0,245,78,134,250,164,34,14,220,176,255,142,164,176,20,255,60,0,42,240,200,245,78,134,250,164,34,14,220,176,255,20,255,0,42,240,221,150,255,10,10,226,226,226,30,64,112,160,208,255],A:[0,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64],I:[0,2,3,4,5,7,8,10,11,12,13,14,15,16,17,18,24,26,28,30,31,41,42,43,44,46,47,49,50,51,52,53,54,58,60,62,63,72,77,78,79,80,81,82,85,251,252,253,254,255]},I4={R:[0,0,128,255,255],G:[0,128,0,128,255],B:[0,125,255,0,255],A:[0,32,64,96,128],I:[0,63,128,192,255]},F4={R:[0,142,227,255],G:[0,85,170,255],B:[0,14,76,255],A:[0,42,84,128],I:[0,85,170,255]},V4={R:[0,255],G:[0,255],B:[0,255],A:[0,128],I:[0,255]},B4={R:[0,0,0],G:[0,128,255],B:[0,0,0],A:[0,64,128],I:[0,128,255]},L4={R:[0,0,0],G:[72,72,255],B:[0,255,255],A:[0,64,128],I:[0,88,255]},O4={R:[0,255,255],G:[72,88,255],B:[0,0,0],A:[0,64,128],I:[0,88,255]},k4={R:[0,255,255,255],G:[0,0,126,255],B:[0,0,0,255],A:[0,64,96,128],I:[0,128,191,255]},P4={R:[3,255,255,255],G:[0,0,255,255],B:[0,0,0,255],A:[0,48,96,128],I:[0,95,191,255]},z4={R:[255,255,0,0,0,255,255],G:[0,255,255,255,0,0,0],B:[0,0,0,255,255,255,0],A:[0,14,28,43,57,71,85],I:[0,43,85,128,170,213,255]},_4={R:[0,120,237,240],G:[0,28,105,249],B:[4,109,37,33],A:[0,56,80,88],I:[0,64,192,255]},j4={R:[0,0,127,255,127],G:[0,127,255,127,0],B:[127,255,127,0,0],A:[0,32,64,96,128],I:[0,63,128,192,255]},G4={R:[0,255,255],G:[0,0,255],B:[0,0,0],A:[0,64,64],I:[0,86,255]},Y4={R:[94,50,90,152,215,238,249,254,252,241,209,158],G:[79,131,186,214,240,244,237,210,157,100,57,1],B:[162,189,167,164,155,169,168,123,86,68,79,66],A:[0,12,23,35,47,58,70,81,93,105,116,128],I:[0,23,46,70,93,116,139,162,185,209,232,255]},H4={R:[3,7,13,25,45,67,84,98,110,124,138,154,173,191,210,225,233,233,231,229,230,235,243,253],G:[19,33,48,63,77,87,92,94,95,96,96,97,99,101,106,118,133,149,163,177,192,208,225,245],B:[38,58,79,99,114,122,122,120,117,113,110,105,101,97,94,96,103,112,122,134,149,169,192,218],A:[0,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64],I:[0,11,22,33,44,55,66,77,88,99,110,121,133,144,155,166,177,188,199,210,221,232,243,255]},q4={R:[0,148,183,223,247,252],G:[0,44,55,74,112,253],B:[4,128,121,104,92,191],A:[0,44,53,64,75,107],I:[0,107,128,154,179,255]},K4={R:[11,59,55,222],G:[4,45,165,245],B:[5,91,172,229],A:[0,23,70,107],I:[0,56,167,255]},Q4={R:[3,5,6,8,12,19,28,36,42,48,54,61,68,76,86,96,110,129,154,181,205,224,239,252],G:[19,32,44,58,72,86,98,108,116,122,128,134,141,149,157,167,178,191,204,216,225,232,239,244],B:[39,60,82,104,123,137,144,145,142,138,134,130,126,121,116,110,105,104,112,131,155,178,198,217],A:[0,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64],I:[0,11,22,33,44,55,66,77,88,99,110,121,133,144,155,166,177,188,199,210,221,232,243,255]},X4={R:[0,85,0,0,0,0,0,0,85,255,255,255,172],G:[0,0,0,0,85,170,255,255,255,255,85,0,0],B:[0,170,85,255,255,170,170,0,85,0,0,0,0],A:[0,5,10,21,26,32,37,42,48,53,64,72,85],I:[0,15,31,63,79,95,111,127,143,159,191,217,255]},Z4={R:[13,156,237,240],G:[8,23,121,249],B:[135,158,83,33],A:[0,56,80,88],I:[0,64,192,255]},W4={R:[208,71,33,192,32,195,208,173,233,202,25,210,145,89,87,245,246,38,3,25,57,167,245,86,227,208,81,64,90,199,140,48,212,180,70,120,9,192,245,177,65,157,9,193,100,181,125,145,62,8,108,36,140,237,242,248,161,189,41,114,65,121,97,50,238,149,44,214,124,167,40,167,127,178,231,30,173,244,193,203,204,238,139,135,71,234,234,217,66,14,129,19,97,165,112,244,35,73,192,12,149,71,33,192,32,195,208,173,233,202,25,210,145,89,87,245,246,38,3,25,57,167,245,86,227,208,81,64,90,199,140,48,212,180,70,120,9,192,245,177,65,157,9,193,100,181,125,145,62,8,108,36,140,237,242,248,161,189,41,114,65,121,97,50,238,149,44,214,124,167,40,167,127,178,231,30,173,244,193,203,204,238,139,135,71,234,234,217,66,14,129,19,97,165,112,244,35,73,192,12,149,71,33,192,32,195,208,173,233,202,25,210,145,89,87,245,246,38,3,25,57,167,245,86,227,208,81,64,90,199,140,48,212,180,70,120,9,192,245,177,65,157,9,193,100,181,125,145,62,8,108,36,140,237,242,248],G:[182,46,78,199,79,89,41,208,135,20,154,35,21,43,230,113,191,147,208,37,28,27,86,203,25,209,148,187,139,111,48,102,76,110,106,130,37,160,34,222,90,165,245,222,102,47,19,130,4,232,137,211,240,11,140,21,42,22,241,61,99,115,199,166,114,190,204,60,233,66,115,230,125,103,203,125,13,176,94,131,39,198,167,124,67,175,254,1,15,198,62,237,159,31,218,58,244,47,61,67,94,46,78,199,79,89,41,208,135,20,154,35,21,43,230,113,191,147,208,37,28,27,86,203,25,209,148,187,139,111,48,102,76,110,106,130,37,160,34,222,90,165,245,222,102,47,19,130,4,232,137,211,240,11,140,21,42,22,241,61,99,115,199,166,114,190,204,60,233,66,115,230,125,103,203,125,13,176,94,131,39,198,167,124,67,175,254,1,15,198,62,237,159,31,218,58,244,47,61,67,94,46,78,199,79,89,41,208,135,20,154,35,21,43,230,113,191,147,208,37,28,27,86,203,25,209,148,187,139,111,48,102,76,110,106,130,37,160,34,222,90,165,245,222,102,47,19,130,4,232,137,211,240,11,140,21],B:[191,154,43,10,207,204,164,231,136,58,239,30,147,230,101,111,150,35,128,57,252,79,173,120,25,126,81,85,8,7,122,237,190,152,246,182,130,219,67,76,167,178,235,250,28,61,186,250,199,67,58,50,86,182,108,77,89,112,59,125,226,50,205,227,125,128,104,27,59,66,53,133,159,203,97,125,139,159,158,7,215,47,140,226,223,231,44,110,184,61,233,47,67,148,22,120,173,156,117,181,94,154,43,10,207,204,164,231,136,58,239,30,147,230,101,111,150,35,128,57,252,79,173,120,25,126,81,85,8,7,122,237,190,152,246,182,130,219,67,76,167,178,235,250,28,61,186,250,199,67,58,50,86,182,108,77,89,112,59,125,226,50,205,227,125,128,104,27,59,66,53,133,159,203,97,125,139,159,158,7,215,47,140,226,223,231,44,110,184,61,233,47,67,148,22,120,173,156,117,181,94,154,43,10,207,204,164,231,136,58,239,30,147,230,101,111,150,35,128,57,252,79,173,120,25,126,81,85,8,7,122,237,190,152,246,182,130,219,67,76,167,178,235,250,28,61,186,250,199,67,58,50,86,182,108,77],A:[0,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64],I:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255]},J4={R:[0,128,255],G:[0,0,0],B:[0,0,0],A:[0,64,128],I:[0,128,255]},$4={R:[192,224,255],G:[1,128,255],B:[0,0,0],A:[0,64,128],I:[0,128,255]},ex={R:[3,112,144,188,236,246,255],G:[5,31,29,22,76,158,250],B:[26,87,91,86,62,117,235],A:[0,30,38,49,67,85,107],I:[0,73,92,118,160,205,255]},tx={R:[1,240,255],G:[1,128,255],B:[1,128,255],A:[0,76,128],I:[0,153,255]},ix={R:[0,5,18,34,53,72,90,107,126,144,161,178,194,209,222,233,242,248,251,251,249,244,241,252],G:[0,4,10,11,9,11,17,23,30,36,43,50,59,70,83,98,117,136,157,177,199,220,240,254],B:[3,24,50,76,96,106,109,110,108,104,97,89,79,67,55,42,26,12,6,22,47,79,121,164],A:[0,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64],I:[0,11,22,33,44,55,66,77,88,99,110,121,133,144,155,166,177,188,199,210,221,232,243,255]},sx={R:[48,48,64,70,65,25,132,195,244,254,218,122],G:[18,18,64,107,150,226,255,241,199,158,57,4],B:[59,59,162,227,255,187,81,52,58,47,7,3],A:[0,22,26,30,34,43,52,57,63,67,77,86],I:[0,1,16,32,49,83,118,140,164,181,219,255]},nx={R:[0,128,255],G:[0,0,0],B:[0,128,255],A:[0,64,128],I:[0,128,255]},ax={R:[68,49,53,253],G:[1,104,183,231],B:[84,142,121,37],A:[0,56,80,88],I:[0,64,192,255]},rx={R:[255,255,255],G:[127,196,254],B:[0,0,0],A:[0,64,128],I:[0,128,255]},ox={R:[0,0,0],G:[0,128,255],B:[255,196,128],A:[0,64,128],I:[0,128,255]},lx={R:[3,64,0,0,255,255,255],G:[0,0,0,255,255,192,3],B:[0,32,48,56,64,96,128],A:[0,8,16,24,32,52,80],I:[0,32,64,96,160,192,255]},cx={min:0,max:0,R:[0,37],G:[242,0],B:[255,255],A:[0,64],I:[0,255]},ux={R:[255,255],G:[255,11],B:[0,0],A:[0,64],I:[0,255]},hx={min:0,max:0,R:[65,10,223,120,216,207,251,93,252,217,21,253,131,165,173,143,144,217,86,89,63,254,172,1,142,107,42,78,221,8,222,71,127,126,167,33,104,2,208,216,0,251,7,105,2,101,248,190,253,62,255,224,166,37,110,138,45,34,6,37,69,201,43,122,199,37,173,194,103,211,75,159,96,4,239,98,110,193,253,166,40,255,48,130,140,243,101,9,177,220,133,32,4,81,48,48,210,109,60,132,1,119,1,159,247,33,212,187,253,144,196,254,168,79,64,196,39,97,73,173,104,216,217,43,101,119,254,5,237,103,203,122,57,87,251,164,19,75,200,2,252,150,66,0,255,157,23,254,55,16,240,161,69,253,207,195,5,60,255,251,200,217,134,123,253,180,27,246,130,136,250,232,4,125,140,22,253,255,13,180,123,61,254,111,10,185,76,192,255,223,186,61,198,5,172,13,83,172,171,6,23,73,134,133,109,61,213,55,57,132,36,209,2,144,1,253,68,155,3,160,2,77,121,70,67,176,223,131,4,162,232,255,150,94,235,191,207,10,246,0,225,4,209,116,57,112,172,253,1,6,92,227,73,62,135,223],G:[162,50,112,245,4,124,176,243,56,125,183,139,182,68,189,4,225,10,20,223,7,46,31,193,225,250,219,41,2,100,83,181,34,150,72,223,168,248,80,253,7,117,214,2,248,10,3,59,179,160,90,244,146,4,207,4,125,255,96,100,1,208,130,51,116,181,236,53,244,5,165,28,181,86,96,42,254,1,134,194,214,92,41,204,137,86,207,3,143,3,100,239,164,94,65,251,131,244,173,57,143,107,217,53,210,0,148,250,45,198,81,40,61,218,252,88,171,0,248,24,248,4,41,100,187,46,208,145,43,168,121,46,175,250,125,107,233,112,207,231,174,215,53,9,43,153,52,124,128,65,210,147,255,147,63,200,148,254,0,179,241,42,239,2,230,8,82,135,87,16,3,87,86,151,254,8,255,86,53,19,7,192,171,201,253,247,197,103,251,126,0,149,54,183,61,126,79,113,10,103,184,75,11,195,222,136,149,131,8,99,240,177,252,255,198,16,7,68,178,66,191,150,73,26,211,109,78,209,240,254,1,166,247,131,2,0,167,127,133,10,43,99,235,3,214,142,176,82,132,38,10,249,255,215,44,81],B:[176,182,248,37,117,35,96,69,32,152,108,20,237,250,2,89,141,216,111,251,211,149,10,44,214,103,31,251,3,32,252,246,97,1,219,167,197,4,36,116,206,118,106,43,205,204,114,69,127,205,87,80,41,251,145,204,253,161,247,1,149,9,43,253,97,72,136,161,171,181,26,255,108,80,218,214,231,255,84,31,109,4,218,3,217,36,68,85,241,39,221,2,240,2,173,42,206,5,110,46,103,27,212,184,2,207,246,45,116,72,110,253,38,105,248,159,243,81,192,93,141,145,24,157,234,131,57,178,62,75,65,176,148,40,253,66,76,240,51,154,17,251,139,253,207,9,114,49,200,254,96,73,138,118,204,102,137,89,145,161,4,112,66,234,147,178,212,205,185,11,203,131,2,250,118,169,1,185,154,53,171,197,61,175,249,96,15,254,95,5,222,75,246,194,2,61,180,25,133,165,15,233,59,35,221,140,109,7,114,255,198,0,115,168,252,23,242,80,75,142,137,255,12,182,68,201,4,111,37,228,83,248,24,192,249,5,54,223,160,122,160,114,145,119,252,31,253,250,10,214,8,47,0,142,222,70],A:[0,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64],I:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255]},fx=class{constructor(){k(this,"gamma",1),k(this,"version",.1),k(this,"cluts",{});const e=Object.keys(jl).filter(i=>!i.startsWith("$")).sort(new Intl.Collator("en").compare);for(const i of e)this.cluts[i]=jl[i]}addColormap(t,e){this.cluts[t]=e}colormaps(){return Object.keys(this.cluts)}colorMaps(){return this.colormaps()}colormapFromKey(t){let e=this.cluts[t];return e!==void 0||(e=this.cluts[t.toLowerCase()],e!==void 0)?e:(t.length>0&&j.warn("No color map named "+t),{min:0,max:0,R:[0,255],G:[0,255],B:[0,255],A:[0,255],I:[0,255]})}colormap(t="",e=!1){const i=this.colormapFromKey(t);return this.makeLut(i.R,i.G,i.B,i.A,i.I,e)}makeLabelLut(t,e=255){if(t.R===void 0||t.G===void 0||t.B===void 0)throw new Error(`Invalid colormap table: ${t}`);const i=t.R.length,n=t.I??[...Array(i).keys()];if(i!==t.G.length||i!==t.B.length||i!==n.length)throw new Error(`colormap does not make sense: ${t} Rs ${t.R.length} Gs ${t.G.length} Bs ${t.B.length} Is ${n.length}`);let r=new Uint8ClampedArray(i).fill(e);r[0]=0,t.A!==void 0&&(r=Uint8ClampedArray.from(t.A));const o=Math.min(...n),l=Math.max(...n),h=l-o+1,f=new Uint8ClampedArray(h*4).fill(0);for(let m=0;m<i;m++){let g=(n[m]-o)*4;f[g++]=t.R[m],f[g++]=t.G[m],f[g++]=t.B[m],f[g++]=r[m]}const u={lut:f,min:o,max:l};if(t.labels){const m=t.labels.length;if(m===h)u.labels=t.labels;else if(m===i){u.labels=Array(h).fill("?");for(let g=0;g<i;g++){const p=n[g];u.labels[p]=t.labels[g]}}}return u}async makeLabelLutFromUrl(t){const i=await(await fetch(t)).json();return this.makeLabelLut(i)}makeDrawLut(t){let e=typeof t=="object"?t:jl[t];e===void 0&&(e={min:0,max:0,R:[0,255,0,0,255,0,255],G:[0,0,255,0,255,255,0],B:[0,0,0,255,0,255,255],A:[0,255,255,255,255,255,255],I:[0,255]});const i=this.makeLabelLut(e,255);if(i.labels===void 0&&(i.labels=[]),i.labels.length<256){const l=i.labels.length;for(let h=l;h<256;h++)i.labels.push(h.toString())}const n=new Uint8ClampedArray(256*4);let r=0;for(let l=0;l<256;l++)n[r++]=255,n[r++]=0,n[r++]=0,n[r++]=255;n[3]=0;const o=Math.min(i.lut.length,256*4);if(o>0)for(let l=0;l<o;l++)n[l]=i.lut[l];return{lut:n,labels:i.labels}}makeLut(t,e,i,n,r,o){const l=t.length,h=[...t],f=[...e],u=[...i];if(!r){r=new Array(l);for(let v=0;v<l;v++)r[v]=v/(l-1)*255}n||(n=new Array(l).fill(64),n[0]=0);let m=Uint8ClampedArray.from(n),g=Uint8ClampedArray.from(r);if(o)for(let v=0;v<l;v++)h[v]=t[l-1-v],f[v]=e[l-1-v],u[v]=i[l-1-v],m[v]=255-n[l-1-v],g[v]=255-r[l-1-v];const p=new Uint8ClampedArray(256*4);if(typeof g>"u"){g=new Uint8ClampedArray(l).fill(0);for(let v=0;v<l;v++)g[v]=Math.round(v*255/(l-1))}typeof m>"u"&&(m=new Uint8ClampedArray(l).fill(64),m[0]=0);for(let v=0;v<l-1;v++){const x=g[v];let w=g[v+1];v===0&&x!==0&&j.warn("colormap issue: indices expected to start with 0 not ",x),v===g.length-2&&w!==255&&(j.warn("padding colormap: indices expected end with 255 not ",w),w=255);const b=w-x;let S=x*4;for(let C=x;C<=w;C++){const E=(C-x)/b;p[S++]=h[v]+E*(h[v+1]-h[v]),p[S++]=f[v]+E*(f[v+1]-f[v]),p[S++]=u[v]+E*(u[v+1]-u[v]),p[S++]=m[v]+E*(m[v+1]-m[v])}}if(this.gamma===1)return p;for(let v=0;v<255*4;v++)v%4!==3&&(p[v]=Math.pow(p[v]/255,1/this.gamma)*255);return p}},et=new fx,Dn=class{static getClusterBoundaryU8(t,e){const i=new Array(t.length).fill(!1),n=new Array(t.length).fill(!1);for(let l=0;l<t.length;l++)t[l]>0&&(n[l]=!0);const r=e.length/3;let o=0;for(let l=0;l<r;l++){const h=e[o],f=e[o+1],u=e[o+2];o+=3,!(n[h]===n[f]&&n[h]===n[u]&&n[f]===n[u])&&(i[h]=!0,i[f]=!0,i[u]=!0)}return i}static async gzip(t){const e=new CompressionStream("gzip"),i=e.writable.getWriter();i.write(t).catch(console.error);const n=i.close().catch(console.error),r=new Response(e.readable),o=new Uint8Array(await r.arrayBuffer());return await n,o}static createMZ3(t,e,i=!1,n=null){const o=n instanceof Uint8Array&&n.length===t.length/3*4,l=o?7:3,h=e.length/3,f=t.length/3,u=0,m=16,g=h*3*4,p=f*3*4,v=m+g+p,x=new ArrayBuffer(v),w=new DataView(x);w.setUint16(0,23117,!0),w.setUint16(2,l,!0),w.setUint32(4,h,!0),w.setUint32(8,f,!0),w.setUint32(12,u,!0);let b=m;if(new Uint32Array(x,b,e.length).set(e),b+=g,new Float32Array(x,b,t.length).set(t),o&&(b+=p,new Uint8Array(x,b,n.length).set(n)),i)throw new Error("Call async createMZ3Async() for compression");return x}static async createMZ3Async(t,e,i=!1,n=null){const r=this.createMZ3(t,e,i,n);return i?await this.gzip(new Uint8Array(r)):r}static createOBJ(t,e){let i="";for(let o=0;o<t.length;o+=3)i+=`v ${t[o]} ${t[o+1]} ${t[o+2]}
`;for(let o=0;o<e.length;o+=3)i+=`f ${e[o]+1} ${e[o+1]+1} ${e[o+2]+1}
`;return new TextEncoder().encode(i).buffer}static createSTL(t,e){const i=e.length/3,n=84+i*50,r=new ArrayBuffer(n),o=new DataView(r);for(let h=0;h<80;h++)o.setUint8(h,0);o.setUint32(80,i,!0);let l=84;for(let h=0;h<e.length;h+=3){const f=e[h]*3,u=e[h+1]*3,m=e[h+2]*3;o.setFloat32(l,0,!0),o.setFloat32(l+4,0,!0),o.setFloat32(l+8,0,!0),l+=12,o.setFloat32(l,t[f],!0),o.setFloat32(l+4,t[f+1],!0),o.setFloat32(l+8,t[f+2],!0),l+=12,o.setFloat32(l,t[u],!0),o.setFloat32(l+4,t[u+1],!0),o.setFloat32(l+8,t[u+2],!0),l+=12,o.setFloat32(l,t[m],!0),o.setFloat32(l+4,t[m+1],!0),o.setFloat32(l+8,t[m+2],!0),l+=12,o.setUint16(l,0,!0),l+=2}return r}static downloadArrayBuffer(t,e){const i=new Blob([t],{type:"application/octet-stream"}),n=URL.createObjectURL(i),r=document.createElement("a");r.href=n,r.download=e,document.body.appendChild(r),r.style.display="none",r.click(),setTimeout(()=>{document.body.removeChild(r),URL.revokeObjectURL(n)},0)}static async saveMesh(t,e,i=".mz3",n=!1){let r=new ArrayBuffer(0);return/\.obj$/i.test(i)?r=this.createOBJ(t,e):/\.stl$/i.test(i)?r=this.createSTL(t,e):(/\.mz3$/i.test(i)||(i+=".mz3"),r=await this.createMZ3Async(t,e,n)),i.length>4&&this.downloadArrayBuffer(r,i),r}static getClusterBoundary(t,e){const i=new Uint32Array(t.buffer),n=new Array(i.length).fill(!1),r=e.length/3;let o=0;for(let l=0;l<r;l++){const h=e[o],f=e[o+1],u=e[o+2];o+=3,!(i[h]===i[f]&&i[h]===i[u]&&i[f]===i[u])&&(n[h]=!0,n[f]=!0,n[u]=!0)}return n}static getExtents(t){if(!ArrayBuffer.isView(t)&&!Array.isArray(t)||t.length<3)return{mxDx:0,extentsMin:0,extentsMax:0};let e=0;const i=he(t[0],t[1],t[2]),n=he(t[0],t[1],t[2]);for(let l=0;l<t.length;l+=3){const h=he(t[l],t[l+1],t[l+2]);e=Math.max(e,Qr(h)),ef(i,i,h),tf(n,n,h)}const r=[i[0],i[1],i[2]],o=[n[0],n[1],n[2]];return{mxDx:e,extentsMin:r,extentsMax:o}}static generateNormals(t,e){const i=[];let n;const r=t.length;let o,l,h,f,u,m,g,p,v;const x=new Float32Array(r),w=e.length;for(n=0;n<w;n+=3){g=e[n]*3,p=e[n+1]*3,v=e[n+2]*3;const b=[t[g],t[g+1],t[g+2]],S=[t[p],t[p+1],t[p+2]],C=[t[v],t[v+1],t[v+2]];o=S[0]-b[0],l=S[1]-b[1],h=S[2]-b[2],f=C[0]-b[0],u=C[1]-b[1],m=C[2]-b[2],i[0]=u*h-m*l,i[1]=m*o-f*h,i[2]=f*l-u*o,x[g]+=i[0],x[g+1]+=i[1],x[g+2]+=i[2],x[p]+=i[0],x[p+1]+=i[1],x[p+2]+=i[2],x[v]+=i[0],x[v+1]+=i[1],x[v+2]+=i[2]}for(n=0;n<r;n+=3){i[0]=-1*x[n],i[1]=-1*x[n+1],i[2]=-1*x[n+2];let b=i[0]*i[0]+i[1]*i[1]+i[2]*i[2];b>0&&(b=1/Math.sqrt(b),i[0]*=b,i[1]*=b,i[2]*=b),x[n]=i[0],x[n+1]=i[1],x[n+2]=i[2]}return x}},Se,pi,Gl,Xh,_r,ng=class{constructor(t){Vr(this,Se),Vr(this,pi,0),Vr(this,Gl,[]),Vr(this,Xh,[]),Vr(this,_r),ba(this,Se,new DataView(t)),this.read()}async extract(t){const e=new Uint8Array(xe(this,Se).buffer.slice(t.startsAt,t.startsAt+t.compressedSize));if(t.compressionMethod===0)return e;if(t.compressionMethod===8){const i=new DecompressionStream("deflate-raw"),n=i.writable.getWriter();n.write(e).catch(console.error);const r=n.close().catch(console.error),o=new Response(i.readable),l=new Uint8Array(await o.arrayBuffer());return await r,l}throw new Error(`Unsupported compression method: ${t.compressionMethod}`)}read(){for(;!xe(this,_r)&&xe(this,pi)<xe(this,Se).byteLength;){const t=xe(this,Se).getUint32(xe(this,pi),!0);if(t===67324752){const e=this.readLocalFile(xe(this,pi));e.extract=this.extract.bind(this,e),xe(this,Gl).push(e);const i=(e.generalPurpose&8)!==0;if(e.startsAt=xe(this,pi)+30+e.fileNameLength+e.extraLength,e.compressedSize===0&&i){let n=e.startsAt;for(;n+20<=xe(this,Se).byteLength;){if(xe(this,Se).getUint32(n,!0)===134695760&&xe(this,Se).getUint16(n+16,!0)===19280){n+=4;break}n++}e.crc=xe(this,Se).getUint32(n,!0),e.compressedSize=xe(this,Se).getUint32(n+4,!0),e.uncompressedSize=xe(this,Se).getUint32(n+8,!0),ba(this,pi,n+12)}else ba(this,pi,e.startsAt+e.compressedSize)}else if(t===33639248){const e=this.readCentralDirectory(xe(this,pi));xe(this,Xh).push(e),ba(this,pi,xe(this,pi)+(46+e.fileNameLength+e.extraLength+e.fileCommentLength))}else if(t===101010256){ba(this,_r,this.readEndCentralDirectory(xe(this,pi)));break}else if(t===101075792){ba(this,_r,this.readEndCentralDirectory64(xe(this,pi)));break}else{console.error(`Unexpected ZIP signature 0x${t.toString(16).padStart(8,"0")} at index ${xe(this,pi)}`);break}}}readLocalFile(t){let e=xe(this,Se).getUint32(t+18,!0),i=xe(this,Se).getUint32(t+22,!0);const n=xe(this,Se).getUint16(t+26,!0),r=xe(this,Se).getUint16(t+28,!0),o=t+30+n;if(this.readString(o,r),e===4294967295&&i===4294967295){let l=o,h=!1;for(;l<o+r-4;){const f=xe(this,Se).getUint16(l,!0),u=xe(this,Se).getUint16(l+2,!0);if(l+=4,f===1)if(u>=16){i=Number(xe(this,Se).getBigUint64(l,!0)),l+=8,e=Number(xe(this,Se).getBigUint64(l,!0)),h=!0;break}else throw new Error(`ZIP64 extra field found but is too small (expected at least 16 bytes, got ${u}).`);l+=u}if(!h)throw new Error("ZIP64 format missing extra field with signature 0x0001.")}return{signature:this.readString(t,4),version:xe(this,Se).getUint16(t+4,!0),generalPurpose:xe(this,Se).getUint16(t+6,!0),compressionMethod:xe(this,Se).getUint16(t+8,!0),lastModifiedTime:xe(this,Se).getUint16(t+10,!0),lastModifiedDate:xe(this,Se).getUint16(t+12,!0),crc:xe(this,Se).getUint32(t+14,!0),compressedSize:e,uncompressedSize:i,fileNameLength:n,extraLength:r,fileName:this.readString(t+30,n),extra:this.readString(t+30+n,r)}}readCentralDirectory(t){return{versionCreated:xe(this,Se).getUint16(t+4,!0),versionNeeded:xe(this,Se).getUint16(t+6,!0),fileNameLength:xe(this,Se).getUint16(t+28,!0),extraLength:xe(this,Se).getUint16(t+30,!0),fileCommentLength:xe(this,Se).getUint16(t+32,!0),diskNumber:xe(this,Se).getUint16(t+34,!0),internalAttributes:xe(this,Se).getUint16(t+36,!0),externalAttributes:xe(this,Se).getUint32(t+38,!0),offset:xe(this,Se).getUint32(t+42,!0),comments:this.readString(t+46,xe(this,Se).getUint16(t+32,!0))}}readEndCentralDirectory(t){const e=xe(this,Se).getUint16(t+20,!0);return{numberOfDisks:xe(this,Se).getUint16(t+4,!0),centralDirectoryStartDisk:xe(this,Se).getUint16(t+6,!0),numberCentralDirectoryRecordsOnThisDisk:xe(this,Se).getUint16(t+8,!0),numberCentralDirectoryRecords:xe(this,Se).getUint16(t+10,!0),centralDirectorySize:xe(this,Se).getUint32(t+12,!0),centralDirectoryOffset:xe(this,Se).getUint32(t+16,!0),commentLength:e,comment:this.readString(t+22,e)}}readEndCentralDirectory64(t){const e=Number(xe(this,Se).getBigUint64(t+0,!0));return{numberOfDisks:xe(this,Se).getUint32(t+16,!0),centralDirectoryStartDisk:xe(this,Se).getUint32(t+20,!0),numberCentralDirectoryRecordsOnThisDisk:Number(xe(this,Se).getBigUint64(t+24,!0)),numberCentralDirectoryRecords:Number(xe(this,Se).getBigUint64(t+32,!0)),centralDirectorySize:Number(xe(this,Se).getBigUint64(t+40,!0)),centralDirectoryOffset:Number(xe(this,Se).getBigUint64(t+48,!0)),commentLength:e,comment:""}}readString(t,e){return Array.from({length:e},(i,n)=>String.fromCharCode(xe(this,Se).getUint8(t+n))).join("")}get entries(){return xe(this,Gl)}};Se=new WeakMap;pi=new WeakMap;Gl=new WeakMap;Xh=new WeakMap;_r=new WeakMap;var Ae=class Ma{static arrayBufferToBase64(e){const i=new Uint8Array(e);return Ma.uint8tob64(i)}static async decompress(e){const i=e[0]===31&&e[1]===139&&e[2]===8?"gzip":e[0]===120&&(e[1]===1||e[1]===94||e[1]===156||e[1]===218)?"deflate":"deflate-raw",n=new DecompressionStream(i),r=n.writable.getWriter();r.write(e).catch(console.error);const o=r.close().catch(console.error),l=new Response(n.readable),h=new Uint8Array(await l.arrayBuffer());return await o,h}static async decompressToBuffer(e){const i=await Ma.decompress(e);return i.buffer.slice(i.byteOffset,i.byteOffset+i.byteLength)}static async readMatV4(e,i=!1){let n=e.byteLength;if(n<40)throw new Error("File too small to be MAT v4: bytes = "+e.byteLength);let r=new DataView(e),o=r.getUint16(0,!0),l=e;if(o===35615||o===8075){const x=await this.decompress(new Uint8Array(e));r=new DataView(x.buffer),o=r.getUint16(0,!0),l=x.buffer,n=l.byteLength}const h=new TextDecoder("utf-8"),f=new Uint8Array(l);let u=0;const m={};function g(x){return Math.floor(x/10)%10}function p(x,w,b){const S=new Uint8Array(f.subarray(w,b));return x===1?new Float32Array(S.buffer):x===2?new Int32Array(S.buffer):x===3?new Int16Array(S.buffer):x===4?new Uint16Array(S.buffer):x===5?new Uint8Array(S.buffer):new Float64Array(S.buffer)}function v(){const x=r.getUint32(u,!0),w=r.getUint32(u+4,!0),b=r.getUint32(u+8,!0),S=r.getUint32(u+12,!0),C=r.getUint32(u+16,!0);if(u+=20,S!==0)throw new Error("Matlab V4 reader does not support imaginary numbers");const E=w*b;if(E<1)throw new Error("mrows * ncols must be greater than one");const T=new Uint8Array(f.subarray(u,u+C));let D=h.decode(T).trim().replaceAll("\0","");i&&(D=D.replaceAll(".","_"));const R=g(x);let N=8;if(R>=1&&R<=2)N=4;else if(R>=3&&R<=4)N=2;else if(R===5)N=1;else if(R!==0)throw new Error("impossible Matlab v4 datatype");if(u+=C,x>50)throw new Error("Does not appear to be little-endian V4 Matlab file");const M=u+E*N;m[D]=p(R,u,M),u=M}for(;u+20<n;)v();return m}static b64toUint8(e){const i=atob(e),n=i.length,r=new Uint8Array(n);for(let o=0;o<n;o++)r[o]=i.charCodeAt(o);return r}static uint8tob64(e){let i="";const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=e.byteLength,o=r%3,l=r-o;let h,f,u,m,g;for(let p=0;p<l;p=p+3)g=e[p]<<16|e[p+1]<<8|e[p+2],h=(g&16515072)>>18,f=(g&258048)>>12,u=(g&4032)>>6,m=g&63,i+=n[h]+n[f]+n[u]+n[m];return o===1?(g=e[l],h=(g&252)>>2,f=(g&3)<<4,i+=n[h]+n[f]+"=="):o===2&&(g=e[l]<<8|e[l+1],h=(g&64512)>>10,f=(g&1008)>>4,u=(g&15)<<2,i+=n[h]+n[f]+n[u]+"="),i}static download(e,i,n){const r=document.createElement("a"),o=Array.isArray(e)?e:[e],l=new Blob(o,{type:n});r.href=URL.createObjectURL(l),r.download=i,r.click()}static readFileAsync(e){return new Promise((i,n)=>{const r=new FileReader;r.onload=()=>{i(r.result)},r.onerror=n,r.readAsArrayBuffer(e)})}static blobToBase64(e){return new Promise(i=>{const n=new FileReader;n.onloadend=()=>i(n.result),n.readAsDataURL(e)})}static async decompressBase64String(e){const i=atob(e),n=new ArrayBuffer(i.length),r=new Uint8Array(n);for(let o=0;o<i.length;o++)r[o]=i.charCodeAt(o);return Ma.decompressArrayBuffer(r)}static async compressToBase64String(e){const i=await Ma.compressStringToArrayBuffer(e);return Ma.uint8tob64(new Uint8Array(i))}static strToU8(e,i){if(i){const f=new Uint8Array(e.length);for(let u=0;u<e.length;++u)f[u]=e.charCodeAt(u);return f}const n=e.length,r=(f,u,m)=>((m==null||m>f.length)&&(m=f.length),new Uint8Array(f.subarray(u,m)));let o=new Uint8Array(e.length+(e.length>>1)),l=0;const h=f=>{o[l++]=f};for(let f=0;f<n;++f){if(l+5>o.length){const m=new Uint8Array(l+8+(n-f<<1));m.set(o),o=m}let u=e.charCodeAt(f);u<128||i?h(u):u<2048?(h(192|u>>6),h(128|u&63)):(u>55295&&u<57344,u=65536+(u&1047552)|e.charCodeAt(++f)&1023,h(240|u>>18),h(128|u>>12&63),h(128|u>>6&63),h(128|u&63))}return r(o,0,l)}static async compress(e,i="gzip"){const n=new CompressionStream(i),r=n.writable.getWriter();r.write(e).catch(console.error);const o=r.close().catch(console.error),h=await new Response(n.readable).arrayBuffer();return await o,h}static async compressStringToArrayBuffer(e){const i=this.strToU8(e);return await this.compress(i)}static isArrayBufferCompressed(e){if(e&&e.byteLength){const i=new Uint8Array(e);return(i[0]<<8|i[1])===8075}else return!1}static strFromU8(e,i){if(i){let n="";for(let r=0;r<e.length;r+=16384)n+=String.fromCharCode.apply(null,e.subarray(r,r+16384));return n}else{const n=(h,f,u)=>((f==null||f<0)&&(f=0),(u==null||u>h.length)&&(u=h.length),new Uint8Array(h.subarray(f,u))),r=h=>{for(let f="",u=0;;){let m=h[u++];const g=(m>127)+(m>223)+(m>239);if(u+g>h.length)return{s:f,r:n(h,u-1)};g?g===3?(m=((m&15)<<18|(h[u++]&63)<<12|(h[u++]&63)<<6|h[u++]&63)-65536,f+=String.fromCharCode(55296|m>>10,56320|m&1023)):g&1?f+=String.fromCharCode((m&31)<<6|h[u++]&63):f+=String.fromCharCode((m&15)<<12|(h[u++]&63)<<6|h[u++]&63):f+=String.fromCharCode(m)}},{s:o,r:l}=r(e);if(l.length)throw new Error("Unexpected trailing bytes in UTF-8 decoding");return o}}static async decompressArrayBuffer(e){const i=await this.decompress(new Uint8Array(e));return this.strFromU8(i)}static arraysAreEqual(e,i){return S5(e,i)}static range(e,i,n){return Array.from({length:(i-e)/n+1},(r,o)=>e+o*n)}static sph2cartDeg(e,i){const n=-i*(Math.PI/180),r=(e-90)%360*(Math.PI/180),o=[Math.cos(n)*Math.cos(r),Math.cos(n)*Math.sin(r),Math.sin(n)],l=Math.sqrt(o[0]*o[0]+o[1]*o[1]+o[2]*o[2]);return l<=0||(o[0]/=l,o[1]/=l,o[2]/=l),o}static vox2mm(e,i){const n=Rt(i);Ni(n,n);const r=ut(e[0],e[1],e[2],1);return qt(r,r,n),he(r[0],r[1],r[2])}},Lr=j,gt=class Ht{static readTRACT(e){const i=e.byteLength;if(i<20)throw new Error("File too small to be niml.tract: bytes = "+i);const n=new DataView(e),r=new Uint8Array(e);let o=0;function l(){for(;o<i&&r[o]!==60;)o++;const w=o;for(;o<i&&r[o]!==62;)o++;return o++,o-w<1?"":new TextDecoder().decode(e.slice(w,o-1)).trim()}let h=l();function f(w){const b=h.indexOf(w);if(b<0)return 0;const S=h.indexOf('"',b)+1,C=h.indexOf('"',S),E=h.slice(S,C);return parseInt(E)}const u=f("N_tracts=");(!h.startsWith("<network")||u<1)&&j.warn("This is not a valid niml.tract file "+h);let m=0;const g=[];g.push(m);const p=[],v=[];for(let w=0;w<u;w++){h=l();const b=f("ni_dimen="),S=f("Bundle_Tag="),C=h.includes("binary.lsbfirst");for(let E=0;E<b;E++){o+=4;const T=n.getUint32(o,C)/3;o+=4;for(let D=0;D<T;D++)p.push(n.getFloat32(o,C)),o+=4,p.push(-n.getFloat32(o,C)),o+=4,p.push(n.getFloat32(o,C)),o+=4;m+=T,g.push(m),v.push(S)}h=l()}const x=[];return x.push({id:"tract",vals:Float32Array.from(v)}),{pts:new Float32Array(p),offsetPt0:new Uint32Array(g),dps:x}}static async readTT(e){let i=new Uint32Array(0),n=new Float32Array(0);const r=await Ae.readMatV4(e);if(!("trans_to_mni"in r))throw new Error("TT format file must have 'trans_to_mni'");if(!("voxel_size"in r))throw new Error("TT format file must have 'voxel_size'");if(!("track"in r))throw new Error("TT format file must have 'track'");let o=Ge();const l=r.trans_to_mni;o=Ri(l[0],l[1],l[2],l[3],l[4],l[5],l[6],l[7],l[8],l[9],l[10],l[11],l[12],l[13],l[14],l[15]),Ni(o,o);function h(f){const u=new DataView(f.buffer),m=[];let g=0,p=0;for(;p<f.length;){m.push(p);const w=u.getUint32(p,!0);p=p+w+13,g+=w}i=new Uint32Array(m.length+1),n=new Float32Array(g);let v=0;for(let w=0;w<m.length;w++){i[w]=v/3;let b=m[w];const S=u.getUint32(b,!0)/3;let C=u.getInt32(b+4,!0),E=u.getInt32(b+8,!0),T=u.getInt32(b+12,!0);b+=16,n[v++]=C,n[v++]=E,n[v++]=T;for(let D=2;D<=S;D++)C=C+u.getInt8(b++),E=E+u.getInt8(b++),T=T+u.getInt8(b++),n[v++]=C,n[v++]=E,n[v++]=T}for(let w=0;w<v;w++)n[w]=n[w]/32;let x=0;for(let w=0;w<v/3;w++){const b=ut(n[x],n[x+1],n[x+2],1);qt(b,b,o),n[x++]=b[0],n[x++]=b[1],n[x++]=b[2]}i[m.length]=v/3}return h(r.track),{pts:n,offsetPt0:i}}static async readTRX(e){function i(v){const x=(v&31744)>>10,w=v&1023;return(v>>15?-1:1)*(x?x===31?w?NaN:1/0:Math.pow(2,x-15)*(1+w/1024):6103515625e-14*(w/1024))}let n=0,r=0,o=new Float32Array([]);const l=[],h=[],f=[],u=[];let m=[],g=!1;const p=new ng(e);for(let v=0;v<p.entries.length;v++){const x=p.entries[v];if(x.uncompressedSize===0)continue;const w=x.fileName.split("/"),b=w.slice(-1)[0];if(b.startsWith("."))continue;const S=w.slice(-2)[0],C=b.split(".")[0],E=await x.extract();if(b.includes("header.json")){const R=new TextDecoder().decode(E);m=JSON.parse(R);continue}let T=0,D=[];if(b.endsWith(".uint64")||b.endsWith(".int64")){T=E.length/8,D=new Uint32Array(T);const R=new Uint32Array(E.buffer);let N=0;for(let M=0;M<T;M++)D[M]=R[N],R[N+1]!==0&&(g=!0),N+=2}else if(b.endsWith(".uint32"))D=new Uint32Array(E.buffer);else if(b.endsWith(".uint16"))D=new Uint16Array(E.buffer);else if(b.endsWith(".uint8"))D=new Uint8Array(E.buffer);else if(b.endsWith(".int32"))D=new Int32Array(E.buffer);else if(b.endsWith(".int16"))D=new Int16Array(E.buffer);else if(b.endsWith(".int8"))D=new Int8Array(E.buffer);else if(b.endsWith(".float64"))D=new Float64Array(E.buffer);else if(b.endsWith(".float32"))D=new Float32Array(E.buffer);else if(b.endsWith(".float16")){T=E.length/2,D=new Float32Array(T);const R=new Uint16Array(E.buffer),N=new Float32Array(65536);for(let M=0;M<65536;M++)N[M]=i(M);for(let M=0;M<T;M++)D[M]=N[R[M]]}else continue;if(T=D.length,S.includes("groups")){h.push({id:C,vals:Float32Array.from(D.slice())});continue}if(S.includes("dpv")){u.push({id:C,vals:Float32Array.from(D.slice())});continue}if(S.includes("dps")){f.push({id:C,vals:Float32Array.from(D.slice())});continue}if(b.startsWith("offsets.")){n=T;for(let R=0;R<T;R++)l[R]=D[R]}b.startsWith("positions.3.")&&(r=T,o=new Float32Array(D))}if(n===0||r===0)throw new Error("Failure reading TRX format (no offsets or points).");if(g)throw new Error("Too many vertices: JavaScript does not support 64 bit integers");return l[n]=r/3,{pts:o,offsetPt0:new Uint32Array(l),dpg:h,dps:f,dpv:u,header:m}}static readTSF(e,i=0){const n=new Float32Array(i),r=e.byteLength;if(r<20)throw new Error("File too small to be TSF: bytes = "+r);const o=new Uint8Array(e);let l=0;function h(){for(;l<r&&o[l]===10;)l++;const p=l;for(;l<r&&o[l]!==10;)l++;return l++,l-p<1?"":new TextDecoder().decode(e.slice(p,l-1))}let f=h();if(!f.includes("mrtrix track scalars"))throw new Error("Not a valid TSF file");let u=-1;for(;l<r&&!f.includes("END");)if(f=h(),f.toLowerCase().startsWith("file:")&&(u=parseInt(f.split(" ").pop())),f.toLowerCase().startsWith("datatype:")&&!f.endsWith("Float32LE"))throw new Error("Only supports TSF files with Float32LE");if(u<20)throw new Error("Not a valid TSF file (missing file offset)");l=u;const m=new DataView(e);let g=0;for(;l+4<=r&&g<i;){const p=m.getFloat32(l,!0);if(l+=4,isFinite(p))n[g++]=p;else if(!isNaN(p))break}return n}static readTCK(e){const i=e.byteLength;if(i<20)throw new Error("File too small to be TCK: bytes = "+i);const n=new Uint8Array(e);let r=0;function o(){for(;r<i&&n[r]===10;)r++;const x=r;for(;r<i&&n[r]!==10;)r++;return r++,r-x<1?"":new TextDecoder().decode(e.slice(x,r-1))}let l=o();if(!l.includes("mrtrix tracks"))throw new Error("Not a valid TCK file");let h=-1;for(;r<i&&!l.includes("END");)l=o(),l.toLowerCase().startsWith("file:")&&(h=parseInt(l.split(" ").pop()));if(h<20)throw new Error("Not a valid TCK file (missing file offset)");r=h;const f=new DataView(e);let u=0,m=new Uint32Array(i/(4*4)),g=0,p=0,v=new Float32Array(i/4);for(m[0]=0;r+12<i;){const x=f.getFloat32(r,!0);r+=4;const w=f.getFloat32(r,!0);r+=4;const b=f.getFloat32(r,!0);if(r+=4,isFinite(x))v[p++]=x,v[p++]=w,v[p++]=b,u++;else if(m[g++]=u,!isNaN(x))break}return v=v.slice(0,p),m=m.slice(0,g),{pts:v,offsetPt0:m}}static async readTRK(e){let i=new DataView(e),n=i.getUint32(0,!0);if(n!==1128354388){let B;if(n===4247762216)throw new Error("zstd TRK decompression is not supported");B=await Ae.decompress(new Uint8Array(e)),e=B.buffer,i=new DataView(e),n=i.getUint32(0,!0)}const r=i.getUint32(992,!0),o=i.getUint32(996,!0);if(r>2||o!==1e3||n!==1128354388)throw new Error("Not a valid TRK file");const l=i.getInt16(36,!0),h=[];for(let B=0;B<l;B++){const U=new Uint8Array(e.slice(38+B*20,58+B*20)),z=new TextDecoder().decode(U).split("\0").shift();h.push({id:z.trim(),vals:[]})}const f=i.getFloat32(12,!0),u=i.getFloat32(16,!0),m=i.getFloat32(20,!0),g=Ri(1/f,0,0,-.5,0,1/u,0,-.5,0,0,1/m,-.5,0,0,0,1),p=i.getInt16(238,!0),v=[];for(let B=0;B<p;B++){const U=new Uint8Array(e.slice(240+B*20,260+B*20)),z=new TextDecoder().decode(U).split("\0").shift();v.push({id:z.trim(),vals:[]})}const x=Ge();for(let B=0;B<16;B++)x[B]=i.getFloat32(440+B*4,!0);x[15]===0&&(j.warn("TRK vox_to_ras not set"),Nm(x));const w=Ge();Rm(w,g,x);let b=null,S=null;b=new Int32Array(e.slice(o)),S=new Float32Array(b.buffer);const C=b.length;if(C<1)throw new Error("Empty TRK file.");let E=0,T=0,D=new Uint32Array(b.length/4),R=0,N=new Float32Array(b.length),M=0;for(;E<C;){const B=b[E];E=E+1,D[R++]=T;for(let U=0;U<B;U++){const z=S[E+0],P=S[E+1],K=S[E+2];if(E+=3,N[M++]=z*w[0]+P*w[1]+K*w[2]+w[3],N[M++]=z*w[4]+P*w[5]+K*w[6]+w[7],N[M++]=z*w[8]+P*w[9]+K*w[10]+w[11],l>0)for(let _=0;_<l;_++)h[_].vals.push(S[E]),E++;T++}if(p>0)for(let U=0;U<p;U++)v[U].vals.push(S[E]),E++}const V=[];for(let B=0;B<v.length;B++)V.push({id:v[B].id,vals:Float32Array.from(v[B].vals)});const I=[];for(let B=0;B<h.length;B++)I.push({id:h[B].id,vals:Float32Array.from(h[B].vals)});return D[R++]=T,N=N.slice(0,M),D=D.slice(0,R),{pts:N,offsetPt0:D,dps:V,dpv:I}}static readTxtVTK(e){const r=new TextDecoder("utf-8").decode(e).split(`
`);if(r.length<7||!r[0].startsWith("# vtk DataFile"))throw new Error("Invalid VTK image");if(!r[2].startsWith("ASCII"))throw new Error("Not ASCII VTK mesh");let l=3;for(;r[l].length<1;)l++;if(!r[l].includes("POLYDATA"))throw new Error("Not ASCII VTK polydata");for(l++;r[l].length<1;)l++;if(!r[l].startsWith("POINTS"))throw new Error("Not VTK POINTS");let h=r[l].trim().split(/\s+/);const f=parseInt(h[1]),u=f*3,m=new Float32Array(f*3);let g=0;for(;g<f*3;){l++;const w=r[l].trim().trim().split(/\s+/);for(let b=0;b<w.length&&!(g>=u);b++)m[g]=parseFloat(w[b]),g++}const p=[];for(l++;r[l].length<1;)l++;if(r[l].startsWith("METADATA")){for(;r[l].length>1;)l++;l++}if(h=r[l].trim().split(/\s+/),l++,h[0].includes("LINES")){const x=parseInt(h[1]);if(x<1)throw new Error("Corrupted VTK ASCII");let w=r[l].trim();const b=[];let S=[];if(w.startsWith("OFFSETS")){l++;let C=0;for(;C<x;){w=r[l].trim(),l++;const E=w.trim().split(/\s+/);for(let T=0;T<E.length&&(b[C]=parseInt(E[T]),C++,!(C>=x));T++);}S=Array.from(m)}else{let C=function(){w=r[l].trim();const R=w.trim().split(/\s+/);T=[];for(let N=0;N<R.length;N++)T.push(parseInt(R[N]));D=0,l++},E=0;b[0]=0;let T=[],D=0;C();for(let R=0;R<x;R++){D>=T.length&&C();const N=T[D++];E+=N,b[R+1]=E;for(let M=0;M<N;M++){D>=T.length&&C();const V=T[D++]*3;S.push(m[V+0]),S.push(m[V+1]),S.push(m[V+2])}}}return{pts:Float32Array.from(S),offsetPt0:Uint32Array.from(b)}}else if(h[0].includes("TRIANGLE_STRIPS")){const x=parseInt(h[1]);for(let w=0;w<x;w++){const b=r[l].trim();l++;const S=b.trim().split(/\s+/),C=parseInt(S[0])-2;let E=1;for(let T=0;T<C;T++)T%2?(p.push(parseInt(S[E+2])),p.push(parseInt(S[E+1])),p.push(parseInt(S[E]))):(p.push(parseInt(S[E])),p.push(parseInt(S[E+1])),p.push(parseInt(S[E+2]))),E+=1}}else if(h[0].includes("POLYGONS")){const x=parseInt(h[1]);for(let w=0;w<x;w++){const b=r[l].trim();l++;const S=b.trim().split(/\s+/),C=parseInt(S[0])-2,E=parseInt(S[1]);let T=parseInt(S[2]);for(let D=0;D<C;D++){const R=parseInt(S[3+D]);p.push(E),p.push(T),p.push(R),T=R}}}else throw new Error("Unsupported ASCII VTK datatype "+h[0]);const v=new Uint32Array(p);return{positions:m,indices:v}}static async readLayer(e="",i,n,r=.5,o="warm",l="winter",h=!1,f=null,u=null,m=0){const g={...Cx,colormapInvert:!1,colormapType:0,isTransparentBelowCalMin:!0,isAdditiveBlend:!1,colorbarVisible:!0,colormapLabel:null},p=/(?:\.([^.]+))?$/;let v=p.exec(e)[1];v=v.toUpperCase(),v==="GZ"&&(v=p.exec(e.slice(0,-3))[1],v=v.toUpperCase());const x=n.vertexCount/3;if(n.offsetPt0){if(v!=="TSF")throw new Error("readLayer for streamlines only supports TSF files.");const S=n.pts.length/3,C=e.split("/");let E="Unknown";C.length>1&&C.pop()&&(E=E.split(".").slice(0,-1).join("."));const T=Ht.readTSF(i,S);n.dpv||(n.dpv=[]);const D=T.reduce((N,M)=>Math.min(N,M)),R=T.reduce((N,M)=>Math.max(N,M));return n.dpv.push({id:E,vals:Float32Array.from(T.slice()),global_min:D,global_max:R,cal_min:D,cal_max:R}),g}if(x<3){j.error("n_vert < 3 in layer");return}if(v==="MZ3"){const S=await Ht.readMZ3(i,x);g.values=S.scalars,"colormapLabel"in S&&(g.colormapLabel=S.colormapLabel)}else if(v==="ANNOT"){const S=Ht.readANNOT(i,x,!0);S instanceof Uint32Array?g.values=S:(g.values=S.scalars,g.colormapLabel=S.colormapLabel)}else if(v==="CRV"||v==="CURV"||v==="THICKNESS"||v==="AREA")g.values=Ht.readCURV(i,x),g.isTransparentBelowCalMin=!1;else if(v==="GII"){const S=await Ht.readGII(i,x);g.values=S.scalars,g.colormapLabel=S.colormapLabel}else if(v==="MGH"||v==="MGZ"){const S=await Ht.readMGH(i,x,!0);"scalars"in S?(g.values=S.scalars,g.colormapLabel=S.colormapLabel):g.values=S}else if(v==="NII")g.values=await Ht.readNII(i,x,n.anatomicalStructurePrimary);else if(v==="SMP")g.values=await Ht.readSMP(i,x);else if(v==="STC")g.values=Ht.readSTC(i,x);else if(Ht.isCurv(i))g.values=Ht.readCURV(i,x),g.isTransparentBelowCalMin=!1;else return j.warn("Unknown layer overlay format "+e),g;if(!g.values){j.error("no values in layer");return}g.nFrame4D=g.values.length/x,g.frame4D=0,g.outlineBorder=m;let w=g.values[0],b=g.values[0];for(let S=0;S<g.values.length;S++)w=Math.min(w,g.values[S]),b=Math.max(b,g.values[S]);return g.global_min=w,g.global_max=b,g.cal_min=f||0,f||(g.cal_min=w),g.cal_max=u||0,u||(g.cal_max=b),g.cal_minNeg=NaN,g.cal_maxNeg=NaN,g.opacity=r,g.colormap=o,g.colormapNegative=l,g.useNegativeCmap=h,g}static async readSMP(e,i){const n=e.byteLength;let r=new DataView(e),o=r.getUint16(0,!0);if(o>5){const g=await Ae.decompress(new Uint8Array(e));r=new DataView(g.buffer),o=r.getUint16(0,!0),e=g.buffer}o>5&&j.error("Unsupported or invalid BrainVoyager SMP version "+o);const l=r.getUint32(2,!0);l!==i&&j.error("SMP file has "+l+" vertices, background mesh has "+i);const h=r.getUint16(6,!0),f=new Float32Array(l*h);let u=9;function m(){const g=u;for(;u<n&&r.getUint8(u)!==0;)u++;return u++,new TextDecoder().decode(e.slice(g,u-1))}m();for(let g=0;g<h;g++){const p={};p.mapType=r.getUint32(u,!0),u+=4,o>=3&&p.mapType===3&&(p.nLags=r.getUint32(u,!0),u+=4,p.mnLag=r.getUint32(u,!0),u+=4,p.mxLag=r.getUint32(u,!0),u+=4,p.ccOverlay=r.getUint32(u,!0),u+=4),p.clusterSize=r.getUint32(u,!0),u+=4,p.clusterCheck=r.getUint8(u),u+=1,p.critThresh=r.getFloat32(u,!0),u+=4,p.maxThresh=r.getFloat32(u,!0),u+=4,o>=4&&(p.includeValuesGreaterThreshMax=r.getUint32(u,!0),u+=4),p.df1=r.getUint32(u,!0),u+=4,p.df2=r.getUint32(u,!0),u+=4,o>=5?(p.posNegFlag=r.getUint32(u,!0),u+=4):p.posNegFlag=3,p.cortexBonferroni=r.getUint32(u,!0),u+=4,p.posMinRGB=[0,0,0],p.posMaxRGB=[0,0,0],p.negMinRGB=[0,0,0],p.negMaxRGB=[0,0,0],o>=2&&(p.posMinRGB[0]=r.getUint8(u),u++,p.posMinRGB[1]=r.getUint8(u),u++,p.posMinRGB[2]=r.getUint8(u),u++,p.posMaxRGB[0]=r.getUint8(u),u++,p.posMaxRGB[1]=r.getUint8(u),u++,p.posMaxRGB[2]=r.getUint8(u),u++,o>=4&&(p.negMinRGB[0]=r.getUint8(u),u++,p.negMinRGB[1]=r.getUint8(u),u++,p.negMinRGB[2]=r.getUint8(u),u++,p.negMaxRGB[0]=r.getUint8(u),u++,p.negMaxRGB[1]=r.getUint8(u),u++,p.negMaxRGB[2]=r.getUint8(u),u++),p.enableSMPColor=r.getUint8(u),u++,o>=4&&(p.lut=m()),p.colorAlpha=r.getFloat32(u,!0),u+=4),p.name=m();const v=new Float32Array(e,u,l);f.set(v,g*l),u+=l*4}return f}static readSTC(e,i){const n=new DataView(e),r=n.getInt32(8,!1);if(r!==i)throw new Error("Overlay has "+r+" vertices, expected "+i);let o=12+r*4;const l=n.getUint32(o,!1);o+=4;const h=new Float32Array(l*r);for(let f=0;f<l*r;f++)h[f]=n.getFloat32(o,!1),o+=4;return h}static isCurv(e){const i=new DataView(e),n=i.getUint8(0),r=i.getUint8(1),o=i.getUint8(2);return n!==255||r!==255||o!==255?(Lr.debug("Unable to recognize file type: does not appear to be FreeSurfer format."),!1):!0}static readCURV(e,i){const n=new DataView(e),r=n.getUint8(0),o=n.getUint8(1),l=n.getUint8(2),h=n.getUint32(3,!1),f=n.getUint32(11,!1);if((r!==255||o!==255||l!==255)&&Lr.debug("Unable to recognize file type: does not appear to be FreeSurfer format."),i!==h)throw new Error("CURV file has different number of vertices ( "+h+")than mesh ("+i+")");if(e.byteLength<15+4*h*f)throw new Error("CURV file smaller than specified");const u=new Float32Array(f*h);let m=15;for(let x=0;x<f*h;x++)u[x]=n.getFloat32(m,!1),m+=4;let g=u[0],p=u[0];for(let x=0;x<u.length;x++)g=Math.min(g,u[x]),p=Math.max(p,u[x]);const v=1/(p-g);for(let x=0;x<u.length;x++)u[x]=1-(u[x]-g)*v;return u}static readANNOT(e,i,n=!1){const r=new DataView(e),o=r.getUint32(0,!1),l=this.decimateLayerVertices(o,i);if(i!==l)throw new Error("ANNOT file has different number of vertices than mesh");if(e.byteLength<4+8*o)throw new Error("ANNOT file smaller than specified");let h=0;const f=new Uint32Array(o);for(let E=0;E<o;E++){const T=r.getUint32(h+=4,!1);f[T]=r.getUint32(h+=4,!1)}if(!n)return f;let u=0;try{u=r.getInt32(h+=4,!1)}catch{return f}if(u!==1||r.getInt32(h+=4,!1)>0)return f;const p=r.getInt32(h+=4,!1),v=r.getInt32(h+=4,!1);h+=v;const x=r.getInt32(h+=4,!1);if(x<1)return f;const w={R:Array(p).fill(0),G:Array(p).fill(0),B:Array(p).fill(0),A:Array(p).fill(0),I:Array(p).fill(0),labels:Array(p).fill("")};for(let E=0;E<x;E++){const T=r.getInt32(h+=4,!1),D=r.getInt32(h+=4,!1);h+=4;let R="";for(let B=0;B<D;B++){const U=r.getUint8(h++);if(U===0)break;R+=String.fromCharCode(U)}h-=4;const N=r.getInt32(h+=4,!1),M=r.getInt32(h+=4,!1),V=r.getInt32(h+=4,!1),I=r.getInt32(h+=4,!1);if(T<0||T>=p){j.warn("annot entry out of range");continue}w.R[T]=N,w.G[T]=M,w.B[T]=V,w.A[T]=I,w.I[T]=(I<<24)+(V<<16)+(M<<8)+N,w.labels[T]=R}const b=new Float32Array(o);b.fill(-1);let S=0;for(let E=0;E<i;E++){const T=f[E];for(let D=0;D<p;D++)if(w.I[D]===T){b[E]=D;break}b[E]<0&&(S++,b[E]=0)}S>0&&j.error(`annot vertex colors do not match ${S} of ${o} vertices.`);for(let E=0;E<p;E++)w.I[E]=E;const C=et.makeLabelLut(w);return{scalars:b,colormapLabel:C}}static readNV(e){const i=e.byteLength,n=new Uint8Array(e);let r=0;function o(){for(;r<i&&n[r]===10;)r++;const p=r;for(;r<i&&n[r]!==10;)r++;return r++,r-p<1?"":new TextDecoder().decode(e.slice(p,r-1))}let l=0,h=0,f=0,u=0,m,g;for(;r<i;){const p=o();if(p.startsWith("#"))continue;const v=p.trim().split(/\s+/);if(l<1){l=parseInt(v[0]),m=new Float32Array(l*3);continue}if(f<l*3){m[f]=parseFloat(v[0]),m[f+1]=parseFloat(v[1]),m[f+2]=parseFloat(v[2]),f+=3;continue}if(h<1){h=parseInt(v[0]),g=new Uint32Array(h*3);continue}if(u>=h*3)break;g[u+2]=parseInt(v[0])-1,g[u+1]=parseInt(v[1])-1,g[u+0]=parseInt(v[2])-1,u+=3}return{positions:m,indices:g}}static readASC(e){const i=e.byteLength,n=new Uint8Array(e);let r=0;function o(){for(;r<i&&n[r]===10;)r++;const v=r;for(;r<i&&n[r]!==10;)r++;return r++,r-v<1?"":new TextDecoder().decode(e.slice(v,r-1))}let l=o();l.startsWith("#!ascii")||j.warn("Invalid ASC mesh"),l=o();let h=l.trim().split(/\s+/);const f=parseInt(h[0]),u=parseInt(h[1]),m=new Float32Array(f*3);let g=0;for(let v=0;v<f;v++)l=o(),h=l.trim().split(/\s+/),m[g]=parseFloat(h[0]),m[g+1]=parseFloat(h[1]),m[g+2]=parseFloat(h[2]),g+=3;const p=new Uint32Array(u*3);g=0;for(let v=0;v<u;v++)l=o(),h=l.trim().split(/\s+/),p[g]=parseInt(h[0]),p[g+1]=parseInt(h[1]),p[g+2]=parseInt(h[2]),g+=3;return{positions:m,indices:p}}static readVTK(e){const i=e.byteLength;if(i<20)throw new Error("File too small to be VTK: bytes = "+e.byteLength);const n=new Uint8Array(e);let r=0;function o(w=!0){if(w)for(;r<i&&n[r]===10;)r++;const b=r;for(;r<i&&n[r]!==10;)r++;return r++,r-b<1?"":new TextDecoder().decode(e.slice(b,r-1))}let l=o();if(!l.startsWith("# vtk DataFile"))throw new Error("Invalid VTK mesh");if(l=o(!1),l=o(),l.startsWith("ASCII"))return Ht.readTxtVTK(e);if(!l.startsWith("BINARY"))throw new Error("Invalid VTK image, expected ASCII or BINARY "+l);if(l=o(),!l.includes("POLYDATA"))throw new Error("Only able to read VTK POLYDATA "+l);l=o(),(!l.includes("POINTS")||!l.includes("double")&&!l.includes("float"))&&j.warn("Only able to read VTK float or double POINTS"+l);const h=l.includes("double");let f=l.trim().split(/\s+/);const m=parseInt(f[1])*3,g=new Float32Array(m),p=new DataView(e);if(h)for(let w=0;w<m;w++)g[w]=p.getFloat64(r,!1),r+=8;else for(let w=0;w<m;w++)g[w]=p.getFloat32(r,!1),r+=4;l=o(),f=l.trim().split(/\s+/);const v=[];if(f[0].includes("LINES")){const w=parseInt(f[1]),b=r;if(l=o(),l.startsWith("OFFSETS")){let T=!1;l.includes("int64")&&(T=!0);const D=new Uint32Array(w);if(T){let N=!1;for(let M=0;M<w;M++){let V=p.getInt32(r,!1);V!==0&&(N=!0),r+=4,V=p.getInt32(r,!1),r+=4,D[M]=V}N&&j.warn("int32 overflow: JavaScript does not support int64")}else for(let N=0;N<w;N++){const M=p.getInt32(r,!1);r+=4,D[N]=M}return{pts:g,offsetPt0:D}}r=b;let S=0;const C=[],E=[];C.push(S);for(let T=0;T<w;T++){const D=p.getInt32(r,!1);r+=4,S+=D,C.push(S);for(let R=0;R<D;R++){const N=p.getInt32(r,!1)*3;r+=4,E.push(g[N+0]),E.push(g[N+1]),E.push(g[N+2])}}return{pts:Float32Array.from(E),offsetPt0:Uint32Array.from(C)}}else if(f[0].includes("TRIANGLE_STRIPS")){const w=parseInt(f[1]);for(let b=0;b<w;b++){const S=p.getInt32(r,!1)-2;r+=4;for(let C=0;C<S;C++)C%2?(v.push(p.getInt32(r+8,!1)),v.push(p.getInt32(r+4,!1)),v.push(p.getInt32(r,!1))):(v.push(p.getInt32(r,!1)),v.push(p.getInt32(r+4,!1)),v.push(p.getInt32(r+8,!1))),r+=4;r+=8}}else if(f[0].includes("POLYGONS")){const w=parseInt(f[1]);for(let b=0;b<w;b++){const S=p.getInt32(r,!1)-2;if(b===0&&S>65535)throw new Error("Invalid VTK binary polygons using little-endian data (MRtrix)");r+=4;const C=p.getInt32(r,!1);r+=4;let E=p.getInt32(r,!1);r+=4;for(let T=0;T<S;T++){const D=p.getInt32(r,!1);r+=4,v.push(C),v.push(E),v.push(D),E=D}}}else throw new Error("Unsupported binary VTK datatype "+f[0]);const x=new Uint32Array(v);return{positions:g,indices:x}}static readWRL(e){const i=new TextDecoder("utf-8").decode(e),n=/coord\s+Coordinate\s*\{\s*point\s*\[([\s\S]*?)\]/,r=/coordIndex\s*\[([\s\S]*?)\]/,o=/color\s+Color\s*\{\s*color\s*\[([\s\S]*?)\]/,l=n.exec(i),h=r.exec(i),f=o.exec(i);if(!l||!h)throw new Error("Invalid WRL file: Could not find vertices or indices.");const u=new Float32Array(l[1].trim().split(/[\s,]+/).map(Number));let m=null;if(f){m=new Float32Array(f[1].trim().split(/[\s,]+/).map(Number));const p=u.length/3;m.length!==p*3&&(console.warn(`Unexpected color count: expected ${p*3}, got ${m.length}`),m=null)}const g=new Uint32Array(h[1].trim().split(/[\s,]+/).map(Number).filter(p=>p!==-1));return{positions:u,indices:g,colors:m}}static readDFS(e){const i=new DataView(e),n=i.getUint32(0,!0),r=i.getUint16(4,!0);(n!==1599292996||r!==17740)&&j.warn("Not a little-endian brainsuite DFS mesh");const o=i.getUint32(12,!0),l=i.getUint32(24,!0),h=i.getUint32(28,!0),f=i.getUint32(48,!0);let u=o;const m=new Uint32Array(e,u,l*3);u+=l*3*4;const g=new Float32Array(e,u,h*3);for(let v=0;v<h*3;v+=3){const x=g[v];g[v]=g[v+1],g[v+1]=x}let p;return f>=0&&(p=new Float32Array(e,f,h*3)),{positions:g,indices:m,colors:p}}static async readMZ3(e,i=0){if(e.byteLength<20)throw new Error("File too small to be mz3: bytes = "+e.byteLength);let n=new DataView(e),r=e,o=n.getUint16(0,!0);if(o===35615||o===8075){const V=await Ae.decompress(new Uint8Array(e));n=new DataView(V.buffer),o=n.getUint16(0,!0),r=V.buffer}const l=n.getUint16(2,!0),h=n.getUint32(4,!0);let f=n.getUint32(8,!0);const u=n.getUint32(12,!0);if(Lr.debug("MZ3 magic %d attr %d face %d vert %d skip %d",o,l,h,f,u),o!==23117)throw new Error("Invalid MZ3 file");const m=(l&1)!==0,g=(l&2)!==0,p=(l&4)!==0;let v=(l&8)!==0;const x=(l&16)!==0,w=(l&32)!==0,b=(l&64)!==0;if(Lr.debug(`isFace=${m} isVert=${g} isRGBA=${p} isSCALAR=${v} isDOUBLE=${x} isAOMAP=${w} isLOOKUP=${b}`),l>127)throw new Error("Unsupported future version of MZ3 file");let S=4;x&&(S=8);let C=0;if(i>0&&!m&&h<1&&!p&&(v=!0),v){const V=i||f,I=16+u+(m?h*12:0)+(g?V*12:0)+(p?V*4:0),B=Math.floor((r.byteLength-I)/S);f!==i&&B%i===0&&(f=i),C=Math.floor(B/f),C<1&&(j.warn("Corrupt MZ3: file reports NSCALAR but not enough bytes"),v=!1)}if(f<3&&i<3)throw new Error("Not a mesh MZ3 file (maybe scalar)");i>0&&i!==f&&j.warn("Layer has "+f+"vertices, but background mesh has "+i);let E=16+u;const T=new DataView(r);let D=null;if(m){D=new Uint32Array(h*3);for(let V=0;V<h*3;V++)D[V]=T.getUint32(E,!0),E+=4}let R=null;if(g){R=new Float32Array(f*3);for(let V=0;V<f*3;V++)R[V]=T.getFloat32(E,!0),E+=4}let N=null;if(p){N=new Float32Array(f*3);for(let V=0;V<f;V++){for(let I=0;I<3;I++)N[V*3+I]=T.getUint8(E++)/255;E++}}let M=new Float32Array;if(v&&C>0)if(x){const V=new Float64Array(C*f);for(let I=0;I<C*f;I++)V[I]=T.getFloat64(E,!0),E+=8;M=Float32Array.from(V)}else{M=new Float32Array(C*f);for(let V=0;V<C*f;V++)M[V]=T.getFloat32(E,!0),E+=4}if(i>0&&b&&v){const V=new TextDecoder("utf-8"),I=new Uint8Array(r,16,u),B=V.decode(I),U=JSON.parse(B),z=et.makeLabelLut(U);return{scalars:M,colormapLabel:z}}if(i>0&&p&&v){let V=M[0];for(let U=0;U<f;U++)V=Math.max(V,M[U]);const I={R:[],G:[],B:[],A:[],I:[],labels:[]};for(let U=0;U<=V;U++)for(let z=0;z<f;z++)if(U===M[z]){const P=z*3;I.I.push(U),I.R.push(N[P]*255),I.G.push(N[P+1]*255),I.B.push(N[P+2]*255),I.A.push(255),I.labels.push(`${U}`);break}const B=et.makeLabelLut(I);return{scalars:M,colormapLabel:B}}return i>0?{scalars:M}:{positions:R,indices:D,scalars:M,colors:N}}static readPLY(e){const i=e.byteLength,n=new Uint8Array(e);let r=0;function o(){for(;r<i&&n[r]===10;)r++;const M=r;for(;r<i&&n[r]!==10;)r++;return r++,r-M<1?"":new TextDecoder().decode(e.slice(M,r-1))}let l=o();if(!l.startsWith("ply"))throw new Error("Not a valid PLY file");l=o();const h=l.includes("ascii");function f(M){if(M==="char"||M==="uchar"||M==="int8"||M==="uint8")return 1;if(M==="short"||M==="ushort"||M==="int16"||M==="uint16")return 2;if(M==="int"||M==="uint"||M==="int32"||M==="uint32"||M==="float"||M==="float32")return 4;if(M==="double")return 8;throw new Error("Unknown data type: "+M)}const u=l.includes("binary_little_endian");let m=0,g=!1,p=0,v=0,x=0,w=0,b=0,S=0,C=0;for(;r<i&&!l.startsWith("end_header");){if(l=o(),l.startsWith("comment"))continue;let M=l.split(/\s/);if(l.startsWith("element vertex"))for(m=parseInt(M[M.length-1]),l=o(),M=l.split(/\s/);l.startsWith("property");){const V=M[1];M[2]==="x"&&V.startsWith("double")?g=!0:M[2]==="x"&&!V.startsWith("float")&&j.error("Error: expect ply xyz to be float or double: "+l),p+=f(V),l=o(),M=l.split(/\s/)}if(l.startsWith("element face"))for(C=parseInt(M[M.length-1]),l=o(),M=l.split(/\s/);l.startsWith("property");){if(M[1]==="list")x=f(M[2]),w=f(M[3]),v+=x+3*w;else{const V=f(M[1]);v+=V,w===0&&(b+=V,S++)}l=o(),M=l.split(/\s/)}}if(h){C<1&&j.error(`Malformed ply format: faces ${C} `);const M=new Float32Array(m*3);let V=0;for(let U=0;U<m;U++){l=o();const z=l.split(/\s/);M[V]=parseFloat(z[0]),M[V+1]=parseFloat(z[1]),M[V+2]=parseFloat(z[2]),V+=3}let I=new Uint32Array(C*3),B=0;for(let U=0;U<C;U++){l=o();const z=l.split(/\s/),P=parseInt(z[S])-2;if(P<1)break;if(B+P*3>I.length){const H=new Uint32Array(I.length+I.length);H.set(I),I=H.slice()}const K=parseInt(z[S+1]);let _=parseInt(z[S+2]);for(let H=0;H<P;H++){const q=parseInt(z[S+3+H]);I[B+0]=K,I[B+1]=_,I[B+2]=q,_=q,B+=3}}return I.length!==B&&(I=I.slice(0,B)),{positions:M,indices:I}}(p<12||x<1||w<1||C<1)&&j.warn(`Malformed ply format: stride ${p} count ${x} iBytes ${w} iStrideBytes ${v} iPadBytes ${b} faces ${C}`);const E=new DataView(e);let T;if(r%4===0&&p===12&&u)T=new Float32Array(e,r,m*3),r+=m*p;else{T=new Float32Array(m*3);let M=0;for(let V=0;V<m;V++)g?(T[M]=E.getFloat64(r,u),T[M+1]=E.getFloat64(r+8,u),T[M+2]=E.getFloat64(r+16,u)):(T[M]=E.getFloat32(r,u),T[M+1]=E.getFloat32(r+4,u),T[M+2]=E.getFloat32(r+8,u)),M+=3,r+=p}const D=new Uint32Array(C*3);let R=!0,N=0;if(x===1&&w===4&&v===13)for(let M=0;M<C;M++){const V=E.getUint8(r);r+=x,V!==3&&(R=!1),D[N]=E.getUint32(r,u),r+=4,D[N+1]=E.getUint32(r,u),r+=4,D[N+2]=E.getUint32(r,u),r+=4,N+=3}else{let M=r;for(let V=0;V<C;V++){r=M+b;let I=0;x===1?I=E.getUint8(r):x===2?I=E.getUint16(r,u):x===4&&(I=E.getUint32(r,u)),r+=x,I!==3&&(R=!1);for(let B=0;B<3;B++)w===1?D[N]=E.getUint8(r):w===2?D[N]=E.getUint16(r,u):w===4&&(D[N]=E.getUint32(r,u)),N++,r+=w;M+=v}}return R||j.warn("Only able to read PLY meshes limited to triangles."),{positions:T,indices:D}}static readICO(e){const r=new TextDecoder("utf-8").decode(e).split(`
`);let o=r[0].trim().split(/\s+/);o.length>1&&j.warn("This is not a valid FreeSurfer ICO/TRI mesh.");const l=parseInt(o[0]),h=new Float32Array(l*3);let f=1;for(let g=0;g<l;g++){const p=r[f].trim().split(/\s+/);f++;let v=parseInt(p[0])-1;const x=parseFloat(p[1]),w=parseFloat(p[2]),b=parseFloat(p[3]);if(v<0||v>=l){j.error("ICO vertices corrupted");break}v*=3,h[v]=x,h[v+1]=w,h[v+2]=b}o=r[f].trim().split(/\s+/),f++;const u=parseInt(o[0]),m=new Uint32Array(u*3);for(let g=0;g<u;g++){const p=r[f].trim().split(/\s+/);f++;let v=parseInt(p[0])-1;const x=parseInt(p[1])-1,w=parseInt(p[2])-1,b=parseInt(p[3])-1;if(v<0||v>=u){j.error("ICO indices corrupted");break}v*=3,m[v]=x,m[v+1]=w,m[v+2]=b}for(let g=0;g<m.length;g+=3){const p=m[g];m[g]=m[g+1],m[g+1]=p}return{positions:h,indices:m}}static readGEO(e,i=!1){const o=new TextDecoder("utf-8").decode(e).split(`
`),l=o[0].trim().split(/\s+/),h=parseInt(l[0]);let f=parseInt(l[1]),u=parseInt(l[2]);const m=parseInt(l[3]);(h>1||m!==u*3)&&j.warn("Multi-part BYU/GEO header or not a triangular mesh.");const g=[];f*=3;let p=0,v=2;for(;p<f;){const C=o[v].trim().split(/\s+/);v++;for(let E=0;E<C.length&&(g.push(parseFloat(C[E])),p++,!(p>=f));E++);}const x=[];u*=3;let w=0;for(;w<u;){const C=o[v].trim().split(/\s+/);v++;for(let E=0;E<C.length&&(x.push(Math.abs(parseInt(C[E]))-1),w++,!(w>=u));E++);}if(i)for(let C=0;C<x.length;C+=3){const E=x[C];x[C]=x[C+1],x[C+1]=E}const b=new Float32Array(g),S=new Uint32Array(x);return{positions:b,indices:S}}static readOFF(e){const r=new TextDecoder("utf-8").decode(e).split(`
`),o=[],l=[];let h=0;r[h].includes("OFF")?h++:j.warn("File does not start with OFF");let f=r[h].trim().split(/\s+/);const u=parseInt(f[0]),m=parseInt(f[1]);h++;for(let v=0;v<u;v++)f=r[h].trim().split(/\s+/),o.push(parseFloat(f[0])),o.push(parseFloat(f[1])),o.push(parseFloat(f[2])),h++;for(let v=0;v<m;v++)f=r[h].trim().split(/\s+/),parseInt(f[0])!==3&&j.warn("Only able to read OFF files with triangular meshes"),l.push(parseInt(f[1])),l.push(parseInt(f[2])),l.push(parseInt(f[3])),h++;const g=new Float32Array(o),p=new Uint32Array(l);return{positions:g,indices:p}}static readOBJMNI(e){const r=new TextDecoder("utf-8").decode(e).trim().split(/\s*,\s*|\s+/);(r.length<1||r[0]!=="P")&&j.warn("This is not a valid MNI OBJ mesh.");let o=6;const l=parseInt(r[o++]),h=l*3,f=new Float32Array(h);for(let x=0;x<h;x++)f[x]=parseFloat(r[o++]);o+=h;const u=parseInt(r[o++]),m=parseInt(r[o++]);(u<1||m<0||m>2)&&j.warn("This is not a valid MNI OBJ mesh.");let g=1;m===1?g=u:m===1&&(g=l),o+=g*4,o+=u;const p=u*3,v=new Uint32Array(p);for(let x=0;x<p;x++)v[x]=parseInt(r[o++]);return{positions:f,indices:v}}static async readOBJ(e){const i=new Uint8Array(e,0,2);i[0]===31&&i[1]===139&&(e=await Ae.decompressToBuffer(new Uint8Array(e)));const r=new TextDecoder("utf-8").decode(e);if(r[0]==="P")return this.readOBJMNI(e);const o=r.split(`
`),l=o.length,h=[],f=[];for(let v=0;v<l;v++){const x=o[v];if(x[0]==="v"&&x[1]===" "){const w=x.trim().split(/\s+/);h.push(parseFloat(w[1])),h.push(parseFloat(w[2])),h.push(parseFloat(w[3]))}if(x[0]==="f"){const w=x.trim().split(/\s+/),b=w.length-3;if(b<1)break;let S=w[1].split("/");const C=parseInt(S[0])-1;S=w[2].split("/");let E=parseInt(S[0])-1;for(let T=0;T<b;T++){S=w[3+T].split("/");const D=parseInt(S[0])-1;f.push(C),f.push(E),f.push(D),E=D}}}const u=new Float32Array(h),m=new Uint32Array(f);let g=m[0],p=m[0];for(let v=1;v<m.length;v++)m[v]<g&&(g=m[v]),m[v]>p&&(p=m[v]);if(p-g+1>u.length/3)throw new Error("Not a valid OBJ file");for(let v=0;v<m.length;v++)m[v]-=g;return{positions:u,indices:m}}static readFreeSurfer(e){const i=new Uint8Array(e);if(i[0]===35&&i[1]===33&&i[2]===97)return Ht.readASC(e);const n=new DataView(e),r=n.getUint32(0,!1),o=n.getUint32(4,!1);(r!==4294966883||o!==1919246708)&&Lr.debug("Unable to recognize file type: does not appear to be FreeSurfer format.");let l=0;for(;n.getUint8(l)!==10;)l++;l+=2;let h=n.getUint32(l,!1);l+=4;let f=n.getUint32(l,!1);l+=4,h*=3;const u=new Float32Array(h);for(let v=0;v<h;v++)u[v]=n.getFloat32(l,!1),l+=4;f*=3;const m=new Uint32Array(f);for(let v=0;v<f;v++)m[v]=n.getUint32(l,!1),l+=4;const g=n.getUint32(l,!1);l+=4;let p=g===20;if(!p){const v=n.getUint32(l,!1);l+=4;const x=n.getUint32(l,!1);l+=4,p=g===2&&v===0&&x===20}if(!p)j.warn("Unknown FreeSurfer Mesh extension code.");else{const x=new TextDecoder().decode(e.slice(l)).trim().split(`
`);for(let w=0;w<x.length;w++){if(!x[w].startsWith("cras"))continue;const S=x[w].split("=")[1].trim().split(" ").map(Number),C=Math.floor(u.length/3);let E=0;for(let T=0;T<C;T++)u[E]+=S[0],E++,u[E]+=S[1],E++,u[E]+=S[2],E++}}return{positions:u,indices:m}}static async readSRF(e){const i=new Uint8Array(e);if(i[0]===35&&i[1]===33&&i[2]===97)return Ht.readASC(e);i[0]===31&&i[1]===139&&(e=(await Ae.decompress(new Uint8Array(e))).buffer);const n=new DataView(e),r=n.getFloat32(0,!0),o=n.getUint32(8,!0),l=n.getUint32(12,!0),h=n.getFloat32(16,!0),f=n.getFloat32(20,!0),u=n.getFloat32(24,!0),m=new Float32Array(o*3);let g=28,p=1;for(let R=0;R<o;R++)m[p]=-n.getFloat32(g,!0)+h,p+=3,g+=4;p=2;for(let R=0;R<o;R++)m[p]=-n.getFloat32(g,!0)+f,p+=3,g+=4;p=0;for(let R=0;R<o;R++)m[p]=-n.getFloat32(g,!0)+u,p+=3,g+=4;g=28+4*6*o;const v=n.getFloat32(g,!0),x=n.getFloat32(g+4,!0),w=n.getFloat32(g+8,!0),b=n.getFloat32(g+16,!0),S=n.getFloat32(g+20,!0),C=n.getFloat32(g+24,!0);g+=8*4;const E=new Float32Array(o*3),T=new Uint32Array(e,g,o);p=0;for(let R=0;R<o;R++){const N=T[R];N>1056964608&&(E[p+0]=(N>>16&255)/255,E[p+1]=(N>>8&255)/255,E[p+2]=(N&255)/255),N===0&&(E[p+0]=v,E[p+1]=x,E[p+2]=w),N===1&&(E[p+0]=b,E[p+1]=S,E[p+2]=C),p+=3}g+=o*4;for(let R=0;R<o;R++){const N=n.getUint32(g,!0);g+=4+4*N}const D=new Uint32Array(l*3);for(let R=0;R<l*3;R++)D[R]=n.getInt32(g,!0),g+=4;return r!==4&&j.warn("Not valid SRF"),{positions:m,indices:D,colors:E}}static readTxtSTL(e){const r=new TextDecoder("utf-8").decode(e).split(`
`);if(!r[0].startsWith("solid"))throw new Error("Not a valid STL file");const o=[];for(let u=1;u<r.length;u++){if(!r[u].includes("vertex"))continue;const m=r[u].trim().split(/\s+/);for(let g=1;g<m.length;g++)o.push(parseFloat(m[g]))}const l=Math.floor(o.length/3);if(l*3!==o.length)throw new Error("Unable to parse ASCII STL file.");const h=new Float32Array(o),f=new Uint32Array(l);for(let u=0;u<l;u++)f[u]=u;return{positions:h,indices:f}}static readSTL(e){if(e.byteLength<134)throw new Error("File too small to be STL: bytes = "+e.byteLength);const i=new DataView(e);if(i.getUint32(0,!0)===1768714099)return Ht.readTxtSTL(e);const r=i.getUint32(80,!0),o=3*r;if(e.byteLength<84+r*50)throw new Error("STL file too small to store triangles = "+r);const l=new Uint32Array(o),h=new Float32Array(o*3);let f=96,u=0;for(let m=0;m<r;m++){for(let g=0;g<9;g++)h[u]=i.getFloat32(f,!0),u+=1,f+=4;f+=14}for(let m=0;m<o;m++)l[m]=m;return{positions:h,indices:l}}static decimateLayerVertices(e,i){if(e%i===0)return e;const n=12,r=Math.round(Math.log((e-2)/(n-2))/Math.log(4)),o=Math.round(Math.log((i-2)/(n-2))/Math.log(4)),l=Math.pow(4,r)*(n-2)+2,h=Math.pow(4,o)*(n-2)+2;return l!==e||h!==i?e:i}static async readNII2(e,i=0,n=""){let r=new Float32Array;const o=e.byteLength;let l=!0;const h=new DataView(e);let f=h.getUint16(0,l);if(f===469893120&&(l=!1,f=h.getUint16(0,l)),f!==540)throw new Error("Not a valid NIfTI-2 dataset");const u=Number(h.getBigInt64(168,l)),m=h.getFloat64(176,l),g=h.getFloat64(184,l);(m!==1||g!==0)&&j.warn("ignoring scale slope and intercept");const p=h.getUint32(504,l),v=h.getUint16(12,l);if(v!==2&&v!==4&&v!==8&&v!==16)throw new Error("Unsupported NIfTI datatype "+v);let x=1;const w=[1,1,1,1,1,1,1,1];for(let b=1;b<8;b++)w[b]=Math.max(Number(h.getBigInt64(16+b*8,l)),1),x*=w[b];if(p>=3e3&&p<=3099&&u>580){let b=function(){for(;V<o&&M[V]===10;)V++;const _=V;for(;V<o&&M[V]!==10;)V++;return V++,V-_<1?"":new TextDecoder().decode(e.slice(_,V-1)).trim()},S=function(){let _=b();if(!_.startsWith("<")||_.endsWith(">"))return _;for(;V<o&&!_.endsWith(">");)_+=b();return _},C=function(_,H=!1){const q=I.indexOf(_);if(q<0)return 1;const se=I.indexOf('"',q)+1,G=I.indexOf('"',se),W=I.slice(se,G);return H?W:parseInt(W)},E=0,T=0,D=0,R="",N=new Uint32Array;const M=new Uint8Array(e);let V=552,I;const B=w[5],U=new Float32Array(i*B);for(;V<o&&(I=S(),!I.includes("</CIFTI>"));)if(I.includes("<BrainModel")){const _=C("SurfaceNumberOfVertices="),H=C("BrainStructure=",!0).toUpperCase();if(_%i!==0)continue;let q=!1;if(n.includes("CORTEX")&&H.includes("CORTEX")&&(q=!0),!q||(q=!1,n.includes("LEFT")&&H.includes("LEFT")&&(q=!0),n.includes("RIGHT")&&H.includes("RIGHT")&&(q=!0),!q))continue;if(D=_,E=C("IndexOffset="),T=C("IndexCount="),R=H,I.includes("<VertexIndices>")||(I=S()),!I.startsWith("<VertexIndices>")||!I.endsWith("</VertexIndices>"))return j.warn("Unable to find CIfTI <VertexIndices>"),U;I=I.slice(15,-16);const se=I.trim().split(/\s+/);se.length<T&&j.error("Error parsing VertexIndices"),N=new Uint32Array(T);for(let G=0;G<T;G++)N[G]=parseInt(se[G])}if(D===0||N.length===0)return j.warn("Unable to find CIfTI structure that matches the mesh."),U;if(v!==16)return j.warn("Only able to read float32 CIfTI (only known datatype)."),U;const z=new Float32Array(T*B),P=u+B*E*4;for(let _=0;_<T*B;_++)z[_]=h.getFloat32(P+_*4,l);let K=0;for(let _=0;_<T;_++)for(let H=0;H<B;H++)U[N[_]+H*i]=z[K],K++;return j.debug("CIfTI diagnostics",D,R,E,T,E,n),U}if(x=this.decimateLayerVertices(x,i),x%i!==0)throw new Error("Vertices in layer ("+x+") is not a multiple of number of vertices ("+i+")");if(l)v===16?r=new Float32Array(e,u,x):v===8?r=new Int32Array(e,u,x):v===4&&(r=new Int16Array(e,u,x));else if(v===16){r=new Float32Array(x);for(let b=0;b<x;b++)r[b]=h.getFloat32(u+b*4,l)}else if(v===8){r=new Int32Array(x);for(let b=0;b<x;b++)r[b]=h.getInt32(u+b*4,l)}else if(v===4){r=new Int16Array(x);for(let b=0;b<x;b++)r[b]=h.getInt16(u+b*2,l)}return v===2&&(r=new Uint8Array(e,u,x)),r}static async readNII(e,i=0,n=""){let r=new Float32Array,o=!0,l=new DataView(e),h=l.getUint16(0,o);if(h===540||h===469893120)return Ht.readNII2(e,i,n);if(h===23553&&(o=!1,h=l.getUint16(0,o)),h!==348){const v=await Ae.decompress(new Uint8Array(e));if(l=new DataView(v.buffer),e=v.buffer,h=l.getUint16(0,o),h===540||h===469893120)return Ht.readNII2(e,i,n);h===23553&&(o=!1,h=l.getUint16(0,o))}h!==348&&j.error("Not a valid NIfTI image.");const f=l.getFloat32(108,o),u=l.getFloat32(112,o),m=l.getFloat32(116,o);(u!==1||m!==0)&&j.warn("ignoring scale slope and intercept");const g=l.getUint16(70,o);if(g!==2&&g!==4&&g!==8&&g!==16)throw new Error("Unsupported NIfTI datatype "+g);let p=1;for(let v=1;v<8;v++){const x=l.getUint16(40+v*2,o);p*=Math.max(x,1)}if(p=this.decimateLayerVertices(p,i),p%i!==0)throw new Error("Vertices in layer ("+p+") is not a multiple of number of vertices ("+i+")");if(o)g===16?r=new Float32Array(e,f,p):g===8?r=new Int32Array(e,f,p):g===4&&(r=new Int16Array(e,f,p));else if(g===16){r=new Float32Array(p);for(let v=0;v<p;v++)r[v]=l.getFloat32(f+v*4,o)}else if(g===8){r=new Int32Array(p);for(let v=0;v<p;v++)r[v]=l.getInt32(f+v*4,o)}else if(g===4){r=new Int16Array(p);for(let v=0;v<p;v++)r[v]=l.getInt16(f+v*2,o)}return g===2&&(r=new Uint8Array(e,f,p)),r}static async readMGH(e,i=0,n=!1){let r=new DataView(e),o=e;if(r.getUint8(0)===31&&r.getUint8(1)===139){const N=await Ae.decompress(new Uint8Array(e));o=new ArrayBuffer(N.byteLength),new Uint8Array(o).set(new Uint8Array(N)),r=new DataView(N.buffer)}const l=r.getInt32(0,!1),h=Math.max(1,r.getInt32(4,!1)),f=Math.max(1,r.getInt32(8,!1)),u=Math.max(1,r.getInt32(12,!1)),m=Math.max(1,r.getInt32(16,!1)),g=r.getInt32(20,!1);let p=284;const v=!1;(l!==1||g<0||g>4)&&j.warn("Not a valid MGH file");let x=h*f*u*m,w=[];if(x=this.decimateLayerVertices(x,i),x%i!==0)return j.warn("Vertices in layer ("+x+") is not a multiple of number of vertices ("+i+")"),w;if(g===3){w=new Float32Array(x);for(let N=0;N<x;N++)w[N]=r.getFloat32(p+N*4,v)}else if(g===1){w=new Int32Array(x);for(let N=0;N<x;N++)w[N]=r.getInt32(p+N*4,v)}else if(g===4){w=new Int16Array(x);for(let N=0;N<x;N++)w[N]=r.getInt16(p+N*2,v)}else g===0&&(w=new Uint8Array(e,p,x));if(!n)return w;let b=4;g===4&&(b=2),g===0&&(b=1),p+=b*x,p+=4*4;const S=1,C=2,E=20,T=30,D=o.byteLength;let R;for(;p<D-8;){const N=r.getInt32(p+=4,v);let M=0;switch(N){case T:M=r.getInt32(p+=4,v)-1;break;case E:case C:M=0;break;case S:M=0;{let V=r.getInt32(p+=4,v);if(V>0)return j.warn("unsupported CTABreadFromBinaryV1"),w;if(V=-V,V!==2)return j.warn("CTABreadFromBinary: unknown version"),w;const I=r.getInt32(p+=4,v);if(I<0)return j.warn("CTABreadFromBinaryV2: nentries was ",I),w;const B=r.getInt32(p+=4,v);p+=B;const U=r.getInt32(p+=4,v);if(U<0)return w;const z={R:[],G:[],B:[],A:[],I:[],labels:[]};for(let P=0;P<U;P++){const K=r.getInt32(p+=4,v),_=r.getInt32(p+=4,v);let H=p+4,q="";for(let ce=0;ce<_;ce++){const fe=r.getUint8(H++);if(fe===0)break;q+=String.fromCharCode(fe)}p+=_;const se=r.getInt32(p+=4,v),G=r.getInt32(p+=4,v),W=r.getInt32(p+=4,v),le=255-r.getInt32(p+=4,v);z.I.push(K),z.R.push(se),z.G.push(G),z.B.push(W),z.A.push(le),z.labels.push(q)}R=et.makeLabelLut(z)}break;default:M=r.getInt32(p+=8,v)}p+=M}return{scalars:w,colormapLabel:R}}static readX3D(e){const i=e.byteLength;if(i<20)throw new Error("File too small to be X3D: bytes = "+i);const n=new Uint8Array(e);let r=0;function o(){for(;r<i&&n[r]!==60;)r++;const E=r;for(;r<i&&n[r]!==62;)r++;const T=r;return new TextDecoder().decode(e.slice(E,T+1)).trim()}let l=o();function h(E){const T=l.indexOf(E+"=");if(T<0)return"";const D=l[T+E.length+1],R=l.indexOf(D,T)+1,N=l.indexOf(D,R);return l.slice(R,N)}function f(E){const T=l.indexOf(E+"=");if(T<0)return 1;const D=l[T+E.length+1],R=l.indexOf(D,T)+1,N=l.indexOf(D,R);let M=l.slice(R,N).trim();M=M.replace(/,\s*$/,"");const V=M.trim().split(/\s*,\s*|\s+/);if(V.length<2)return parseFloat(M);let I=new Array(V.length),B=0;for(let U=0;U<V.length;U++){const z=parseFloat(V[U]);isFinite(z)&&(I[B]=z,B++)}return I=I.slice(0,B),I}l.includes("xml version")||j.warn("Not a X3D image");let u=[],m=[],g=[],p=[],v=[0,0,0,0],x=[0,0,0,0],w=[255,255,255,255],b=[255,255,255,255];const S={};function C(){if(!l.endsWith("/>"))if(l.startsWith("<Appearance>"))for(;r<i&&!l.endsWith("</Appearance>");)l+=o();else for(;r<i&&!l.endsWith("/>");)l+=o();const E=h("USE");if(E.length>1){E in S?w=S[E]:j.warn("Unable to find DEF for "+E);return}const T=f("diffuseColor");if(T.length<3)return;w[0]=Math.round(T[0]*255),w[1]=Math.round(T[1]*255),w[2]=Math.round(T[2]*255);const D=h("DEF");D.length<1||(S[D]=w)}for(;r<i;)if(l=o(),w=b.slice(),l.startsWith("<Transform")&&(v=f("translation"),x=f("rotation")),l.startsWith("<Appearance")&&(C(),b=w.slice()),l.startsWith("<Shape")){let E=1,T=1,D=[],R=[];for(;r<i&&(l=o(),l.startsWith("<Appearance")&&C(),!l.startsWith("</Shape"));){if(l.startsWith("<Sphere")&&(E=f("radius"),T=-1),l.startsWith("<Cylinder")&&(E=f("radius"),T=f("height")),l.startsWith("<IndexedFaceSet")&&(T=-2,D=f("coordIndex")),l.startsWith("<IndexedTriangleSet")&&(T=-7,D=f("index")),l.startsWith("<IndexedTriangleStripSet")&&(T=-3,D=f("index")),l.startsWith("<Coordinate")){R=f("point");const N=R.length%3;N!==0&&(R=R.slice(0,-N))}l.startsWith("<Color")&&(p=f("color")),l.startsWith("<Box")&&(T=-4,j.warn("Unsupported x3d shape: Box")),l.startsWith("<Cone")&&(T=-5,j.warn("Unsupported x3d shape: Cone")),l.startsWith("<ElevationGrid")&&(T=-6,j.warn("Unsupported x3d shape: ElevationGrid"))}if(!(T<-3&&T!==-7))if(T<-1){if(D.length<1||R.length<3||R.length===void 0){j.warn("Indexed mesh must specify indices and points");break}const N=Math.floor(u.length/3);let M=2;if(T===-7)m=[...m,...D];else if(T===-2){let B=0;for(;M<D.length;)D[M]>=0?(m.push(D[B]+N),m.push(D[M-1]+N),m.push(D[M-0]+N),M+=1):(M+=3,B=M-2)}else for(;M<D.length;)D[M]>=0?(m.push(D[M-2]+N),m.push(D[M-1]+N),m.push(D[M-0]+N),M+=1):M+=3;u=[...u,...R];const V=Math.floor(R.length/3),I=Array(V).fill(w).flat();if(p.length===V*3){let B=0,U=0;for(let z=0;z<V;z++){for(let P=0;P<3;P++)I[U]=Math.round(p[B]*255),B++,U++;U++}}g=[...g,...I]}else if(T<0)Bn.makeColoredSphere(u,m,g,E,v,w);else{const N=Ge();c5(N,x[3],[x[0],x[1],x[2]]);const M=ut(0,-T*.5,0,1),V=ut(0,+T*.5,0,1);qt(M,M,N),qt(V,V,N),w2(M,M,v),w2(V,V,v);const I=he(M[0],M[1],M[2]),B=he(V[0],V[1],V[2]);Bn.makeColoredCylinder(u,m,g,I,B,E,w)}}return{positions:Float32Array.from(u),indices:Uint32Array.from(m),rgba255:Uint8Array.from(g)}}static async readGII(e,i=0){let n=e.byteLength;if(n<20)throw new Error("File too small to be GII: bytes = "+n);let r=new TextDecoder("ascii").decode(e);if(r[0].charCodeAt(0)===31){const U=await Ae.decompress(new Uint8Array(e));e=U.buffer,r=new TextDecoder("ascii").decode(U.buffer)}let o=0;function l(){let U=!0,z=o;for(;U;){for(;o<n&&r[o]!=="<";)o++;for(z=o;o<n&&r[o]!==">";)o++;if(U=r[o-1]==="/",z+1<n&&r[z+1]==="/"&&(o+=1,U=!0),o>=n)break}const P=new TextDecoder().decode(e.slice(z+1,o)).trim(),K=P.split(" ")[0].trim(),_=o;let H=o,q=o;if(r[z+1]!=="?"&&r[z+1]!=="!"){const se="</"+K+">";H=r.indexOf(se,_),q=H+se.length-1}return{name:P,startPos:z,contentStartPos:_,contentEndPos:H,endPos:q}}let h=l();if(!h.name.startsWith("?xml"))throw new Error("readGII: Invalid XML file");for(;!h.name.startsWith("GIFTI")&&h.endPos<n;)h=l();if(!h.name.startsWith("GIFTI")||h.contentStartPos===h.contentEndPos)throw new Error("readGII: XML file does not include GIFTI tag");n=h.contentEndPos;let f=new Float32Array,u=new Uint32Array,m=new Float32Array,g="",p=!1,v=!1,x=!1,w=!1,b=[1,1,1];const S=[0,0,0];let C=0,E=!1,T=!1,D=0,R=!1;h.endPos=h.contentStartPos;let N="";function M(U,z=!1){const P=N.indexOf(U);if(P<0)return 1;const K=N.indexOf('"',P)+1,_=N.indexOf('"',K),H=N.slice(K,_);return z?parseFloat(H):parseInt(H)}function V(U){const z=N.indexOf(U);if(z<0)return"";const P=z+U.length,K=N.indexOf("]",P);return N.slice(P,K)}const I={R:[],G:[],B:[],A:[],I:[],labels:[]};for(;h.endPos<n&&h.name.length>1;){if(h=l(),h.name.startsWith("Label Key")&&(N=h.name,I.I.push(M("Key=")),I.R.push(Math.round(255*M("Red=",!0))),I.G.push(Math.round(255*M("Green=",!0))),I.B.push(Math.round(255*M("Blue=",!0))),I.A.push(Math.round(255*M("Alpha",!0))),N=new TextDecoder().decode(e.slice(h.contentStartPos+1,h.contentEndPos)).trim(),I.labels.push(V("<![CDATA["))),h.name.trim()==="Data"){if(x)continue;N=new TextDecoder().decode(e.slice(h.contentStartPos+1,h.contentEndPos)).trim();let U;if(T){const z=b[0]*b[1]*b[2],P=N.split(/\s+/);if(z!==P.length)throw new Error("Unable to parse ASCII GIfTI");if(C===2&&(C=8),C===32&&(C=16),C===8){U=new Int32Array(z);for(let K=0;K<z;K++)U[K]=parseInt(P[K])}if(C===16){U=new Float32Array(z);for(let K=0;K<z;K++)U[K]=parseFloat(P[K])}}else if(typeof Buffer>"u"){let z=function(P){const K=atob(P),_=K.length,H=new Uint8Array(_);for(let q=0;q<_;q++)H[q]=K.charCodeAt(q);return H};if(E){const P=z(N.slice());U=await Ae.decompress(new Uint8Array(P))}else U=z(N.slice())}else if(E){const z=Buffer.from(N.slice(),"base64");U=await Ae.decompress(new Uint8Array(z))}else U=Buffer.from(N.slice(),"base64");if(v){if(C!==16&&j.warn("expect positions as FLOAT32"),f=new Float32Array(U.buffer),w){const z=f.slice(),P=z.length/3;let K=0;for(let _=0;_<P;_++)for(let H=0;H<3;H++)f[K]=z[H*P+_],K++}}else if(p){if(C!==8&&j.warn("expect indices as INT32"),u=new Uint32Array(U.buffer),w){const z=u.slice(),P=z.length/3;let K=0;for(let _=0;_<P;_++)for(let H=0;H<3;H++)u[K]=z[H*P+_],K++}}else{let z=function(K,_){const H=K.length,q=new Float32Array(H+_.length);return q.set(K),q.set(_,H),q};D=b[0]*b[1]*b[2],i!==0&&D%i!==0&&j.warn("Number of vertices in scalar overlay ("+D+") does not match mesh ("+i+")");let P;if(C===2){const K=new Uint8Array(U.buffer);P=Float32Array.from(K)}else if(C===8){const K=new Int32Array(U.buffer);P=Float32Array.from(K)}else if(C===16)P=new Float32Array(U.buffer);else if(C===32){const K=new Float64Array(U.buffer);P=Float32Array.from(K)}else throw new Error(`Invalid dataType: ${C}`);m=z(m,P)}continue}if(h.name.trim()==="DataSpace"&&(N=new TextDecoder().decode(e.slice(h.contentStartPos+1,h.contentEndPos)).trim(),N.includes("NIFTI_XFORM_SCANNER_ANAT")&&(R=!0)),h.name.trim()==="MD"&&(N=new TextDecoder().decode(e.slice(h.contentStartPos+1,h.contentEndPos)).trim(),N.includes("AnatomicalStructurePrimary")&&N.includes("CDATA[")&&(g=V("<Value><![CDATA[").toUpperCase()),N.includes("VolGeom")&&N.includes("CDATA["))){let U=-1;if(N.includes("VolGeomC_R")&&(U=0),N.includes("VolGeomC_A")&&(U=1),N.includes("VolGeomC_S")&&(U=2),U<0)continue;S[U]=parseFloat(V("<Value><![CDATA["))}h.name.startsWith("DataArray")&&(N=h.name,b=[1,1,1],E=N.includes('Encoding="GZipBase64Binary"'),T=N.includes('Encoding="ASCII"'),p=N.includes('Intent="NIFTI_INTENT_TRIANGLE"'),v=N.includes('Intent="NIFTI_INTENT_POINTSET"'),x=N.includes('Intent="NIFTI_INTENT_VECTOR"'),w=N.includes('ArrayIndexingOrder="ColumnMajorOrder"'),N.includes('DataType="NIFTI_TYPE_UINT8"')&&(C=2),N.includes('DataType="NIFTI_TYPE_INT32"')&&(C=8),N.includes('DataType="NIFTI_TYPE_FLOAT32"')&&(C=16),N.includes('DataType="NIFTI_TYPE_FLOAT64"')&&(C=32),b[0]=M("Dim0="),b[1]=M("Dim1="),b[2]=M("Dim2="))}let B;if(I.I.length>1&&(B=et.makeLabelLut(I)),i>0)return{scalars:m,colormapLabel:B,anatomicalStructurePrimary:g};if(f.length>2&&!R&&(S[0]!==0||S[1]!==0||S[2]!==0)){D=Math.floor(f.length/3);let U=0;for(let z=0;z<D;z++)f[U]+=S[0],U++,f[U]+=S[1],U++,f[U]+=S[2],U++}return{positions:f,indices:u,scalars:m,colormapLabel:B,anatomicalStructurePrimary:g}}},xf=class{constructor(t,e,i,n,r){k(this,"text"),k(this,"style"),k(this,"points"),k(this,"anchor"),k(this,"onClick"),this.text=t,this.style=e,this.points=i,this.anchor=n||0,this.onClick=r}},dx=()=>{const t=new ArrayBuffer(2);return new DataView(t).setInt16(0,256,!0),new Int16Array(t)[0]===256},ag=(t=>(t[t.UNKNOWN=0]="UNKNOWN",t[t.NII=1]="NII",t[t.DCM=2]="DCM",t[t.DCM_MANIFEST=3]="DCM_MANIFEST",t[t.MIH=4]="MIH",t[t.MIF=5]="MIF",t[t.NHDR=6]="NHDR",t[t.NRRD=7]="NRRD",t[t.MHD=8]="MHD",t[t.MHA=9]="MHA",t[t.MGH=10]="MGH",t[t.MGZ=11]="MGZ",t[t.V=12]="V",t[t.V16=13]="V16",t[t.VMR=14]="VMR",t[t.HEAD=15]="HEAD",t[t.DCM_FOLDER=16]="DCM_FOLDER",t[t.SRC=17]="SRC",t[t.FIB=18]="FIB",t[t.BMP=19]="BMP",t[t.ZARR=20]="ZARR",t[t.NPY=21]="NPY",t[t.NPZ=22]="NPZ",t))(ag||{}),Fe=Object.freeze({...ag,parse:t=>{let e=0;switch(t.toUpperCase()){case"":case"DCM":e=2;break;case"TXT":e=3;break;case"FZ":case"GQI":case"QSDR":case"FIB":e=18;break;case"NII":e=1;break;case"MIH":e=4;break;case"MIF":e=5;break;case"NHDR":e=6;break;case"NRRD":e=7;break;case"MHD":e=8;break;case"MHA":e=9;break;case"MGH":e=10;break;case"MGZ":e=11;break;case"NPY":e=21;break;case"NPZ":e=22;break;case"SRC":e=17;break;case"V":e=12;break;case"V16":e=13;break;case"VMR":e=14;break;case"HEAD":e=15;break;case"PNG":case"BMP":case"GIF":case"JPG":case"JPEG":e=19;break;case"ZARR":e=20;break}return e}}),Yl=(t,e="",i="",n="gray",r=1,o=NaN,l=NaN,h=!0,f=.02,u=!1,m=!1,g="",p=0,v=Fe.UNKNOWN,x=NaN,w=NaN,b=!0,S=!1,C=null)=>({url:t,urlImageData:e,name:i,colormap:n,colorMap:n,opacity:r,cal_min:o,cal_max:l,trustCalMinMax:h,percentileFrac:f,ignoreZeroVoxels:u,useQFormNotSForm:m,colormapNegative:g,imageType:v,cal_minNeg:x,cal_maxNeg:w,colorbarVisible:b,frame4D:p,alphaThreshold:S,colormapLabel:C});function q2(t,e=80){t=t.replace(/[`$]/g,"");const i=[],n=Math.min(e,t.length);for(let r=0;r<n;r++){const o=t.charCodeAt(r);i.push(o&255)}return i}function Zl(t,e=!1,i=!1){let o=!0;i&&(o=t.littleEndian);const l=new Uint8Array(348),h=new DataView(l.buffer);h.setInt32(0,348,o),h.setUint8(38,114),h.setUint8(39,t.dim_info);for(let u=0;u<8;u++)h.setUint16(40+2*u,t.dims[u],o);h.setFloat32(56,t.intent_p1,o),h.setFloat32(60,t.intent_p2,o),h.setFloat32(64,t.intent_p3,o),h.setInt16(68,t.intent_code,o),e?(h.setInt16(70,2,o),h.setInt16(72,8,o)):(h.setInt16(70,t.datatypeCode,o),h.setInt16(72,t.numBitsPerVoxel,o)),h.setInt16(74,t.slice_start,o);for(let u=0;u<8;u++)h.setFloat32(76+4*u,t.pixDims[u],o);e?(h.setFloat32(108,352,o),h.setFloat32(112,1,o),h.setFloat32(116,0,o)):(h.setFloat32(108,352,o),h.setFloat32(112,t.scl_slope,o),h.setFloat32(116,t.scl_inter,o)),h.setInt16(120,t.slice_end,o),h.setUint8(122,t.slice_code),t.xyzt_units===0?h.setUint8(123,10):h.setUint8(123,t.xyzt_units),e?(h.setFloat32(124,0,o),h.setFloat32(128,0,o)):(h.setFloat32(124,t.cal_max,o),h.setFloat32(128,t.cal_min,o)),h.setFloat32(132,t.slice_duration,o),h.setFloat32(136,t.toffset,o),l.set(q2(t.description),148),l.set(q2(t.aux_file),228),h.setInt16(252,t.qform_code,o),t.sform_code<1||t.sform_code<1?h.setInt16(254,1,o):h.setInt16(254,t.sform_code,o),h.setFloat32(256,t.quatern_b,o),h.setFloat32(260,t.quatern_c,o),h.setFloat32(264,t.quatern_d,o),h.setFloat32(268,t.qoffset_x,o),h.setFloat32(272,t.qoffset_y,o),h.setFloat32(276,t.qoffset_z,o);const f=t.affine.flat();for(let u=0;u<12;u++)h.setFloat32(280+4*u,f[u],o);return h.setInt32(344,3222382,!0),l}function mx(t,e=!0){const i=Math.round(t.length/3),n=he(0,0,0),r=ot(),o=ot();let l=0,h=1;e&&(h=2);for(let g=0;g<h;g++){l=0;for(let v=0;v<i;v++){const x=he(t[v*3],t[v*3+1],t[v*3+2]);v===0&&(x2(r,x),x2(o,x)),ef(r,r,x),tf(o,o,x),ct(x,x,n);const w=Qr(x);l=Math.max(l,w)}if(g+1>=h)break;let p=!0;for(let v=0;v<3;++v)r[v]>n[v]&&(p=!1),o[v]<n[v]&&(p=!1);if(p)break;g5(n,r,o,.5),j.debug("origin moved inside volume: ",n)}const f=[r[0],r[1],r[2]],u=[o[0],o[1],o[2]];return{min:f,max:u,furthestVertexFromOrigin:l,origin:n}}function K2(t){const e=[!1,!1,!1,!1],i=[!1,!1,!1,!1];for(let n=0;n<4;n++)for(let r=0;r<4;r++)if(isNaN(t[n][r]))return!1;for(let n=0;n<3;n++)for(let r=0;r<3;r++)t[n][r]!==0&&(e[n]=!0,i[r]=!0);for(let n=0;n<3;n++)if(!e[n]||!i[n])return!1;return!0}async function Ih(t){const e=t.getReader(),{done:i,value:n}=await e.read();if(i)return e.releaseLock(),new ReadableStream({start(l){l.close()}});if(!n||n.length<2)return e.releaseLock(),new ReadableStream({start(l){n&&l.enqueue(n),l.close()}});const r=n[0]===31&&n[1]===139,o=new ReadableStream({async start(l){try{for(l.enqueue(n);;){const{done:h,value:f}=await e.read();if(h){l.close(),e.releaseLock();break}l.enqueue(f)}}catch(h){l.error(h),e.releaseLock()}}});return r?o.pipeThrough(new DecompressionStream("gzip")):o}function rg(t=[256,256,256],e=[1,1,1],i=[1,0,0,-128,0,1,0,-128,0,0,1,-128,0,0,0,1],n=2){const r=new Be;r.littleEndian=!0,r.dims=[3,1,1,1,0,0,0,0],r.dims[0]=Math.max(3,t.length);for(let l=0;l<t.length;l++)r.dims[l+1]=t[l];r.pixDims=[1,1,1,1,1,0,0,0];for(let l=0;l<t.length;l++)r.pixDims[l+1]=e[l];if(i.length===16){let l=0;for(let h=0;h<4;h++)for(let f=0;f<4;f++)r.affine[h][f]=i[l],l++}let o=8;return n===256||n===2?o=8:n===512||n===4?o=16:n===16||n===768||n===8||n===2304?o=32:n===64?o=64:j.warn("Unsupported NIfTI datatypeCode for header creation: "+n),r.datatypeCode=n,r.numBitsPerVoxel=o,r.scl_inter=0,r.scl_slope=1,r.sform_code=2,r.magic="n+1",r.vox_offset=352,r}function gx(t=[256,256,256],e=[1,1,1],i=[1,0,0,-128,0,1,0,-128,0,0,1,-128,0,0,0,1],n=2,r=new Uint8Array){const o=rg(t,e,i,n),l=Zl(o,!1);o.vox_offset=Math.max(352,l.length);const h=Zl(o,!1);if(r.length<1)return h;const f=Math.max(0,o.vox_offset-h.length),u=new Uint8Array(f),m=new Uint8Array(r.buffer,r.byteOffset,r.byteLength),g=o.vox_offset+m.length,p=new Uint8Array(g);return p.set(h,0),p.set(u,h.length),p.set(m,o.vox_offset),p}function og(t,e=null){if(!t.hdr)throw new Error("NVImage header is not defined for toUint8Array");if(!t.img&&e===null)throw new Error("NVImage image data is not defined for toUint8Array");const i=e!==null,n=JSON.parse(JSON.stringify(t.hdr));n.vox_offset=Math.max(352,n.vox_offset),i&&(n.datatypeCode=2,n.numBitsPerVoxel=8,n.scl_slope=1,n.scl_inter=0);const r=Zl(n,i);let o;if(i){const g=e,p=t.permRAS;if(p&&(p[0]!==1||p[1]!==2||p[2]!==3)){j.debug("Reorienting drawing bytes back to native space for saving...");const v=t.hdr.dims,x=v[1]*v[2]*v[3],w=t.dimsRAS?t.dimsRAS[1]*t.dimsRAS[2]*t.dimsRAS[3]:x;if(g.length!==w)console.warn(`Drawing length (${g.length}) does not match expected RAS voxel count (${w}). Cannot reorient drawing reliably.`),o=g;else if(!t.img2RASstep||!t.img2RASstart||!t.dimsRAS)console.warn("Missing RAS transformation info (img2RASstep, img2RASstart, dimsRAS). Cannot reorient drawing reliably."),o=g;else{const b=t.img2RASstep,S=t.img2RASstart,C=t.dimsRAS,E=new Uint8Array(x);E.fill(0);const T=g;let D=0;for(let R=0;R<C[3];R++){const N=S[2]+R*b[2];for(let M=0;M<C[2];M++){const V=S[1]+M*b[1];for(let I=0;I<C[1];I++){const U=S[0]+I*b[0]+V+N;U>=0&&U<x?E[U]=T[D]:D<T.length&&console.warn(`Calculated native index ${U} is out of bounds [0..${x-1}] during drawing reorientation.`),D++}}}o=E}}else o=g}else{if(!t.img)throw new Error("NVImage image data is null when trying to save non-drawing.");o=new Uint8Array(t.img.buffer,t.img.byteOffset,t.img.byteLength)}const l=r.length,h=Math.max(0,n.vox_offset-l),f=new Uint8Array(h),u=n.vox_offset+o.length,m=new Uint8Array(u);return m.set(r,0),m.set(f,l),m.set(o,n.vox_offset),m}async function lg(t,e,i=null){const n=og(t,i);if(e.toLowerCase().endsWith(".gz"))try{const o=await Ae.compress(n,"gzip");return new Uint8Array(o)}catch(o){return j.error("Compression failed:",o),j.warn("Returning uncompressed data due to compression error."),n}else return n}async function px(t,e="",i=null){const n=await lg(t,e,i);if(!e)return j.debug("saveToDisk: empty file name, returning data as Uint8Array rather than triggering download"),n;try{const r=new Blob([n.buffer],{type:"application/octet-stream"}),o=URL.createObjectURL(r),l=document.createElement("a");l.setAttribute("href",o),l.setAttribute("download",e),l.style.visibility="hidden",document.body.appendChild(l),l.click(),document.body.removeChild(l),setTimeout(()=>URL.revokeObjectURL(o),100)}catch(r){j.error("Failed to trigger download:",r)}return n}function Ax(t,e,i,n,r=0,o=!1){if(!t.hdr)throw new Error("getValue: NVImage header is not defined.");if(!o&&!t.img)throw new Error("getValue: NVImage image data is not defined.");if(o&&!t.imaginary)return j.warn("getValue: Attempted to read imaginary data, but none exists."),0;const l=t.hdr.dims[1],h=t.hdr.dims[2],f=t.hdr.dims[3],u=t.permRAS.slice();if(u[0]!==1||u[1]!==2||u[2]!==3){const C=ut(e,i,n,1);qt(C,C,t.toRASvox),e=C[0],i=C[1],n=C[2]}e=Math.max(0,Math.min(Math.round(e),l-1)),i=Math.max(0,Math.min(Math.round(i),h-1)),n=Math.max(0,Math.min(Math.round(n),f-1)),r=Math.max(0,r);let m=e+i*l+n*l*h;if(t.hdr.datatypeCode===2304){if(!t.img)return 0;if(m*=4,m+2>=t.img.length)return j.warn(`getValue: Calculated index ${m} out of bounds for RGBA data.`),0;const C=t.img[m]*.2126+t.img[m+1]*.7152+t.img[m+2]*.0722;return Math.round(C)}if(t.hdr.datatypeCode===128){if(!t.img)return 0;if(m*=3,m+2>=t.img.length)return j.warn(`getValue: Calculated index ${m} out of bounds for RGB data.`),0;const C=t.img[m]*.2126+t.img[m+1]*.7152+t.img[m+2]*.0722;return Math.round(C)}const g=l*h*f,p=r*g,v=m+p,x=o?t.imaginary:t.img;if(v<0||v>=x.length)return 0;const w=x[v],b=isNaN(t.hdr.scl_slope)||t.hdr.scl_slope===0?1:t.hdr.scl_slope,S=isNaN(t.hdr.scl_inter)?0:t.hdr.scl_inter;return b*w+S}function vx(t,e=[-1,0,0],i=[0,0,0],n="same"){const r=[new Uint8Array,[0,0,0]];if(!t.hdr||!t.img||!t.dimsRAS||!t.img2RASstep||!t.img2RASstart)return j.error("getVolumeData: Missing required NVImage properties (hdr, img, dimsRAS, img2RASstep/start)."),r;if(e=e.slice(0,3),i=i.slice(0,3),Math.min(...e)<0||Math.min(...i)<0)return j.warn("getVolumeData: Invalid start or end coordinates provided."),r;const o=t.dimsRAS.slice(1,4);for(let b=0;b<3;b++)if(e[b]=Math.max(0,Math.min(Math.round(e[b]),o[b]-1)),i[b]=Math.max(0,Math.min(Math.round(i[b]),o[b]-1)),i[b]<e[b]){const S=i[b];i[b]=e[b],e[b]=S}const l=[i[0]-e[0]+1,i[1]-e[1]+1,i[2]-e[2]+1],h=l[0]*l[1]*l[2];if(h<=0)return j.warn("getVolumeData: Calculated slab size is zero or negative."),r;let f=t.img.constructor;n==="uint8"?f=Uint8Array:n==="int16"?f=Int16Array:n==="uint16"?f=Uint16Array:n==="float32"||n==="scaled"||n==="normalized"||n==="windowed"?f=Float32Array:n==="float64"?f=Float64Array:n!=="same"&&j.warn(`getVolumeData: Unsupported dataType '${n}'. Using 'same'.`);let u;try{u=new f(h)}catch(b){return j.error(`getVolumeData: Failed to create output array for dataType '${n}'.`,b),r}const m=t.img2RASstep,g=t.img2RASstart,p=t.img;let v=0;for(let b=e[2];b<=i[2];b++){const S=g[2]+b*m[2];for(let C=e[1];C<=i[1];C++){const E=g[1]+C*m[1];for(let T=e[0];T<=i[0];T++){const R=g[0]+T*m[0]+E+S;let N=0;R>=0&&R<p.length&&(N=p[R]),u[v++]=N}}}const x=isNaN(t.hdr.scl_slope)||t.hdr.scl_slope===0?1:t.hdr.scl_slope,w=isNaN(t.hdr.scl_inter)?0:t.hdr.scl_inter;if(n==="scaled"||n==="normalized"||n==="windowed"){u instanceof Float32Array||(j.warn(`getVolumeData: Converting output to Float32 for scaling type '${n}'.`),u=Float32Array.from(u));for(let b=0;b<u.length;b++)u[b]=u[b]*x+w}if(n==="normalized"||n==="windowed"){let b=t.cal_min,S=t.cal_max;n==="normalized"&&(b=t.global_min,S=t.global_max);const C=S-b,E=C===0?0:1/C;for(let T=0;T<u.length;T++)u[T]=(u[T]-b)*E,u[T]=Math.max(0,Math.min(u[T],1))}return[u,l]}function xx(t,e=[-1,0,0],i=[0,0,0],n=new Uint8Array){if(!t.hdr||!t.img||!t.dimsRAS||!t.img2RASstep||!t.img2RASstart){j.error("setVolumeData: Missing required NVImage properties (hdr, img, dimsRAS, img2RASstep/start).");return}if(n.length<1){j.warn("setVolumeData: Input slabData is empty.");return}if(e=e.slice(0,3),i=i.slice(0,3),Math.min(...e)<0||Math.min(...i)<0){j.warn("setVolumeData: Invalid start or end coordinates provided.");return}const r=t.dimsRAS.slice(1,4);for(let g=0;g<3;g++)if(e[g]=Math.max(0,Math.min(Math.round(e[g]),r[g]-1)),i[g]=Math.max(0,Math.min(Math.round(i[g]),r[g]-1)),i[g]<e[g]){const p=i[g];i[g]=e[g],e[g]=p}const o=[i[0]-e[0]+1,i[1]-e[1]+1,i[2]-e[2]+1],l=o[0]*o[1]*o[2];if(l<=0){j.warn("setVolumeData: Calculated slab size is zero or negative.");return}if(n.length<l){j.error(`setVolumeData: Input slabData length (${n.length}) is less than the calculated slab size (${l}).`);return}const h=t.img2RASstep,f=t.img2RASstart,u=t.img;let m=0;for(let g=e[2];g<=i[2];g++){const p=f[2]+g*h[2];for(let v=e[1];v<=i[1];v++){const x=f[1]+v*h[1];for(let w=e[0];w<=i[0];w++){const S=f[0]+w*h[0]+x+p;S>=0&&S<u.length&&(u[S]=n[m]),m++}}}}var cg={};sc(cg,{readMgh:()=>yx});async function yx(t,e){t.hdr||(j.warn("readMgh called before nvImage.hdr was initialized. Creating default."),t.hdr=new Be);const i=t.hdr;i.littleEndian=!1;let n=e,r=new DataView(n);if(n.byteLength>=2&&r.getUint8(0)===31&&r.getUint8(1)===139)try{n=await Ae.decompressToBuffer(new Uint8Array(e)),r=new DataView(n)}catch(se){return j.error("Failed to decompress MGZ file.",se),null}if(n.byteLength<284)return j.error("File too small to be a valid MGH/MGZ header."),null;const o=r.getInt32(0,!1),l=r.getInt32(4,!1),h=r.getInt32(8,!1),f=r.getInt32(12,!1),u=r.getInt32(16,!1),m=r.getInt32(20,!1),g=r.getFloat32(30,!1),p=r.getFloat32(34,!1),v=r.getFloat32(38,!1),x=r.getFloat32(42,!1),w=r.getFloat32(46,!1),b=r.getFloat32(50,!1),S=r.getFloat32(54,!1),C=r.getFloat32(58,!1),E=r.getFloat32(62,!1),T=r.getFloat32(66,!1),D=r.getFloat32(70,!1),R=r.getFloat32(74,!1),N=r.getFloat32(78,!1),M=r.getFloat32(82,!1),V=r.getFloat32(86,!1);if(o!==1&&j.warn(`Unexpected MGH version: ${o}.`),l<=0||h<=0||f<=0)return j.error(`Invalid MGH dimensions: ${l}x${h}x${f}`),null;switch(m){case 0:i.numBitsPerVoxel=8,i.datatypeCode=2;break;case 4:i.numBitsPerVoxel=16,i.datatypeCode=4;break;case 1:i.numBitsPerVoxel=32,i.datatypeCode=8;break;case 3:i.numBitsPerVoxel=32,i.datatypeCode=16;break;default:return j.error(`Unsupported MGH data type: ${m}`),null}i.dims[1]=l,i.dims[2]=h,i.dims[3]=f,i.dims[4]=Math.max(1,u),i.dims[0]=i.dims[4]>1?4:3,i.pixDims[1]=Math.abs(g),i.pixDims[2]=Math.abs(p),i.pixDims[3]=Math.abs(v),i.pixDims[4]=0,i.sform_code=1,i.qform_code=0;const I=Ri(x*i.pixDims[1],S*i.pixDims[2],T*i.pixDims[3],0,w*i.pixDims[1],C*i.pixDims[2],D*i.pixDims[3],0,b*i.pixDims[1],E*i.pixDims[2],R*i.pixDims[3],0,0,0,0,1),B=ut(i.dims[1]/2,i.dims[2]/2,i.dims[3]/2,1),U=cs();qt(U,B,I);const z=he(N-U[0],M-U[1],V-U[2]);i.affine=[[I[0],I[1],I[2],z[0]],[I[4],I[5],I[6],z[1]],[I[8],I[9],I[10],z[2]],[0,0,0,1]],i.vox_offset=284,i.magic="n+1";const P=i.numBitsPerVoxel/8,_=l*h*f*i.dims[4]*P,H=n.byteLength-i.vox_offset;return H<_?(j.error(`MGH image data size mismatch: expected ${_}, found ${H}`),null):(H>_&&j.warn(`MGH file has extra ${H-_} bytes after image data. Truncating.`),n.slice(i.vox_offset,i.vox_offset+_))}var ug={};sc(ug,{readNifti:()=>wx});async function wx(t,e){let i=e,n=null;try{if(of(i)&&(j.debug(`Decompressing NIfTI file: ${t.name}`),i=await J5(i),j.debug(`Decompression complete for: ${t.name}`)),!i||i.byteLength===0)throw new Error("Buffer became invalid after decompression attempt.");if(t.hdr=await Pr(i),t.hdr===null)throw new Error(`Failed to read NIfTI header: ${t.name}`);if(t.hdr.cal_min===0&&t.hdr.cal_max===255&&t.hdr.datatypeCode!==2&&(j.debug(`Resetting suspicious cal_min/max (0/255) for non-uint8 NIfTI: ${t.name}`),t.hdr.cal_min=0,t.hdr.cal_max=0),n=ev(t.hdr,i),n===null)throw new Error(`nifti-reader-js readImage returned null for ${t.name}`);return n}catch(r){return j.error(`Error processing NIfTI file ${t.name}:`,r),t.hdr=null,null}}var hg={};sc(hg,{readNrrd:()=>bx});async function bx(t,e,i=null){t.hdr||(j.warn("readNrrd called before nvImage.hdr was initialized. Creating default."),t.hdr=new Be);const n=t.hdr;n.pixDims=[1,1,1,1,1,0,0,0];const r=e.byteLength;let o=null;const l=new Uint8Array(e);for(let R=1;R<r;R++)if(l[R-1]===10&&l[R]===10){const N=e.slice(0,R-1);o=new TextDecoder().decode(N),n.vox_offset=R+1;break}if(o===null)return j.error("readNrrd: could not extract txt"),null;const h=o.split(`
`);if(!h[0].startsWith("NRRD"))return j.error("Invalid NRRD image (magic signature missing)"),null;const f=h.length;let u=!1,m=!1,g=!1;const p=Nn(NaN,0,0,0,1,0,0,0,1),v=he(0,0,0);let x=o5();for(let R=1;R<f;R++){let N=h[R];if((N.length===0||N[0]==="#")&&(N.startsWith("#")||N.trim().length===0))continue;N=N.toLowerCase();const M=N.split(":");if(M.length<2)continue;const V=M[0].trim();let I=M[1].trim();switch(I=I.replaceAll(")"," "),I=I.replaceAll("("," "),I=I.trim(),V){case"data file":g=!0;break;case"encoding":if(I.includes("raw"))u=!1;else if(I.includes("gz"))u=!0;else return j.error("Unsupported NRRD encoding"),null;break;case"type":switch(I){case"uchar":case"unsigned char":case"uint8":case"uint8_t":n.numBitsPerVoxel=8,n.datatypeCode=2;break;case"signed char":case"int8":case"int8_t":n.numBitsPerVoxel=8,n.datatypeCode=256;break;case"short":case"short int":case"signed short":case"signed short int":case"int16":case"int16_t":n.numBitsPerVoxel=16,n.datatypeCode=4;break;case"ushort":case"unsigned short":case"unsigned short int":case"uint16":case"uint16_t":n.numBitsPerVoxel=16,n.datatypeCode=512;break;case"int":case"signed int":case"int32":case"int32_t":n.numBitsPerVoxel=32,n.datatypeCode=8;break;case"uint":case"unsigned int":case"uint32":case"uint32_t":n.numBitsPerVoxel=32,n.datatypeCode=768;break;case"float":n.numBitsPerVoxel=32,n.datatypeCode=16;break;case"double":n.numBitsPerVoxel=64,n.datatypeCode=64;break;default:return j.error("Unsupported NRRD data type: "+I),null}break;case"spacings":{const B=I.split(/[ ,]+/);for(let U=0;U<B.length;U++)n.pixDims[U+1]=parseFloat(B[U])}break;case"sizes":{const B=I.split(/[ ,]+/);n.dims[0]=B.length;for(let U=0;U<B.length;U++)n.dims[U+1]=parseInt(B[U])}break;case"endian":I.includes("little")?n.littleEndian=!0:I.includes("big")&&(n.littleEndian=!1);break;case"space directions":{const B=I.split(/[ ,]+/);if(B.length===9)for(let U=0;U<9;U++)p[U]=parseFloat(B[U])}break;case"space origin":{const B=I.split(/[ ,]+/);B.length===3&&(v[0]=parseFloat(B[0]),v[1]=parseFloat(B[1]),v[2]=parseFloat(B[2]))}break;case"space units":I.includes("microns")&&(m=!0);break;case"space":I.includes("right-anterior-superior")||I.includes("ras")?x=Nn(1,0,0,0,1,0,0,0,1):I.includes("left-anterior-superior")||I.includes("las")?x=Nn(-1,0,0,0,1,0,0,0,1):I.includes("left-posterior-superior")||I.includes("lps")?x=Nn(-1,0,0,0,-1,0,0,0,1):j.warn("Unsupported NRRD space value:",I);break;default:j.warn("Unknown:",V);break}}if(!isNaN(p[0])){n.sform_code=2,m&&(h5(p,p,.001),v[0]*=.001,v[1]*=.001,v[2]*=.001),x[0]<0&&(v[0]=-v[0]),x[4]<0&&(v[1]=-v[1]),x[8]<0&&(v[2]=-v[2]),Dm(p,x,p);const R=Ri(p[0],p[3],p[6],v[0],p[1],p[4],p[7],v[1],p[2],p[5],p[8],v[2],0,0,0,1);if(!t.vox2mm)return null;const N=t.vox2mm([0,0,0],R),M=t.vox2mm([1,0,0],R);ct(M,M,N);const V=t.vox2mm([0,1,0],R);ct(V,V,N);const I=t.vox2mm([0,0,1],R);ct(I,I,N),n.pixDims[1]=rn(M),n.pixDims[2]=rn(V),n.pixDims[3]=rn(I),n.affine=[[R[0],R[1],R[2],R[3]],[R[4],R[5],R[6],R[7]],[R[8],R[9],R[10],R[11]],[0,0,0,1]]}let w=null;const b=g?i:e,S=g?0:n.vox_offset;if(g&&!b)return j.warn("Missing data: NRRD header describes detached data file but only one URL provided"),null;if(!b||S>=b.byteLength)return j.error(`NRRD data offset (${S}) invalid for buffer length (${(b==null?void 0:b.byteLength)??0})`),null;let C=b.slice(S);if(u)try{j.debug("Decompressing NRRD data..."),C=await Ae.decompressToBuffer(new Uint8Array(C)),j.debug("Decompression complete.")}catch(R){return j.error("Failed to decompress NRRD data.",R),null}const E=n.numBitsPerVoxel/8,D=n.dims.slice(1,n.dims[0]+1).reduce((R,N)=>R*Math.max(1,N),1)*E;return C.byteLength<D?(j.error(`NRRD image data size mismatch: expected ${D}, found ${C.byteLength}`),null):(C.byteLength>D&&(j.warn(`NRRD has extra ${C.byteLength-D} bytes after expected image data. Truncating.`),C=C.slice(0,D)),w=C,n.datatypeCode?n.numBitsPerVoxel?w:(j.error("NRRD parsing failed to set numBitsPerVoxel."),null):(j.error("NRRD parsing failed to set datatypeCode."),null))}var ni=class Hl{constructor(e=null,i="",n="gray",r=1,o=null,l=NaN,h=NaN,f=!0,u=.02,m=!1,g=!1,p="",v=0,x=Fe.UNKNOWN,w=NaN,b=NaN,S=!0,C=null,E=0){k(this,"name"),k(this,"id"),k(this,"url"),k(this,"headers"),k(this,"_colormap"),k(this,"_opacity"),k(this,"percentileFrac"),k(this,"ignoreZeroVoxels"),k(this,"trustCalMinMax"),k(this,"colormapNegative"),k(this,"colormapLabel"),k(this,"colormapInvert"),k(this,"nFrame4D"),k(this,"frame4D"),k(this,"nTotalFrame4D"),k(this,"cal_minNeg"),k(this,"cal_maxNeg"),k(this,"colorbarVisible",!0),k(this,"modulationImage",null),k(this,"modulateAlpha",0),k(this,"series",[]),k(this,"nVox3D"),k(this,"oblique_angle"),k(this,"maxShearDeg"),k(this,"useQFormNotSForm"),k(this,"colormapType"),k(this,"pixDims"),k(this,"matRAS"),k(this,"pixDimsRAS"),k(this,"obliqueRAS"),k(this,"dimsRAS"),k(this,"permRAS"),k(this,"img2RASstep"),k(this,"img2RASstart"),k(this,"toRAS"),k(this,"toRASvox"),k(this,"frac2mm"),k(this,"frac2mmOrtho"),k(this,"extentsMinOrtho"),k(this,"extentsMaxOrtho"),k(this,"mm2ortho"),k(this,"hdr",null),k(this,"imageType"),k(this,"img"),k(this,"imaginary"),k(this,"v1"),k(this,"fileObject"),k(this,"dims"),k(this,"onColormapChange",()=>{}),k(this,"onOpacityChange",()=>{}),k(this,"mm000"),k(this,"mm100"),k(this,"mm010"),k(this,"mm001"),k(this,"cal_min"),k(this,"cal_max"),k(this,"robust_min"),k(this,"robust_max"),k(this,"global_min"),k(this,"global_max"),k(this,"urlImgData"),k(this,"isManifest"),k(this,"limitFrames4D"),this.init(e,i,n,r,o,l,h,f,u,m,g,p,v,x,w,b,S,C,E)}init(e=null,i="",n="gray",r=1,o=null,l=NaN,h=NaN,f=!0,u=.02,m=!1,g=!1,p="",v=0,x=Fe.UNKNOWN,w=NaN,b=NaN,S=!0,C=null,E=0,T=null){if(this.name=i,this.imageType=x,this.id=_h(),this._colormap=n,this._opacity=r>1?1:r,this.percentileFrac=u,this.ignoreZeroVoxels=m,this.trustCalMinMax=f,this.colormapNegative=p,this.colormapLabel=C,this.frame4D=v,this.cal_minNeg=w,this.cal_maxNeg=b,this.colorbarVisible=S,this.colormapType=E,this.useQFormNotSForm=g,!e)return;if(this.hdr&&typeof this.hdr.magic=="number"&&(this.hdr.magic="n+1"),this.nFrame4D=1,this.hdr)for(let M=4;M<7;M++)this.hdr.dims[M]>1&&(this.nFrame4D*=this.hdr.dims[M]);if(this.frame4D=Math.min(this.frame4D,this.nFrame4D-1),this.nTotalFrame4D=this.nFrame4D,!this.hdr||!T)return;this.nVox3D=this.hdr.dims[1]*this.hdr.dims[2]*this.hdr.dims[3];const D=this.nVox3D*(this.hdr.numBitsPerVoxel/8),R=T.byteLength/D;R!==this.nFrame4D&&(R>0&&R*D===T.byteLength?j.debug("Loading the first "+R+" of "+this.nFrame4D+" volumes"):j.warn("This header does not match voxel data",this.hdr,T.byteLength),this.nFrame4D=R),(this.hdr.intent_code===1007||this.hdr.intent_code===2003)&&this.nFrame4D===3&&this.hdr.datatypeCode===16&&(T=this.float32V1asRGBA(new Float32Array(T)).buffer),(this.hdr.pixDims[1]===0||this.hdr.pixDims[2]===0||this.hdr.pixDims[3]===0)&&j.error("pixDims not plausible",this.hdr),(isNaN(this.hdr.scl_slope)||this.hdr.scl_slope===0)&&(this.hdr.scl_slope=1),isNaN(this.hdr.scl_inter)&&(this.hdr.scl_inter=0);let N=K2(this.hdr.affine);if(g||!N||this.hdr.qform_code>this.hdr.sform_code){j.debug("spatial transform based on QForm");const M=this.hdr.quatern_b,V=this.hdr.quatern_c,I=this.hdr.quatern_d,B=Math.sqrt(1-(Math.pow(M,2)+Math.pow(V,2)+Math.pow(I,2))),U=this.hdr.pixDims[0]===0?1:this.hdr.pixDims[0],z=[[B*B+M*M-V*V-I*I,2*M*V-2*B*I,2*M*I+2*B*V],[2*M*V+2*B*I,B*B+V*V-M*M-I*I,2*V*I-2*B*M],[2*M*I-2*B*V,2*V*I+2*B*M,B*B+I*I-V*V-M*M]],P=this.hdr.affine;for(let K=0;K<3;K+=1)for(let _=0;_<3;_+=1)P[K][_]=z[K][_]*this.hdr.pixDims[_+1],_===2&&(P[K][_]*=U);P[0][3]=this.hdr.qoffset_x,P[1][3]=this.hdr.qoffset_y,P[2][3]=this.hdr.qoffset_z,this.hdr.affine=P}if(N=K2(this.hdr.affine),!N){j.debug("Defective NIfTI: spatial transform does not make sense");let M=this.hdr.pixDims[1],V=this.hdr.pixDims[2],I=this.hdr.pixDims[3];(isNaN(M)||M===0)&&(M=1),(isNaN(V)||V===0)&&(V=1),(isNaN(I)||I===0)&&(I=1),this.hdr.pixDims[1]=M,this.hdr.pixDims[2]=V,this.hdr.pixDims[3]=I;const B=[[M,0,0,0],[0,V,0,0],[0,0,I,0],[0,0,0,1]];this.hdr.affine=B}if(this.hdr.datatypeCode!==128&&this.hdr.datatypeCode!==2304&&this.hdr.littleEndian!==dx()&&this.hdr.numBitsPerVoxel>8){if(this.hdr.numBitsPerVoxel===16){const M=new Uint16Array(T);for(let V=0;V<M.length;V++){const I=M[V];M[V]=((I&255)<<8|I>>8&255)<<16>>16}}else if(this.hdr.numBitsPerVoxel===32){const M=new Uint32Array(T);for(let V=0;V<M.length;V++){const I=M[V];M[V]=(I&255)<<24|(I&65280)<<8|I>>8&65280|I>>24&255}}else if(this.hdr.numBitsPerVoxel===64){const M=this.hdr.numBitsPerVoxel/8,V=new Uint8Array(T);for(let I=0;I<V.length;I+=M){let B=M-1;for(let U=0;U<B;U++){const z=V[I+U];V[I+U]=V[I+B],V[I+B]=z,B--}}}}switch(this.hdr.datatypeCode){case 2:this.img=new Uint8Array(T);break;case 4:this.img=new Int16Array(T);break;case 16:this.img=new Float32Array(T);break;case 64:this.img=new Float64Array(T);break;case 128:this.img=new Uint8Array(T);break;case 512:this.img=new Uint16Array(T);break;case 2304:this.img=new Uint8Array(T);break;case 256:{const M=new Int8Array(T),V=M.length;this.img=new Int16Array(V);for(let I=0;I<V;I++)this.img[I]=M[I];this.hdr.datatypeCode=4,this.hdr.numBitsPerVoxel=16;break}case 1:{const M=this.hdr.dims[1]*this.hdr.dims[2]*Math.max(1,this.hdr.dims[3])*Math.max(1,this.hdr.dims[4]),V=new Uint8Array(T);this.img=new Uint8Array(M);const I=new Uint8Array(8);for(let U=0;U<8;U++)I[U]=Math.pow(2,U);let B=-1;for(let U=0;U<M;U++){const z=U%8;z===0&&B++,(V[B]&I[z])!==0&&(this.img[U]=1)}this.hdr.datatypeCode=2,this.hdr.numBitsPerVoxel=8;break}case 768:{const M=new Uint32Array(T),V=M.length;this.img=new Float64Array(V);for(let I=0;I<V-1;I++)this.img[I]=M[I];this.hdr.datatypeCode=64;break}case 8:{const M=new Int32Array(T),V=M.length;this.img=new Float64Array(V);for(let I=0;I<V-1;I++)this.img[I]=M[I];this.hdr.datatypeCode=64;break}case 1024:{const M=new BigInt64Array(T),V=M.length;this.img=new Float64Array(V);for(let I=0;I<V-1;I++)this.img[I]=Number(M[I]);this.hdr.datatypeCode=64;break}case 32:{const M=new Float32Array(T),V=Math.floor(M.length/2);this.imaginary=new Float32Array(V),this.img=new Float32Array(V);let I=0;for(let B=0;B<V-1;B++)this.img[B]=M[I],this.imaginary[B]=M[I+1],I+=2;this.hdr.datatypeCode=16;break}default:throw new Error("datatype "+this.hdr.datatypeCode+" not supported")}this.calculateRAS(),isNaN(l)||(this.hdr.cal_min=l),isNaN(h)||(this.hdr.cal_max=h),this.calMinMax()}static async new(e=null,i="",n="gray",r=1,o=null,l=NaN,h=NaN,f=!0,u=.02,m=!1,g=!1,p="",v=0,x=Fe.UNKNOWN,w=NaN,b=NaN,S=!0,C=null,E=0,T){const D=new Hl,R=/(?:\.([^.]+))?$/;let N=R.exec(i)[1]||"";N=N.toUpperCase(),N==="GZ"&&(N=R.exec(i.slice(0,-3))[1],N=N.toUpperCase());let M=null;if(x===Fe.UNKNOWN&&(x=Fe.parse(N)),e instanceof ArrayBuffer&&e.byteLength>=2&&x===Fe.DCM){const V=new Uint8Array(e);(V[0]===92&&V[1]===1||V[1]===92&&V[0]===1)&&(x=Fe.NII)}switch(D.imageType=x,x){case Fe.DCM_FOLDER:case Fe.DCM_MANIFEST:case Fe.DCM:return;case Fe.FIB:[M,D.v1]=await D.readFIB(e);break;case Fe.MIH:case Fe.MIF:M=await D.readMIF(e,o);break;case Fe.NHDR:case Fe.NRRD:if(M=await hg.readNrrd(D,e),M===null)throw new Error(`Failed to parse NHDR/NRRD file ${i}`);break;case Fe.MHD:case Fe.MHA:M=await D.readMHA(e,o);break;case Fe.MGH:case Fe.MGZ:if(M=await cg.readMgh(D,e),M===null)throw new Error(`Failed to parse MGH/MGZ file ${i}`);break;case Fe.SRC:M=await D.readSRC(e);break;case Fe.V:M=D.readECAT(e);break;case Fe.V16:M=D.readV16(e);break;case Fe.VMR:M=D.readVMR(e);break;case Fe.HEAD:M=await D.readHEAD(e,o);break;case Fe.BMP:M=await D.readBMP(e);break;case Fe.NPY:M=await D.readNPY(e);break;case Fe.NPZ:M=await D.readNPZ(e);break;case Fe.ZARR:M=await D.readZARR(e,T);break;case Fe.NII:if(M=await ug.readNifti(D,e),M===null)throw new Error(`Failed to parse NIfTI file ${i}.`);break;default:throw new Error("Image type not supported")}return D.init(e,i,n,r,o,l,h,f,u,m,g,p,v,x,w,b,S,C,E,M),D}computeObliqueAngle(e){const i=Rt(e);Ni(i,e);const n=Math.sqrt(i[0]*i[0]+i[1]*i[1]+i[2]*i[2]),r=Math.max(Math.max(Math.abs(i[0]),Math.abs(i[1])),Math.abs(i[2]))/n,o=Math.sqrt(i[4]*i[4]+i[5]*i[5]+i[6]*i[6]),l=Math.max(Math.max(Math.abs(i[4]),Math.abs(i[5])),Math.abs(i[6]))/o,h=Math.sqrt(i[8]*i[8]+i[9]*i[9]+i[10]*i[10]),f=Math.max(Math.max(Math.abs(i[8]),Math.abs(i[9])),Math.abs(i[10]))/h,u=Math.min(Math.min(r,l),f);let m=Math.abs(Math.acos(u)*180/3.141592653);return m>.01?j.warn("Warning voxels not aligned with world space: "+m+` degrees from plumb.
`):m=0,m}float32V1asRGBA(e){e.length!==this.nVox3D*3&&j.warn("float32V1asRGBA() expects "+this.nVox3D*3+"voxels, got ",+e.length);const i=e.slice();this.hdr.datatypeCode=2304,this.nFrame4D=1;for(let f=4;f<7;f++)this.hdr.dims[f]=1;this.hdr.dims[0]=3;const n=new Uint8Array(this.nVox3D*4);let r=1;for(let f=0;f<this.nVox3D*3;f++)isNaN(i[f])||(r=Math.max(r,Math.abs(i[f])));const o=255/r,l=this.nVox3D*2;let h=0;for(let f=0;f<this.nVox3D;f++){const u=i[f],m=i[f+this.nVox3D],g=i[f+l];n[h]=Math.abs(u*o),n[h+1]=Math.abs(m*o),n[h+2]=Math.abs(g*o);const p=+(u>0)*1,v=+(m>0)*2,x=+(g>0)*4;let w=248+p+v+x;Math.abs(u)+Math.abs(m)+Math.abs(g)<.1&&(w=0),n[h+3]=w,h+=4}return n}loadImgV1(e=!1,i=!1,n=!1){let r=this.v1;if(!r&&this.nFrame4D===3&&this.img.constructor===Float32Array&&(r=this.img.slice()),!r)return j.warn("Image does not have V1 data"),!1;if(e)for(let o=0;o<this.nVox3D;o++)r[o]=-r[o];if(i)for(let o=this.nVox3D;o<2*this.nVox3D;o++)r[o]=-r[o];if(n)for(let o=2*this.nVox3D;o<3*this.nVox3D;o++)r[o]=-r[o];return this.img=this.float32V1asRGBA(r),!0}calculateOblique(){if(!this.matRAS)throw new Error("matRAS not defined");if(this.pixDimsRAS===void 0)throw new Error("pixDimsRAS not defined");if(!this.dimsRAS)throw new Error("dimsRAS not defined");this.oblique_angle=this.computeObliqueAngle(this.matRAS);const e=this.vox2mm([0,0,0],this.matRAS),i=this.vox2mm([1/this.pixDimsRAS[1],0,0],this.matRAS),n=this.vox2mm([0,1/this.pixDimsRAS[2],0],this.matRAS),r=this.vox2mm([0,0,1/this.pixDimsRAS[3]],this.matRAS);ct(i,i,e),ct(n,n,e),ct(r,r,e);const o=Ri(i[0],i[1],i[2],0,n[0],n[1],n[2],0,r[0],r[1],r[2],0,0,0,0,1);this.obliqueRAS=Rt(o);const l=Math.abs(90-yh(i,n)*(180/Math.PI)),h=Math.abs(90-yh(i,r)*(180/Math.PI)),f=Math.abs(90-yh(n,r)*(180/Math.PI));this.maxShearDeg=Math.max(Math.max(l,h),f),this.maxShearDeg>.1&&j.warn("Warning: voxels are rhomboidal, maximum shear is %f degrees.",this.maxShearDeg);const u=ut(this.dimsRAS[1],this.dimsRAS[2],this.dimsRAS[3],1),m=Rt(this.matRAS);Ni(m,m);const g=ut(-.5,-.5,-.5,0);Ta(m,m,he(g[0],g[1],g[2])),m[0]*=u[0],m[1]*=u[0],m[2]*=u[0],m[4]*=u[1],m[5]*=u[1],m[6]*=u[1],m[8]*=u[2],m[9]*=u[2],m[10]*=u[2],this.frac2mm=Rt(m);const p=this.pixDimsRAS[1],v=this.pixDimsRAS[2],x=this.pixDimsRAS[3],w=Rt(m);w[0]=p*u[0],w[1]=0,w[2]=0,w[4]=0,w[5]=v*u[1],w[6]=0,w[8]=0,w[9]=0,w[10]=x*u[2];const b=this.mm2vox([0,0,0],!0);w[12]=(-b[0]-.5)*p,w[13]=(-b[1]-.5)*v,w[14]=(-b[2]-.5)*x,this.frac2mmOrtho=Rt(w),this.extentsMinOrtho=[w[12],w[13],w[14]],this.extentsMaxOrtho=[w[0]+w[12],w[5]+w[13],w[10]+w[14]],this.mm2ortho=Ge(),vi(this.mm2ortho,o)}THD_daxes_to_NIFTI(e,i,n){const r=this.hdr;if(r===null)throw new Error("HDR is not set");r.sform_code=2;const o="xxyyzzg";let l=-1,h=-1,f=-1;const u=["x","y","z"];u[0]=o[n[0]],u[1]=o[n[1]],u[2]=o[n[2]];const m=e.slice(0,3),g=i.slice(0,3);for(let p=0;p<3;p++)u[p]==="x"?l=p:u[p]==="y"?h=p:f=p;l<0||h<0||f<0||l===h||l===f||h===f||(r.pixDims[1]=Math.abs(m[0]),r.pixDims[2]=Math.abs(m[1]),r.pixDims[3]=Math.abs(m[2]),r.affine=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],r.affine[0][l]=-m[l],r.affine[1][h]=-m[h],r.affine[2][f]=m[f],r.affine[0][3]=-g[l],r.affine[1][3]=-g[h],r.affine[2][3]=g[f])}SetPixDimFromSForm(){if(!this.hdr)throw new Error("hdr not defined");const e=this.hdr.affine,i=Ri(e[0][0],e[0][1],e[0][2],e[0][3],e[1][0],e[1][1],e[1][2],e[1][3],e[2][0],e[2][1],e[2][2],e[2][3],e[3][0],e[3][1],e[3][2],e[3][3]),n=this.vox2mm([0,0,0],i),r=this.vox2mm([1,0,0],i);ct(r,r,n);const o=this.vox2mm([0,1,0],i);ct(o,o,n);const l=this.vox2mm([0,0,1],i);ct(l,l,n),this.hdr.pixDims[1]=rn(r),this.hdr.pixDims[2]=rn(o),this.hdr.pixDims[3]=rn(l)}readECAT(e){this.hdr=new Be;const i=this.hdr;i.dims=[3,1,1,1,0,0,0,0],i.pixDims=[1,1,1,1,1,0,0,0];const n=new DataView(e),r=n.getInt32(0,!1),o=n.getInt16(50,!1);if(r!==1296127058||o<1||o>14)throw new Error("Not a valid ECAT file");let l=512,h=0;const f=[];let u=new Float32Array;for(;;){const m=n.getInt32(l,!1),g=n.getInt32(l+12,!1);if(m+g!==31)break;let p=l+20,v=0,x=0;for(;v<31&&(x=n.getInt32(p,!1),p+=16,x!==0);){v++;let w=x*512;const b=w-512,S=n.getUint16(b,!1);i.dims[1]=n.getUint16(b+4,!1),i.dims[2]=n.getUint16(b+6,!1),i.dims[3]=n.getUint16(b+8,!1);const C=n.getFloat32(b+26,!1);i.pixDims[1]=n.getFloat32(b+34,!1)*10,i.pixDims[2]=n.getFloat32(b+38,!1)*10,i.pixDims[3]=n.getFloat32(b+42,!1)*10,i.pixDims[4]=n.getUint32(b+46,!1)/1e3,f.push(i.pixDims[4]);const E=i.dims[1]*i.dims[2]*i.dims[3],T=new Float32Array(E);if(S===1)for(let R=0;R<E;R++)T[R]=n.getUint8(w)*C,w++;else if(S===6)for(let R=0;R<E;R++)T[R]=n.getUint16(w,!1)*C,w+=2;else if(S===7)for(let R=0;R<E;R++)T[R]=n.getUint32(w,!1)*C,w+=4;else j.warn("Unknown ECAT data type "+S);const D=u.slice(0);u=new Float32Array(D.length+T.length),u.set(D),u.set(T,D.length),h++}if(x===0)break;l+=512}if(i.dims[4]=h,i.pixDims[4]=f[0],h>1){i.dims[0]=4;let m=!1;for(let g=0;g<h;g++)f[g]!==f[0]&&(m=!0);m&&j.warn("Frame durations vary")}return i.sform_code=1,i.affine=[[-i.pixDims[1],0,0,(i.dims[1]-2)*.5*i.pixDims[1]],[0,-i.pixDims[2],0,(i.dims[2]-2)*.5*i.pixDims[2]],[0,0,-i.pixDims[3],(i.dims[3]-2)*.5*i.pixDims[3]],[0,0,0,1]],i.numBitsPerVoxel=32,i.datatypeCode=16,u.buffer}readV16(e){this.hdr=new Be;const i=this.hdr;i.dims=[3,1,1,1,0,0,0,0],i.pixDims=[1,1,1,1,1,0,0,0];const n=new DataView(e);return i.dims[1]=n.getUint16(0,!0),i.dims[2]=n.getUint16(2,!0),i.dims[3]=n.getUint16(4,!0),2*i.dims[1]*i.dims[2]*i.dims[3]+6!==e.byteLength&&j.warn("This does not look like a valid BrainVoyager V16 file"),i.numBitsPerVoxel=16,i.datatypeCode=512,j.warn("Warning: V16 files have no spatial transforms"),i.affine=[[0,0,-i.pixDims[1],(i.dims[1]-2)*.5*i.pixDims[1]],[-i.pixDims[2],0,0,(i.dims[2]-2)*.5*i.pixDims[2]],[0,-i.pixDims[3],0,(i.dims[3]-2)*.5*i.pixDims[3]],[0,0,0,1]],i.littleEndian=!0,e.slice(6)}async readNPY(e){function i(T){return{"|b1":1,"<i1":1,"<u1":1,"<i2":2,"<u2":2,"<i4":4,"<u4":4,"<f4":4,"<f8":8}[T]??1}function n(T){return{"|b1":2,"<i1":256,"<u1":2,"<i2":4,"<u2":512,"<i4":8,"<u4":768,"<f4":16,"<f8":64}[T]??16}const r=new DataView(e),o=[r.getUint8(0),r.getUint8(1),r.getUint8(2),r.getUint8(3),r.getUint8(4),r.getUint8(5)],l=[147,78,85,77,80,89];if(!o.every((T,D)=>T===l[D]))throw new Error("Not a valid NPY file: Magic number mismatch");const h=r.getUint16(8,!0),f=new TextDecoder("utf-8").decode(e.slice(10,10+h)),u=f.match(/'shape': \((.*?)\)/);if(!u)throw new Error("Invalid NPY header: Shape not found");const m=u[1].split(",").map(T=>T.trim()).filter(T=>T!=="").map(Number),g=f.match(/'descr': '([^']+)'/);if(!g)throw new Error("Invalid NPY header: Data type not found");const p=g[1],v=m.reduce((T,D)=>T*D,1),x=10+h,w=e.slice(x,x+v*i(p)),b=m.length>0?m[m.length-1]:1,S=m.length>1?m[m.length-2]:1,C=m.length>2?m[m.length-3]:1;this.hdr=new Be;const E=this.hdr;return E.dims=[3,b,S,C,0,0,0,0],E.pixDims=[1,1,1,1,1,0,0,0],E.affine=[[E.pixDims[1],0,0,-(E.dims[1]-2)*.5*E.pixDims[1]],[0,-E.pixDims[2],0,(E.dims[2]-2)*.5*E.pixDims[2]],[0,0,-E.pixDims[3],(E.dims[3]-2)*.5*E.pixDims[3]],[0,0,0,1]],E.numBitsPerVoxel=i(p)*8,E.datatypeCode=n(p),w}async readNPZ(e){const i=new ng(e);for(let n=0;n<i.entries.length;n++){const r=i.entries[n];if(r.fileName.toLowerCase().endsWith(".npy")){const o=await r.extract();return await this.readNPY(o.buffer)}}}async imageDataFromArrayBuffer(e){return new Promise((i,n)=>{const r=new Blob([e]),o=URL.createObjectURL(r),l=new Image;l.crossOrigin="Anonymous",l.src=o,l.onload=()=>{URL.revokeObjectURL(o);const h=document.createElement("canvas");h.width=l.width,h.height=l.height;const f=h.getContext("2d");if(!f){n(new Error("Failed to get 2D context"));return}f.drawImage(l,0,0),i(f.getImageData(0,0,l.width,l.height))},l.onerror=h=>{URL.revokeObjectURL(o),n(h)}})}async readBMP(e){const i=await this.imageDataFromArrayBuffer(e),{width:n,height:r,data:o}=i;this.hdr=new Be;const l=this.hdr;l.dims=[3,n,r,1,0,0,0,0],l.pixDims=[1,1,1,1,1,0,0,0],l.affine=[[l.pixDims[1],0,0,-(l.dims[1]-2)*.5*l.pixDims[1]],[0,-l.pixDims[2],0,(l.dims[2]-2)*.5*l.pixDims[2]],[0,0,-l.pixDims[3],(l.dims[3]-2)*.5*l.pixDims[3]],[0,0,0,1]],l.numBitsPerVoxel=8,l.datatypeCode=2304;let h=!0;for(let f=0;f<o.length;f+=4)if(o[f]!==o[f+1]||o[f]!==o[f+2]){h=!1;break}if(h){l.datatypeCode=2;const f=new Uint8Array(n*r);for(let u=0,m=0;u<o.length;u+=4,m++)f[m]=o[u];return f.buffer}return o.buffer}async readZARR(e,i){let{width:n,height:r,depth:o=1,data:l}=i??{},h=n*r*o*3,f=h===l.length;if(f||(h=n*r*o,o===3&&(f=!0,o=1)),h!==l.length)throw new Error(`Expected RGB ${n}${r}${o}3 =  ${h}, but ZARR length ${l.length}`);this.hdr=new Be;const u=this.hdr;if(u.dims=[3,n,r,o,1,1,1,1],u.pixDims=[1,1,1,1,0,0,0,0],u.affine=[[u.pixDims[1],0,0,-(u.dims[1]-2)*.5*u.pixDims[1]],[0,-u.pixDims[2],0,(u.dims[2]-2)*.5*u.pixDims[2]],[0,0,-u.pixDims[3],(u.dims[3]-2)*.5*u.pixDims[3]],[0,0,0,1]],!f)return u.numBitsPerVoxel=8,u.datatypeCode=2,l;u.numBitsPerVoxel=24,u.datatypeCode=128;function m(g,p,v,x){const w=p*v,b=new Uint8Array(w*x*3),S=new Array(x);for(let T=0;T<x;T++)S[T]=w*3*T;let C=0,E=0;for(let T=0;T<w;T++){for(let D=0;D<x;D++)b[S[D]+E]=g[C++],b[S[D]+E+1]=g[C++],b[S[D]+E+2]=g[C++];E+=3}return b}return m(l,u.dims[1],u.dims[2],u.dims[3])}readVMR(e){this.hdr=new Be;const i=this.hdr;i.dims=[3,1,1,1,0,0,0,0],i.pixDims=[1,1,1,1,1,0,0,0];const n=new DataView(e),r=n.getUint16(0,!0);r!==4&&j.warn("Not a valid version 4 VMR image"),i.dims[1]=n.getUint16(2,!0),i.dims[2]=n.getUint16(4,!0),i.dims[3]=n.getUint16(6,!0);const o=i.dims[1]*i.dims[2]*i.dims[3];if(r>=4){let l=8+o;const h=n.getUint32(l+88,!0);if(l=l+92,h>0){const f=e.byteLength;for(let u=0;u<h;u++){for(;l<f&&n.getUint8(l)!==0;)l++;for(l++,l+=4;l<f&&n.getUint8(l)!==0;)l++;l++;const m=n.getUint32(l,!0);l+=4;for(let g=0;g<m;g++)l+=4}}i.pixDims[1]=n.getFloat32(l+2,!0),i.pixDims[2]=n.getFloat32(l+6,!0),i.pixDims[3]=n.getFloat32(l+10,!0)}return j.warn("Warning: VMR spatial transform not implemented"),i.affine=[[0,0,-i.pixDims[1],(i.dims[1]-2)*.5*i.pixDims[1]],[-i.pixDims[2],0,0,(i.dims[2]-2)*.5*i.pixDims[2]],[0,-i.pixDims[3],0,(i.dims[3]-2)*.5*i.pixDims[3]],[0,0,0,1]],j.debug(i),i.numBitsPerVoxel=8,i.datatypeCode=2,e.slice(8,8+o)}async readFIB(e){this.hdr=new Be;const i=this.hdr;i.littleEndian=!1,i.dims=[3,1,1,1,0,0,0,0],i.pixDims=[1,1,1,1,1,0,0,0];const n=await Ae.readMatV4(e,!0);if(!("dimension"in n)||!("dti_fa"in n))throw new Error("Not a valid DSIstudio FIB file");const r="index0"in n&&"index1"in n&&"index2"in n&&"odf_vertices"in n;i.numBitsPerVoxel=32,i.datatypeCode=16,i.dims[1]=n.dimension[0],i.dims[2]=n.dimension[1],i.dims[3]=n.dimension[2],i.dims[4]=1,i.pixDims[1]=n.voxel_size[0],i.pixDims[2]=n.voxel_size[1],i.pixDims[3]=n.voxel_size[2],i.sform_code=1;const o=(i.dims[1]-1)*.5*i.pixDims[1],l=(i.dims[2]-1)*.5*i.pixDims[2],h=(i.dims[3]-1)*.5*i.pixDims[3];i.affine=[[i.pixDims[1],0,0,-o],[0,-i.pixDims[2],0,l],[0,0,i.pixDims[2],-h],[0,0,0,1]],i.littleEndian=!0;const f=i.dims[1]*i.dims[2]*i.dims[3],u=f*Math.ceil(i.numBitsPerVoxel/8),m=u*i.dims[4],g=new Uint8Array(new ArrayBuffer(f*4*3));if(r){const w=i.dims[1]*i.dims[2]*i.dims[3],b=new Float32Array(w),S=new Float32Array(w),C=new Float32Array(w),E=n.index0,T=n.odf_vertices;for(let D=0;D<w;D++){const R=E[D]*3;b[D]=T[R+0],S[D]=T[R+1],C[D]=-T[R+2]}g.set(new Uint8Array(b.buffer,b.byteOffset,b.byteLength),0*u),g.set(new Uint8Array(S.buffer,S.byteOffset,S.byteLength),1*u),g.set(new Uint8Array(C.buffer,C.byteOffset,C.byteLength),2*u)}"report"in n&&(i.description=new TextDecoder().decode(n.report.subarray(0,Math.min(79,n.report.byteLength))));const p=new Uint8Array(new ArrayBuffer(m)),v=Float32Array.from(n.dti_fa);if("mask"in n){let w=1;"dti_fa_slope"in n&&(w=n.dti_fa_slope[0]);let b=1;"dti_fa_inter"in n&&(b=n.dti_fa_inter[0]);const S=i.dims[1]*i.dims[2]*i.dims[3],C=n.mask,E=new Float32Array(S);let T=0;for(let D=0;D<S;D++)C[D]!==0&&(E[D]=v[T]*w+b,T++);return[E.buffer,new Float32Array(g.buffer)]}const x=new Uint8Array(v.buffer,v.byteOffset,v.byteLength);return p.set(x,0),[p.buffer,new Float32Array(g.buffer)]}async readSRC(e){this.hdr=new Be;const i=this.hdr;i.littleEndian=!1,i.dims=[3,1,1,1,0,0,0,0],i.pixDims=[1,1,1,1,1,0,0,0];const n=await Ae.readMatV4(e);if(!("dimension"in n)||!("image0"in n))throw new Error("Not a valid DSIstudio SRC file");let r=0,o=0;for(const[v,x]of Object.entries(n))if(v.startsWith("image")){if(r===0?o=x.length:o!==x.length&&(o=-1),x.constructor!==Uint16Array)throw new Error("DSIstudio SRC files always use Uint16 datatype");r++}if(o<1||r<1)throw new Error("SRC file not valid DSI Studio data. The image(s) should have the same length");i.numBitsPerVoxel=16,i.datatypeCode=512,i.dims[1]=n.dimension[0],i.dims[2]=n.dimension[1],i.dims[3]=n.dimension[2],i.dims[4]=r,i.dims[4]>1&&(i.dims[0]=4),i.pixDims[1]=n.voxel_size[0],i.pixDims[2]=n.voxel_size[1],i.pixDims[3]=n.voxel_size[2],i.sform_code=1;const l=(i.dims[1]-1)*.5*i.pixDims[1],h=(i.dims[2]-1)*.5*i.pixDims[2],f=(i.dims[3]-1)*.5*i.pixDims[3];i.affine=[[i.pixDims[1],0,0,-l],[0,-i.pixDims[2],0,h],[0,0,i.pixDims[2],-f],[0,0,0,1]],i.littleEndian=!0;const u=i.dims[1]*i.dims[2]*i.dims[3]*(i.numBitsPerVoxel/8),m=u*i.dims[4],g=new Uint8Array(new ArrayBuffer(m));let p=0;for(let v=0;v<r;v++){const x=n[`image${v}`],w=new Uint8Array(x.buffer,x.byteOffset,x.byteLength);g.set(w,p),p+=u}return"report"in n&&(i.description=new TextDecoder().decode(n.report.subarray(0,Math.min(79,n.report.byteLength)))),g.buffer}async readHEAD(e,i){this.hdr=new Be;const n=this.hdr;n.dims[0]=3,n.pixDims=[1,1,1,1,1,0,0,0];let r=[0,0,0],o=[0,0,0],l=[1,1,1];const f=new TextDecoder().decode(e).split(/\r?\n/),u=(e.byteLength+8)%16,m=e.byteLength+(16-u);j.debug(e.byteLength,"len",m);const g=new ArrayBuffer(m);new Uint8Array(g).set(new Uint8Array(e));const p=new jm(m+8,42,g,!0);n.addExtension(p),n.extensionCode=42,n.extensionFlag[0]=1,n.extensionSize=m+8;const v=f.length;let x=0,w=!1;for(;x<v;){let S=f[x];if(x++,!S.startsWith("type"))continue;const C=S.includes("integer-attribute"),E=S.includes("float-attribute");if(S=f[x],x++,!S.startsWith("name"))continue;let T=S.split("= ");const D=T[1];S=f[x],x++,T=S.split("= ");let R=parseInt(T[1]);if(!(R<1)){if(S=f[x],x++,T=S.trim().split(/\s+/),E||C){for(;T.length<R;){S=f[x],x++;const N=S.trim().split(/\s+/);T.push(...N)}for(let N=0;N<R;N++)T[N]=parseFloat(T[N])}switch(D){case"BYTEORDER_STRING":T[0].includes("LSB_FIRST")?n.littleEndian=!0:T[0].includes("MSB_FIRST")&&(n.littleEndian=!1);break;case"BRICK_TYPES":{n.dims[4]=R;const N=parseInt(T[0]);N===0?(n.numBitsPerVoxel=8,n.datatypeCode=2):N===1?(n.numBitsPerVoxel=16,n.datatypeCode=4):N===3?(n.numBitsPerVoxel=32,n.datatypeCode=16):j.warn("Unknown BRICK_TYPES ",N)}break;case"IJK_TO_DICOM_REAL":if(R<12)break;w=!0,n.sform_code=2,n.affine=[[-T[0],-T[1],-T[2],-T[3]],[-T[4],-T[5],-T[6],-T[7]],[T[8],T[9],T[10],T[11]],[0,0,0,1]];break;case"DATASET_DIMENSIONS":R=Math.max(R,3);for(let N=0;N<R;N++)n.dims[N+1]=T[N];break;case"ORIENT_SPECIFIC":r=T;break;case"ORIGIN":o=T;break;case"DELTA":l=T;break;case"TAXIS_FLOATS":n.pixDims[4]=T[0];break;default:j.warn("Unknown:",D)}}}w?this.SetPixDimFromSForm():this.THD_daxes_to_NIFTI(l,o,r);const b=n.numBitsPerVoxel/8*n.dims[1]*n.dims[2]*n.dims[3]*n.dims[4];if(!i)throw new Error("pairedImgData not set");return i.byteLength<b?await Ae.decompressToBuffer(new Uint8Array(i)):i.slice(0)}async readMHA(e,i){const n=e.byteLength;if(n<20)throw new Error("File too small to be VTK: bytes = "+e.byteLength);const r=new Uint8Array(e);let o=0;function l(w){return w===10||w===13}function h(){for(;o<n&&l(r[o]);)o++;const w=o;for(;o<n&&!l(r[o]);)o++;return o-w<2?"":new TextDecoder().decode(e.slice(w,o))}let f=h();this.hdr=new Be;const u=this.hdr;u.pixDims=[1,1,1,1,1,0,0,0],u.dims=[1,1,1,1,1,1,1,1],u.littleEndian=!0;let m=!1,g=!1;const p=Nn(NaN,0,0,0,1,0,0,0,1),v=he(0,0,0);for(;f!=="";){let w=f.split(" ");if(w.length>2&&(w=w.slice(2)),f.startsWith("BinaryDataByteOrderMSB")&&w[0].includes("False")&&(u.littleEndian=!0),f.startsWith("BinaryDataByteOrderMSB")&&w[0].includes("True")&&(u.littleEndian=!1),f.startsWith("CompressedData")&&w[0].includes("True")&&(m=!0),f.startsWith("TransformMatrix"))for(let b=0;b<9;b++)p[b]=parseFloat(w[b]);if(f.startsWith("Offset"))for(let b=0;b<Math.min(w.length,3);b++)v[b]=parseFloat(w[b]);if(f.startsWith("ElementSpacing"))for(let b=0;b<w.length;b++)u.pixDims[b+1]=parseFloat(w[b]);if(f.startsWith("DimSize")){u.dims[0]=w.length;for(let b=0;b<w.length;b++)u.dims[b+1]=parseInt(w[b])}if(f.startsWith("ElementType"))switch(w[0]){case"MET_UCHAR":u.numBitsPerVoxel=8,u.datatypeCode=2;break;case"MET_CHAR":u.numBitsPerVoxel=8,u.datatypeCode=256;break;case"MET_SHORT":u.numBitsPerVoxel=16,u.datatypeCode=4;break;case"MET_USHORT":u.numBitsPerVoxel=16,u.datatypeCode=512;break;case"MET_INT":u.numBitsPerVoxel=32,u.datatypeCode=8;break;case"MET_UINT":u.numBitsPerVoxel=32,u.datatypeCode=768;break;case"MET_FLOAT":u.numBitsPerVoxel=32,u.datatypeCode=16;break;case"MET_DOUBLE":u.numBitsPerVoxel=64,u.datatypeCode=64;break;default:throw new Error("Unsupported MHA data type: "+w[0])}if(f.startsWith("ObjectType")&&!w[0].includes("Image")&&j.warn("Only able to read ObjectType = Image, not "+f),f.startsWith("ElementDataFile")){w[0]!=="LOCAL"&&(g=!0);break}f=h()}const x=Nn(u.pixDims[1],0,0,0,u.pixDims[2],0,0,0,u.pixDims[3]);for(Dm(p,p,x),u.affine=[[-p[0],-p[3],-p[6],-v[0]],[-p[1],-p[4],-p[7],-v[1]],[p[2],p[5],p[8],v[2]],[0,0,0,1]];r[o]===10;)o++;return u.vox_offset=o,g&&i?m?await Ae.decompressToBuffer(new Uint8Array(i.slice(0))):i.slice(0):m?await Ae.decompressToBuffer(new Uint8Array(e.slice(u.vox_offset))):e.slice(u.vox_offset)}async readMIF(e,i){this.hdr=new Be;const n=this.hdr;n.pixDims=[1,1,1,1,1,0,0,0],n.dims=[1,1,1,1,1,1,1,1];let r=e.byteLength;if(r<20)throw new Error("File too small to be MIF: bytes = "+r);const o=new Uint8Array(e);o[0]===31&&o[1]===139&&(j.debug("MIF with GZ decompression"),e=await Ae.decompressToBuffer(new Uint8Array(e)),r=e.byteLength);let l=0;function h(){for(;l<r&&o[l]===10;)l++;const U=l;for(;l<r&&o[l]!==10;)l++;return l++,l-U<1?"":new TextDecoder().decode(e.slice(U,l-1))}let f=h();if(!f.startsWith("mrtrix image"))throw new Error("Not a valid MIF file");const u=[];let m=!1,g=0,p=0,v=!1;for(f=h();l<r&&!f.startsWith("END");){let U=f.split(":");if(f=h(),U.length<2)break;const z=U[0];U=U[1].split(",");for(let P=0;P<U.length;P++)U[P]=U[P].trim();switch(z){case"dim":n.dims[0]=U.length;for(let P=0;P<U.length;P++)n.dims[P+1]=parseInt(U[P]);break;case"vox":for(let P=0;P<U.length;P++)n.pixDims[P+1]=parseFloat(U[P]),isNaN(n.pixDims[P+1])&&(n.pixDims[P+1]=0);break;case"layout":for(let P=0;P<U.length;P++)u.push(parseInt(U[P]));break;case"datatype":{const P=U[0];P.startsWith("Bit")?(m=!0,n.datatypeCode=2):P.startsWith("Int8")?n.datatypeCode=256:P.startsWith("UInt8")?n.datatypeCode=2:P.startsWith("Int16")?n.datatypeCode=4:P.startsWith("UInt16")?n.datatypeCode=512:P.startsWith("Int32")?n.datatypeCode=8:P.startsWith("UInt32")?n.datatypeCode=768:P.startsWith("Float32")?n.datatypeCode=16:P.startsWith("Float64")?n.datatypeCode=64:j.warn("Unsupported datatype "+P),P.includes("8")?n.numBitsPerVoxel=8:P.includes("16")?n.numBitsPerVoxel=16:P.includes("32")?n.numBitsPerVoxel=32:P.includes("64")&&(n.numBitsPerVoxel=64),n.littleEndian=!0,P.endsWith("LE")&&(n.littleEndian=!0),P.endsWith("BE")&&(n.littleEndian=!1)}break;case"transform":if(g>2||U.length!==4)break;n.affine[g][0]=parseFloat(U[0]),n.affine[g][1]=parseFloat(U[1]),n.affine[g][2]=parseFloat(U[2]),n.affine[g][3]=parseFloat(U[3]),g++;break;case"comments":n.description=U[0].substring(0,Math.min(79,U[0].length));break;case"RepetitionTime":p=parseFloat(U[0]);break;case"file":v=!U[0].startsWith(". "),v||(U=U[0].split(" "),n.vox_offset=parseInt(U[1]));break}}const x=n.dims[0];x>5&&j.warn("reader only designed for a maximum of 5 dimensions (XYZTD)");let w=1;for(let U=0;U<x;U++)w*=Math.max(n.dims[U+1],1);for(let U=0;U<3;U++)for(let z=0;z<3;z++)n.affine[U][z]*=n.pixDims[z+1];j.debug("mif affine:"+n.affine[0]),p>0&&(n.pixDims[4]=p),v&&!i&&j.warn("MIH header provided without paired image data");let b;if(i&&v)b=i.slice(0);else if(m){n.numBitsPerVoxel=8;const U=new Uint8Array(w),z=e.slice(n.vox_offset,n.vox_offset+Math.ceil(w/8)),P=new Uint8Array(z);let K=0;for(let _=0;_<w;_++){const H=_%8;U[_]=P[K]>>7-H&1,H===7&&K++}b=U.buffer}else b=e.slice(n.vox_offset,n.vox_offset+w*(n.numBitsPerVoxel/8));u.length!==n.dims[0]&&j.warn("dims does not match layout");let S=1;const C=[1,1,1,1,1],E=[!1,!1,!1,!1,!1];for(let U=0;U<u.length;U++)for(let z=0;z<u.length;z++)Math.abs(u[z])===U&&(C[z]=S,(u[z]<0||Object.is(u[z],-0))&&(E[z]=!0),S*=n.dims[z+1]);let T=Ae.range(0,n.dims[1]-1,1);E[0]&&(T=Ae.range(n.dims[1]-1,0,-1));for(let U=0;U<n.dims[1];U++)T[U]*=C[0];let D=Ae.range(0,n.dims[2]-1,1);E[1]&&(D=Ae.range(n.dims[2]-1,0,-1));for(let U=0;U<n.dims[2];U++)D[U]*=C[1];let R=Ae.range(0,n.dims[3]-1,1);E[2]&&(R=Ae.range(n.dims[3]-1,0,-1));for(let U=0;U<n.dims[3];U++)R[U]*=C[2];let N=Ae.range(0,n.dims[4]-1,1);E[3]&&(N=Ae.range(n.dims[4]-1,0,-1));for(let U=0;U<n.dims[4];U++)N[U]*=C[3];let M=Ae.range(0,n.dims[5]-1,1);E[4]&&(M=Ae.range(n.dims[5]-1,0,-1));for(let U=0;U<n.dims[5];U++)M[U]*=C[4];let V=0,I,B;switch(n.datatypeCode){case 256:I=new Int8Array(b),B=new Int8Array(w);break;case 2:I=new Uint8Array(b),B=new Uint8Array(w);break;case 4:I=new Int16Array(b),B=new Int16Array(w);break;case 512:I=new Uint16Array(b),B=new Uint16Array(w);break;case 8:I=new Int32Array(b),B=new Int32Array(w);break;case 768:I=new Uint32Array(b),B=new Uint32Array(w);break;case 16:I=new Float32Array(b),B=new Float32Array(w);break;case 64:I=new Float64Array(b),B=new Float64Array(w);break;default:throw new Error("unknown datatypeCode")}for(let U=0;U<n.dims[5];U++)for(let z=0;z<n.dims[4];z++)for(let P=0;P<n.dims[3];P++)for(let K=0;K<n.dims[2];K++)for(let _=0;_<n.dims[1];_++)B[V]=I[T[_]+D[K]+R[P]+N[z]+M[U]],V++;return B.buffer}calculateRAS(){if(!this.hdr)throw new Error("hdr not set");const e=this.hdr.affine,i=this.hdr,n=Nn(Math.abs(e[0][0]),Math.abs(e[0][1]),Math.abs(e[0][2]),Math.abs(e[1][0]),Math.abs(e[1][1]),Math.abs(e[1][2]),Math.abs(e[2][0]),Math.abs(e[2][1]),Math.abs(e[2][2])),r=[1,1,1];n[3]>n[0]&&(r[0]=2),n[6]>n[0]&&n[6]>n[3]&&(r[0]=3),r[1]=1,r[0]===1?n[4]>n[7]?r[1]=2:r[1]=3:r[0]===2?n[1]>n[7]?r[1]=1:r[1]=3:n[1]>n[4]?r[1]=1:r[1]=2,r[2]=6-r[1]-r[0];let o=[1,2,3];o[r[0]-1]=1,o[r[1]-1]=2,o[r[2]-1]=3;let l=Ri(e[0][0],e[0][1],e[0][2],e[0][3],e[1][0],e[1][1],e[1][2],e[1][3],e[2][0],e[2][1],e[2][2],e[2][3],0,0,0,1);this.mm000=this.vox2mm([-.5,-.5,-.5],l),this.mm100=this.vox2mm([i.dims[1]-.5,-.5,-.5],l),this.mm010=this.vox2mm([-.5,i.dims[2]-.5,-.5],l),this.mm001=this.vox2mm([-.5,-.5,i.dims[3]-.5],l);const h=Ge();l5(h,l);for(let b=0;b<3;b++)for(let S=0;S<3;S++)h[b*4+S]=l[b*4+o[S]-1];const f=[0,0,0];h[0]<0&&(f[0]=1),h[5]<0&&(f[1]=1),h[10]<0&&(f[2]=1),this.dimsRAS=[i.dims[0],i.dims[o[0]],i.dims[o[1]],i.dims[o[2]]],this.pixDimsRAS=[i.pixDims[0],i.pixDims[o[0]],i.pixDims[o[1]],i.pixDims[o[2]]],this.permRAS=o.slice();for(let b=0;b<3;b++)f[b]===1&&(this.permRAS[b]=-this.permRAS[b]);if(this.arrayEquals(o,[1,2,3])&&this.arrayEquals(f,[0,0,0])){this.toRAS=Ge(),this.matRAS=Rt(l),this.calculateOblique(),this.img2RASstep=[1,this.dimsRAS[1],this.dimsRAS[1]*this.dimsRAS[2]],this.img2RASstart=[0,0,0];return}Nm(l),l[0+0*4]=1-f[0]*2,l[1+1*4]=1-f[1]*2,l[2+2*4]=1-f[2]*2,l[3+0*4]=(i.dims[o[0]]-1)*f[0],l[3+1*4]=(i.dims[o[1]]-1)*f[1],l[3+2*4]=(i.dims[o[2]]-1)*f[2];const u=Ge();vi(u,l),sn(u,u,h),this.matRAS=Rt(u),l=Ri(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1),l[o[0]-1+0*4]=-f[0]*2+1,l[o[1]-1+1*4]=-f[1]*2+1,l[o[2]-1+2*4]=-f[2]*2+1,l[3+0*4]=f[0],l[3+1*4]=f[1],l[3+2*4]=f[2],this.toRAS=Rt(l),l[3]=0,l[7]=0,l[11]=0,l[12]=0,(this.permRAS[0]===-1||this.permRAS[1]===-1||this.permRAS[2]===-1)&&(l[12]=i.dims[1]-1),l[13]=0,(this.permRAS[0]===-2||this.permRAS[1]===-2||this.permRAS[2]===-2)&&(l[13]=i.dims[2]-1),l[14]=0,(this.permRAS[0]===-3||this.permRAS[1]===-3||this.permRAS[2]===-3)&&(l[14]=i.dims[3]-1),this.toRASvox=Rt(l),j.debug(this.hdr.dims),j.debug(this.dimsRAS);const m=this.hdr;o=this.permRAS;const g=[Math.abs(o[0]),Math.abs(o[1]),Math.abs(o[2])],p=[m.dims[g[0]],m.dims[g[1]],m.dims[g[2]]],v=[1,m.dims[1],m.dims[1]*m.dims[2]],x=[v[g[0]-1],v[g[1]-1],v[g[2]-1]],w=[0,0,0];for(let b=0;b<3;b++)o[b]<0&&(w[b]=x[b]*(p[b]-1),x[b]=-x[b]);this.img2RASstep=x,this.img2RASstart=w,this.calculateOblique()}async hdr2RAS(e=1){if(!this.permRAS)throw new Error("permRAS undefined");if(!this.hdr)throw new Error("hdr undefined");const i=Zl({...this.hdr},!1),n=await Pr(i.buffer,!0);e===1?(n.dims[0]=3,n.dims[4]=1):e>1&&(n.dims[0]=4,n.dims[4]=e);const r=this.permRAS.slice();if(r[0]===1&&r[1]===2&&r[2]===3)return n;n.qform_code=0;for(let l=1;l<4;l++)n.dims[l]=this.dimsRAS[l];for(let l=0;l<this.pixDimsRAS.length;l++)n.pixDims[l]=this.pixDimsRAS[l];let o=0;for(let l=0;l<4;l++)for(let h=0;h<4;h++)n.affine[l][h]=this.matRAS[o],o++;return n}img2RAS(e=0){if(!this.permRAS)throw new Error("permRAS undefined");if(!this.img)throw new Error("img undefined");if(!this.hdr)throw new Error("hdr undefined");const i=this.permRAS.slice();if(i[0]===1&&i[1]===2&&i[2]===3)return this.img;const n=this.hdr,r=n.dims[1]*n.dims[2]*n.dims[3];let o=e*r;(o+r>this.img.length||o<0)&&(o=0,j.warn(`img2RAS nVolume (${e}) out of bounds (${e}+1)${r} > ${this.img.length}`));const l=this.img.slice(0,r),h=[Math.abs(i[0]),Math.abs(i[1]),Math.abs(i[2])],f=[n.dims[h[0]],n.dims[h[1]],n.dims[h[2]]],u=[1,n.dims[1],n.dims[1]*n.dims[2]],m=[u[h[0]-1],u[h[1]-1],u[h[2]-1]],g=[0,0,0];for(let v=0;v<3;v++)i[v]<0&&(g[v]=m[v]*(f[v]-1),m[v]=-m[v]);let p=0;for(let v=0;v<f[2];v++){const x=g[2]+v*m[2];for(let w=0;w<f[1];w++){const b=g[1]+w*m[1];for(let S=0;S<f[0];S++){const C=g[0]+S*m[0];l[p]=this.img[C+b+x+o],p++}}}return l}vox2mm(e,i){const n=Rt(i);Ni(n,n);const r=ut(e[0],e[1],e[2],1);return qt(r,r,n),he(r[0],r[1],r[2])}mm2vox(e,i=!1){if(!this.matRAS)throw new Error("matRAS undefined");const n=Rt(this.matRAS),r=Rt(n);Ni(r,n),vi(r,r);const o=ut(e[0],e[1],e[2],1);qt(o,o,r);const l=he(o[0],o[1],o[2]);return i?l:[Math.round(l[0]),Math.round(l[1]),Math.round(l[2])]}arrayEquals(e,i){return Array.isArray(e)&&Array.isArray(i)&&e.length===i.length&&e.every((n,r)=>n===i[r])}setColormap(e){this._colormap=e,this.calMinMax(),this.onColormapChange&&this.onColormapChange(this)}setColormapLabel(e){this.colormapLabel=et.makeLabelLut(e)}async setColormapLabelFromUrl(e){this.colormapLabel=await et.makeLabelLutFromUrl(e)}get colormap(){return this._colormap}get colorMap(){return this._colormap}set colormap(e){this.setColormap(e)}set colorMap(e){this.setColormap(e)}get opacity(){return this._opacity}set opacity(e){this._opacity=e,this.onOpacityChange&&this.onOpacityChange(this)}calMinMax(e=Number.POSITIVE_INFINITY,i=!0){if(!this.hdr)throw new Error("hdr undefined");if(!this.img)throw new Error("img undefined");let n=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY,o=0,l=0,h=this.hdr.dims[1]*this.hdr.dims[2]*this.hdr.dims[3];const f=Math.floor(this.img.length/h);e>=f&&(e=this.frame4D),e=Math.min(e,f-1);const u=e*h;let m=[];if(i){const z=[Math.floor(.25*this.hdr.dims[1]),Math.floor(.25*this.hdr.dims[2]),Math.floor(.25*this.hdr.dims[3])],P=[this.hdr.dims[1]-2*z[0],this.hdr.dims[2]-2*z[1],this.hdr.dims[3]-2*z[2]],K=[P[0]+z[0],P[1]+z[1],P[2]+z[2]];h=P[0]*P[1]*P[2],m=new this.img.constructor(h);let _=-1,H=0;for(let q=0;q<this.hdr.dims[3];q++)for(let se=0;se<this.hdr.dims[2];se++)for(let G=0;G<this.hdr.dims[1];G++)_++,!(G<z[0]||se<z[1]||q<z[2])&&(G>=K[0]||se>=K[1]||q>=K[2]||(m[H]=this.img[_+u],H++))}else{m=new this.img.constructor(h);for(let U=0;U<h;U++)m[U]=this.img[U+u]}const g=m.constructor!==Float64Array&&m.constructor!==Float32Array&&this.ignoreZeroVoxels;if(g)for(let U=0;U<h;U++)n=Math.min(m[U],n),r=Math.max(m[U],r),m[U]===0&&o++;else for(let U=0;U<h;U++){if(isNaN(m[U])){l++;continue}m[U]===0&&(o++,this.ignoreZeroVoxels)||(n=Math.min(m[U],n),r=Math.max(m[U],r))}this.ignoreZeroVoxels&&n===r&&o>0&&(n=0);const p=this.intensityRaw2Scaled(n),v=this.intensityRaw2Scaled(r),x=et.colormapFromKey(this._colormap);let w=0,b=0;if(x.min!==void 0&&(w=x.min),x.max!==void 0&&(b=x.max),w===b&&this.trustCalMinMax&&isFinite(this.hdr.cal_min)&&isFinite(this.hdr.cal_max)&&this.hdr.cal_max>this.hdr.cal_min)return this.cal_min=this.hdr.cal_min,this.cal_max=this.hdr.cal_max,this.robust_min=this.cal_min,this.robust_max=this.cal_max,this.global_min=p,this.global_max=v,[this.hdr.cal_min,this.hdr.cal_max,this.hdr.cal_min,this.hdr.cal_max];if(w!==b)return this.cal_min=w,this.cal_max=b,this.robust_min=this.cal_min,this.robust_max=this.cal_max,[w,b,w,b];const S=100*o/(h-0);let C=!1;S>60&&!this.ignoreZeroVoxels&&(j.warn(`${Math.round(S)}% of voxels are zero: ignoring zeros for cal_max`),C=!0,this.ignoreZeroVoxels=!0),this.ignoreZeroVoxels||(o=0),o+=l;const E=Math.round((h-0-o)*this.percentileFrac);if(E<1||n===r)return j.debug("no variability in image intensity?"),this.cal_min=p,this.cal_max=v,this.robust_min=this.cal_min,this.robust_max=this.cal_max,this.global_min=p,this.global_max=v,[p,v,p,v];const T=1001,D=(T-1)/(r-n),R=new Array(T);for(let U=0;U<T;U++)R[U]=0;if(g)for(let U=0;U<h;U++)R[Math.round((m[U]-n)*D)]++;else if(this.ignoreZeroVoxels)for(let U=0;U<h;U++)m[U]!==0&&(isNaN(m[U])||R[Math.round((m[U]-n)*D)]++);else for(let U=0;U<h;U++)isNaN(m[U])||R[Math.round((m[U]-n)*D)]++;let N=0,M=0;for(;N<E;)N+=R[M],M++;M--,N=0;let V=T;for(;N<E;)V--,N+=R[V];if(M===V){let U=-1;for(;U!==0;)M>0&&(M--,R[M]>0&&(U=0)),U!==0&&V<T-1&&(V++,R[V]>0&&(U=0)),M===0&&V===T-1&&(U=0)}let I=this.intensityRaw2Scaled(M/D+n),B=this.intensityRaw2Scaled(V/D+n);return this.hdr.cal_min<this.hdr.cal_max&&this.hdr.cal_min>=p&&this.hdr.cal_max<=v&&(I=this.hdr.cal_min,B=this.hdr.cal_max),C&&(I=Math.min(I,0)),this.cal_min=I,this.cal_max=B,this.robust_min=this.cal_min,this.robust_max=this.cal_max,this.global_min=p,this.global_max=v,[I,B,p,v]}intensityRaw2Scaled(e){if(!this.hdr)throw new Error("hdr undefined");return this.hdr.scl_slope===0&&(this.hdr.scl_slope=1),e*this.hdr.scl_slope+this.hdr.scl_inter}intensityScaled2Raw(e){if(!this.hdr)throw new Error("hdr undefined");return this.hdr.scl_slope===0&&(this.hdr.scl_slope=1),(e-this.hdr.scl_inter)/this.hdr.scl_slope}async saveToUint8Array(e,i=null){return lg(this,e,i)}async saveToDisk(e="",i=null){return px(this,e,i)}static async fetchDicomData(e,i={}){if(e==="")throw Error("url must not be empty");let r=/^(?:[a-z+]+:)?\/\//i.test(e)?e:new URL(e,window.location.href);/(?:.([^.]+))?$/.exec(r.pathname)||(r=new URL("niivue-manifest.txt",e));let h=await fetch(r,{headers:i});if(!h.ok)throw Error(h.statusText);const u=(await h.text()).split(`
`),g=/(.*\/).*/.exec(r)[0],p=[];for(const v of u){const x=new URL(v,g);if(h=await fetch(x,{headers:i}),!h.ok)throw Error(h.statusText);const w=await h.arrayBuffer();p.push({name:v,data:w})}return p}static async readFirstDecompressedBytes(e,i){const n=e.getReader(),r=new G5,o=[];let l=0,h=!1,f,u;const m=new Promise((p,v)=>{f=p,u=v});function g(){const p=new Uint8Array(l);let v=0;for(const x of o)p.set(x,v),v+=x.length;f(p)}return r.ondata=p=>{o.push(p),l+=p.length,l>=i&&(h=!0,n.cancel().catch(()=>{}),g())},(async()=>{try{for(;!h;){const{done:p,value:v}=await n.read();if(p){h=!0,r.push(new Uint8Array,!0);return}r.push(v,!1)}}catch(p){u(p)}})().catch(()=>{}),m}static extractFilenameFromUrl(e){const n=new URL(e).searchParams.get("response-content-disposition");if(n){const r=n.match(/filename\*?=(?:UTF-8'')?"?([^";]+)"?/);if(r)return decodeURIComponent(r[1])}return e.split("/").pop().split("?")[0]}static async loadInitialVolumesGz(e="",i={},n=NaN){if(isNaN(n))return null;const r=await fetch(e,{headers:i,cache:"force-cache"});let o=352,l=await this.readFirstDecompressedBytes(r.body,o);const h=new DataView(l.buffer,l.byteOffset,l.byteLength),f=h.getUint16(0,!0),u=f===348;if(!u&&!(f===23553)||(l.length>111&&(o=h.getFloat32(108,u)),o>l.length&&(l=await this.readFirstDecompressedBytes(r.body,o)),!(l[0]===92&&l[1]===1||l[1]===92&&l[0]===1)))return null;const p=await Pr(l.buffer);if(!p)throw new Error("Could not read NIfTI header");const v=p.numBitsPerVoxel/8,x=[1,2,3].reduce((T,D)=>T*(p.dims[D]>1?p.dims[D]:1),1),w=[4,5,6].reduce((T,D)=>T*(p.dims[D]>1?p.dims[D]:1),1),b=Math.max(Math.min(n,w),1),S=p.vox_offset+b*x*v;if(b===w)return null;const C=await fetch(e,{headers:i,cache:"force-cache"});return(await this.readFirstDecompressedBytes(C.body,S)).buffer.slice(0,S)}static async loadInitialVolumes(e="",i={},n=NaN){if(isNaN(n))return null;const o=(await fetch(e,{headers:i,cache:"force-cache"})).body.getReader(),{value:l,done:h}=await o.read();let f=l;if(h||!f||f.length<2)throw new Error("Not enough data to determine compression");const u=new DataView(f.buffer,f.byteOffset,f.byteLength),m=u.getUint16(0,!0);if(m===35615)return await o.cancel(),this.loadInitialVolumesGz(e,i,n);const p=m===348;if(!p&&!(m===23553))return await o.cancel(),null;let x=352;for(f.length>111&&(x=u.getFloat32(108,p));f.length<x;){let M=function(B,U){const z=new Uint8Array(B.length+U.length);return z.set(B,0),z.set(U,B.length),z};const{value:V,done:I}=await o.read();if(I||!V)break;f=M(f,V)}const w=await Pr(f.buffer);if(!w)throw new Error("Could not read NIfTI header");const b=w.numBitsPerVoxel/8,S=[1,2,3].reduce((M,V)=>M*(w.dims[V]>1?w.dims[V]:1),1),C=[4,5,6].reduce((M,V)=>M*(w.dims[V]>1?w.dims[V]:1),1),E=Math.max(Math.min(n,C),1),T=w.vox_offset+E*S*b,D=new Uint8Array(T),R=Math.min(f.length,T);D.set(f.subarray(0,R),0);let N=R;for(;N<T;){const{value:M,done:V}=await o.read();if(V||!M)return await o.cancel(),null;const I=Math.min(M.length,T-N);D.set(M.subarray(0,I),N),N+=I}return await o.cancel(),D.buffer}static async loadFromUrl({url:e="",urlImgData:i="",headers:n={},name:r="",colormap:o="gray",opacity:l=1,cal_min:h=NaN,cal_max:f=NaN,trustCalMinMax:u=!0,percentileFrac:m=.02,ignoreZeroVoxels:g=!1,useQFormNotSForm:p=!1,colormapNegative:v="",frame4D:x=0,isManifest:w=!1,limitFrames4D:b=NaN,imageType:S=Fe.UNKNOWN,colorbarVisible:C=!0,buffer:E=new ArrayBuffer(0)}={}){if(e==="")throw Error("url must not be empty");let T=null,D=null,R=null;if(e instanceof Uint8Array&&(e=e.slice().buffer),E.byteLength>0&&(e=E),e instanceof ArrayBuffer)if(D=e,r!=="")e=r;else{const B=new Uint8Array(D);e=B[0]===31&&B[1]===139?"array.nii.gz":"array.nii"}function N(B){const U=B.match(/\.([^.]+)(?:\.gz|\.bz2|\.xz)?$/);return U?U[1]:""}let M="";if(r===""?M=N(e):M=N(r),S===Fe.UNKNOWN&&(S=Fe.parse(M)),S===Fe.UNKNOWN&&typeof e=="string"){const B=await fetch(e,{});if(B.redirected){const U=this.extractFilenameFromUrl(B.url);U&&U.length>0&&r===""&&(r=U,M=N(r),S=Fe.parse(M))}}if(S===Fe.ZARR){const B=new URL(e).searchParams,U=B.get("z"),z=B.get("y"),P=B.get("x"),K=U?Hr(parseInt(U),parseInt(U)+1):null,_=z?Hr(parseInt(z),parseInt(z)+1):null,H=P?Hr(parseInt(P),parseInt(P)+1):null,q=e.split("?")[0],se=new Kv(q),G=yv(se);let W;try{W=await an(G.resolve(e),{kind:"array"})}catch{W=await an(G,{kind:"array"})}console.log("arr",W);let le;if(W.shape.length===4){const ve=W.shape[2],ze=W.shape[1],Ie=W.shape[0];K&&K[0]>=ve&&(K[0]=ve-1),_&&_[0]>=ze&&(_[0]=ze-1),H&&H[0]>=Ie&&(H[0]=Ie-1),le=await k2(W,[H,_,K,null])}else le=await k2(W,[H,_,K]);D=le.data;const[ce,fe,ye,me]=le.shape;R={data:D,width:fe,height:ce,depth:ye,channels:me}}const V=S===Fe.DCM||Fe.NII;if(!D&&V&&(D=await this.loadInitialVolumes(e,n,b)),!D)if(w)D=await Hl.fetchDicomData(e,n),S=Fe.DCM_MANIFEST;else{const B=await fetch(e,{headers:n});if(!B.ok)throw Error(B.statusText);if(!B.body)throw new Error("No readable stream available");const U=await Ih(B.body),z=[],P=U.getReader();for(;;){const{done:q,value:se}=await P.read();if(q)break;z.push(se)}const K=z.reduce((q,se)=>q+se.length,0);D=new ArrayBuffer(K);const _=new Uint8Array(D);let H=0;for(const q of z)_.set(q,H),H+=q.length}M.toUpperCase()==="HEAD"&&i===""&&(i=e.substring(0,e.lastIndexOf("HEAD"))+"BRIK");let I=null;if(i)try{let B=await fetch(i,{headers:n});if(B.status===404&&i.includes("BRIK")&&(B=await fetch(`${i}.gz`,{headers:n})),B.ok&&B.body){const U=await Ih(B.body),z=[],P=U.getReader();for(;;){const{done:q,value:se}=await P.read();if(q)break;z.push(se)}const K=z.reduce((q,se)=>q+se.length,0);I=new ArrayBuffer(K);const _=new Uint8Array(I);let H=0;for(const q of z)_.set(q,H),H+=q.length}}catch(B){console.error("Error loading paired image data:",B)}if(!D)throw new Error("Unable to load buffer properly from volume");if(!r){let B;try{B=new URL(e).pathname.split("/")}catch{B=e.split("/")}r=B.slice(-1)[0],r.indexOf("?")>-1&&(r=r.slice(0,r.indexOf("?")))}return T=await this.new(D,r,o,l,I,h,f,u,m,g,p,v,x,S,NaN,NaN,!0,null,0,R),T.url=e,T.colorbarVisible=C,T}static async readFileAsync(e,i=NaN){let n=e.stream();if(!isNaN(i)){let g=0;const p=new TransformStream({transform(v,x){if(g>=i){x.terminate();return}const w=i-g;v.length>w?(x.enqueue(v.slice(0,w)),x.terminate()):x.enqueue(v),g+=v.length}});n=n.pipeThrough(p)}const r=await Ih(n),o=[],l=r.getReader();for(;;){const{done:g,value:p}=await l.read();if(g)break;o.push(p)}const h=o.reduce((g,p)=>g+p.length,0),f=new ArrayBuffer(h),u=new Uint8Array(f);let m=0;for(const g of o)u.set(g,m),m+=g.length;return f}static async loadFromFile({file:e,name:i="",colormap:n="gray",opacity:r=1,urlImgData:o=null,cal_min:l=NaN,cal_max:h=NaN,trustCalMinMax:f=!0,percentileFrac:u=.02,ignoreZeroVoxels:m=!1,useQFormNotSForm:g=!1,colormapNegative:p="",frame4D:v=0,limitFrames4D:x=NaN,imageType:w=Fe.UNKNOWN}){let b=null,S=[];try{if(Array.isArray(e))S=await Promise.all(e.map(E=>this.readFileAsync(E)));else{if(isNaN(x))S=await this.readFileAsync(e);else{const E=await this.readFileAsync(e,512),T=new Uint8Array(E);if(!(T[0]===92&&T[1]===1||T[1]===92&&T[0]===1))S=await this.readFileAsync(e);else{const R=await Pr(E);if(!R)throw new Error("could not read nifti header");const N=R.numBitsPerVoxel/8,M=[1,2,3].reduce((U,z)=>U*(R.dims[z]>1?R.dims[z]:1),1),V=[4,5,6].reduce((U,z)=>U*(R.dims[z]>1?R.dims[z]:1),1),I=Math.max(Math.min(x,V),1),B=R.vox_offset+I*M*N;S=await this.readFileAsync(e,B)}}i=e.name}let C=null;o&&(C=await this.readFileAsync(o)),b=await this.new(S,i,n,r,C,l,h,f,u,m,g,p,v,w,NaN,NaN,!0,null,0,null),b.fileObject=e}catch(C){throw j.error(C),new Error("could not build NVImage")}if(b===null)throw new Error("could not build NVImage");return b}static createNiftiArray(e=[256,256,256],i=[1,1,1],n=[1,0,0,-128,0,1,0,-128,0,0,1,-128,0,0,0,1],r=2,o=new Uint8Array){return gx(e,i,n,r,o)}static createNiftiHeader(e=[256,256,256],i=[1,1,1],n=[1,0,0,-128,0,1,0,-128,0,0,1,-128,0,0,0,1],r=2){return rg(e,i,n,r)}getVolumeData(e=[-1,0,0],i=[0,0,0],n="same"){return vx(this,e,i,n)}setVolumeData(e=[-1,0,0],i=[0,0,0],n=new Uint8Array){xx(this,e,i,n)}static async loadFromBase64({base64:e,name:i="",colormap:n="gray",opacity:r=1,cal_min:o=NaN,cal_max:l=NaN,trustCalMinMax:h=!0,percentileFrac:f=.02,ignoreZeroVoxels:u=!1,useQFormNotSForm:m=!1,colormapNegative:g="",frame4D:p=0,imageType:v=Fe.UNKNOWN,cal_minNeg:x=NaN,cal_maxNeg:w=NaN,colorbarVisible:b=!0,colormapLabel:S=null}){function C(T){const D=window.atob(T),R=D.length,N=new Uint8Array(R);for(let M=0;M<R;M++)N[M]=D.charCodeAt(M);return N.buffer}let E=null;try{const T=C(e);E=await this.new(T,i,n,r,null,o,l,h,f,u,m,g,p,v,x,w,b,S,0,null)}catch(T){j.debug(T)}if(E===null)throw new Error("could not load NVImage");return E}clone(){const e=new Hl;return e.id=_h(),e.hdr=Object.assign({},this.hdr),e.img=this.img.slice(),e.calculateRAS(),e.calMinMax(),e}zeroImage(){this.img.fill(0)}getImageMetadata(){if(!this.hdr)throw new Error("hdr undefined");const e=this.id,i=this.hdr.datatypeCode,n=this.hdr.dims,r=n[1],o=n[2],l=n[3],h=Math.max(1,n[4]),f=this.hdr.pixDims,u=f[1],m=f[2],g=f[3],p=f[4],v=Math.floor(this.hdr.numBitsPerVoxel/8);return{id:e,datatypeCode:i,nx:r,ny:o,nz:l,nt:h,dx:u,dy:m,dz:g,dt:p,bpv:v}}static zerosLike(e,i="same"){const n=e.clone();return n.zeroImage(),i==="uint8"&&(n.img=Uint8Array.from(n.img),n.hdr.datatypeCode=2,n.hdr.numBitsPerVoxel=8),i==="float32"&&(n.img=Float32Array.from(n.img),n.hdr.datatypeCode=16,n.hdr.numBitsPerVoxel=32),n}getValue(e,i,n,r=0,o=!1){return Ax(this,e,i,n,r,o)}applyOptionsUpdate(e){this.hdr.cal_min=e.cal_min,this.hdr.cal_max=e.cal_max,Object.assign(this,e)}getImageOptions(){return Yl("","",this.name,this._colormap,this.opacity,this.hdr.cal_min,this.hdr.cal_max,this.trustCalMinMax,this.percentileFrac,this.ignoreZeroVoxels,this.useQFormNotSForm,this.colormapNegative,this.frame4D,this.imageType,this.colormapType)}toUint8Array(e=null){return og(this,e)}convertVox2Frac(e){return he((e[0]+.5)/this.dimsRAS[1],(e[1]+.5)/this.dimsRAS[2],(e[2]+.5)/this.dimsRAS[3])}convertFrac2Vox(e){return he(Math.round(e[0]*this.dims[1]-.5),Math.round(e[1]*this.dims[2]-.5),Math.round(e[2]*this.dims[3]-.5))}convertFrac2MM(e,i=!1){const n=ut(e[0],e[1],e[2],1);return i?qt(n,n,this.frac2mm):qt(n,n,this.frac2mmOrtho),n}convertMM2Frac(e,i=!1){const n=ut(e[0],e[1],e[2],1),r=this.dimsRAS,o=he(0,0,0);if(typeof r>"u")return o;if(!i){const h=Rt(this.frac2mmOrtho);return vi(h,h),qt(n,n,h),o[0]=n[0],o[1]=n[1],o[2]=n[2],o}if(r[1]<1||r[2]<1||r[3]<1)return o;const l=Rt(this.matRAS);return vi(l,l),Ni(l,l),qt(n,n,l),o[0]=(n[0]+.5)/r[1],o[1]=(n[1]+.5)/r[2],o[2]=(n[2]+.5)/r[3],o}},Ua=(t=>(t[t.NEVER=0]="NEVER",t[t.ALWAYS=1]="ALWAYS",t[t.AUTO=2]="AUTO",t))(Ua||{}),fg=(t=>(t[t.none=0]="none",t[t.contrast=1]="contrast",t[t.measurement=2]="measurement",t[t.pan=3]="pan",t[t.slicer3D=4]="slicer3D",t[t.callbackOnly=5]="callbackOnly",t[t.roiSelection=6]="roiSelection",t))(fg||{}),tn={textHeight:.06,colorbarHeight:.05,colorbarWidth:-1,showColorbarBorder:!0,crosshairWidth:1,crosshairWidthUnit:"voxels",crosshairGap:0,rulerWidth:4,show3Dcrosshair:!1,backColor:[0,0,0,1],crosshairColor:[1,0,0,1],fontColor:[.5,.5,.5,1],selectionBoxColor:[1,1,1,.5],clipPlaneColor:[.7,0,.7,.5],clipThick:2,clipVolumeLow:[0,0,0],clipVolumeHigh:[1,1,1],rulerColor:[1,0,0,.8],colorbarMargin:.05,trustCalMinMax:!0,clipPlaneHotKey:"KeyC",viewModeHotKey:"KeyV",doubleTouchTimeout:500,longTouchTimeout:1e3,keyDebounceTime:50,isNearestInterpolation:!1,isResizeCanvas:!0,atlasOutline:0,isRuler:!1,isColorbar:!1,isOrientCube:!1,tileMargin:0,multiplanarPadPixels:0,multiplanarForceRender:!1,multiplanarEqualSize:!1,multiplanarShowRender:2,isRadiologicalConvention:!1,meshThicknessOn2D:1/0,dragMode:1,dragModePrimary:0,yoke3Dto2DZoom:!1,isDepthPickMesh:!1,isCornerOrientationText:!1,isOrientationTextVisible:!0,heroImageFraction:0,heroSliceType:4,sagittalNoseLeft:!1,isSliceMM:!1,isV1SliceShader:!1,forceDevicePixelRatio:0,logLevel:"info",loadingText:"loading ...",isForceMouseClickToVoxelCenters:!1,dragAndDropEnabled:!0,drawingEnabled:!1,penValue:1,floodFillNeighbors:6,isFilledPen:!1,thumbnail:"",maxDrawUndoBitmaps:8,sliceType:3,meshXRay:0,isAntiAlias:null,limitFrames4D:NaN,isAdditiveBlend:!1,showLegend:!0,legendBackgroundColor:[.3,.3,.3,.5],legendTextColor:[1,1,1,1],multiplanarLayout:0,renderOverlayBlend:1,sliceMosaicString:"",centerMosaic:!1,penSize:1,interactive:!0,clickToSegment:!1,clickToSegmentRadius:3,clickToSegmentBright:!0,clickToSegmentAutoIntensity:!1,clickToSegmentIntensityMax:NaN,clickToSegmentIntensityMin:NaN,clickToSegmentPercent:0,clickToSegmentMaxDistanceMM:Number.POSITIVE_INFINITY,clickToSegmentIs2D:!1,selectionBoxLineThickness:4,selectionBoxIsOutline:!1,scrollRequiresFocus:!1,showMeasureUnits:!0,measureTextJustify:"center",measureTextColor:[1,0,0,1],measureLineColor:[1,0,0,1],measureTextHeight:.03,isAlphaClipDark:!1,gradientOrder:1,gradientOpacity:0,renderSilhouette:0,gradientAmount:0,invertScrollDirection:!1,is2DSliceShader:!1},ql={gamma:1,azimuth:110,elevation:10,crosshairPos:he(.5,.5,.5),clipPlane:[0,0,0,0],clipPlaneDepthAziElev:[2,0,0],volScaleMultiplier:1,pan2Dxyzmm:ut(0,0,0,1),clipThick:2,clipVolumeLow:[0,0,0],clipVolumeHigh:[1,1,1]},Fh=class Da{constructor(){k(this,"data",{title:"Untitled document",imageOptionsArray:[],meshOptionsArray:[],opts:{...tn},previewImageDataURL:"",labels:[],encodedImageBlobs:[],encodedDrawingBlob:""}),k(this,"scene"),k(this,"volumes",[]),k(this,"meshDataObjects"),k(this,"meshes",[]),k(this,"drawBitmap",null),k(this,"imageOptionsMap",new Map),k(this,"meshOptionsMap",new Map),this.scene={onAzimuthElevationChange:()=>{},onZoom3DChange:()=>{},sceneData:{...ql,pan2Dxyzmm:ut(0,0,0,1),crosshairPos:he(.5,.5,.5)},get renderAzimuth(){return this.sceneData.azimuth},set renderAzimuth(e){this.sceneData.azimuth=e,this.onAzimuthElevationChange&&this.onAzimuthElevationChange(this.sceneData.azimuth,this.sceneData.elevation)},get renderElevation(){return this.sceneData.elevation},set renderElevation(e){this.sceneData.elevation=e,this.onAzimuthElevationChange&&this.onAzimuthElevationChange(this.sceneData.azimuth,this.sceneData.elevation)},get volScaleMultiplier(){return this.sceneData.volScaleMultiplier},set volScaleMultiplier(e){this.sceneData.volScaleMultiplier=e,this.onZoom3DChange(e)},get crosshairPos(){return this.sceneData.crosshairPos},set crosshairPos(e){this.sceneData.crosshairPos=e},get clipPlane(){return this.sceneData.clipPlane},set clipPlane(e){this.sceneData.clipPlane=e},get clipPlaneDepthAziElev(){return this.sceneData.clipPlaneDepthAziElev},set clipPlaneDepthAziElev(e){this.sceneData.clipPlaneDepthAziElev=e},get pan2Dxyzmm(){return this.sceneData.pan2Dxyzmm},set pan2Dxyzmm(e){this.sceneData.pan2Dxyzmm=e},get gamma(){return this.sceneData.gamma},set gamma(e){this.sceneData.gamma=e}}}get title(){return this.data.title}get previewImageDataURL(){return this.data.previewImageDataURL}set previewImageDataURL(e){this.data.previewImageDataURL=e}set title(e){this.data.title=e}get imageOptionsArray(){return this.data.imageOptionsArray}get encodedImageBlobs(){return this.data.encodedImageBlobs}get encodedDrawingBlob(){return this.data.encodedDrawingBlob}get opts(){return this.data.opts}set opts(e){this.data.opts={...e}}get labels(){return this.data.labels}set labels(e){this.data.labels=e}get customData(){return this.data.customData}set customData(e){this.data.customData=e}hasImage(e){return this.volumes.find(i=>i.id===e.id)!==void 0}hasImageFromUrl(e){return this.data.imageOptionsArray.find(i=>i.url===e)!==void 0}addImageOptions(e,i){if(!this.hasImage(e)&&!i.name)if(i.url){const r=/^(?:[a-z+]+:)?\/\//i.test(i.url)?new URL(i.url):new URL(i.url,window.location.href);i.name=r.pathname.split("/").pop(),i.name.toLowerCase().endsWith(".gz")&&(i.name=i.name.slice(0,-3)),i.name.toLowerCase().endsWith(".nii")||(i.name+=".nii")}else i.name="untitled.nii";i.imageType=Fe.NII,this.data.imageOptionsArray.push(i),this.imageOptionsMap.set(e.id,this.data.imageOptionsArray.length-1)}removeImage(e){if(this.imageOptionsMap.has(e.id)){const i=this.imageOptionsMap.get(e.id);this.data.imageOptionsArray.length>i&&this.data.imageOptionsArray.splice(i,1),this.imageOptionsMap.delete(e.id)}this.volumes=this.volumes.filter(i=>i.id!==e.id)}getImageOptions(e){return this.imageOptionsMap.has(e.id)?this.data.imageOptionsArray[this.imageOptionsMap.get(e.id)]:null}json(){const e={encodedImageBlobs:[],previewImageDataURL:this.data.previewImageDataURL,imageOptionsMap:new Map},i=[];e.sceneData={...this.scene.sceneData},e.opts={...this.opts},this.opts.meshThicknessOn2D===1/0&&(e.opts.meshThicknessOn2D="infinity"),e.labels=[...this.data.labels];for(const r of e.labels)delete r.onClick;if(e.customData=this.customData,this.volumes.length)for(let r=0;r<this.volumes.length;r++){const o=this.volumes[r];let l=this.getImageOptions(o);l===null?(j.warn("no options found for image, using default"),l={name:"",colormap:"gray",opacity:1,pairedImgData:null,cal_min:NaN,cal_max:NaN,trustCalMinMax:!0,percentileFrac:.02,ignoreZeroVoxels:!1,useQFormNotSForm:!1,colormapNegative:"",colormapLabel:null,imageType:Fe.NII,frame4D:0,limitFrames4D:NaN,url:"",urlImageData:"",alphaThreshold:!1,cal_minNeg:NaN,cal_maxNeg:NaN,colorbarVisible:!0}):"imageType"in l||(l.imageType=Fe.NII),l.colormap=o.colormap,l.colormapLabel=o.colormapLabel,l.opacity=o.opacity,l.cal_max=o.cal_max||NaN,l.cal_min=o.cal_min||NaN,i.push(l);const h=Ae.uint8tob64(o.toUint8Array());e.encodedImageBlobs.push(h),e.imageOptionsMap.set(o.id,r)}e.imageOptionsArray=[...i];const n=[];e.connectomes=[];for(const r of this.meshes){if(r.type==="connectome"){e.connectomes.push(JSON.stringify(r.json()));continue}const o={pts:r.pts,tris:r.tris,name:r.name,rgba255:Uint8Array.from(r.rgba255),opacity:r.opacity,connectome:r.connectome,dpg:r.dpg,dps:r.dps,dpv:r.dpv,meshShaderIndex:r.meshShaderIndex,layers:r.layers.map(l=>({values:l.values,nFrame4D:l.nFrame4D,frame4D:0,outlineBorder:l.outlineBorder,global_min:l.global_min,global_max:l.global_max,cal_min:l.cal_min,cal_max:l.cal_max,opacity:l.opacity,colormap:l.colormap,colormapNegative:l.colormapNegative,colormapLabel:l.colormapLabel,useNegativeCmap:l.useNegativeCmap})),hasConnectome:r.hasConnectome,edgeColormap:r.edgeColormap,edgeColormapNegative:r.edgeColormapNegative,edgeMax:r.edgeMax,edgeMin:r.edgeMin,edges:r.edges&&Array.isArray(r.edges)?[...r.edges]:[],extentsMax:r.extentsMax,extentsMin:r.extentsMin,furthestVertexFromOrigin:r.furthestVertexFromOrigin,nodeColormap:r.nodeColormap,nodeColormapNegative:r.nodeColormapNegative,nodeMaxColor:r.nodeMaxColor,nodeMinColor:r.nodeMinColor,nodeScale:r.nodeScale,legendLineThickness:r.legendLineThickness,offsetPt0:r.offsetPt0,nodes:r.nodes};r.offsetPt0&&r.offsetPt0.length>0&&(o.offsetPt0=r.offsetPt0,o.fiberGroupColormap=r.fiberGroupColormap,o.fiberColor=r.fiberColor,o.fiberDither=r.fiberDither,o.fiberRadius=r.fiberRadius,o.colormap=r.colormap),n.push(o)}return e.meshesString=JSON.stringify(R5(n)),this.drawBitmap&&(e.encodedDrawingBlob=Ae.uint8tob64(this.drawBitmap)),e}async download(e,i){const n=this.json(),r=JSON.stringify(n),o=i?"application/gzip":"application/json";let l;i?l=await Ae.compressStringToArrayBuffer(r):l=r,Ae.download(l,e,o)}static deserializeMeshDataObjects(e){if(e.data.meshesString){e.meshDataObjects=T5(JSON.parse(e.data.meshesString));for(const i of e.meshDataObjects)for(const n of i.layers)"colorMap"in n&&(n.colormap=n.colorMap,delete n.colorMap),"colorMapNegative"in n&&(n.colormapNegative=n.colorMapNegative,delete n.colorMapNegative)}}static async loadFromUrl(e){const n=await(await fetch(e)).arrayBuffer();let r;if(Ae.isArrayBufferCompressed(n)){const o=await Ae.decompressArrayBuffer(n);r=JSON.parse(o)}else{const o=new TextDecoder;r=JSON.parse(o.decode(n))}return Da.loadFromJSON(r)}static async loadFromFile(e){const i=await Ae.readFileAsync(e);let n;const r=new Da;return Ae.isArrayBufferCompressed(i)?n=await Ae.decompressArrayBuffer(i):n=new TextDecoder().decode(i),r.data=JSON.parse(n),r.data.opts.meshThicknessOn2D==="infinity"&&(r.data.opts.meshThicknessOn2D=1/0),r.scene.sceneData={...ql,...r.data.sceneData},Da.deserializeMeshDataObjects(r),r}static loadFromJSON(e){const i=new Da;return i.data=e,i.data.opts.meshThicknessOn2D==="infinity"&&(i.data.opts.meshThicknessOn2D=1/0),i.scene.sceneData={...ql,...e.sceneData},Da.deserializeMeshDataObjects(i),i}},Cx={colormap:"gray",opacity:0,nFrame4D:0,frame4D:0,outlineBorder:0,cal_min:0,cal_max:0,cal_minNeg:0,cal_maxNeg:0,colormapType:0,values:new Array,useNegativeCmap:!1,showLegend:!0},Na=class rs{constructor(e,i,n="",r=new Uint8Array([255,255,255,255]),o=1,l=!0,h,f=null,u=null,m=null,g=null,p=!0,v=""){k(this,"id"),k(this,"name"),k(this,"anatomicalStructurePrimary"),k(this,"colorbarVisible"),k(this,"furthestVertexFromOrigin"),k(this,"extentsMin"),k(this,"extentsMax"),k(this,"opacity"),k(this,"visible"),k(this,"meshShaderIndex",0),k(this,"offsetPt0",null),k(this,"colormapInvert",!1),k(this,"fiberGroupColormap",null),k(this,"indexBuffer"),k(this,"vertexBuffer"),k(this,"vao"),k(this,"vaoFiber"),k(this,"pts"),k(this,"tris"),k(this,"layers"),k(this,"type","mesh"),k(this,"data_type"),k(this,"rgba255"),k(this,"fiberLength"),k(this,"fiberLengths"),k(this,"fiberDensity"),k(this,"fiberDither",.1),k(this,"fiberColor","Global"),k(this,"fiberDecimationStride",1),k(this,"fiberSides",5),k(this,"fiberRadius",0),k(this,"fiberOcclusion",0),k(this,"f32PerVertex",5),k(this,"fiberMask"),k(this,"colormap"),k(this,"dpg"),k(this,"dps"),k(this,"dpv"),k(this,"hasConnectome",!1),k(this,"connectome"),k(this,"indexCount"),k(this,"vertexCount",1),k(this,"nodeScale",4),k(this,"edgeScale",1),k(this,"legendLineThickness",0),k(this,"nodeColormap","warm"),k(this,"edgeColormap","warm"),k(this,"nodeColormapNegative"),k(this,"edgeColormapNegative"),k(this,"nodeMinColor"),k(this,"nodeMaxColor"),k(this,"edgeMin"),k(this,"edgeMax"),k(this,"nodes"),k(this,"edges"),k(this,"points"),this.anatomicalStructurePrimary=v,this.name=n,this.colorbarVisible=p,this.id=_h();const x=Dn.getExtents(e);if(this.furthestVertexFromOrigin=x.mxDx,this.extentsMin=x.extentsMin,this.extentsMax=x.extentsMax,this.opacity=o>1?1:o,this.visible=l,this.meshShaderIndex=0,this.indexBuffer=h.createBuffer(),this.vertexBuffer=h.createBuffer(),this.vao=h.createVertexArray(),h.bindVertexArray(this.vao),h.bindBuffer(h.ELEMENT_ARRAY_BUFFER,this.indexBuffer),h.bindBuffer(h.ARRAY_BUFFER,this.vertexBuffer),h.enableVertexAttribArray(0),h.enableVertexAttribArray(1),this.f32PerVertex!==7?(h.vertexAttribPointer(0,3,h.FLOAT,!1,20,0),h.vertexAttribPointer(1,4,h.BYTE,!0,20,12),h.enableVertexAttribArray(2),h.vertexAttribPointer(2,4,h.UNSIGNED_BYTE,!0,20,16)):(h.vertexAttribPointer(0,3,h.FLOAT,!1,28,0),h.vertexAttribPointer(1,3,h.FLOAT,!1,28,12),h.enableVertexAttribArray(2),h.vertexAttribPointer(2,4,h.UNSIGNED_BYTE,!0,28,24)),h.bindVertexArray(null),this.vaoFiber=h.createVertexArray(),this.offsetPt0=null,this.hasConnectome=!1,this.colormapInvert=!1,this.fiberGroupColormap=null,this.pts=e,this.layers=[],this.type="mesh",this.tris=i,r[3]<1){this.rgba255=r,this.fiberLength=2,this.fiberDither=.1,this.fiberColor="Global",this.fiberDecimationStride=1,this.fiberMask=[],this.colormap=f,this.dpg=u,this.dps=m,this.dpv=g,u&&this.initValuesArray(u),m&&this.initValuesArray(m),g&&this.initValuesArray(g),this.offsetPt0=new Uint32Array(i),this.tris=new Uint32Array(0),this.updateFibers(h),h.bindVertexArray(this.vaoFiber),h.bindBuffer(h.ELEMENT_ARRAY_BUFFER,this.indexBuffer),h.bindBuffer(h.ARRAY_BUFFER,this.vertexBuffer),h.enableVertexAttribArray(0),h.vertexAttribPointer(0,3,h.FLOAT,!1,16,0),h.enableVertexAttribArray(1),h.vertexAttribPointer(1,4,h.UNSIGNED_BYTE,!0,16,12),h.bindVertexArray(null);return}if(f){this.connectome=f,this.hasConnectome=!0;const b=Object.keys(f);for(let S=0,C=b.length;S<C;S++)this[b[S]]=f[b[S]]}this.rgba255=r,this.updateMesh(h)}initValuesArray(e){for(let i=0;i<e.length;i++){const n=e[i].vals.reduce((o,l)=>Math.min(o,l)),r=e[i].vals.reduce((o,l)=>Math.max(o,l));e[i].global_min=n,e[i].global_max=r,e[i].cal_min=n,e[i].cal_max=r}return e}linesToCylinders(e,i,n){function r(V){return he(V[0],V[1],V[2])}const o=Math.pow(2,32)-1,l=n.length;let h=0,f=0;for(let V=0;V<l;V++){if(n[V]===o){f++;continue}h++}const u=this.fiberSides,m=u*h,g=this.f32PerVertex;if(g!==5)throw Error("fiberSides > 1 requires f32PerVertex == 5");const p=new Float32Array(m*g),v=new Uint8Array(p.buffer);let x=0,w=cs(),b=cs(),S=cs();const C=ot();let E=ot(),T=0;const D=this.fiberRadius;for(let V=0;V<l;V++){const I=n[V]===o;if(I&&T<1)continue;let B=n[V]*4;if(T++,T<=1){w=ut(i[B+0],i[B+1],i[B+2],i[B+3]),b=Ms(w),V+1<l&&n[V+1]!==o&&(B=n[V+1]*4,S=ut(i[B+0],i[B+1],i[B+2],i[B+3]),ct(C,r(w),r(S)),Hi(C,C),E=Bn.getFirstPerpVector(C));continue}I?S=Ms(b):S=ut(i[B+0],i[B+1],i[B+2],i[B+3]),ct(C,r(w),r(S)),Hi(C,C);const U=ot();kl(U,E,C);const z=ot();kl(z,C,U),E=jr(E);const P=ot();kl(P,C,z),Hi(P,P);const K=ot();for(let _=0;_<u;_++){const H=Math.cos(_/u*2*Math.PI),q=Math.sin(_/u*2*Math.PI);K[0]=D*(H*z[0]+q*P[0]),K[1]=D*(H*z[1]+q*P[1]),K[2]=D*(H*z[2]+q*P[2]),Fn(K,r(b),K);const se=x*g;p[se+0]=K[0],p[se+1]=K[1],p[se+2]=K[2];const G=ot();ct(G,K,r(b)),Hi(G,G);const W=(se+3)*4;v[W+0]=G[0]*127,v[W+1]=G[1]*127,v[W+2]=G[2]*127,p[se+4]=b[3],x++}w=Ms(b),b=Ms(S),I&&(T=0)}const R=(h-f)*u*2*3,N=new Uint32Array(R);let M=0;x=0;for(let V=1;V<l;V++){if(n[V]===o){x+=u;continue}if(n[V-1]===o)continue;let I=x,B=x+u;const U=B,z=B+u;for(let P=0;P<u;P++)N[M++]=I,N[M++]=B++,B===z&&(B=z-u),N[M++]=B,N[M++]=I++,I===U&&(I=U-u),N[M++]=B,N[M++]=I;x+=u}e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,Uint32Array.from(N),e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer),e.bufferData(e.ARRAY_BUFFER,v,e.STATIC_DRAW),this.indexCount=R}createFiberDensityMap(){if(this.fiberDensity)return;const e=this.pts,i=e.length/3;let n=0;for(let C=0;C<3;C++){const E=this.extentsMax[C]-this.extentsMin[C];n=Math.max(n,E)}if(this.fiberDensity=new Float32Array(i),n===0)return;const r=64,l=n/(r-1)/2,h=(r-1)/n;let f=new Float32Array(r*r*r);const u=[this.extentsMin[0]-l,this.extentsMin[1]-l,this.extentsMin[2]-l],m=[0,0,0],g=-1,p=r*r;let v=0;for(let C=0;C<i;C++){m[0]=Math.round((e[v++]-u[0])*h),m[1]=Math.round((e[v++]-u[1])*h),m[2]=Math.round((e[v++]-u[2])*h);const E=m[0]+m[1]*r+m[2]*p;E!==g&&f[E]++}function x(C,E){let T=C.slice(),D=-1;const R=E-1;for(let M=0;M<E;M++)for(let V=0;V<E;V++)for(let I=0;I<E;I++)D++,!(I<1||I>=R)&&(C[D]=T[D-1]+T[D]+T[D]+T[D+1]);D=-1,T=C.slice();for(let M=0;M<E;M++)for(let V=0;V<E;V++)for(let I=0;I<E;I++)D++,!(V<1||V>=R)&&(C[D]=T[D-E]+T[D]+T[D]+T[D+E]);const N=E*E;D=-1,T=C.slice();for(let M=0;M<E;M++)for(let V=0;V<E;V++)for(let I=0;I<E;I++)D++,!(M<1||M>=R)&&(C[D]=T[D-N]+T[D]+T[D]+T[N]);return C}f=x(f,r),f=x(f,r);let w=0,b=1/0;const S=r*r*r;for(let C=0;C<S;C++)f[C]<=0||(w=Math.max(w,f[C]),b=Math.min(b,f[C]));if(!(w<=1||w<=b)){v=0;for(let C=0;C<S;C++)f[C]=Math.max(0,f[C]-b);w-=b;for(let C=0;C<i;C++){m[0]=Math.round((e[v++]-u[0])*h),m[1]=Math.round((e[v++]-u[1])*h),m[2]=Math.round((e[v++]-u[2])*h);const E=m[0]+m[1]*r+m[2]*p;this.fiberDensity[C]=f[E]/w}}}updateFibers(e){if(!this.offsetPt0||!this.fiberLength)return;const i=this.pts,n=this.offsetPt0,r=n.length-1,o=i.length/3;if(!this.fiberLengths){this.fiberLengths=new Uint32Array(r);for(let R=0;R<r;R++){const N=n[R]*3,M=(n[R+1]-1)*3;let V=0;for(let I=N;I<M;I+=3){const B=he(i[I+0]-i[I+3],i[I+1]-i[I+4],i[I+2]-i[I+5]);V+=Qr(B)}this.fiberLengths[R]=V}}const l=new Float32Array(o*4),h=new Uint32Array(l.buffer);let f=0,u=0;for(let R=0;R<o;R++)l[u+0]=i[f+0],l[u+1]=i[f+1],l[u+2]=i[f+2],f+=3,u+=4;const m=this.fiberDither,g=m*.5;function p(R,N,M){const I=255*(m*Math.random()-g);return R=Math.max(Math.min(R+I,255),0),N=Math.max(Math.min(N+I,255),0),M=Math.max(Math.min(M+I,255),0),R+(N<<8)+(M<<16)}function v(R,N,M,V,I,B,U){const z=he(Math.abs(R-V),Math.abs(N-I),Math.abs(M-B));Hi(z,z);const P=U-g;for(let K=0;K<3;K++)z[K]=255*Math.max(Math.min(Math.abs(z[K])+P,1),0);return z[0]+(z[1]<<8)+(z[2]<<16)}const x=this.fiberColor.toLowerCase();let w=null,b=null;if(x.startsWith("dps")&&this.dps&&this.dps.length>0){const R=parseInt(x.substring(3));R<this.dps.length&&this.dps[R].vals.length===r&&(w=this.dps[R].vals)}if(x.startsWith("dpv")&&this.dpv&&this.dpv.length>0){const R=parseInt(x.substring(3));R<this.dpv.length&&this.dpv[R].vals.length===o&&(b=this.dpv[R])}const S=new Int16Array(r);if(this.dpg&&this.fiberGroupColormap!==null){const R=new Uint8ClampedArray(this.dpg.length*4),N=new Array(this.dpg.length).fill(!1),M=this.fiberGroupColormap;M.A===void 0&&(M.A=Array.from(new Uint8ClampedArray(M.I.length).fill(255)));for(let V=0;V<M.I.length;V++){let I=M.I[V];I<0||I>=this.dpg.length||M.A[V]<1||(N[I]=!0,I*=4,R[I]=M.R[V],R[I+1]=M.G[V],R[I+2]=M.B[V],R[I+3]=255)}S.fill(-1);for(let V=0;V<this.dpg.length;V++)if(N[V])for(let I=0;I<this.dpg[V].vals.length;I++)S[this.dpg[V].vals[I]]=V;for(let V=0;V<r;V++){if(S[V]<0)continue;const I=S[V]%256*4,B=p(R[I],R[I+1],R[I+2]),U=n[V],z=n[V+1]-1,P=U*4+3,K=z*4+3;for(let _=P;_<=K;_+=4)h[_]=B}}else if(b){const R=et.colormap(this.colormap,this.colormapInvert),N=b.cal_min,M=b.cal_max;let V=3;for(let I=0;I<o;I++){let B=Math.min(Math.max((b.vals[I]-N)/(M-N),0),1);B=Math.round(Math.max(Math.min(255,B*255)))*4;const U=R[B]+(R[B+1]<<8)+(R[B+2]<<16);h[V]=U,V+=4}}else if(w){const R=et.colormap(this.colormap,this.colormapInvert);let N=w[0],M=w[0];for(let V=0;V<r;V++)N=Math.min(N,w[V]),M=Math.max(M,w[V]);M===N&&(N-=1);for(let V=0;V<r;V++){let I=(w[V]-N)/(M-N);I=Math.round(Math.max(Math.min(255,I*255)))*4;const B=R[I]+(R[I+1]<<8)+(R[I+2]<<16),U=n[V],z=n[V+1]-1,P=U*4+3,K=z*4+3;for(let _=P;_<=K;_+=4)h[_]=B}}else if(x.includes("fixed"))if(m===0){const R=this.rgba255[0]+(this.rgba255[1]<<8)+(this.rgba255[2]<<16);let N=3;for(let M=0;M<o;M++)h[N]=R,N+=4}else for(let R=0;R<r;R++){const N=p(this.rgba255[0],this.rgba255[1],this.rgba255[2]),M=n[R],V=n[R+1]-1,I=M*4+3,B=V*4+3;for(let U=I;U<=B;U+=4)h[U]=N}else if(x.includes("local"))for(let R=0;R<r;R++){const N=n[R],M=n[R+1]-1;let V=N*3;const I=M*3,B=m*Math.random();let U=v(i[V],i[V+1],i[V+2],i[V+4],i[V+5],i[V+6],B),z=N*4+3;for(;V<I;)h[z]=U,z+=4,V+=3,U=v(i[V-3],i[V-2],i[V-1],i[V+3],i[V+4],i[V+5],B);h[z]=h[z-4]}else for(let R=0;R<r;R++){const N=n[R],M=n[R+1]-1,V=N*3,I=M*3,B=v(i[V],i[V+1],i[V+2],i[I],i[I+1],i[I+2],m*Math.random()),U=N*4+3,z=M*4+3;for(let P=U;P<=z;P+=4)h[P]=B}if(this.fiberOcclusion>0){let R=function(N,M){const V=M*(N&255),I=M*(N>>8&255),B=M*(N>>16&255);return V+(I<<8)+(B<<16)};this.createFiberDensityMap();for(let N=0;N<r;N++){const M=n[N],V=n[N+1]-1,I=M*4+3,B=V*4+3;let U=M;const z=Math.min(this.fiberOcclusion,.99);for(let P=I;P<=B;P+=4){let K=this.fiberDensity[U++];if(K<=0)continue;K=K/((1/z-2)*(1-K)+1);const _=1-Math.min(K,.9);let H=h[P];H=R(H,_),h[P]=H}}}const C=this.fiberLength,E=Math.pow(2,32)-1,T=[];let D=-1;for(let R=0;R<r;R++)if(!(S[R]<0)&&!(this.fiberLengths[R]<C)&&(D++,D%this.fiberDecimationStride===0)){for(let N=n[R];N<n[R+1];N++)T.push(N);T.push(E)}this.fiberSides>2&&this.fiberRadius>0?this.linesToCylinders(e,l,T):(this.indexCount=T.length,e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer),e.bufferData(e.ARRAY_BUFFER,Uint32Array.from(h),e.STATIC_DRAW),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,Uint32Array.from(T),e.STATIC_DRAW))}indexNearestXYZmm(e,i,n){const r=this.pts,o=this.pts.length/3;let l=0,h=1/0,f=0;for(let u=0;u<o;u++){const m=Math.pow(r[l]-e,2)+Math.pow(r[l+1]-i,2)+Math.pow(r[l+2]-n,2);m<h&&(h=m,f=u),l+=3}return h=Math.sqrt(h),[f,h]}unloadMesh(e){if(e.bindBuffer(e.ARRAY_BUFFER,null),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null),e.bindVertexArray(null),e.deleteBuffer(this.vertexBuffer),e.deleteBuffer(this.indexBuffer),e.deleteVertexArray(this.vao),e.deleteVertexArray(this.vaoFiber),this.offsetPt0=null,this.tris=null,this.pts=null,this.layers&&this.layers.length>0)for(let i=0;i<this.layers.length;i++)this.layers[i].values=null;if(this.dpg&&this.dpg.length>0)for(let i=0;i<this.dpg.length;i++)this.dpg[i].vals=null;if(this.dps&&this.dps.length>0)for(let i=0;i<this.dps.length;i++)this.dps[i].vals=null}scalars2RGBA(e,i,n,r=!1){const o=n.length;if(4*o<e.length)return j.error(`colormap2RGBA incorrectly specified ${o}*4 != ${e.length}`),e;const l=Math.round(i.opacity*255);let h=i.cal_min,f=i.cal_max,u=et.colormap(i.colormap,this.colormapInvert),m=1;if(r){if(!i.useNegativeCmap)return e;m=-1,u=et.colormap(i.colormapNegative,i.colormapInvert),h=i.cal_min,f=i.cal_max,isFinite(i.cal_minNeg)&&isFinite(i.cal_minNeg)&&(h=-i.cal_minNeg,f=-i.cal_maxNeg)}let g=h;i.isTransparentBelowCalMin||(g=Number.NEGATIVE_INFINITY);const p=i.colormapType===2;i.colormapType!==0&&(h=Math.min(h,0));const v=255/(f-h);for(let x=0;x<o;x++){let w=n[x]*m;if(isNaN(w))continue;let b=l;if(w<g)if(w>0&&p)b=Math.round(i.opacity*255*Math.pow(w/g,2));else continue;if(w=(w-h)*v,w<0&&i.isTransparentBelowCalMin)continue;w=Math.min(255,Math.max(0,Math.round(w)))*4;const S=x*4;e[S+0]=u[w+0],e[S+1]=u[w+1],e[S+2]=u[w+2],e[S+3]=b}return e}blendColormap(e,i,n,r,o,l,h=!1){const f=this.pts.length/3,u=Math.min(n.opacity,1);function m(E,T,D){return E*(1-D)+T*D}function g(E,T){return Math.min(E+T,255)}const p=h?-1:1,v=Math.min(Math.max(n.frame4D,0),n.nFrame4D-1),x=f*v;let w=r;n.isTransparentBelowCalMin||(w=Number.NEGATIVE_INFINITY),n.colormapType!==0&&(r=Math.min(r,0));const b=255/(o-r);let S=new Array(f).fill(!1);if(n.outlineBorder!==0){const E=new Uint8Array(f).fill(0);for(let T=0;T<f;T++)p*n.values[T+x]>=w&&(E[T]=1);S=Dn.getClusterBoundaryU8(E,this.tris);for(let T=0;T<f;T++)p*n.values[T+x]<w&&(S[T]=!1)}const C=new Float32Array(256).fill(u);if(w>r&&n.colormapType===2){let E=Math.round((w-r)*b);E=Math.max(E,1);for(let T=1;T<E;T++)C[T]=u*Math.pow(T/E,2);C[0]=0,w=r+Number.EPSILON}for(let E=0;E<f;E++){const T=p*n.values[E+x];if(T<w)continue;let D=Math.round((T-r)*b);if(D<0&&n.isTransparentBelowCalMin)continue;D=Math.max(0,D),D=Math.min(255,D);let R=C[D];D*=4;let N=E*28+24;if(this.f32PerVertex!==7&&(N=E*20+16),n.isAdditiveBlend){const M=E*4;i[M+0]=g(i[M+0],l[D+0]),i[M+1]=g(i[M+1],l[D+1]),i[M+2]=g(i[M+2],l[D+2]),i[M+3]=g(i[M+3],255)}else{if(S[E]&&(R=n.outlineBorder,n.outlineBorder<0)){e[N+0]=0,e[N+1]=0,e[N+2]=0;continue}e[N+0]=m(e[N+0],l[D+0],R),e[N+1]=m(e[N+1],l[D+1],R),e[N+2]=m(e[N+2],l[D+2],R)}}}updateMesh(e){if(this.offsetPt0){this.updateFibers(e);return}if(this.hasConnectome)return;if(!this.pts||!this.tris||!this.rgba255){j.warn("underspecified mesh");return}function i(f,u,m){return f*(1-m)+u*m}const n=this.generatePosNormClr(this.pts,this.tris,this.rgba255),r=this.pts.length/3,o=new Uint8Array(n.buffer),l=new Uint8Array(r*4);let h=this.tris;if(this.layers&&this.layers.length>0)for(let f=0;f<this.layers.length;f++){const u=this.layers[f],m=u.opacity;if(m<=0||u.cal_min>u.cal_max)continue;if(u.outlineBorder===void 0&&(u.outlineBorder=0),u.isAdditiveBlend===void 0&&(u.isAdditiveBlend=!1),u.colormapLabel&&u.colormapLabel.R&&!u.colormapLabel.lut&&(u.colormapLabel=et.makeLabelLut(u.colormapLabel)),u.colormapLabel&&u.colormapLabel.lut){const p=u.colormapLabel;let v=0;u.colormapLabel.min&&(v=u.colormapLabel.min);let x=p.lut;const w=Math.round(u.opacity*255);x[3]>0&&(x[3]=w);for(let R=7;R<x.length;R+=4)x[R]=w;const b=Math.floor(x.length/4);if(u.atlasValues&&b>0&&b===u.atlasValues.length&&u.colormap){const R=u.atlasValues;let N=!1,M=!0;for(let V=0;V<b;V++)isNaN(R[V])?N=!0:M=!1;if(M){j.debug("invisible mesh: all atlasValues are NaN.");return}if(N){j.debug("some vertices have NaN atlasValues (mesh will be decimated).");const V=new Array(r).fill(!1);for(let P=0;P<r;P++){const K=Math.round(u.values[P])-v;isNaN(R[K])&&(V[P]=!0)}const I=new Array(h.length).fill(!1);for(let P=0;P<h.length;P++)V[h[P]]&&(I[P]=!0);const B=this.tris;let U=0;for(let P=0;P<B.length;P+=3)!I[P]&&!I[P+1]&&!I[P+2]&&U++;U===0&&j.debug("invisible mesh: all triangles of a vertex with a NaN atlasValue."),h=new Uint32Array(U*3);let z=0;for(let P=0;P<B.length;P+=3)!I[P]&&!I[P+1]&&!I[P+2]&&(h[z++]=B[P],h[z++]=B[P+1],h[z++]=B[P+2])}x.fill(0),x=this.scalars2RGBA(x,u,R),u.useNegativeCmap&&(x=this.scalars2RGBA(x,u,R,!0))}else u.atlasValues&&j.warn(`Expected ${b} atlasValues but got ${u.atlasValues.length} for mesh layer`);if(u.showLegend&&b===u.colormapLabel.labels.length){u.labels=[];for(let R=0;R<b;R++){const N=Array.from(x.slice(R*4,R*4+4)).map(I=>I/255),M=u.colormapLabel.labels[R];if(N[3]===0||!M||M.startsWith("_"))continue;N[3]=1;const V=new xf(M,{textColor:N,bulletScale:1,bulletColor:N,lineWidth:0,lineColor:N,textScale:1,textAlignment:"left",lineTerminator:"none"});u.labels.push(V),j.debug("label for mesh layer:",V)}}else delete u.labels;const S=Math.min(Math.max(u.frame4D,0),u.nFrame4D-1),C=r*S,E=new Uint8Array(r*4);let T=0;for(let R=0;R<r;R++){const N=u.values[R+C]-v,M=4*Math.min(Math.max(N,0),b-1);E[T+0]=x[M+0],E[T+1]=x[M+1],E[T+2]=x[M+2],E[T+3]=x[M+3],T+=4}let D=new Array(r).fill(!1);u.outlineBorder!==0&&(D=Dn.getClusterBoundary(E,this.tris)),T=0;for(let R=0;R<r;R++){let N=R*28+24;this.f32PerVertex!==7&&(N=R*20+16);let M=E[T+3]/255;if(D[R]&&(M=u.outlineBorder,u.outlineBorder<0)){o[N+0]=0,o[N+1]=0,o[N+2]=0,T+=4;continue}o[N+0]=i(o[N+0],E[T+0],M),o[N+1]=i(o[N+1],E[T+1],M),o[N+2]=i(o[N+2],E[T+2],M),T+=4}continue}if(u.values instanceof Uint8Array){const p=new Uint8Array(u.values.buffer);let v=new Array(r).fill(!0);u.outlineBorder!==0&&(v=Dn.getClusterBoundary(p,this.tris));let x=0;for(let w=0;w<u.values.length;w++){let b=w*28+24;this.f32PerVertex!==7&&(b=w*20+16);let S=m;if(v[w]&&(S=u.outlineBorder,u.outlineBorder<0)){o[b+0]=0,o[b+1]=0,o[b+2]=0,x+=4;continue}o[b+0]=i(o[b+0],p[x+0],S),o[b+1]=i(o[b+1],p[x+1],S),o[b+2]=i(o[b+2],p[x+2],S),x+=4}continue}u.useNegativeCmap&&(u.cal_min=Math.max(Number.EPSILON,u.cal_min),u.cal_max=Math.max(u.cal_min+1e-6,u.cal_max)),u.isTransparentBelowCalMin===void 0&&(u.isTransparentBelowCalMin=!0);const g=et.colormap(u.colormap,u.colormapInvert);if(this.blendColormap(o,l,u,u.cal_min,u.cal_max,g),u.useNegativeCmap){const p=et.colormap(u.colormapNegative,u.colormapInvert);let v=u.cal_min,x=u.cal_max;isFinite(u.cal_minNeg)&&isFinite(u.cal_minNeg)&&(v=-u.cal_minNeg,x=-u.cal_maxNeg),this.blendColormap(o,l,u,v,x,p,!0)}}e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,Uint32Array.from(h),e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer),e.bufferData(e.ARRAY_BUFFER,o,e.STATIC_DRAW),this.indexCount=h.length,this.vertexCount=this.pts.length}reverseFaces(e){if(this.offsetPt0||this.hasConnectome)return;const i=this.tris||[];for(let n=0;n<i.length;n+=3){const r=i[n];i[n]=i[n+1],i[n+1]=r}this.updateMesh(e)}hierarchicalOrder(){const n=this.tris.length/3,r=Math.log(n/20)/Math.log(4);if(n!==Math.pow(4,r)*20)return NaN;if(this.pts.length/3!==Math.pow(4,r)*10+2)return NaN;for(let l=0;l<15;l+=3)if(this.tris[l]!==0)return NaN;for(let l=15;l<24;l+=3)if(this.tris[l]!==3)return NaN;for(let l=24;l<30;l+=3)if(this.tris[l]!==4)return NaN;return r}decimateFaces(e,i){let n=this.tris;const r=12,o=20;for(let l=e-1;l>=i;l--){const h=Math.pow(4,l+1)*(r-2)+2,f=Math.pow(4,l)*(r-2)+2,u=n.length/3,m=Math.pow(4,l)*o;console.log(`order ${l+1} -> ${l} vertices ${h} -> ${f} faces ${u} -> ${m}`);const g=Array.from({length:h},(v,x)=>x+1);for(let v=0;v<u;v++){const x=n[3*v],w=n[3*v+1],b=n[3*v+2];g[x-1]=Math.min(g[x-1],w,b)}const p=new Uint32Array(m*3);for(let v=0;v<m;v++)p[3*v]=g[n[3*v]-1],p[3*v+1]=g[n[3*v+1]-1],p[3*v+2]=g[n[3*v+2]-1];n=p}this.tris=new Uint32Array(n)}decimateHierarchicalMesh(e,i=4){const n=this.hierarchicalOrder();if(isNaN(n))return j.warn("Unable to decimate mesh: it does not have a hierarchical structure"),!1;if(i>=n)return j.warn(`Unable to decimate mesh: input order (${n}) must be larger than downsampled order (${i})`),!1;const r=this.pts.length/3,l=Math.pow(4,i)*(12-2)+2;if(this.pts=new Float32Array(this.pts.slice(0,l*3)),this.decimateFaces(n,i),this.layers&&this.layers.length>0)for(let h=0;h<this.layers.length;h++){const f=this.layers[h];f.values instanceof Float32Array||f.values.length!==r?f.values=new Float32Array(f.values.slice(0,l)):j.warn("decimation logic needs to be updated")}return this.updateMesh(e),!0}async setLayerProperty(e,i,n,r){const o=this.layers[e];if(!o||!(i in o)){j.warn("mesh does not have property ",i," for layer ",o);return}if(i==="colormapLabel")if(typeof n=="object")o[i]=et.makeLabelLut(n);else if(typeof n=="string"){const l=await et.makeLabelLutFromUrl(n);o[i]=l,this.updateMesh(r);return}else j.error("colormapLabel requires a string or object");else o[i]=n;this.updateMesh(r)}setProperty(e,i,n){if(!(e in this)){console.warn("Mesh does not have property:",e,this);return}this[e]=i,this.updateMesh(n)}generatePosNormClr(e,i,n){(e.length<3||n.length<4)&&(j.error("Catastrophic failure generatePosNormClr()"),j.debug("this",this),j.debug("pts",e),j.debug("rgba",n));const r=Dn.generateNormals(e,i),o=e.length/3,l=o===n.length/4,h=this.f32PerVertex,f=new Float32Array(o*h),u=new Uint8Array(f.buffer);let m=0,g=0,p=0,v=(h-1)*4;for(let x=0;x<o;x++)f[p+0]=e[m+0],f[p+1]=e[m+1],f[p+2]=e[m+2],h!==7?(u[v-4]=r[m+0]*127,u[v-3]=r[m+1]*127,u[v-2]=r[m+2]*127):(f[p+3]=r[m+0],f[p+4]=r[m+1],f[p+5]=r[m+2]),u[v]=n[g+0],u[v+1]=n[g+1],u[v+2]=n[g+2],u[v+3]=n[g+3],l&&(g+=4),m+=3,p+=h,v+=h*4;return f}static async readMesh(e,i,n,r=1,o=new Uint8Array([255,255,255,255]),l=!0){let h=new Uint32Array([]),f=new Float32Array([]),u="",m;const g=/(?:\.([^.]+))?$/;let p=g.exec(i)[1];if(p=p.toUpperCase(),p==="GZ"&&(p=g.exec(i.slice(0,-3))[1],p=p.toUpperCase()),p==="JCON"&&j.error("you should never see this message: load using nvconnectome not nvmesh"),p==="JSON"&&j.error("you should never see this message: load using nvconnectome not nvmesh"),o[3]=Math.max(1,o[3]),p==="TCK"||p==="TRK"||p==="TT"||p==="TRX"||p==="TRACT"){if(p==="TCK"?m=gt.readTCK(e):p==="TRACT"?m=gt.readTRACT(e):p==="TT"?m=await gt.readTT(e):p==="TRX"?m=await gt.readTRX(e):m=await gt.readTRK(e),typeof m>"u"){const b=new Float32Array([0,0,0,0,0,0]),S=new Uint32Array([0]);m={pts:b,offsetPt0:S},j.error("Creating empty tracts")}return o[3]=0,new rs(m.pts,m.offsetPt0,i,o,r,l,n,"inferno",m.dpg||null,m.dps||null,m.dpv||null)}if(p==="GII")m=await gt.readGII(e);else if(p==="MZ3")m=await gt.readMZ3(e),"positions"in m||j.warn("MZ3 does not have positions (statistical overlay?)");else if(p==="ASC")m=gt.readASC(e);else if(p==="DFS")m=gt.readDFS(e);else if(p==="BYU"||p==="G")m=gt.readGEO(e);else if(p==="GEO")m=gt.readGEO(e,!0);else if(p==="ICO"||p==="TRI")m=gt.readICO(e);else if(p==="OFF")m=gt.readOFF(e);else if(p==="NV")m=gt.readNV(e);else if(p==="OBJ")m=await gt.readOBJ(e);else if(p==="PLY")m=gt.readPLY(e);else if(p==="WRL")m=gt.readWRL(e);else if(p==="X3D")m=gt.readX3D(e);else if(p==="FIB"||p==="VTK"){if(m=gt.readVTK(e),"offsetPt0"in m)return o[3]=0,new rs(m.pts,m.offsetPt0,i,o,r,l,n,"inferno")}else p==="SRF"?m=await gt.readSRF(e):p==="STL"?m=gt.readSTL(e):m=gt.readFreeSurfer(e);if(m.anatomicalStructurePrimary&&(u=m.anatomicalStructurePrimary),m instanceof Float32Array)throw new Error("fatal: unknown mesh type loaded");if(!("positions"in m))throw new Error("positions not loaded");if(!m.indices)throw new Error("indices not loaded");if(f=m.positions,h=m.indices,"rgba255"in m&&m.rgba255.length>0&&(o=m.rgba255),"colors"in m&&m.colors&&m.colors.length===f.length){const b=f.length/3;o=new Uint8Array(b*4);let S=0,C=0;for(let E=0;E<b;E++)o[C++]=m.colors[S]*255,o[C++]=m.colors[S+1]*255,o[C++]=m.colors[S+2]*255,o[C++]=255,S+=3}const v=f.length/3;if(h.length/3<1||v<3)throw new Error("Mesh should have at least one triangle and three vertices");o[3]=Math.max(1,o[3]);const w=new rs(f,h,i,o,r,l,n,null,null,null,null,!0,u);if("scalars"in m&&m.scalars.length>0){const b=await gt.readLayer(i,e,w,r,"gray");typeof b>"u"?j.warn("readLayer() failed to convert scalars"):(w.layers.push(b),w.updateMesh(n))}return w}static async loadLayer(e,i){let n=new Uint8Array().buffer;function r(x){const w=window.atob(x),b=w.length,S=new Uint8Array(b);for(let C=0;C<b;C++)S[C]=w.charCodeAt(C);return S.buffer}if(e.base64!==void 0)n=r(e.base64);else{if(!e.url)throw new Error("layer: missing url");const x=await fetch(e.url,{headers:e.headers});if(!x.ok)throw Error(x.statusText);n=await x.arrayBuffer()}let o,l=[];if(e.name&&e.name!=="")o=e.name;else{if(!e.url)throw new Error("layer: missing url");try{l=new URL(e.url).pathname.split("/")}catch{l=e.url.split("/")}finally{o=l.slice(-1)[0]}}o.indexOf("?")>-1&&(o=o.slice(0,o.indexOf("?")));let h=.5;"opacity"in e&&(h=e.opacity);let f="warm";"colormap"in e&&(f=e.colormap);let u="winter";"colormapNegative"in e&&(u=e.colormapNegative);let m=!1;"useNegativeCmap"in e&&(m=e.useNegativeCmap);let g=null;"cal_min"in e&&(g=e.cal_min);let p=null;"cal_max"in e&&(p=e.cal_max);const v=await gt.readLayer(o,n,i,h,f,u,m,g,p);v&&i.layers.push(v)}static async loadFromUrl({url:e="",headers:i={},gl:n,name:r="",opacity:o=1,rgba255:l=[255,255,255,255],visible:h=!0,layers:f=[],buffer:u=new ArrayBuffer(0)}={}){let m=e.split("/");if(r===""){try{m=new URL(e).pathname.split("/")}catch{m=e.split("/")}r=m.slice(-1)[0],r.indexOf("?")>-1&&(r=r.slice(0,r.indexOf("?")))}if(e==="")throw Error("url must not be empty");if(!n)throw Error("gl context is null");let g;if(u.byteLength>0)g=u;else{const v=await fetch(e,{headers:i});if(!v.ok)throw Error(v.statusText);g=await v.arrayBuffer()}const p=await this.readMesh(g,r,n,o,new Uint8Array(l),h);if(!f||f.length<1)return p;for(let v=0;v<f.length;v++)await rs.loadLayer(f[v],p);return p.updateMesh(n),p}static async readFileAsync(e){return new Promise((i,n)=>{const r=new FileReader;r.onload=()=>{i(r.result)},r.onerror=n,r.readAsArrayBuffer(e)})}static async loadFromFile({file:e,gl:i,name:n="",opacity:r=1,rgba255:o=[255,255,255,255],visible:l=!0,layers:h=[]}={}){if(!e)throw new Error("file must be set");if(!i)throw new Error("rendering context must be set");const f=await rs.readFileAsync(e),u=await rs.readMesh(f,n,i,r,new Uint8Array(o),l);if(!h||h.length<1)return u;for(let m=0;m<h.length;m++)await rs.loadLayer(h[m],u);return u.updateMesh(i),u}async loadFromBase64({base64:e,gl:i,name:n="",opacity:r=1,rgba255:o=[255,255,255,255],visible:l=!0,layers:h=[]}={}){if(!e)throw new Error("base64 must bet set");if(!i)throw new Error("rendering context must be set");function f(g){const p=window.atob(g),v=p.length,x=new Uint8Array(v);for(let w=0;w<v;w++)x[w]=p.charCodeAt(w);return x.buffer}const u=f(e),m=await rs.readMesh(u,n,i,r,new Uint8Array(o),l);if(!h||h.length<1)return m;for(let g=0;g<h.length;g++)await rs.loadLayer(h[g],m);return m.updateMesh(i),m}},Sx="data:image/jpeg;base64,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ZwAAAAAAAAALY3JvcFJlY3RUb3Bsb25nAAAAAAA4QklNA+0AAAAAABAASAAAAAEAAQBIAAAAAQABOEJJTQQmAAAAAAAOAAAAAAAAAAAAAD+AAAA4QklNBA0AAAAAAAQAAAAeOEJJTQQZAAAAAAAEAAAAHjhCSU0D8wAAAAAACQAAAAAAAAAAAQA4QklNJxAAAAAAAAoAAQAAAAAAAAABOEJJTQP1AAAAAABIAC9mZgABAGxmZgAGAAAAAAABAC9mZgABAKGZmgAGAAAAAAABADIAAAABAFoAAAAGAAAAAAABADUAAAABAC0AAAAGAAAAAAABOEJJTQP4AAAAAABwAAD/////////////////////////////A+gAAAAA/////////////////////////////wPoAAAAAP////////////////////////////8D6AAAAAD/////////////////////////////A+gAADhCSU0EAAAAAAAAAgAAOEJJTQQCAAAAAAACAAA4QklNBDAAAAAAAAEBADhCSU0ELQAAAAAABgABAAAAMjhCSU0ECAAAAAAAEAAAAAEAAAJAAAACQAAAAAA4QklNBB4AAAAAAAQAAAAAOEJJTQQaAAAAAAM9AAAABgAAAAAAAAAAAAACAAAAAgAAAAAEAG0AYwA2ADEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAgAAAAIAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAEAAAAAAABudWxsAAAAAgAAAAZib3VuZHNPYmpjAAAAAQAAAAAAAFJjdDEAAAAEAAAAAFRvcCBsb25nAAAAAAAAAABMZWZ0bG9uZwAAAAAAAAAAQnRvbWxvbmcAAAIAAAAAAFJnaHRsb25nAAACAAAAAAZzbGljZXNWbExzAAAAAU9iamMAAAABAAAAAAAFc2xpY2UAAAASAAAAB3NsaWNlSURsb25nAAAAAAAAAAdncm91cElEbG9uZwAAAAAAAAAGb3JpZ2luZW51bQAAAAxFU2xpY2VPcmlnaW4AAAANYXV0b0dlbmVyYXRlZAAAAABUeXBlZW51bQAAAApFU2xpY2VUeXBlAAAAAEltZyAAAAAGYm91bmRzT2JqYwAAAAEAAAAAAABSY3QxAAAABAAA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bnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChXaW5kb3dzKSIgeG1wOkNyZWF0ZURhdGU9IjIwMTgtMDctMTJUMjA6MDc6NDcrMDE6MDAiIHhtcDpNb2RpZnlEYXRlPSIyMDE4LTA3LTEzVDE3OjU0OjI3KzAxOjAwIiB4bXA6TWV0YWRhdGFEYXRlPSIyMDE4LTA3LTEzVDE3OjU0OjI3KzAxOjAwIiBkYzpmb3JtYXQ9ImltYWdlL2pwZWciIHBob3Rvc2hvcDpDb2xvck1vZGU9IjMiIHBob3Rvc2hvcDpJQ0NQcm9maWxlPSJzUkdCIElFQzYxOTY2LTIuMSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo3MmVhYjVmZS02NDZkLWVhNDMtODQyNC0xNWQzZTgwOWExNDQiIHhtcE1NOkRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDo0OGNjMGI3YS1iYTJkLWZmNDAtYmNkNC1jNGQzMzIyZjBiNzQiIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDphYzFjM2NhNS1hYTg4LWI5NGMtOGE4MS05YmU4MjA3ZGZiODciPiA8cGhvdG9zaG9wOkRvY3VtZW50QW5jZXN0b3JzPiA8cmRmOkJhZz4gPHJkZjpsaT5hZG9iZTpkb2NpZDpwaG90b3Nob3A6YThjMGNhZTYtODNjYy1hYzQ4LWI2YzAtN2FiODNlOWJkMGM3PC9yZGY6bGk+IDwvcmRmOkJhZz4gPC9waG90b3Nob3A6RG9jdW1lbnRBbmNlc3RvcnM+IDx4bXBNTTpIaXN0b3J5PiA8cmRmOlNlcT4gPHJkZjpsaSBzdEV2dDphY3Rpb249ImNyZWF0ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6YWMxYzNjYTUtYWE4OC1iOTRjLThhODEtOWJlODIwN2RmYjg3IiBzdEV2dDp3aGVuPSIyMDE4LTA3LTEyVDIwOjA3OjQ3KzAxOjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ0MgKFdpbmRvd3MpIi8+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJzYXZlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDpjYmI3MzZlZC0zOTRhLTM2NDgtYThiOC02Mzk1MmY0NDcxMjIiIHN0RXZ0OndoZW49IjIwMTgtMDctMTNUMTY6MTM6NTgrMDE6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDQyAoV2luZG93cykiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249InNhdmVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjQ2YjNkYTI3LWI4YjEtYmU0Yi1hYTQ4LTExZGM5NmZkNTIyZiIgc3RFdnQ6d2hlbj0iMjAxOC0wNy0xM1QxNzo1NDoyNyswMTowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIENDIChXaW5kb3dzKSIgc3RFdnQ6Y2hhbmdlZD0iLyIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0iY29udmVydGVkIiBzdEV2dDpwYXJhbWV0ZXJzPSJmcm9tIGFwcGxpY2F0aW9uL3ZuZC5hZG9iZS5waG90b3Nob3AgdG8gaW1hZ2UvanBlZyIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0iZGVyaXZlZCIgc3RFdnQ6cGFyYW1ldGVycz0iY29udmVydGVkIGZyb20gYXBwbGljYXRpb24vdm5kLmFkb2JlLnBob3Rvc2hvcCB0byBpbWFnZS9qcGVnIi8+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJzYXZlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDo3MmVhYjVmZS02NDZkLWVhNDMtODQyNC0xNWQzZTgwOWExNDQiIHN0RXZ0OndoZW49IjIwMTgtMDctMTNUMTc6NTQ6MjcrMDE6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDQyAoV2luZG93cykiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPC9yZGY6U2VxPiA8L3htcE1NOkhpc3Rvcnk+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjQ2YjNkYTI3LWI4YjEtYmU0Yi1hYTQ4LTExZGM5NmZkNTIyZiIgc3RSZWY6ZG9jdW1lbnRJRD0iYWRvYmU6ZG9jaWQ6cGhvdG9zaG9wOjg3NjM1NDk5LWZiMTItYWU0MC04NWEzLThkMWFiN2NkZGVhOSIgc3RSZWY6b3JpZ2luYWxEb2N1bWVudElEPSJ4bXAuZGlkOmFjMWMzY2E1LWFhODgtYjk0Yy04YTgxLTliZTgyMDdkZmI4NyIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8P3hwYWNrZXQgZW5kPSJ3Ij8+/+IMWElDQ19QUk9GSUxFAAEBAAAMSExpbm8CEAAAbW50clJHQiBYWVogB84AAgAJAAYAMQAAYWNzcE1TRlQAAAAASUVDIHNSR0IAAAAAAAAAAAAAAAEAAPbWAAEAAAAA0y1IUCAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAARY3BydAAAAVAAAAAzZGVzYwAAAYQAAABsd3RwdAAAAfAAAAAUYmtwdAAAAgQAAAAUclhZWgAAAhgAAAAUZ1hZWgAAAiwAAAAUYlhZWgAAAkAAAAAUZG1uZAAAAlQAAABwZG1kZAAAAsQAAACIdnVlZAAAA0wAAACGdmlldwAAA9QAAAAkbHVtaQAAA/gAAAAUbWVhcwAABAwAAAAkdGVjaAAABDAAAAAMclRSQwAABDwAAAgMZ1RSQwAABDwAAAgMYlRSQwAABDwAAAgMdGV4dAAAAABDb3B5cmlnaHQgKGMpIDE5OTggSGV3bGV0dC1Q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",Q2="data:image/png;base64,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",X2={atlas:{type:"msdf",distanceRange:2,size:59.65625,width:512,height:256,yOrigin:"bottom"},metrics:{emSize:1,lineHeight:1.171875,ascender:.927734375,descender:-.244140625,underlineY:-.09765625,underlineThickness:.048828125},glyphs:[{unicode:32,advance:.24755859375},{unicode:33,advance:.25732421875,planeBounds:{left:.056159633438645884,bottom:-.02437761405677056,right:.20702396031135412,top:.7299440203067705},atlasBounds:{left:488.5,bottom:145.5,right:497.5,top:190.5}},{unicode:34,advance:.31982421875,planeBounds:{left:.049409125974004715,bottom:.48691155587022,right:.2840869677759953,top:.77187750662978},atlasBounds:{left:486.5,bottom:213.5,right:500.5,top:230.5}},{unicode:35,advance:.61572265625,planeBounds:{left:.037219103997511785,bottom:-.02169206718177056,right:.6239137085024882,top:.7326295671817705},atlasBounds:{left:66.5,bottom:51.5,right:101.5,top:96.5}},{unicode:36,advance:.5615234375,planeBounds:{left:.02956531458715296,bottom:-.12381369908983761,right:.5324464041628472,top:.8484230740898377},atlasBounds:{left:109.5,bottom:197.5,right:139.5,top:255.5}},{unicode:37,advance:.732421875,planeBounds:{left:.026481776289942378,bottom:-.030073418674698794,right:.7137525987100576,top:.7410109186746989},atlasBounds:{left:88.5,bottom:144.5,right:129.5,top:190.5}},{unicode:38,advance:.62158203125,planeBounds:{left:.03225572125458355,bottom:-.030073418674698794,right:.6357130287454166,top:.7410109186746989},atlasBounds:{left:130.5,bottom:144.5,right:166.5,top:190.5}},{unicode:39,advance:.17431640625,planeBounds:{left:.028244602049502358,bottom:.49895501673814824,right:.14558352295049765,top:.7671582645118518},atlasBounds:{left:498.5,bottom:62.5,right:505.5,top:78.5}},{unicode:40,advance:.341796875,planeBounds:{left:.042983329377291775,bottom:-.250029542422407,right:.34471198312270823,top:.8227834486724072},atlasBounds:{left:.5,bottom:191.5,right:18.5,top:255.5}},{unicode:41,advance:.34765625,planeBounds:{left:-.003159248747708225,bottom:-.250029542422407,right:.29856940499770823,top:.8227834486724072},atlasBounds:{left:19.5,bottom:191.5,right:37.5,top:255.5}},{unicode:42,advance:.4306640625,planeBounds:{left:-.011208599684062338,bottom:.27785390031593765,right:.44138438093406235,top:.7304468809340623},atlasBounds:{left:449.5,bottom:23.5,right:476.5,top:50.5}},{unicode:43,advance:.56689453125,planeBounds:{left:.01353503347629649,bottom:.053493525733368255,right:.5499415290237036,top:.6066627242666317},atlasBounds:{left:361.5,bottom:17.5,right:393.5,top:50.5}},{unicode:44,advance:.1962890625,planeBounds:{left:-.009919475797210583,bottom:-.15981695975478,right:.1744702570472106,top:.12514899100478},atlasBounds:{left:498.5,bottom:79.5,right:509.5,top:96.5}},{unicode:45,advance:.27587890625,planeBounds:{left:-.00527594412977999,bottom:.24333249267450235,right:.27969000662978,top:.36067141357549765},atlasBounds:{left:52.5,bottom:7.5,right:69.5,top:14.5}},{unicode:46,advance:.26318359375,planeBounds:{left:.051032680313645884,bottom:-.027092319686354116,right:.20189700718635412,top:.12377200718635412},atlasBounds:{left:501.5,bottom:221.5,right:510.5,top:230.5}},{unicode:47,advance:.412109375,planeBounds:{left:-.013733006073205867,bottom:-.08573505127848349,right:.4053345685732059,top:.7356373950284835},atlasBounds:{left:252.5,bottom:206.5,right:277.5,top:255.5}},{unicode:48,advance:.5615234375,planeBounds:{left:.037458384830081196,bottom:-.030073418674698794,right:.5235767714199189,top:.7410109186746989},atlasBounds:{left:167.5,bottom:144.5,right:196.5,top:190.5}},{unicode:49,advance:.5615234375,planeBounds:{left:.06023674350936354,bottom:-.01998308280677056,right:.37872810024063647,top:.7343385515567705},atlasBounds:{left:488.5,bottom:97.5,right:507.5,top:142.5}},{unicode:50,advance:.5615234375,planeBounds:{left:.025334353719224725,bottom:-.01680925468177056,right:.5449781462807752,top:.7375123796817705},atlasBounds:{left:278.5,bottom:51.5,right:309.5,top:96.5}},{unicode:51,advance:.5615234375,planeBounds:{left:.028181041080081196,bottom:-.030073418674698794,right:.5142994276699189,top:.7410109186746989},atlasBounds:{left:197.5,bottom:144.5,right:226.5,top:190.5}},{unicode:52,advance:.5615234375,planeBounds:{left:.005886103858368255,bottom:-.02169206718177056,right:.5590553023916317,top:.7326295671817705},atlasBounds:{left:310.5,bottom:51.5,right:343.5,top:96.5}},{unicode:53,advance:.5615234375,planeBounds:{left:.055524791080081196,bottom:-.02657487968177056,right:.5416431776699189,top:.7277467546817705},atlasBounds:{left:344.5,bottom:51.5,right:373.5,top:96.5}},{unicode:54,advance:.5615234375,planeBounds:{left:.046003306705081196,bottom:-.034712090549698794,right:.5321216932949189,top:.7363722467996989},atlasBounds:{left:227.5,bottom:144.5,right:256.5,top:190.5}},{unicode:55,advance:.5615234375,planeBounds:{left:.018010134969224725,bottom:-.02169206718177056,right:.5376539275307752,top:.7326295671817705},atlasBounds:{left:374.5,bottom:51.5,right:405.5,top:96.5}},{unicode:56,advance:.5615234375,planeBounds:{left:.037702525455081196,bottom:-.030073418674698794,right:.5238209120449189,top:.7410109186746989},atlasBounds:{left:257.5,bottom:144.5,right:286.5,top:190.5}},{unicode:57,advance:.5615234375,planeBounds:{left:.029401744205081196,bottom:-.025434746799698794,right:.5155201307949189,top:.7456495905496989},atlasBounds:{left:287.5,bottom:144.5,right:316.5,top:190.5}},{unicode:58,advance:.2421875,planeBounds:{left:.046394008438645884,bottom:-.029431286627488215,right:.19725833531135412,top:.5572633178774882},atlasBounds:{left:439.5,bottom:61.5,right:448.5,top:96.5}},{unicode:59,advance:.21142578125,planeBounds:{left:.001066852327789419,bottom:-.16459733294591408,right:.1854565851722106,top:.556198895445914},atlasBounds:{left:406.5,bottom:53.5,right:417.5,top:96.5}},{unicode:60,advance:.50830078125,planeBounds:{left:.016948142433865897,bottom:.0726146348300812,right:.4527784200661341,top:.5587330214199189},atlasBounds:{left:394.5,bottom:21.5,right:420.5,top:50.5}},{unicode:61,advance:.548828125,planeBounds:{left:.051535540940937666,bottom:.17620354038436353,right:.5041285215590624,top:.49469489711563647},atlasBounds:{left:477.5,bottom:31.5,right:504.5,top:50.5}},{unicode:62,advance:.5224609375,planeBounds:{left:.047629290940937666,bottom:.0731029160800812,right:.5002222715590624,top:.5592213026699189},atlasBounds:{left:421.5,bottom:21.5,right:448.5,top:50.5}},{unicode:63,advance:.47216796875,planeBounds:{left:.016704001808865897,bottom:-.027876153049698794,right:.4525342794411341,top:.7432081842996989},atlasBounds:{left:317.5,bottom:144.5,right:343.5,top:190.5}},{unicode:64,advance:.89794921875,planeBounds:{left:.034064457306783605,bottom:-.23896750384690937,right:.8721996065996072,top:.7165065663469093},atlasBounds:{left:155.5,bottom:198.5,right:205.5,top:255.5}},{unicode:65,advance:.65234375,planeBounds:{left:-.008838044092129387,bottom:-.02169206718177056,right:.6616700753421295,top:.7326295671817705},atlasBounds:{left:237.5,bottom:51.5,right:277.5,top:96.5}},{unicode:66,advance:.62255859375,planeBounds:{left:.06464099434422473,bottom:-.02169206718177056,right:.5842847869057752,top:.7326295671817705},atlasBounds:{left:205.5,bottom:51.5,right:236.5,top:96.5}},{unicode:67,advance:.65087890625,planeBounds:{left:.038439807122511785,bottom:-.030073418674698794,right:.6251344116274882,top:.7410109186746989},atlasBounds:{left:344.5,bottom:144.5,right:379.5,top:190.5}},{unicode:68,advance:.65576171875,planeBounds:{left:.06301501010836826,bottom:-.02169206718177056,right:.6161842086416317,top:.7326295671817705},atlasBounds:{left:162.5,bottom:51.5,right:195.5,top:96.5}},{unicode:69,advance:.568359375,planeBounds:{left:.0652904160800812,bottom:-.02169206718177056,right:.5514088026699189,top:.7326295671817705},atlasBounds:{left:132.5,bottom:51.5,right:161.5,top:96.5}},{unicode:70,advance:.552734375,planeBounds:{left:.059675181705081196,bottom:-.02169206718177056,right:.5457935682949189,top:.7326295671817705},atlasBounds:{left:102.5,bottom:51.5,right:131.5,top:96.5}},{unicode:71,advance:.68115234375,planeBounds:{left:.040148791497511785,bottom:-.030073418674698794,right:.6268433960024882,top:.7410109186746989},atlasBounds:{left:380.5,bottom:144.5,right:415.5,top:190.5}},{unicode:72,advance:.712890625,planeBounds:{left:.062365588372511785,bottom:-.02169206718177056,right:.6490601928774882,top:.7326295671817705},atlasBounds:{left:30.5,bottom:51.5,right:65.5,top:96.5}},{unicode:73,advance:.27197265625,planeBounds:{left:.06917965680657412,bottom:-.02169206718177056,right:.20328128069342588,top:.7326295671817705},atlasBounds:{left:196.5,bottom:51.5,right:204.5,top:96.5}},{unicode:74,advance:.5517578125,planeBounds:{left:.007184947330081194,bottom:-.02657487968177056,right:.4933033339199188,top:.7277467546817705},atlasBounds:{left:.5,bottom:51.5,right:29.5,top:96.5}},{unicode:75,advance:.626953125,planeBounds:{left:.061633166497511785,bottom:-.02169206718177056,right:.6483277710024882,top:.7326295671817705},atlasBounds:{left:452.5,bottom:97.5,right:487.5,top:142.5}},{unicode:76,advance:.5380859375,planeBounds:{left:.06341786132300943,bottom:-.02169206718177056,right:.5327735449269906,top:.7326295671817705},atlasBounds:{left:423.5,bottom:97.5,right:451.5,top:142.5}},{unicode:77,advance:.873046875,planeBounds:{left:.05911847969322944,bottom:-.02169206718177056,right:.8134401140567705,top:.7326295671817705},atlasBounds:{left:377.5,bottom:97.5,right:422.5,top:142.5}},{unicode:78,advance:.712890625,planeBounds:{left:.062365588372511785,bottom:-.02169206718177056,right:.6490601928774882,top:.7326295671817705},atlasBounds:{left:341.5,bottom:97.5,right:376.5,top:142.5}},{unicode:79,advance:.6875,planeBounds:{left:.033395854136655315,bottom:-.030073418674698794,right:.6536158646133446,top:.7410109186746989},atlasBounds:{left:416.5,bottom:144.5,right:453.5,top:190.5}},{unicode:80,advance:.630859375,planeBounds:{left:.061550166358368255,bottom:-.02169206718177056,right:.6147193648916317,top:.7326295671817705},atlasBounds:{left:273.5,bottom:97.5,right:306.5,top:142.5}},{unicode:81,advance:.6875,planeBounds:{left:.030466166636655315,bottom:-.14391866037519643,right:.6506861771133446,top:.7445045978751964},atlasBounds:{left:214.5,bottom:202.5,right:251.5,top:255.5}},{unicode:82,advance:.61572265625,planeBounds:{left:.06350329135836826,bottom:-.02169206718177056,right:.6166724898916317,top:.7326295671817705},atlasBounds:{left:186.5,bottom:97.5,right:219.5,top:142.5}},{unicode:83,advance:.59326171875,planeBounds:{left:.020778681983368255,bottom:-.030073418674698794,right:.5739478805166317,top:.7410109186746989},atlasBounds:{left:454.5,bottom:144.5,right:487.5,top:190.5}},{unicode:84,advance:.5966796875,planeBounds:{left:.005480822747511787,bottom:-.02169206718177056,right:.5921754272524882,top:.7326295671817705},atlasBounds:{left:112.5,bottom:97.5,right:147.5,top:142.5}},{unicode:85,advance:.6484375,planeBounds:{left:.049098994483368255,bottom:-.02657487968177056,right:.6022681930166317,top:.7277467546817705},atlasBounds:{left:78.5,bottom:97.5,right:111.5,top:142.5}},{unicode:86,advance:.63623046875,planeBounds:{left:-.008269192599201152,bottom:-.02169206718177056,right:.6454762238492011,top:.7326295671817705},atlasBounds:{left:38.5,bottom:97.5,right:77.5,top:142.5}},{unicode:87,advance:.88720703125,planeBounds:{left:.011923628617731797,bottom:-.02169206718177056,right:.8835841838822683,top:.7326295671817705},atlasBounds:{left:220.5,bottom:97.5,right:272.5,top:142.5}},{unicode:88,advance:.626953125,planeBounds:{left:.004098979136655316,bottom:-.02169206718177056,right:.6243189896133446,top:.7326295671817705},atlasBounds:{left:.5,bottom:97.5,right:37.5,top:142.5}},{unicode:89,advance:.6005859375,planeBounds:{left:-.010793598988344685,bottom:-.02169206718177056,right:.6094264114883446,top:.7326295671817705},atlasBounds:{left:148.5,bottom:97.5,right:185.5,top:142.5}},{unicode:90,advance:.5986328125,planeBounds:{left:.024196650733368255,bottom:-.02169206718177056,right:.5773658492666317,top:.7326295671817705},atlasBounds:{left:307.5,bottom:97.5,right:340.5,top:142.5}},{unicode:91,advance:.26513671875,planeBounds:{left:.05437250871693295,bottom:-.17280296457569408,right:.27228764753306706,top:.8329592145756942},atlasBounds:{left:59.5,bottom:195.5,right:72.5,top:255.5}},{unicode:92,advance:.41015625,planeBounds:{left:.0014037126767941326,bottom:-.08573505127848349,right:.4204712873232059,top:.7356373950284835},atlasBounds:{left:278.5,bottom:206.5,right:303.5,top:255.5}},{unicode:93,advance:.26513671875,planeBounds:{left:-.020659233400995285,bottom:-.17280296457569408,right:.2140186084009953,top:.8329592145756942},atlasBounds:{left:94.5,bottom:195.5,right:108.5,top:255.5}},{unicode:94,advance:.41796875,planeBounds:{left:.006855376669722368,bottom:.33229482979472236,right:.40916024833027764,top:.7345997014552776},atlasBounds:{left:486.5,bottom:231.5,right:510.5,top:255.5}},{unicode:95,advance:.451171875,planeBounds:{left:-.017473255794918804,bottom:-.09553469482549765,right:.4686451307949188,top:.021804226075497646},atlasBounds:{left:70.5,bottom:7.5,right:99.5,top:14.5}},{unicode:96,advance:.30908203125,planeBounds:{left:.00391839948107648,bottom:.5860277898277895,right:.2553589442689235,top:.7704175226722105},atlasBounds:{left:36.5,bottom:3.5,right:51.5,top:14.5}},{unicode:97,advance:.5439453125,planeBounds:{left:.028181041080081196,bottom:-.029187146002488215,right:.5142994276699189,top:.5575074585024882},atlasBounds:{left:30.5,bottom:15.5,right:59.5,top:50.5}},{unicode:98,advance:.56103515625,planeBounds:{left:.048932994205081196,bottom:-.032187684160555265,right:.5350513807949189,top:.7724220591605554},atlasBounds:{left:304.5,bottom:207.5,right:333.5,top:255.5}},{unicode:99,advance:.5234375,planeBounds:{left:.024518931705081196,bottom:-.029187146002488215,right:.5106373182949189,top:.5575074585024882},atlasBounds:{left:.5,bottom:15.5,right:29.5,top:50.5}},{unicode:100,advance:.56396484375,planeBounds:{left:.026227916080081196,bottom:-.032187684160555265,right:.5123463026699189,top:.7724220591605554},atlasBounds:{left:334.5,bottom:207.5,right:363.5,top:255.5}},{unicode:101,advance:.52978515625,planeBounds:{left:.026472056705081196,bottom:-.029187146002488215,right:.5125904432949189,top:.5575074585024882},atlasBounds:{left:468.5,bottom:61.5,right:497.5,top:96.5}},{unicode:102,advance:.34716796875,planeBounds:{left:.004575110905578838,bottom:-.022177918535555265,right:.3733545765944212,top:.7824318247855554},atlasBounds:{left:364.5,bottom:207.5,right:386.5,top:255.5}},{unicode:103,advance:.56103515625,planeBounds:{left:.026960337955081196,bottom:-.22888445766762702,right:.5130787245449189,top:.558962582667627},atlasBounds:{left:28.5,bottom:143.5,right:57.5,top:190.5}},{unicode:104,advance:.55078125,planeBounds:{left:.049826556565937666,bottom:-.01892352016762703,right:.5024195371840624,top:.768923520167627},atlasBounds:{left:.5,bottom:143.5,right:27.5,top:190.5}},{unicode:105,advance:.24267578125,planeBounds:{left:.046882289688645884,bottom:-.01680925468177056,right:.19774661656135412,top:.7375123796817705},atlasBounds:{left:498.5,bottom:145.5,right:507.5,top:190.5}},{unicode:106,advance:.23876953125,planeBounds:{left:-.048979545900995285,bottom:-.2324562772148376,right:.1856982959009953,top:.7397804959648377},atlasBounds:{left:140.5,bottom:197.5,right:154.5,top:255.5}},{unicode:107,advance:.5068359375,planeBounds:{left:.044294322330081196,bottom:-.01892352016762703,right:.5304127089199189,top:.768923520167627},atlasBounds:{left:58.5,bottom:143.5,right:87.5,top:190.5}},{unicode:108,advance:.24267578125,planeBounds:{left:.05428707868157412,bottom:-.01892352016762703,right:.18838870256842588,top:.768923520167627},atlasBounds:{left:477.5,bottom:208.5,right:485.5,top:255.5}},{unicode:109,advance:.87646484375,planeBounds:{left:.04430890170737297,bottom:-.024304333502488215,right:.832155942042627,top:.5623902710024882},atlasBounds:{left:116.5,bottom:15.5,right:163.5,top:50.5}},{unicode:110,advance:.5517578125,planeBounds:{left:.049826556565937666,bottom:-.024304333502488215,right:.5024195371840624,top:.5623902710024882},atlasBounds:{left:60.5,bottom:15.5,right:87.5,top:50.5}},{unicode:111,advance:.5703125,planeBounds:{left:.025090213094224725,bottom:-.029187146002488215,right:.5447340056557752,top:.5575074585024882},atlasBounds:{left:193.5,bottom:15.5,right:224.5,top:50.5}},{unicode:112,advance:.56103515625,planeBounds:{left:.048444712955081196,bottom:-.22644305141762702,right:.5345630995449189,top:.561403988917627},atlasBounds:{left:447.5,bottom:208.5,right:476.5,top:255.5}},{unicode:113,advance:.568359375,planeBounds:{left:.025983775455081196,bottom:-.22644305141762702,right:.5121021620449189,top:.561403988917627},atlasBounds:{left:417.5,bottom:208.5,right:446.5,top:255.5}},{unicode:114,advance:.33837890625,planeBounds:{left:.045180595002291775,bottom:-.024304333502488215,right:.34690924874770823,top:.5623902710024882},atlasBounds:{left:449.5,bottom:61.5,right:467.5,top:96.5}},{unicode:115,advance:.515625,planeBounds:{left:.021669814448009427,bottom:-.029187146002488215,right:.4910254980519906,top:.5575074585024882},atlasBounds:{left:164.5,bottom:15.5,right:192.5,top:50.5}},{unicode:116,advance:.32666015625,planeBounds:{left:-.019433670483564695,bottom:-.02877457520298586,right:.3158203892335647,top:.675258950202986},atlasBounds:{left:418.5,bottom:54.5,right:438.5,top:96.5}},{unicode:117,advance:.55126953125,planeBounds:{left:.048117572190937666,bottom:-.034069958502488215,right:.5007105528090624,top:.5526246460024882},atlasBounds:{left:88.5,bottom:15.5,right:115.5,top:50.5}},{unicode:118,advance:.484375,planeBounds:{left:-.002092396419918806,bottom:-.02080579450955998,right:.4840259901699188,top:.5491261070095601},atlasBounds:{left:331.5,bottom:16.5,right:360.5,top:50.5}},{unicode:119,advance:.75146484375,planeBounds:{left:-.002649098431770561,bottom:-.02080579450955998,right:.7516725359317705,top:.5491261070095601},atlasBounds:{left:225.5,bottom:16.5,right:270.5,top:50.5}},{unicode:120,advance:.49560546875,planeBounds:{left:-.0046143729128470395,bottom:-.02080579450955998,right:.4982667166628471,top:.5491261070095601},atlasBounds:{left:300.5,bottom:16.5,right:330.5,top:50.5}},{unicode:121,advance:.47314453125,planeBounds:{left:-.007219349544918806,bottom:-.23645281704262702,right:.4788990370449188,top:.551394223292627},atlasBounds:{left:387.5,bottom:208.5,right:416.5,top:255.5}},{unicode:122,advance:.49560546875,planeBounds:{left:.018007705073009427,bottom:-.02080579450955998,right:.4873633886769906,top:.5491261070095601},atlasBounds:{left:271.5,bottom:16.5,right:299.5,top:50.5}},{unicode:123,advance:.33837890625,planeBounds:{left:.011572188891435306,bottom:-.20234398020069408,right:.3468262486085647,top:.8034181989506942},atlasBounds:{left:73.5,bottom:195.5,right:93.5,top:255.5}},{unicode:124,advance:.24365234375,planeBounds:{left:.06315671142450235,bottom:-.15466084787519643,right:.18049563232549765,top:.7337624103751964},atlasBounds:{left:206.5,bottom:202.5,right:213.5,top:255.5}},{unicode:125,advance:.33837890625,planeBounds:{left:-.010156326733564695,bottom:-.20234398020069408,right:.3250977329835647,top:.8034181989506942},atlasBounds:{left:38.5,bottom:195.5,right:58.5,top:255.5}},{unicode:126,advance:.68017578125,planeBounds:{left:.046984728997511785,bottom:.1766063915990047,right:.6336793335024882,top:.4112842334009953},atlasBounds:{left:.5,bottom:.5,right:35.5,top:14.5}}],kerning:[]},Vl={name:"untitled connectome",nodeColormap:"warm",nodeColormapNegative:"winter",nodeMinColor:0,nodeMaxColor:4,nodeScale:3,edgeColormap:"warm",edgeColormapNegative:"winter",edgeMin:2,edgeMax:6,edgeScale:1,legendLineThickness:0},Bl=class dg extends Na{constructor(e,i){super(new Float32Array([]),new Uint32Array([]),i.name,new Uint8Array([]),1,!0,e,i),k(this,"gl"),k(this,"nodesChanged"),this.gl=e,this.type="connectome",this.nodes&&this.updateLabels(),this.nodesChanged=new EventTarget}static convertLegacyConnectome(e){const i={nodes:[],edges:[],...Vl};for(const r in e)if(r in Vl){const o=r;i[o]=e[o]}const n=e.nodes;for(let r=0;r<n.names.length;r++)i.nodes.push({name:n.names[r],x:n.X[r],y:n.Y[r],z:n.Z[r],colorValue:n.Color[r],sizeValue:n.Size[r]});for(let r=0;r<n.names.length-1;r++)for(let o=r+1;o<n.names.length;o++){const l=e.edges[r*n.names.length+o];i.edges.push({first:r,second:o,colorValue:l})}return i}static convertFreeSurferConnectome(e,i="warm"){let n=!0;if("data_type"in e?e.data_type!=="fs_pointset"&&(n=!1):n=!1,"points"in e||(n=!1),!n)throw Error("not a valid FreeSurfer json pointset");const r=e.points.map(l=>({name:Array.isArray(l.comments)&&l.comments.length>0&&"text"in l.comments[0]?l.comments[0].text:"",x:l.coordinates.x,y:l.coordinates.y,z:l.coordinates.z,colorValue:1,sizeValue:1,metadata:l.comments}));return{...Vl,nodeColormap:i,edgeColormap:i,nodes:r,edges:[]}}updateLabels(){const e=this.nodes;if(e&&e.length>0){const i=e.reduce((u,m)=>u.sizeValue>m.sizeValue?u:m).sizeValue;let n,r;if(typeof this.nodeMinColor<"u"&&isFinite(this.nodeMinColor))n=this.nodeMinColor;else{n=e[0].colorValue;for(let u=1;u<e.length;u++)e[u].colorValue<n&&(n=e[u].colorValue)}if(typeof this.nodeMaxColor<"u"&&isFinite(this.nodeMaxColor))r=this.nodeMaxColor;else{r=e[0].colorValue;for(let u=1;u<e.length;u++)e[u].colorValue>r&&(r=e[u].colorValue)}const o=et.colormap(this.nodeColormap,this.colormapInvert),l=et.colormap(this.nodeColormapNegative,this.colormapInvert),h="nodeColormapNegative"in this,f=this.legendLineThickness?this.legendLineThickness:0;for(let u=0;u<e.length;u++){let m=e[u].colorValue,g=!1;if(h&&m<0&&(g=!0,m=-m),n<r){if(m<n){j.warn("color value lower than min");continue}m=(m-n)/(r-n)}else m=1;m=Math.round(Math.max(Math.min(255,m*255)))*4;let p=[o[m],o[m+1],o[m+2],255];g&&(p=[l[m],l[m+1],l[m+2],255]),p=p.map(v=>v/255),j.debug("adding label for ",e[u]),e[u].label=new xf(e[u].name,{textColor:p,bulletScale:e[u].sizeValue/i,bulletColor:p,lineWidth:f,lineColor:p,textScale:1,textAlignment:"left",lineTerminator:"none"},[e[u].x,e[u].y,e[u].z]),j.debug("label for node:",e[u].label)}}}addConnectomeNode(e){if(j.debug("adding node",e),!this.nodes)throw new Error("nodes not defined");this.nodes.push(e),this.updateLabels(),this.nodesChanged.dispatchEvent(new CustomEvent("nodeAdded",{detail:{node:e}}))}deleteConnectomeNode(e){const i=this.nodes.indexOf(e),n=this.edges;n&&(this.edges=n.filter(r=>r.first!==i&&r.second!==i)),this.nodes=this.nodes.filter(r=>r!==e),this.updateLabels(),this.updateConnectome(this.gl),this.nodesChanged.dispatchEvent(new CustomEvent("nodeDeleted",{detail:{node:e}}))}updateConnectomeNodeByIndex(e,i){this.nodes[e]=i,this.updateLabels(),this.updateConnectome(this.gl),this.nodesChanged.dispatchEvent(new CustomEvent("nodeChanged",{detail:{node:i}}))}updateConnectomeNodeByPoint(e,i){const n=this.nodes;if(!n)throw new Error("Node to update does not exist");const r=n.find(l=>Ae.arraysAreEqual([l.x,l.y,l.z],e));if(!r)throw new Error(`Node with point ${e} to update does not exist`);const o=n.findIndex(l=>l===r);this.updateConnectomeNodeByIndex(o,i)}addConnectomeEdge(e,i,n){const r=this.edges;let o=r.find(l=>(l.first===e||l.second===e)&&l.first+l.second===e+i);return o||(o={first:e,second:i,colorValue:n},r.push(o),this.updateConnectome(this.gl),o)}deleteConnectomeEdge(e,i){const n=this.edges,r=n.find(o=>(o.first===e||o.first===i)&&o.first+o.second===e+i);if(r)this.edges=n.filter(o=>o!==r);else throw new Error(`edge between ${e} and ${i} not found`);return this.updateConnectome(this.gl),r}findClosestConnectomeNode(e,i){const n=this.nodes;if(!n||n.length===0)return null;const r=n.map((o,l)=>({node:o,distance:Math.sqrt(Math.pow(o.x-e[0],2)+Math.pow(o.y-e[1],2)+Math.pow(o.z-e[2],2)),index:l})).filter(o=>o.distance<i).sort((o,l)=>o.distance-l.distance);return r.length>0?r[0].node:null}updateConnectome(e){const i=[],n=[],r=[];let o=et.colormap(this.nodeColormap,this.colormapInvert),l=et.colormap(this.nodeColormapNegative,this.colormapInvert),h="nodeColormapNegative"in this;this.nodeMinColor===void 0&&(this.nodeMinColor=NaN),this.nodeMaxColor===void 0&&(this.nodeMaxColor=NaN),this.edgeMin===void 0&&(this.edgeMin=NaN),this.edgeMax===void 0&&(this.edgeMax=NaN);let f=this.nodeMinColor,u=this.nodeMaxColor;if(!isFinite(f)||!isFinite(f)){const S=this.nodes;f=S[0].colorValue,u=S[0].colorValue;for(let C=0;C<S.length;C++)f=Math.min(f,S[C].colorValue),u=Math.max(u,S[C].colorValue)}const m=this.nodes,g=m.length;for(let S=0;S<g;S++){const C=m[S].sizeValue*this.nodeScale;if(C<=0)continue;let E=m[S].colorValue,T=!1;if(h&&E<0&&(T=!0,E=-E),f<u){if(E<f)continue;E=(E-f)/(u-f)}else E=1;E=Math.round(Math.max(Math.min(255,E*255)))*4;let D=[o[E],o[E+1],o[E+2],255];T&&(D=[l[E],l[E+1],l[E+2],255]);const R=he(m[S].x,m[S].y,m[S].z);Bn.makeColoredSphere(n,i,r,C,R,D)}o=et.colormap(this.edgeColormap,this.colormapInvert),l=et.colormap(this.edgeColormapNegative,this.colormapInvert),h="edgeColormapNegative"in this;const p=this.edges;if(p!==void 0&&p.length>0){if(f=this.edgeMin,u=this.edgeMax,!isFinite(f)||!isFinite(f)){f=p[0].colorValue,u=p[0].colorValue;for(let S=0;S<p.length;S++)f=Math.min(f,p[S].colorValue),u=Math.max(u,p[S].colorValue)}for(const S of p){let C=S.colorValue;const E=h&&C<0;E&&(C=-C);const T=C*this.edgeScale;if(T<=0)continue;if(f<u){if(C<f)continue;C=(C-f)/(u-f)}else C=1;C=Math.round(Math.max(Math.min(255,C*255)))*4;let D=[o[C],o[C+1],o[C+2],255];E&&(D=[l[C],l[C+1],l[C+2],255]);const R=he(m[S.first].x,m[S.first].y,m[S.first].z),N=he(m[S.second].x,m[S.second].y,m[S.second].z);Bn.makeColoredCylinder(n,i,r,R,N,T,D)}}const v=new Float32Array(n),x=new Uint32Array(i),w=Dn.getExtents(v);this.furthestVertexFromOrigin=w.mxDx,this.extentsMin=w.extentsMin,this.extentsMax=w.extentsMax;const b=this.generatePosNormClr(v,x,new Uint8Array(r));e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,Uint32Array.from(x),e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer),e.bufferData(e.ARRAY_BUFFER,Float32Array.from(b),e.STATIC_DRAW),this.indexCount=i.length}updateMesh(e){this.updateConnectome(e),this.updateLabels()}json(){const e={};for(const i in this)(i in Vl||i==="nodes"||i==="edges")&&(e[i]=this[i]);return e}static async loadConnectomeFromUrl(e,i){const r=await(await fetch(i)).json();return new dg(e,r)}};function Ex(t,e,i){if(!t.dimsRAS||!t.matRAS||!t.pixDimsRAS||!t.vox2mm)throw new Error("Cannot create NiivueObject3D: Missing required RAS properties or vox2mm access on NVImage.");const n=t.dimsRAS,r=t.matRAS,o=t.pixDimsRAS,l=-.5,h=-.5,f=-.5,u=n[1]-1+.5,m=n[2]-1+.5,g=n[3]-1+.5,p=t.vox2mm,v=p.call(t,[l,h,f],r),x=p.call(t,[l,m,f],r),w=p.call(t,[l,h,g],r),b=p.call(t,[l,m,g],r),S=p.call(t,[u,h,f],r),C=p.call(t,[u,m,f],r),E=p.call(t,[u,h,g],r),T=p.call(t,[u,m,g],r),D=[...w,0,0,1,...E,1,0,1,...T,1,1,1,...b,0,1,1,...v,0,0,0,...x,0,1,0,...C,1,1,0,...S,1,0,0],R=i.createBuffer();if(!R)throw new Error("Failed to create GL index buffer");i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,R);const N=[0,3,2,2,1,0,4,7,6,6,5,4,5,6,2,2,3,5,4,0,1,1,7,4,7,1,2,2,6,7,4,5,3,3,0,4];i.bufferData(i.ELEMENT_ARRAY_BUFFER,new Uint16Array(N),i.STATIC_DRAW);const M=i.createBuffer();if(!M)throw new Error("Failed to create GL vertex buffer");i.bindBuffer(i.ARRAY_BUFFER,M),i.bufferData(i.ARRAY_BUFFER,new Float32Array(D),i.STATIC_DRAW);const V=i.createVertexArray();if(!V)throw new Error("Failed to create GL VAO");i.bindVertexArray(V),i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,R),i.bindBuffer(i.ARRAY_BUFFER,M);const I=24;i.enableVertexAttribArray(0),i.vertexAttribPointer(0,3,i.FLOAT,!1,I,0),i.enableVertexAttribArray(1),i.vertexAttribPointer(1,3,i.FLOAT,!1,I,12),i.bindVertexArray(null);const B=new Bn(e,M,i.TRIANGLES,N.length,R,V),U=[...w,...E,...T,...b,...v,...x,...C,...S],z=mx(U);return B.extentsMin=z.min.slice(),B.extentsMax=z.max.slice(),B.furthestVertexFromOrigin=z.furthestVertexFromOrigin,B.originNegate=jr(z.origin),d5(B.originNegate,B.originNegate),B.fieldOfViewDeObliqueMM=[n[1]*o[1],n[2]*o[2],n[3]*o[3]],B}function Tx(t){return new Promise((e,i)=>{let n;t instanceof File?n=Promise.resolve(t):n=new Promise((r,o)=>{t.file(r,o)}),n.then(r=>{const o=new FileReader;o.onload=()=>{typeof o.result=="string"?e(o.result):i(new Error("Expected a string from FileReader.result"))},o.onerror=()=>{i(o.error??new Error("Unknown FileReader error"))},o.readAsDataURL(r)}).catch(r=>i(r))})}function Mx(t){const e=t.hdr.dims,i=t.permRAS,n=e[1]*e[2]*e[3],r=new Int16Array(n),o=[0,0,0];for(let v=0;v<3;v++)for(let x=0;x<3;x++)Math.abs(i[v])-1===x&&(o[x]=v*Math.sign(i[v]));let l=1;const h=[1,1,1],f=[!1,!1,!1];for(let v=0;v<o.length;v++)for(let x=0;x<o.length;x++)Math.abs(o[x])===v&&(h[x]=l,(o[x]<0||Object.is(o[x],-0))&&(f[x]=!0),l*=e[x+1]);let u=Ae.range(0,e[1]-1,1);f[0]&&(u=Ae.range(e[1]-1,0,-1));for(let v=0;v<e[1];v++)u[v]*=h[0];let m=Ae.range(0,e[2]-1,1);f[1]&&(m=Ae.range(e[2]-1,0,-1));for(let v=0;v<e[2];v++)m[v]*=h[1];let g=Ae.range(0,e[3]-1,1);f[2]&&(g=Ae.range(e[3]-1,0,-1));for(let v=0;v<e[3];v++)g[v]*=h[2];let p=0;for(let v=0;v<e[3];v++)for(let x=0;x<e[2];x++)for(let w=0;w<e[1];w++)r[u[w]+m[x]+g[v]]=t.img[p],p++;return r}function Z2(t,e){const i=Math.floor(Math.log(t)/Math.log(10)),n=t/Math.pow(10,i);let r;return e?n<1.5?r=1:n<3?r=2:n<7?r=5:r=10:n<=1?r=1:n<=2?r=2:n<=5?r=5:r=10,r*Math.pow(10,i)}function Or(t,e,i=4){const n=Z2(e-t,!1),r=Z2(n/(i-1),!0),o=Math.floor(t/r)*r,l=Math.ceil(e/r)*r;return[r,o,l,o===t&&l===e]}function W2(t,e){let i=Or(t,e,3);return i[3]||(i=Or(t,e,5)),i[3]||(i=Or(t,e,4)),i[3]||(i=Or(t,e,3)),i[3]||(i=Or(t,e,5)),[i[0],i[1],i[2]]}function en(t){return t*(Math.PI/180)}function Vh(t,e,i,n){let r=-t,o=-e;return isFinite(i)&&isFinite(n)&&(r=i,o=n),r>o&&([r,o]=[o,r]),[r,o]}function si(t,e=[0,1,2]){const i=ot();return i[0]=t[e[0]],i[1]=t[e[1]],i[2]=t[e[2]],i}function J2(t){const e=ut(1,0,0,0),i=cs();return qt(i,e,t),i[0]}function Dx(t,e,i,n){const r=ut(t,e,i,1),o=Rt(n);vi(o,o),r[0]=r[0]*2-1,r[1]=r[1]*2-1,r[2]=r[2]*2-1;const l=cs();return qt(l,r,o),l[3]===0||(l[0]/=l[3],l[1]/=l[3],l[2]/=l[3]),l}function Nx(t){const e=[5960464477539063e-23,152587890625e-16,.00390625,1];return(t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3])/255}function Bh(t,e,i){return Math.min(Math.max(t,e),i)}function Rx(t){const e=t.length;let i=0;const n=new Uint8Array(e+Math.ceil(.01*e)),r=new Int8Array(n.buffer);let o=0;for(;i<e;){let l=t[i];i++;let h=1;for(;h<129&&i<e&&t[i]===l;)i++,h++;if(h>1){r[o]=-h+1,o++,n[o]=l,o++;continue}for(;i<e&&!(h>127||i+2<e&&l!==t[i]&&t[i+2]===t[i]&&t[i+1]===t[i]);)l=t[i],i++,h++;n[o]=h-1,o++;for(let f=0;f<h;f++)n[o]=t[i-h+f],o++}return j.info("PackBits "+e+" -> "+o+" bytes (x"+e/o+")"),n.slice(0,o)}function $2(t,e){const i=new Uint8Array(t.buffer),n=new Int8Array(i.buffer);let r=0;const o=new Uint8Array(e);let l=0;for(;r<i.length;){const h=n[r];if(r++,h<0){const f=n[r];r++;for(let u=0;u<1-h;u++)o[l]=f,l++}else for(let f=0;f<h+1;f++)o[l]=n[r],r++,l++}return o}function em(t,e){return t.scl_slope===0&&(t.scl_slope=1),e*t.scl_slope+t.scl_inter}var Tn=["ASC","BYU","DFS","FSM","PIAL","ORIG","INFLATED","SMOOTHWM","SPHERE","WHITE","G","GEO","GII","ICO","MZ3","NV","OBJ","OFF","PLY","SRF","STL","TCK","TRACT","TRI","TRK","TT","TRX","VTK","WRL","X3D","JCON","JSON"],tm=0,Ux=1,Ix=2,Sa=33984,Ll=33985,Lh=33986,Fx=33987,Vx=33988,im=33989,sm=33990,Mn=33991,nm=33992,Bx=33993,am=33994,Lx=33995,Ox=33996,kx=33997,Px=33998,zx=33999,rm={filename:"",isSaveDrawing:!1,volumeByIndex:0},yf=class{constructor(t=tn){k(this,"loaders",{}),k(this,"dicomLoader",null),k(this,"canvas",null),k(this,"_gl",null),k(this,"isBusy",!1),k(this,"needsRefresh",!1),k(this,"colormapTexture",null),k(this,"colormapLists",[]),k(this,"volumeTexture",null),k(this,"gradientTexture",null),k(this,"gradientTextureAmount",0),k(this,"renderGradientValues",!1),k(this,"drawTexture",null),k(this,"drawUndoBitmaps",[]),k(this,"drawLut",et.makeDrawLut("$itksnap")),k(this,"drawOpacity",.8),k(this,"clickToSegmentIsGrowing",!1),k(this,"clickToSegmentGrowingBitmap",null),k(this,"clickToSegmentXY",[0,0]),k(this,"renderDrawAmbientOcclusion",.4),k(this,"colorbarHeight",0),k(this,"drawPenLocation",[NaN,NaN,NaN]),k(this,"drawPenAxCorSag",-1),k(this,"drawFillOverwrites",!0),k(this,"drawPenFillPts",[]),k(this,"overlayTexture",null),k(this,"overlayTextureID",null),k(this,"sliceMMShader"),k(this,"slice2DShader"),k(this,"sliceV1Shader"),k(this,"orientCubeShader"),k(this,"orientCubeShaderVAO",null),k(this,"rectShader"),k(this,"rectOutlineShader"),k(this,"renderShader"),k(this,"lineShader"),k(this,"line3DShader"),k(this,"passThroughShader"),k(this,"renderGradientShader"),k(this,"renderGradientValuesShader"),k(this,"renderSliceShader"),k(this,"renderVolumeShader"),k(this,"pickingMeshShader"),k(this,"pickingImageShader"),k(this,"colorbarShader"),k(this,"fontShader",null),k(this,"fiberShader"),k(this,"fontTexture",null),k(this,"circleShader"),k(this,"matCapTexture",null),k(this,"bmpShader",null),k(this,"bmpTexture",null),k(this,"thumbnailVisible",!1),k(this,"bmpTextureWH",1),k(this,"growCutShader"),k(this,"orientShaderAtlasU",null),k(this,"orientShaderAtlasI",null),k(this,"orientShaderU",null),k(this,"orientShaderI",null),k(this,"orientShaderF",null),k(this,"orientShaderRGBU",null),k(this,"surfaceShader",null),k(this,"blurShader",null),k(this,"sobelBlurShader",null),k(this,"sobelFirstOrderShader",null),k(this,"sobelSecondOrderShader",null),k(this,"genericVAO",null),k(this,"unusedVAO",null),k(this,"crosshairs3D",null),k(this,"DEFAULT_FONT_GLYPH_SHEET",Q2),k(this,"DEFAULT_FONT_METRICS",X2),k(this,"fontMetrics"),k(this,"fontMets",null),k(this,"backgroundMasksOverlays",0),k(this,"overlayOutlineWidth",0),k(this,"overlayAlphaShader",1),k(this,"position"),k(this,"extentsMin"),k(this,"extentsMax"),k(this,"resizeObserver",null),k(this,"resizeEventListener",null),k(this,"canvasObserver",null),k(this,"syncOpts",{"3d":!1,"2d":!1,zoomPan:!1,cal_min:!1,cal_max:!1,clipPlane:!1,gamma:!1,sliceType:!1,crosshair:!1}),k(this,"readyForSync",!1),k(this,"uiData",{mousedown:!1,touchdown:!1,mouseButtonLeftDown:!1,mouseButtonCenterDown:!1,mouseButtonRightDown:!1,mouseDepthPicker:!1,clickedTile:-1,pan2DxyzmmAtMouseDown:[0,0,0,1],prevX:0,prevY:0,currX:0,currY:0,currentTouchTime:0,lastTouchTime:0,touchTimer:null,doubleTouch:!1,isDragging:!1,dragStart:[0,0],dragEnd:[0,0],dragClipPlaneStartDepthAziElev:[0,0,0],lastTwoTouchDistance:0,multiTouchGesture:!1,windowX:0,windowY:0}),k(this,"back",null),k(this,"overlays",[]),k(this,"deferredVolumes",[]),k(this,"deferredMeshes",[]),k(this,"furthestVertexFromOrigin",100),k(this,"volScale",[]),k(this,"vox",[]),k(this,"mousePos",[0,0]),k(this,"screenSlices",[]),k(this,"cuboidVertexBuffer"),k(this,"otherNV",null),k(this,"volumeObject3D",null),k(this,"pivot3D",[0,0,0]),k(this,"furthestFromPivot",10),k(this,"currentClipPlaneIndex",0),k(this,"lastCalled",new Date().getTime()),k(this,"selectedObjectId",-1),k(this,"CLIP_PLANE_ID",1),k(this,"VOLUME_ID",254),k(this,"DISTANCE_FROM_CAMERA",-.54),k(this,"graph",{LTWH:[0,0,640,480],opacity:0,vols:[0],autoSizeMultiplanar:!1,normalizeValues:!1,isRangeCalMinMax:!1}),k(this,"customLayout",[]),k(this,"meshShaders",[{Name:"Phong",Frag:I3},{Name:"Matte",Frag:V3},{Name:"Harmonic",Frag:L3},{Name:"Hemispheric",Frag:B3},{Name:"Crevice",Frag:U3},{Name:"Edge",Frag:D3},{Name:"Diffuse",Frag:N3},{Name:"Outline",Frag:E3},{Name:"Specular",Frag:R3},{Name:"Toon",Frag:S3},{Name:"Flat",Frag:H2},{Name:"Matcap",Frag:F3},{Name:"Rim",Frag:T3},{Name:"Silhouette",Frag:M3}]),k(this,"dragModes",{contrast:1,measurement:2,none:0,pan:3,slicer3D:4,callbackOnly:5}),k(this,"sliceTypeAxial",0),k(this,"sliceTypeCoronal",1),k(this,"sliceTypeSagittal",2),k(this,"sliceTypeMultiplanar",3),k(this,"sliceTypeRender",4),k(this,"onDragRelease",()=>{}),k(this,"onMouseUp",()=>{}),k(this,"onLocationChange",()=>{}),k(this,"onIntensityChange",()=>{}),k(this,"onClickToSegment",()=>{}),k(this,"onImageLoaded",()=>{}),k(this,"onMeshLoaded",()=>{}),k(this,"onFrameChange",()=>{}),k(this,"onError",()=>{}),k(this,"onColormapChange",()=>{}),k(this,"onInfo",()=>{}),k(this,"onWarn",()=>{}),k(this,"onDebug",()=>{}),k(this,"onVolumeAddedFromUrl",()=>{}),k(this,"onVolumeWithUrlRemoved",()=>{}),k(this,"onVolumeUpdated",()=>{}),k(this,"onMeshAddedFromUrl",()=>{}),k(this,"onMeshAdded",()=>{}),k(this,"onMeshWithUrlRemoved",()=>{}),k(this,"onZoom3DChange",()=>{}),k(this,"onAzimuthElevationChange",()=>{}),k(this,"onClipPlaneChange",()=>{}),k(this,"onCustomMeshShaderAdded",()=>{}),k(this,"onMeshShaderChanged",()=>{}),k(this,"onMeshPropertyChanged",()=>{}),k(this,"onDicomLoaderFinishedWithImages",()=>{}),k(this,"onDocumentLoaded",()=>{}),k(this,"document",new Fh),k(this,"mediaUrlMap",new Map),k(this,"initialized",!1),k(this,"currentDrawUndoBitmap");for(const e in t)typeof t[e]=="function"?this[e]=t[e]:this.opts[e]=tn[e]===void 0?tn[e]:t[e];this.opts.forceDevicePixelRatio===0?this.uiData.dpr=window.devicePixelRatio||1:this.opts.forceDevicePixelRatio<0?this.uiData.dpr=1:this.uiData.dpr=this.opts.forceDevicePixelRatio,this.currentDrawUndoBitmap=this.opts.maxDrawUndoBitmaps,this.opts.drawingEnabled&&this.createEmptyDrawing(),this.opts.thumbnail.length>0&&(this.thumbnailVisible=!0),j.setLogLevel(this.opts.logLevel)}get scene(){return this.document.scene}get opts(){return this.document.opts}get sliceMosaicString(){return this.document.opts.sliceMosaicString||""}set sliceMosaicString(t){this.document.opts.sliceMosaicString=t}get isAlphaClipDark(){return this.document.opts.isAlphaClipDark}set isAlphaClipDark(t){this.document.opts.isAlphaClipDark=t}cleanup(){this.resizeEventListener&&(window.removeEventListener("resize",this.resizeEventListener),this.resizeEventListener=null),this.resizeObserver&&(this.resizeObserver.disconnect(),this.resizeObserver=null),this.canvasObserver&&(this.canvasObserver.disconnect(),this.canvasObserver=null),this.canvas&&this.opts.interactive&&(this.canvas.removeEventListener("mousedown",this.mouseDownListener.bind(this)),this.canvas.removeEventListener("mouseup",this.mouseUpListener.bind(this)),this.canvas.removeEventListener("mousemove",this.mouseMoveListener.bind(this)),this.canvas.removeEventListener("touchstart",this.touchStartListener.bind(this)),this.canvas.removeEventListener("touchend",this.touchEndListener.bind(this)),this.canvas.removeEventListener("touchmove",this.touchMoveListener.bind(this)),this.canvas.removeEventListener("wheel",this.wheelListener.bind(this)),this.canvas.removeEventListener("contextmenu",this.mouseContextMenuListener.bind(this)),this.canvas.removeEventListener("dblclick",this.resetBriCon.bind(this)),this.canvas.removeEventListener("dragenter",this.dragEnterListener.bind(this)),this.canvas.removeEventListener("dragover",this.dragOverListener.bind(this)),this.canvas.removeEventListener("drop",this.dropListener.bind(this)),this.canvas.removeEventListener("keyup",this.keyUpListener.bind(this)),this.canvas.removeEventListener("keydown",this.keyDownListener.bind(this)))}get volumes(){return this.document.volumes}set volumes(t){this.document.volumes=t}get meshes(){return this.document.meshes}set meshes(t){this.document.meshes=t}get drawBitmap(){return this.document.drawBitmap}set drawBitmap(t){this.document.drawBitmap=t}get volScaleMultiplier(){return this.scene.volScaleMultiplier}set volScaleMultiplier(t){this.setScale(t)}async saveScene(t="niivue.png"){function e(n,r){const o=document.createElement("a");document.body.appendChild(o),o.style.display="none";const l=window.URL.createObjectURL(n);o.href=l,o.download=r,o.click(),o.remove()}const i=this.canvas;if(!i)throw new Error("canvas not defined");this.drawScene(),i.toBlob(n=>{n&&(t===""&&(t=`niivue-screenshot-${new Date().toString()}.png`,t=t.replace(/\s/g,"_")),e(n,t))})}async attachTo(t,e=null){return await this.attachToCanvas(document.getElementById(t),e),j.debug("attached to element with id: ",t),this}async attachToCanvas(t,e=null){return this.canvas=t,e===null&&(e=navigator.hardwareConcurrency>6,j.debug("AntiAlias ",e," Threads ",navigator.hardwareConcurrency)),this.gl=this.canvas.getContext("webgl2",{alpha:!0,antialias:e}),this.uiData.max2D=this.gl.getParameter(this.gl.MAX_TEXTURE_SIZE),this.uiData.max3D=this.gl.getParameter(this.gl.MAX_3D_TEXTURE_SIZE),j.info("NIIVUE VERSION ",_2),j.debug(`Max texture size 2D: ${this.uiData.max2D} 3D: ${this.uiData.max3D}`),this.canvas.parentElement.style.backgroundColor="black",this.opts.isResizeCanvas&&(this.canvas.style.width="100%",this.canvas.style.height="100%",this.canvas.style.display="block",this.canvas.width=this.canvas.offsetWidth,this.canvas.height=this.canvas.offsetHeight,this.resizeEventListener=()=>{requestAnimationFrame(()=>{this.resizeListener()})},window.addEventListener("resize",this.resizeEventListener),this.resizeObserver=new ResizeObserver(()=>{requestAnimationFrame(()=>{this.resizeListener()})}),this.resizeObserver.observe(this.canvas.parentElement),this.canvasObserver=new MutationObserver(i=>{for(const n of i)if(n.type==="childList"&&n.removedNodes.length>0&&Array.from(n.removedNodes).includes(this.canvas)){this.cleanup();break}}),this.canvasObserver.observe(this.canvas.parentElement,{childList:!0})),this.opts.interactive&&this.registerInteractions(),await this.init(),this.drawScene(),this}syncWith(t,e={"2d":!0,"3d":!0}){t instanceof Array||(t=[t]),this.otherNV=t,this.syncOpts={...e}}broadcastTo(t,e={"2d":!0,"3d":!0}){t instanceof Array||(t=[t]),this.otherNV=t,this.syncOpts=e}doSync3d(t){t.scene.renderAzimuth=this.scene.renderAzimuth,t.scene.renderElevation=this.scene.renderElevation,t.scene.volScaleMultiplier=this.scene.volScaleMultiplier}doSync2d(t){const e=this.frac2mm(this.scene.crosshairPos);t.scene.crosshairPos=t.mm2frac(e),t.scene.pan2Dxyzmm=Ms(this.scene.pan2Dxyzmm)}doSyncGamma(t){const e=this.scene.gamma,i=t.scene.gamma;e!==i&&t.setGamma(e)}doSyncZoomPan(t){t.scene.pan2Dxyzmm=Ms(this.scene.pan2Dxyzmm)}doSyncCrosshair(t){const e=this.frac2mm(this.scene.crosshairPos);t.scene.crosshairPos=t.mm2frac(e)}doSyncCalMin(t){this.volumes[0].cal_min!==t.volumes[0].cal_min&&(t.volumes[0].cal_min=this.volumes[0].cal_min,t.updateGLVolume())}doSyncCalMax(t){this.volumes[0].cal_max!==t.volumes[0].cal_max&&(t.volumes[0].cal_max=this.volumes[0].cal_max,t.updateGLVolume())}doSyncSliceType(t){t.setSliceType(this.opts.sliceType)}doSyncClipPlane(t){t.setClipPlane(this.scene.clipPlaneDepthAziElev)}sync(){if(!(!this.gl||!this.otherNV||typeof this.otherNV>"u")&&this.gl.canvas.matches(":focus"))for(let t=0;t<this.otherNV.length;t++)this.otherNV[t]!==this&&(this.syncOpts.gamma&&this.doSyncGamma(this.otherNV[t]),this.syncOpts.crosshair&&this.doSyncCrosshair(this.otherNV[t]),this.syncOpts.zoomPan&&this.doSyncZoomPan(this.otherNV[t]),this.syncOpts.sliceType&&this.doSyncSliceType(this.otherNV[t]),this.syncOpts.cal_min&&this.doSyncCalMin(this.otherNV[t]),this.syncOpts.cal_max&&this.doSyncCalMax(this.otherNV[t]),this.syncOpts.clipPlane&&this.doSyncClipPlane(this.otherNV[t]),this.syncOpts["2d"]&&this.doSync2d(this.otherNV[t]),this.syncOpts["3d"]&&this.doSync3d(this.otherNV[t]),this.otherNV[t].drawScene(),this.otherNV[t].createOnLocationChange())}arrayEquals(t,e){return Array.isArray(t)&&Array.isArray(e)&&t.length===e.length&&t.every((i,n)=>i===e[n])}resizeListener(){if(!(!this.canvas||!this.gl)){if(!this.opts.isResizeCanvas){this.opts.forceDevicePixelRatio>=0&&j.warn("this.opts.forceDevicePixelRatio requires isResizeCanvas"),this.drawScene();return}this.canvas.style.width="100%",this.canvas.style.height="100%",this.canvas.style.display="block",this.opts.forceDevicePixelRatio===0?this.uiData.dpr=window.devicePixelRatio||1:this.opts.forceDevicePixelRatio<0?this.uiData.dpr=1:this.uiData.dpr=this.opts.forceDevicePixelRatio,j.debug("devicePixelRatio: "+this.uiData.dpr),"width"in this.canvas.parentElement?(this.canvas.width=this.canvas.parentElement.width*this.uiData.dpr,this.canvas.height=this.canvas.parentElement.height*this.uiData.dpr):(this.canvas.width=this.canvas.offsetWidth*this.uiData.dpr,this.canvas.height=this.canvas.offsetHeight*this.uiData.dpr),this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height),this.drawScene()}}getRelativeMousePosition(t,e){if(e=e||t.target,!e)return;const i=e.getBoundingClientRect();return{x:t.clientX-i.left,y:t.clientY-i.top}}getNoPaddingNoBorderCanvasRelativeMousePosition(t,e){return e=e||t.target,this.getRelativeMousePosition(t,e)}mouseContextMenuListener(t){t.preventDefault()}mouseDownListener(t){t.preventDefault(),this.drawPenLocation=[NaN,NaN,NaN],this.drawPenAxCorSag=-1,this.uiData.mousedown=!0,this.setDragStart(0,0),this.setDragEnd(0,0),j.debug("mouse down"),j.debug(t);const e=this.getNoPaddingNoBorderCanvasRelativeMousePosition(t,this.gl.canvas);if(!e)return;const[i,n]=[e.x*this.uiData.dpr,e.y*this.uiData.dpr];this.opts.clickToSegment&&(this.clickToSegmentXY=[i,n]);const r=this.getLabelAtPoint([i,n]);if(r){if(r.onClick){r.onClick(r,t);return}for(const o of this.meshes)if(o.type==="connectome")for(const l of o.nodes)l.label===r&&(this.scene.crosshairPos=this.mm2frac([l.x,l.y,l.z]),this.updateGLVolume(),this.drawScene())}this.uiData.clickedTile=this.tileIndex(i,n),t.button===tm&&t.shiftKey?(this.uiData.mouseButtonCenterDown=!0,this.mouseCenterButtonHandler(t)):t.button===tm?(this.uiData.mouseButtonLeftDown=!0,this.mouseLeftButtonHandler(t)):t.button===Ix?(this.uiData.mouseButtonRightDown=!0,this.mouseRightButtonHandler(t)):t.button===Ux&&(this.uiData.mouseButtonCenterDown=!0,this.mouseCenterButtonHandler(t))}mouseLeftButtonHandler(t){if(t.ctrlKey||this.opts.dragModePrimary===0){const e=this.getNoPaddingNoBorderCanvasRelativeMousePosition(t,this.gl.canvas);this.mouseDown(e.x,e.y),this.mouseClick(e.x,e.y)}else this.opts.dragModePrimary===1&&(this.uiData.windowX=t.x,this.uiData.windowY=t.y)}mouseCenterButtonHandler(t){const e=this.getNoPaddingNoBorderCanvasRelativeMousePosition(t,this.gl.canvas);this.mousePos=[e.x*this.uiData.dpr,e.y*this.uiData.dpr],this.opts.dragMode!==0&&(this.setDragStart(e.x,e.y),this.uiData.isDragging||(this.uiData.pan2DxyzmmAtMouseDown=Ms(this.scene.pan2Dxyzmm)),this.uiData.isDragging=!0,this.uiData.dragClipPlaneStartDepthAziElev=this.scene.clipPlaneDepthAziElev)}mouseRightButtonHandler(t){const e=this.getNoPaddingNoBorderCanvasRelativeMousePosition(t,this.gl.canvas);this.mousePos=[e.x*this.uiData.dpr,e.y*this.uiData.dpr],this.opts.dragMode!==0&&(this.setDragStart(e.x,e.y),this.uiData.isDragging||(this.uiData.pan2DxyzmmAtMouseDown=Ms(this.scene.pan2Dxyzmm)),this.uiData.isDragging=!0,this.uiData.dragClipPlaneStartDepthAziElev=this.scene.clipPlaneDepthAziElev)}calculateMinMaxVoxIdx(t){if(t.length>2)throw new Error("array must not contain more than two values");return[Math.floor(Math.min(t[0],t[1])),Math.floor(Math.max(t[0],t[1]))]}calculateNewRange({volIdx:t=0}={}){if(this.opts.sliceType===4&&this.sliceMosaicString.length<1||this.uiData.dragStart[0]===this.uiData.dragEnd[0]&&this.uiData.dragStart[1]===this.uiData.dragEnd[1])return;let e=this.canvasPos2frac([this.uiData.dragStart[0],this.uiData.dragStart[1]]);if(e[0]<0)return;const i=this.frac2vox(e,t);if(e=this.canvasPos2frac([this.uiData.dragEnd[0],this.uiData.dragEnd[1]]),e[0]<0)return;const n=this.frac2vox(e,t);let r=-Number.MAX_VALUE,o=Number.MAX_VALUE;const l=this.calculateMinMaxVoxIdx([i[0],n[0]]),h=this.calculateMinMaxVoxIdx([i[1],n[1]]),f=this.calculateMinMaxVoxIdx([i[2],n[2]]);i[0]-n[0]===0?l[1]=i[0]+1:i[1]-n[1]===0?h[1]=i[1]+1:i[2]-n[2]===0&&(f[1]=i[2]+1);const u=this.volumes[t].hdr,m=this.volumes[t].img;if(!u||!m)return;const g=u.dims[1],p=u.dims[2];for(let w=f[0];w<f[1];w++){const b=w*g*p;for(let S=h[0];S<h[1];S++){const C=S*g;for(let E=l[0];E<l[1];E++){const T=b+C+E;o>m[T]&&(o=m[T]),r<m[T]&&(r=m[T])}}}if(o>=r)return;const v=em(u,o),x=em(u,r);this.volumes[t].cal_min=v,this.volumes[t].cal_max=x,this.onIntensityChange(this.volumes[t])}generateMouseUpCallback(t,e){const i=this.tileIndex(this.uiData.dragStart[0],this.uiData.dragStart[1]),n=this.tileIndex(this.uiData.dragEnd[0],this.uiData.dragEnd[1]);let r=-1;i===n&&(r=n);let o=-1;r>=0&&(o=this.screenSlices[r].axCorSag);const l=this.frac2mm(t),h=this.frac2mm(e),f=ot();y2(f,he(l[0],l[1],l[2]),he(h[0],h[1],h[2]));const u=Qr(f),m=this.frac2vox(t),g=this.frac2vox(e);this.onDragRelease({fracStart:t,fracEnd:e,voxStart:m,voxEnd:g,mmStart:l,mmEnd:h,mmLength:u,tileIdx:r,axCorSag:o})}mouseUpListener(){function t(n){return Object.prototype.toString.call(n).indexOf("Function")>-1}const e={mouseButtonRightDown:this.uiData.mouseButtonRightDown,mouseButtonCenterDown:this.uiData.mouseButtonCenterDown,isDragging:this.uiData.isDragging,mousePos:this.mousePos,fracPos:this.canvasPos2frac(this.mousePos)};this.uiData.mousedown=!1,this.uiData.mouseButtonRightDown=!1;const i=this.uiData.mouseButtonCenterDown;if(this.uiData.mouseButtonCenterDown=!1,this.uiData.mouseButtonLeftDown=!1,this.drawPenFillPts.length>0&&this.drawPenFilled(),this.drawPenLocation=[NaN,NaN,NaN],this.drawPenAxCorSag=-1,t(this.onMouseUp)&&this.onMouseUp(e),this.uiData.isDragging){this.uiData.isDragging=!1,this.opts.dragMode===5&&this.drawScene();const n=this.canvasPos2frac([this.uiData.dragStart[0],this.uiData.dragStart[1]]),r=this.canvasPos2frac([this.uiData.dragEnd[0],this.uiData.dragEnd[1]]);if(this.generateMouseUpCallback(n,r),this.opts.dragMode===6||this.opts.dragMode!==1||i||this.uiData.dragStart[0]===this.uiData.dragEnd[0]&&this.uiData.dragStart[1]===this.uiData.dragEnd[1])return;this.calculateNewRange({volIdx:0}),this.refreshLayers(this.volumes[0],0)}this.drawScene()}checkMultitouch(t){if(this.uiData.touchdown&&!this.uiData.multiTouchGesture){const e=this.canvas.getBoundingClientRect();this.mouseDown(t.touches[0].clientX-e.left,t.touches[0].clientY-e.top),this.mouseClick(t.touches[0].clientX-e.left,t.touches[0].clientY-e.top)}}touchStartListener(t){t.preventDefault(),this.uiData.touchTimer||(this.uiData.touchTimer=setTimeout(()=>{this.resetBriCon(t)},this.opts.longTouchTimeout)),this.uiData.touchdown=!0,this.uiData.currentTouchTime=new Date().getTime();const e=this.uiData.currentTouchTime-this.uiData.lastTouchTime;if(e<this.opts.doubleTouchTimeout&&e>0){this.uiData.doubleTouch=!0,this.setDragStart(t.targetTouches[0].clientX-t.target.getBoundingClientRect().left,t.targetTouches[0].clientY-t.target.getBoundingClientRect().top),this.resetBriCon(t),this.uiData.lastTouchTime=this.uiData.currentTouchTime;return}else this.uiData.doubleTouch=!1,this.setDragStart(0,0),this.setDragEnd(0,0),this.uiData.lastTouchTime=this.uiData.currentTouchTime;this.uiData.touchdown&&t.touches.length<2?this.uiData.multiTouchGesture=!1:this.uiData.multiTouchGesture=!0,setTimeout(this.checkMultitouch.bind(this),1,t)}touchEndListener(t){if(t.preventDefault(),this.uiData.touchdown=!1,this.uiData.lastTwoTouchDistance=0,this.uiData.multiTouchGesture=!1,this.uiData.touchTimer&&(clearTimeout(this.uiData.touchTimer),this.uiData.touchTimer=null),this.uiData.isDragging){this.uiData.isDragging=!1,this.opts.dragMode===1&&(this.calculateNewRange(),this.refreshLayers(this.volumes[0],0));const e=this.canvasPos2frac([this.uiData.dragStart[0],this.uiData.dragStart[1]]),i=this.canvasPos2frac([this.uiData.dragEnd[0],this.uiData.dragEnd[1]]);this.generateMouseUpCallback(e,i)}this.mouseUpListener()}windowingHandler(t,e,i=0){const n=this.uiData.windowX,r=this.uiData.windowY;let o=this.volumes[0].cal_min,l=this.volumes[0].cal_max;const h=this.volumes[0].global_min,f=this.volumes[0].global_max;e<r?(o+=1,l+=1):e>r&&(o-=1,l-=1),t>n?(o-=1,l+=1):t<n&&(o+=1,l-=1),l-o<1&&(l=o+1),o<h&&(o=h),l>f&&(l=f),o>l&&(o=l-1),this.volumes[i].cal_min=o,this.volumes[i].cal_max=l,this.refreshLayers(this.volumes[i],0),this.uiData.windowX=t,this.uiData.windowY=e}mouseLeaveListener(){this.clickToSegmentIsGrowing&&(j.debug("Mouse left canvas, stopping clickToSegment preview."),this.clickToSegmentIsGrowing=!1,this.refreshDrawing(!0,!1)),this.opts.drawingEnabled&&!isNaN(this.drawPenLocation[0])&&(j.debug("Mouse left canvas during drawing, resetting pen state."),this.drawPenLocation=[NaN,NaN,NaN],this.drawPenAxCorSag=-1,this.drawPenFillPts=[]),this.uiData.isDragging&&(j.debug("Mouse left canvas during drag, resetting drag state."),this.uiData.isDragging=!1,this.uiData.mouseButtonLeftDown=!1,this.uiData.mouseButtonCenterDown=!1,this.uiData.mouseButtonRightDown=!1,this.uiData.mousedown=!1,this.drawScene())}mouseMoveListener(t){if(this.uiData.mousedown){const e=this.getNoPaddingNoBorderCanvasRelativeMousePosition(t,this.gl.canvas);if(!e)return;const i=e.x*this.uiData.dpr,n=e.y*this.uiData.dpr;if(this.tileIndex(i,n)!==this.uiData.clickedTile)return;if(this.uiData.mouseButtonLeftDown){const o=this.opts.dragModePrimary===0,l=this.opts.dragModePrimary===1;t.ctrlKey||o?(this.mouseMove(e.x,e.y),this.mouseClick(e.x,e.y)):l&&this.windowingHandler(t.x,t.y)}else(this.uiData.mouseButtonRightDown||this.uiData.mouseButtonCenterDown)&&this.setDragEnd(e.x,e.y);this.drawScene(),this.uiData.prevX=this.uiData.currX,this.uiData.prevY=this.uiData.currY}else if(!this.uiData.mousedown&&this.opts.clickToSegment){const e=this.getNoPaddingNoBorderCanvasRelativeMousePosition(t,this.gl.canvas);if(!e)return;const i=e.x*this.uiData.dpr,n=e.y*this.uiData.dpr;this.mousePos=[i,n];const r=this.tileIndex(i,n);r>=0&&this.opts.drawingEnabled&&this.screenSlices[r].axCorSag<=2&&(this.clickToSegmentXY=[i,n],this.clickToSegmentIsGrowing=!0,this.doClickToSegment({x:i,y:n,tileIndex:r}))}}resetBriCon(t=null){if(this.uiData.isDragging)return;let e=!1;this.opts.sliceType===4&&(e=!0);let i=0,n=0;if(t!==null&&("targetTouches"in t?(i=t.targetTouches[0].clientX-t.target.getBoundingClientRect().left,n=t.targetTouches[0].clientY-t.target.getBoundingClientRect().top):(i=t.offsetX,n=t.offsetY),i*=this.uiData.dpr,n*=this.uiData.dpr,this.inRenderTile(i,n)>=0&&(e=!0)),e){this.uiData.mouseDepthPicker=!0,this.drawScene(),this.drawScene();return}this.opts.dragMode!==4&&(this.volumes.length<1||this.uiData.doubleTouch||(this.volumes[0].cal_min=this.volumes[0].robust_min,this.volumes[0].cal_max=this.volumes[0].robust_max,this.onIntensityChange(this.volumes[0]),this.refreshLayers(this.volumes[0],0),this.drawScene()))}setDragStart(t,e){t*=this.uiData.dpr,e*=this.uiData.dpr,this.uiData.dragStart[0]=t,this.uiData.dragStart[1]=e}setDragEnd(t,e){t*=this.uiData.dpr,e*=this.uiData.dpr,this.uiData.dragEnd[0]=t,this.uiData.dragEnd[1]=e}touchMoveListener(t){if(this.uiData.touchdown&&t.touches.length<2){const e=this.canvas.getBoundingClientRect();if(this.uiData.isDragging||(this.uiData.pan2DxyzmmAtMouseDown=Ms(this.scene.pan2Dxyzmm)),this.uiData.isDragging=!0,this.uiData.doubleTouch&&this.uiData.isDragging){this.setDragEnd(t.targetTouches[0].clientX-t.target.getBoundingClientRect().left,t.targetTouches[0].clientY-t.target.getBoundingClientRect().top),this.drawScene();return}const i=this.opts.dragModePrimary===0,n=this.opts.dragModePrimary===1;i?(this.mouseClick(t.touches[0].clientX-e.left,t.touches[0].clientY-e.top),this.mouseMove(t.touches[0].clientX-e.left,t.touches[0].clientY-e.top)):n&&(this.windowingHandler(t.touches[0].pageX,t.touches[0].pageY),this.drawScene())}else this.handlePinchZoom(t)}handlePinchZoom(t){if(t.targetTouches.length===2&&t.changedTouches.length===2){const e=Math.hypot(t.touches[0].pageX-t.touches[1].pageX,t.touches[0].pageY-t.touches[1].pageY),i=this.canvas.getBoundingClientRect();this.mousePos=[t.touches[0].clientX-i.left,t.touches[0].clientY-i.top],e<this.uiData.lastTwoTouchDistance?this.sliceScroll2D(-.01,t.touches[0].clientX-i.left,t.touches[0].clientY-i.top):this.sliceScroll2D(.01,t.touches[0].clientX-i.left,t.touches[0].clientY-i.top),this.uiData.lastTwoTouchDistance=e}}keyUpListener(t){if(t.code===this.opts.clipPlaneHotKey){const e=new Date().getTime();if(e-this.lastCalled>this.opts.keyDebounceTime){switch(this.currentClipPlaneIndex=(this.currentClipPlaneIndex+1)%7,this.currentClipPlaneIndex){case 0:this.scene.clipPlaneDepthAziElev=[2,0,0];break;case 1:this.scene.clipPlaneDepthAziElev=[0,270,0];break;case 2:this.scene.clipPlaneDepthAziElev=[0,90,0];break;case 3:this.scene.clipPlaneDepthAziElev=[0,0,0];break;case 4:this.scene.clipPlaneDepthAziElev=[0,180,0];break;case 5:this.scene.clipPlaneDepthAziElev=[0,0,-90];break;case 6:this.scene.clipPlaneDepthAziElev=[0,0,90];break}this.setClipPlane(this.scene.clipPlaneDepthAziElev)}this.lastCalled=e}else if(t.code===this.opts.viewModeHotKey){const e=new Date().getTime();e-this.lastCalled>this.opts.keyDebounceTime&&(this.setSliceType((this.opts.sliceType+1)%5),this.lastCalled=e)}}keyDownListener(t){t.code==="KeyH"&&this.opts.sliceType===4?this.setRenderAzimuthElevation(this.scene.renderAzimuth-1,this.scene.renderElevation):t.code==="KeyL"&&this.opts.sliceType===4?this.setRenderAzimuthElevation(this.scene.renderAzimuth+1,this.scene.renderElevation):t.code==="KeyJ"&&this.opts.sliceType===4?this.setRenderAzimuthElevation(this.scene.renderAzimuth,this.scene.renderElevation+1):t.code==="KeyK"&&this.opts.sliceType===4?this.setRenderAzimuthElevation(this.scene.renderAzimuth,this.scene.renderElevation-1):t.code==="KeyH"&&this.opts.sliceType!==4?this.moveCrosshairInVox(-1,0,0):t.code==="KeyL"&&this.opts.sliceType!==4?this.moveCrosshairInVox(1,0,0):t.code==="KeyU"&&this.opts.sliceType!==4&&t.ctrlKey?this.moveCrosshairInVox(0,0,1):t.code==="KeyD"&&this.opts.sliceType!==4&&t.ctrlKey?this.moveCrosshairInVox(0,0,-1):t.code==="KeyJ"&&this.opts.sliceType!==4?this.moveCrosshairInVox(0,-1,0):t.code==="KeyK"&&this.opts.sliceType!==4?this.moveCrosshairInVox(0,1,0):t.code==="KeyM"&&this.opts.sliceType!==4?(this.opts.dragMode++,this.opts.dragMode>=4&&(this.opts.dragMode=0),j.info("drag mode changed to ",fg[this.opts.dragMode])):t.code==="ArrowLeft"?this.setFrame4D(this.volumes[0].id,this.volumes[0].frame4D-1):t.code==="ArrowRight"?this.setFrame4D(this.volumes[0].id,this.volumes[0].frame4D+1):t.code==="Slash"&&t.shiftKey&&alert(`NIIVUE VERSION: ${_2}`)}wheelListener(t){if(t.preventDefault(),t.stopPropagation(),this.thumbnailVisible)return;const e=this.uiData.dragStart.reduce((f,u)=>f+u,0),i=this.uiData.dragEnd.reduce((f,u)=>f+u,0),n=e>0&&i>0;if(this.opts.dragMode===6&&n){const f=t.deltaY>0?1:-1;this.uiData.dragStart[0]<this.uiData.dragEnd[0]?(this.uiData.dragStart[0]-=f,this.uiData.dragEnd[0]+=f):(this.uiData.dragStart[0]+=f,this.uiData.dragEnd[0]-=f),this.uiData.dragStart[1]<this.uiData.dragEnd[1]?(this.uiData.dragStart[1]-=f,this.uiData.dragEnd[1]+=f):(this.uiData.dragStart[1]+=f,this.uiData.dragEnd[1]-=f),this.uiData.isDragging=!0,this.drawScene(),this.uiData.isDragging=!1;const u=this.tileIndex(this.uiData.dragStart[0],this.uiData.dragStart[1]);u>=0?this.generateMouseUpCallback(this.screenXY2TextureFrac(this.uiData.dragStart[0],this.uiData.dragStart[1],u),this.screenXY2TextureFrac(this.uiData.dragEnd[0],this.uiData.dragEnd[1],u)):j.warn("Could not generate drag release callback for ROI selection: Invalid tile index.");return}let r=t.deltaY<0?-.01:.01;if(this.opts.invertScrollDirection&&(r=-r),this.opts.clickToSegment){r<0?(this.opts.clickToSegmentPercent-=.01,this.opts.clickToSegmentPercent=Math.max(this.opts.clickToSegmentPercent,0)):(this.opts.clickToSegmentPercent+=.01,this.opts.clickToSegmentPercent=Math.min(this.opts.clickToSegmentPercent,1));const f=this.clickToSegmentXY[0],u=this.clickToSegmentXY[1],m=this.tileIndex(f,u);m>=0&&this.screenSlices[m].axCorSag<=2&&(j.debug(`Adjusting clickToSegment threshold: ${this.opts.clickToSegmentPercent.toFixed(3)}`),this.clickToSegmentIsGrowing=!0,this.doClickToSegment({x:f,y:u,tileIndex:m}));return}const o=this.canvas.getBoundingClientRect(),l=t.clientX-o.left,h=t.clientY-o.top;if(this.opts.dragMode===3&&this.inRenderTile(this.uiData.dpr*l,this.uiData.dpr*h)===-1){const f=r<0?1:-1;let u=this.scene.pan2Dxyzmm[3]*(1+10*(.01*f));u=Math.round(u*10)/10;const m=this.scene.pan2Dxyzmm[3]-u;this.opts.yoke3Dto2DZoom&&(this.scene.volScaleMultiplier=u),this.scene.pan2Dxyzmm[3]=u;const g=this.frac2mm(this.scene.crosshairPos);this.scene.pan2Dxyzmm[0]+=m*g[0],this.scene.pan2Dxyzmm[1]+=m*g[1],this.scene.pan2Dxyzmm[2]+=m*g[2],this.drawScene(),this.canvas.focus(),this.sync();return}this.sliceScroll2D(r,l,h)}registerInteractions(){if(!this.canvas)throw new Error("canvas undefined");this.canvas.addEventListener("mousedown",this.mouseDownListener.bind(this)),this.canvas.addEventListener("mouseup",this.mouseUpListener.bind(this)),this.canvas.addEventListener("mousemove",this.mouseMoveListener.bind(this)),this.canvas.addEventListener("mouseleave",this.mouseLeaveListener.bind(this)),this.canvas.addEventListener("touchstart",this.touchStartListener.bind(this)),this.canvas.addEventListener("touchend",this.touchEndListener.bind(this)),this.canvas.addEventListener("touchmove",this.touchMoveListener.bind(this)),this.canvas.addEventListener("wheel",this.wheelListener.bind(this)),this.canvas.addEventListener("contextmenu",this.mouseContextMenuListener.bind(this)),this.canvas.addEventListener("dblclick",this.resetBriCon.bind(this)),this.canvas.addEventListener("dragenter",this.dragEnterListener.bind(this),!1),this.canvas.addEventListener("dragover",this.dragOverListener.bind(this),!1),this.canvas.addEventListener("drop",t=>{this.dropListener(t).catch(console.error)},!1),this.canvas.setAttribute("tabindex","0"),this.canvas.addEventListener("keyup",this.keyUpListener.bind(this),!1),this.canvas.addEventListener("keydown",this.keyDownListener.bind(this),!1)}dragEnterListener(t){t.stopPropagation(),t.preventDefault()}dragOverListener(t){t.stopPropagation(),t.preventDefault()}getFileExt(t,e=!0){j.debug("fullname: ",t);const i=/(?:\.([^.]+))?$/;let n=i.exec(t)[1];if(n=n.toUpperCase(),n==="GZ")n=i.exec(t.slice(0,-3))[1],n=n.toUpperCase();else if(n==="CBOR"){const r=n;n=i.exec(t.slice(0,-5))[1],n=n.toUpperCase(),n=`${n}.${r}`}return e?n:n.toLowerCase()}async addVolumeFromUrl(t){const e=await ni.loadFromUrl(t);return this.document.addImageOptions(e,t),e.onColormapChange=this.onColormapChange,this.mediaUrlMap.set(e,t.url),this.onVolumeAddedFromUrl&&this.onVolumeAddedFromUrl(t,e),this.addVolume(e),e}async addVolumesFromUrl(t){const e=t.map(async n=>{const r=this.getFileExt(n.name||n.url);if(r==="DCM")throw new Error("DICOM files must be loaded using useDicomLoader");if(this.loaders[r]){let h=n.url;const f=this.loaders[r].toExt;let u=n.name||n.url;if(u=u.split("/").pop(),typeof n.url=="string"){const g=n.url;try{const p=await fetch(g);if(!p.ok)throw new Error(`Failed to load file: ${p.statusText}`);h=await p.arrayBuffer()}catch(p){throw new Error(`Failed to load url ${g}: ${p}`)}}const m=await this.loaders[r].loader(h);n.url=m,n.name=`${u}.${f}`}const o={url:n.url,headers:n.headers,name:n.name,colormap:n.colormap?n.colormap:n.colorMap,colormapNegative:n.colormapNegative?n.colormapNegative:n.colorMapNegative,opacity:n.opacity,urlImgData:n.urlImgData,cal_min:n.cal_min,cal_max:n.cal_max,trustCalMinMax:this.opts.trustCalMinMax,isManifest:n.isManifest,frame4D:n.frame4D,limitFrames4D:n.limitFrames4D||this.opts.limitFrames4D,colorbarVisible:n.colorbarVisible},l=await ni.loadFromUrl(o);return this.document.addImageOptions(l,o),l.onColormapChange=this.onColormapChange,this.mediaUrlMap.set(l,o.url),this.onVolumeAddedFromUrl&&this.onVolumeAddedFromUrl(o,l),l}),i=await Promise.all(e);for(let n=0;n<i.length;n++)this.addVolume(i[n]);return i}getMediaByUrl(t){return[...this.mediaUrlMap.entries()].filter(e=>e[1]===t).map(e=>e[0]).pop()}removeVolumeByUrl(t){const e=this.getMediaByUrl(t);if(e)this.removeVolume(e);else throw new Error("No volume with URL present")}async traverseFileTree(t,e="",i){return new Promise(n=>{if(t.isFile)t.file(r=>{r.fullPath=e+r.name,r._webkitRelativePath=e+r.name,i.push(r),n(i)});else if(t.isDirectory){const r=t.createReader(),o=()=>{r.readEntries(l=>{if(l.length>0){const h=[];for(const f of l)h.push(this.traverseFileTree(f,e+t.name+"/",i));Promise.all(h).then(o).catch(f=>{throw f})}else n(i)})};o()}})}readDirectory(t){const e=t.createReader();let i=[];const n=async o=>{const l=[],h=async f=>new Promise((u,m)=>f.file(u,m));for(let f=0;f<o.length;f++)l.push(await h(o[f])),console.log(l);return l},r=()=>{e.readEntries(o=>{o.length?(i=i.concat(o),r()):n(i).then(async l=>{console.log(l)}).catch(l=>{throw l})})};return r(),i}isMeshExt(t){const e=this.getFileExt(t);return j.debug("dropped ext"),j.debug(e),Tn.includes(e)}async loadFromArrayBuffer(t,e){const i=this.getFileExt(e);if(Tn.includes(i)){await this.addMeshFromUrl({url:e,buffer:t});return}const n=Yl(e);n.buffer=t,n.name=e,await this.addVolumeFromUrl(n)}async loadFromFile(t){const e=this.getFileExt(t.name);if(Tn.includes(e)){await Na.loadFromFile({file:t,gl:this.gl,name:t.name}).then(i=>{this.addMesh(i)});return}await ni.loadFromFile({file:t,name:t.name}).then(i=>{this.addVolume(i)})}useLoader(t,e,i){this.loaders={...this.loaders,[e.toUpperCase()]:{loader:t,toExt:i}}}useDicomLoader(t){this.dicomLoader=t}getDicomLoader(){return this.dicomLoader}async dropListener(t){if(t.stopPropagation(),t.preventDefault(),!this.opts.dragAndDropEnabled)return;const e=[],i=t.dataTransfer;if(!i)return;const n=i.getData("text/uri-list");if(n){const r=Yl(n),o=this.getFileExt(n);j.debug("dropped ext"),j.debug(o),Tn.includes(o)?this.addMeshFromUrl({url:n}).catch(l=>{throw l}):o==="NVD"?this.loadDocumentFromUrl(n).catch(l=>{throw l}):this.addVolumeFromUrl(r).catch(l=>{throw l})}else{const r=i.items;if(r.length>0){!t.shiftKey&&!t.altKey&&(this.volumes=[],this.overlays=[],this.meshes=[]),this.closeDrawing();for(const o of Array.from(r)){const l=o.webkitGetAsEntry();if(j.debug(l),!l)throw new Error("could not get entry from file");if(l.isFile){const h=this.getFileExt(l.name);let f;if(l.name.lastIndexOf("HEAD")!==-1)for(const u of Array.from(r)){const m=u.webkitGetAsEntry();if(!m)throw new Error("could not get paired entry");const g=l.name.substring(0,l.name.lastIndexOf("HEAD")),p=m.name.substring(0,m.name.lastIndexOf("BRIK"));g===p&&(f=m)}if(l.name.lastIndexOf("BRIK")!==-1)continue;if(this.loaders[h]){const u=await Tx(l);await this.loadImages([{url:u,name:`${l.name}`}]);continue}if(Tn.includes(h)){l.file(u=>{(async()=>{try{const m=await Na.loadFromFile({file:u,gl:this.gl,name:u.name});this.addMesh(m)}catch(m){console.error("Error loading mesh:",m)}})().catch(m=>console.error(m))});continue}else if(h==="NVD"){l.file(u=>{(async()=>{try{const m=await Fh.loadFromFile(u);await this.loadDocument(m),j.debug("loaded document")}catch(m){console.error(m)}})().catch(m=>console.error(m))});break}l.file(u=>{(async()=>{try{if(f)f.file(m=>{(async()=>{try{const g=await ni.loadFromFile({file:u,urlImgData:m,limitFrames4D:this.opts.limitFrames4D});this.addVolume(g)}catch(g){console.error(g)}})().catch(console.error)});else{const m=await ni.loadFromFile({file:u,urlImgData:f,limitFrames4D:this.opts.limitFrames4D});t.altKey?(j.debug("alt key detected: assuming this is a drawing overlay"),this.drawClearAllUndoBitmaps(),this.loadDrawing(m)):this.addVolume(m)}}catch(m){console.error(m)}})().catch(console.error)})}else l.isDirectory&&this.traverseFileTree(l,"",e).then(h=>{const f=this.getDicomLoader().loader;if(!f)throw new Error("No loader for DICOM files");f(h).then(async u=>{console.log(u);const m=u.map(g=>ni.loadFromUrl({url:g.data,name:g.name,limitFrames4D:this.opts.limitFrames4D}));Promise.all(m).then(async g=>{console.log("from dicom loader"),console.log(g),await this.onDicomLoaderFinishedWithImages(g)}).catch(g=>{throw g})}).catch(u=>{console.error("Error loading DICOM files:",u)})}).catch(h=>{throw h})}}}this.drawScene()}setMultiplanarPadPixels(t){this.opts.multiplanarPadPixels=t,this.drawScene()}setMultiplanarLayout(t){typeof t=="string"&&(t=parseInt(t)),this.opts.multiplanarLayout=t,this.drawScene()}setCornerOrientationText(t){this.opts.isCornerOrientationText=t,this.updateGLVolume()}setIsOrientationTextVisible(t){this.opts.isOrientationTextVisible=t,this.drawScene()}setHeroImage(t){this.opts.heroImageFraction=t,this.drawScene()}setCustomLayout(t){for(let e=0;e<t.length;e++){const[i,n,r,o]=t[e].position,l=i+r,h=n+o;for(let f=e+1;f<t.length;f++){const[u,m,g,p]=t[f].position,v=u+g,x=m+p,w=i<v&&l>u,b=n<x&&h>m;if(w&&b)throw new Error(`Custom layout is invalid. Tile ${e} overlaps with tile ${f}.`)}}this.customLayout=t,this.drawScene()}clearCustomLayout(){this.customLayout=null,this.drawScene()}getCustomLayout(){return this.customLayout}setRadiologicalConvention(t){this.opts.isRadiologicalConvention=t,this.updateGLVolume()}setDefaults(t={},e=!1){this.document.opts={...tn},this.scene.sceneData={...ql};for(const i in t)typeof t[i]=="function"?this[i]=t[i]:this.opts[i]=tn[i]===void 0?tn[i]:t[i];if(this.scene.pan2Dxyzmm=[0,0,0,1],e&&this.volumes&&this.volumes.length>0)for(let i=0;i<this.volumes.length;i++)this.volumes[i].cal_min=this.volumes[i].robust_min,this.volumes[i].cal_max=this.volumes[i].robust_max;this.updateGLVolume()}setMeshThicknessOn2D(t){this.opts.meshThicknessOn2D=t,this.updateGLVolume()}setSliceMosaicString(t){this.sliceMosaicString=t,this.updateGLVolume()}setSliceMM(t){this.opts.isSliceMM=t,this.updateGLVolume()}setAdditiveBlend(t){this.opts.isAdditiveBlend=t,this.updateGLVolume()}getRadiologicalConvention(){return this.opts.isRadiologicalConvention}setHighResolutionCapable(t){typeof t=="boolean"&&(t=t?0:-1),this.opts.forceDevicePixelRatio=t,this.resizeListener(),this.drawScene()}addVolume(t){this.volumes.push(t);const e=this.volumes.length===1?0:this.volumes.length-1;this.setVolume(t,e),this.onImageLoaded(t),j.debug("loaded volume",t.name),j.debug(t)}addMesh(t){this.meshes.push(t);const e=this.meshes.length===1?0:this.meshes.length-1;this.setMesh(t,e),this.onMeshLoaded(t)}getVolumeIndexByID(t){const e=this.volumes.length;for(let i=0;i<e;i++)if(this.volumes[i].id===t)return i;return-1}drawAddUndoBitmap(){if(!this.drawBitmap||this.drawBitmap.length<1){j.debug("drawAddUndoBitmap error: No drawing open");return}this.currentDrawUndoBitmap++,this.currentDrawUndoBitmap>=this.opts.maxDrawUndoBitmaps&&(this.currentDrawUndoBitmap=0),this.drawUndoBitmaps[this.currentDrawUndoBitmap]=Rx(this.drawBitmap)}drawClearAllUndoBitmaps(){if(this.currentDrawUndoBitmap=this.opts.maxDrawUndoBitmaps,!(!this.drawUndoBitmaps||this.drawUndoBitmaps.length<1))for(let t=this.drawUndoBitmaps.length-1;t>=0;t--)this.drawUndoBitmaps[t]=new Uint8Array}drawUndo(){if(this.drawUndoBitmaps.length<1){j.debug("undo bitmaps not loaded");return}if(this.currentDrawUndoBitmap--,this.currentDrawUndoBitmap<0&&(this.currentDrawUndoBitmap=this.drawUndoBitmaps.length-1),this.currentDrawUndoBitmap>=this.drawUndoBitmaps.length&&(this.currentDrawUndoBitmap=0),this.drawUndoBitmaps[this.currentDrawUndoBitmap].length<2){j.debug("drawUndo is misbehaving");return}this.drawBitmap=$2(this.drawUndoBitmaps[this.currentDrawUndoBitmap],this.drawBitmap.length),this.refreshDrawing(!0)}loadDrawing(t){if(this.drawBitmap&&j.debug("Overwriting open drawing!"),!this.back)throw new Error("back undefined");this.drawClearAllUndoBitmaps();const e=t.hdr.dims;if(e[1]!==this.back.hdr.dims[1]||e[2]!==this.back.hdr.dims[2]||e[3]!==this.back.hdr.dims[3])return j.debug("drawing dimensions do not match background image"),!1;t.img.constructor!==Uint8Array&&j.debug("Drawings should be UINT8");const i=t.permRAS,n=e[1]*e[2]*e[3];this.drawBitmap=new Uint8Array(n),this.opts.is2DSliceShader?this.drawTexture=this.r8Tex2D(this.drawTexture,Mn,this.back.dims,!0):this.drawTexture=this.r8Tex(this.drawTexture,Mn,this.back.dims,!0);const r=[0,0,0];for(let x=0;x<3;x++)for(let w=0;w<3;w++)Math.abs(i[x])-1===w&&(r[w]=x*Math.sign(i[x]));let o=1;const l=[1,1,1],h=[!1,!1,!1];for(let x=0;x<r.length;x++)for(let w=0;w<r.length;w++)Math.abs(r[w])===x&&(l[w]=o,(r[w]<0||Object.is(r[w],-0))&&(h[w]=!0),o*=e[w+1]);let f=Ae.range(0,e[1]-1,1);h[0]&&(f=Ae.range(e[1]-1,0,-1));for(let x=0;x<e[1];x++)f[x]*=l[0];let u=Ae.range(0,e[2]-1,1);h[1]&&(u=Ae.range(e[2]-1,0,-1));for(let x=0;x<e[2];x++)u[x]*=l[1];let m=Ae.range(0,e[3]-1,1);h[2]&&(m=Ae.range(e[3]-1,0,-1));for(let x=0;x<e[3];x++)m[x]*=l[2];const g=t.img,p=this.drawBitmap;let v=0;for(let x=0;x<e[3];x++)for(let w=0;w<e[2];w++)for(let b=0;b<e[1];b++)p[f[b]+u[w]+m[x]]=g[v],v++;return this.drawAddUndoBitmap(),this.refreshDrawing(!1),this.drawScene(),!0}binarize(t){const e=t.hdr.dims,i=e[1]*e[2]*e[3],n=new Uint8Array(i);for(let r=0;r<i;r++)t.img[r]!==0&&(n[r]=1);t.img=n,t.hdr.datatypeCode=2,t.hdr.cal_min=0,t.hdr.cal_max=1}async loadDrawingFromUrl(t,e=!1){this.drawBitmap&&j.debug("Overwriting open drawing!"),this.drawClearAllUndoBitmaps();let i=!1;try{const n=await ni.loadFromUrl(Yl(t));e&&await this.binarize(n),i=this.loadDrawing(n)}catch{j.error("loadDrawingFromUrl() failed to load "+t),this.drawClearAllUndoBitmaps()}return i}findOtsu(t=2){if(this.volumes.length<1)return[];const e=this.volumes[0].img,i=e.length;if(i<1)return[];const n=256,r=n-1,o=new Array(n).fill(0),l=this.volumes[0].cal_min,h=this.volumes[0].cal_max;if(h<=l)return[];const f=(h-l)/n;function u(S){return S*f+l}const m=(n-1)/Math.abs(h-l),g=this.volumes[0].hdr.scl_inter,p=this.volumes[0].hdr.scl_slope;for(let S=0;S<i;S++){let C=e[S]*p+g;C=Math.min(Math.max(C,l),h),C=Math.round((C-l)*m),o[C]++}const v=Array(n).fill(0).map(()=>Array(n).fill(0)),x=Array(n).fill(0).map(()=>Array(n).fill(0));for(let S=1;S<n;++S)v[S][S]=o[S],x[S][S]=S*o[S];for(let S=1;S<n-1;++S)v[1][S+1]=v[1][S]+o[S+1],x[1][S+1]=x[1][S]+(S+1)*o[S+1];for(let S=2;S<n;S++)for(let C=S+1;C<n;C++)v[S][C]=v[1][C]-v[1][S-1],x[S][C]=x[1][C]-x[1][S-1];for(let S=1;S<n;++S)for(let C=S+1;C<n;C++)v[S][C]!==0&&(v[S][C]=x[S][C]*x[S][C]/v[S][C]);let w=0;const b=[1/0,1/0,1/0];if(t>3)for(let S=0;S<n-3;S++)for(let C=S+1;C<n-2;C++)for(let E=C+1;E<n-1;E++){const T=v[0][S]+v[S+1][C]+v[C+1][E]+v[E+1][r];T>w&&(b[0]=S,b[1]=C,b[2]=E,w=T)}else if(t===3)for(let S=0;S<n-2;S++)for(let C=S+1;C<n-1;C++){const E=v[0][S]+v[S+1][C]+v[C+1][r];E>w&&(b[0]=S,b[1]=C,w=E)}else for(let S=0;S<n-1;S++){const C=v[0][S]+v[S+1][r];C>w&&(b[0]=S,w=C)}return[u(b[0]),u(b[1]),u(b[2])]}drawOtsu(t=2){if(this.volumes.length===0)return;const e=this.volumes[0].img.length,i=this.findOtsu(t);if(i.length<3)return;this.drawBitmap||this.createEmptyDrawing();const n=this.drawBitmap,r=this.volumes[0].img;for(let o=0;o<e;o++){if(n[o]!==0)continue;const l=r[o];l>i[0]&&(n[o]=1),l>i[1]&&(n[o]=2),l>i[2]&&(n[o]=3)}this.drawAddUndoBitmap(),this.refreshDrawing(!0)}removeHaze(t=5,e=0){const i=this.volumes[e].img,n=this.volumes[e].hdr,r=i.length;let o=2;(t===5||t===1)&&(o=4),(t===4||t===2)&&(o=3);const l=this.findOtsu(o);if(l.length<3)return;let h=l[0];t===1&&(h=l[2]),t===2&&(h=l[1]);const f=n.scl_inter,u=n.scl_slope,m=this.volumes[e].global_min;for(let g=0;g<r;g++)i[g]*u+f<h&&(i[g]=m);this.refreshLayers(this.volumes[e],0),this.drawScene()}async saveImage(t=rm){var l;const e={...rm,...t},{filename:i,isSaveDrawing:n,volumeByIndex:r}=e;if(j.debug("saveImage",i,n,r),((l=this.back)==null?void 0:l.dims)===void 0)return j.debug("No voxelwise image open"),!1;if(n){if(!this.drawBitmap)return j.debug("No drawing open"),!1;const h=this.volumes[0].permRAS;if(h[0]===1&&h[1]===2&&h[2]===3)return j.debug("saving drawing"),await this.volumes[0].saveToDisk(i,this.drawBitmap);{j.debug("saving drawing");const f=this.volumes[0].hdr.dims,u=[0,0,0];for(let T=0;T<3;T++)for(let D=0;D<3;D++)Math.abs(h[T])-1===D&&(u[D]=T*Math.sign(h[T]));let m=1;const g=[1,1,1],p=[!1,!1,!1];for(let T=0;T<u.length;T++)for(let D=0;D<u.length;D++)Math.abs(u[D])===T&&(g[D]=m,(u[D]<0||Object.is(u[D],-0))&&(p[D]=!0),m*=f[D+1]);let v=Ae.range(0,f[1]-1,1);p[0]&&(v=Ae.range(f[1]-1,0,-1));for(let T=0;T<f[1];T++)v[T]*=g[0];let x=Ae.range(0,f[2]-1,1);p[1]&&(x=Ae.range(f[2]-1,0,-1));for(let T=0;T<f[2];T++)x[T]*=g[1];let w=Ae.range(0,f[3]-1,1);p[2]&&(w=Ae.range(f[3]-1,0,-1));for(let T=0;T<f[3];T++)w[T]*=g[2];const b=new Uint8Array(this.drawBitmap),S=new Uint8Array(f[1]*f[2]*f[3]);let C=0;for(let T=0;T<f[3];T++)for(let D=0;D<f[2];D++)for(let R=0;R<f[1];R++)S[C]=b[v[R]+x[D]+w[T]],C++;return j.debug("saving drawing"),this.volumes[0].saveToDisk(i,S)}}return j.debug("saving image"),this.volumes[r].saveToDisk(i)}getMeshIndexByID(t){if(typeof t=="number")return t>=this.meshes.length?-1:t;const e=this.meshes.length;for(let i=0;i<e;i++)if(this.meshes[i].id===t)return i;return-1}setMeshProperty(t,e,i){const n=this.getMeshIndexByID(t);if(n<0){j.warn("setMeshProperty() id not loaded",t);return}this.meshes[n].setProperty(e,i,this.gl),this.updateGLVolume(),this.onMeshPropertyChanged(n,e,i)}indexNearestXYZmm(t,e,i,n){const r=this.getMeshIndexByID(t);return r<0?(j.warn("indexNearestXYZmm() id not loaded",t),[NaN,NaN]):this.meshes[r].indexNearestXYZmm(e,i,n)}decimateHierarchicalMesh(t,e=3){const i=this.getMeshIndexByID(t);if(i<0){j.warn("reverseFaces() id not loaded",t);return}const n=this.meshes[i].decimateHierarchicalMesh(this.gl,e);return this.updateGLVolume(),n}reverseFaces(t){const e=this.getMeshIndexByID(t);if(e<0){j.warn("reverseFaces() id not loaded",t);return}this.meshes[e].reverseFaces(this.gl),this.updateGLVolume()}async setMeshLayerProperty(t,e,i,n){const r=this.getMeshIndexByID(t);if(r<0){j.warn("setMeshLayerProperty() id not loaded",t);return}await this.meshes[r].setLayerProperty(e,i,n,this.gl),this.updateGLVolume()}setPan2Dxyzmm(t){this.scene.pan2Dxyzmm=t,this.opts.yoke3Dto2DZoom&&(this.scene.volScaleMultiplier=t[3]),this.drawScene()}setRenderAzimuthElevation(t,e){this.scene.renderAzimuth=t,this.scene.renderElevation=e,this.onAzimuthElevationChange(t,e),this.drawScene()}getOverlayIndexByID(t){const e=this.overlays.length;for(let i=0;i<e;i++)if(this.overlays[i].id===t)return i;return-1}setVolume(t,e=0){const i=this.volumes.length;if(e>i)return;const n=this.getVolumeIndexByID(t.id);e===0?(this.volumes.splice(n,1),this.volumes.unshift(t),this.back=this.volumes[0],this.overlays=this.volumes.slice(1)):e<0?(this.volumes.splice(this.getVolumeIndexByID(t.id),1),this.back=this.volumes[0],this.volumes.length>1?this.overlays=this.volumes.slice(1):this.overlays=[]):(this.volumes.splice(n,1),this.volumes.splice(e,0,t),this.overlays=this.volumes.slice(1),this.back=this.volumes[0]),this.updateGLVolume()}setMesh(t,e=0){this.meshes.forEach(r=>{j.debug("MESH: ",r.name)});const i=this.meshes.length;if(e>i)return;const n=this.getMeshIndexByID(t.id);e===0?(this.meshes.splice(n,1),this.meshes.unshift(t)):e<0?this.meshes.splice(this.getMeshIndexByID(t.id),1):(this.meshes.splice(n,1),this.meshes.splice(e,0,t)),this.updateGLVolume(),this.meshes.forEach(r=>{j.debug(r.name)})}removeVolume(t){if(this.setVolume(t,-1),this.mediaUrlMap.has(t)){const e=this.mediaUrlMap.get(t);this.onVolumeWithUrlRemoved(e),this.mediaUrlMap.delete(t)}this.drawScene()}removeVolumeByIndex(t){if(t>=this.volumes.length)throw new Error("Index of volume out of bounds");this.removeVolume(this.volumes[t])}removeMesh(t){if(t.unloadMesh(this.gl),this.setMesh(t,-1),this.mediaUrlMap.has(t)){const e=this.mediaUrlMap.get(t);this.onMeshWithUrlRemoved(e),this.mediaUrlMap.delete(t)}}removeMeshByUrl(t){const e=this.getMediaByUrl(t);e&&(this.removeMesh(e),this.mediaUrlMap.delete(e),this.onMeshWithUrlRemoved(t))}moveVolumeToBottom(t){this.setVolume(t,0)}moveVolumeUp(t){const e=this.getVolumeIndexByID(t.id);this.setVolume(t,e+1)}moveVolumeDown(t){const e=this.getVolumeIndexByID(t.id);this.setVolume(t,e-1)}moveVolumeToTop(t){this.setVolume(t,this.volumes.length-1)}mouseDown(t,e){t*=this.uiData.dpr,e*=this.uiData.dpr,this.mousePos=[t,e]}mouseMove(t,e){t*=this.uiData.dpr,e*=this.uiData.dpr;const i=(t-this.mousePos[0])/this.uiData.dpr,n=(e-this.mousePos[1])/this.uiData.dpr;this.mousePos=[t,e],!(this.inRenderTile(t,e)<0)&&(Math.abs(i)<1&&Math.abs(n)<1||(this.scene.renderAzimuth+=i,this.scene.renderElevation+=n,this.drawScene()))}sph2cartDeg(t,e){const i=-e*(Math.PI/180),n=(t-90)%360*(Math.PI/180),r=[Math.cos(i)*Math.cos(n),Math.cos(i)*Math.sin(n),Math.sin(i)],o=Math.sqrt(r[0]*r[0]+r[1]*r[1]+r[2]*r[2]);return o<=0||(r[0]/=o,r[1]/=o,r[2]/=o),r}setClipPlane(t){const e=this.sph2cartDeg(t[1]+180,t[2]);this.scene.clipPlane=[e[0],e[1],e[2],t[0]],this.scene.clipPlaneDepthAziElev=t,this.onClipPlaneChange(this.scene.clipPlane),this.drawScene()}setCrosshairColor(t){this.opts.crosshairColor=t,this.drawScene()}setCrosshairWidth(t){this.opts.crosshairWidth=t,this.crosshairs3D&&(this.crosshairs3D.mm[0]=NaN),this.drawScene()}setDrawColormap(t){this.drawLut=et.makeDrawLut(t),this.updateGLVolume()}setDrawingEnabled(t){this.opts.drawingEnabled=t,this.opts.drawingEnabled?this.drawBitmap||this.createEmptyDrawing():(this.clickToSegmentIsGrowing&&(this.clickToSegmentIsGrowing=!1,this.refreshDrawing(!0,!1)),this.drawPenLocation=[NaN,NaN,NaN],this.drawPenAxCorSag=-1,this.drawPenFillPts=[]),this.drawScene()}setPenValue(t,e=!1){this.opts.penValue=t,this.opts.isFilledPen=e,this.drawScene()}setDrawOpacity(t){this.drawOpacity=t,this.drawScene()}setSelectionBoxColor(t){this.opts.selectionBoxColor=t}sliceScroll2D(t,e,i,n=!0){if(this.opts.scrollRequiresFocus&&this.canvas!==document.activeElement){j.warn("Canvas element does not have focus. Scroll events will not be processed.");return}if(this.inGraphTile(e,i)){let r=this.volumes[0].frame4D;t>0&&r++,t<0&&r--,this.setFrame4D(this.volumes[0].id,r);return}if(t!==0&&this.opts.dragMode===3&&this.inRenderTile(this.uiData.dpr*e,this.uiData.dpr*i)===-1){let r=this.scene.pan2Dxyzmm[3]*(1+10*t);r=Math.round(r*10)/10;const o=this.scene.pan2Dxyzmm[3]-r;this.opts.yoke3Dto2DZoom&&(this.scene.volScaleMultiplier=r),this.scene.pan2Dxyzmm[3]=r;const l=this.frac2mm(this.scene.crosshairPos);this.scene.pan2Dxyzmm[0]+=o*l[0],this.scene.pan2Dxyzmm[1]+=o*l[1],this.scene.pan2Dxyzmm[2]+=o*l[2],this.drawScene(),this.canvas.focus(),this.sync();return}this.mouseClick(e,i,t,n)}setSliceType(t){return this.opts.sliceType=t,this.drawScene(),this}setOpacity(t,e){this.volumes[t].opacity=e,this.updateGLVolume()}setScale(t){this.scene.volScaleMultiplier=t,this.drawScene()}setClipPlaneColor(t){this.opts.clipPlaneColor=t,this.renderShader.use(this.gl),this.gl.uniform4fv(this.renderShader.uniforms.clipPlaneColor,this.opts.clipPlaneColor),this.drawScene()}setClipPlaneThick(t){this.opts.clipThick=t,this.renderShader.use(this.gl),this.gl.uniform1f(this.renderShader.uniforms.clipThick,this.opts.clipThick),this.drawScene()}setClipVolume(t,e){this.opts.clipVolumeLow=[Math.min(t[0],e[0]),Math.min(t[1],e[1]),Math.min(t[2],e[2])],this.opts.clipVolumeHigh=[Math.max(t[0],e[0]),Math.max(t[1],e[1]),Math.max(t[2],e[2])],this.renderShader.use(this.gl),this.gl.uniform3fv(this.renderShader.uniforms.clipLo,this.opts.clipVolumeLow),this.gl.uniform3fv(this.renderShader.uniforms.clipHi,this.opts.clipVolumeHigh),this.pickingImageShader.use(this.gl),this.gl.uniform3fv(this.pickingImageShader.uniforms.clipLo,this.opts.clipVolumeLow),this.gl.uniform3fv(this.pickingImageShader.uniforms.clipHi,this.opts.clipVolumeHigh),this.drawScene()}async setVolumeRenderIllumination(t=0){this.renderGradientValues=Number.isNaN(t),this.renderShader=this.renderVolumeShader,this.renderGradientValues?this.renderShader=this.renderGradientValuesShader:(this.opts.gradientAmount=t,t>0||this.opts.gradientOpacity>0?this.renderShader=this.renderGradientShader:t<0&&(this.renderShader=this.renderSliceShader)),this.initRenderShader(this.renderShader,t),this.renderShader.use(this.gl),this.setClipPlaneColor(this.opts.clipPlaneColor),Number.isNaN(t)?this.gradientTextureAmount=1:this.gradientTextureAmount=t,!(this.volumes.length<1)&&(this.refreshLayers(this.volumes[0],0),this.drawScene())}async setGradientOpacity(t=0,e=0){this.opts.gradientOpacity=t,this.opts.renderSilhouette=e,this.renderGradientValues?this.renderShader=this.renderGradientValuesShader:this.gradientTextureAmount>0||t>0?this.renderShader=this.renderGradientShader:this.gradientTextureAmount<0&&(this.renderShader=this.renderSliceShader),this.initRenderShader(this.renderShader,this.gradientTextureAmount),this.renderShader.use(this.gl),this.gradientTextureAmount>0&&this.refreshLayers(this.volumes[0],0),this.drawScene()}overlayRGBA(t){const e=t.hdr,i=e.dims[1]*e.dims[2]*e.dims[3],n=new Uint8ClampedArray(i*4),r=.2*Math.min(Math.min(e.dims[1],e.dims[2]),e.dims[3]),o=.5*e.dims[1],l=.5*e.dims[2],h=.5*e.dims[3];let f=0;for(let u=0;u<e.dims[3];u++)for(let m=0;m<e.dims[2];m++)for(let g=0;g<e.dims[1];g++){const p=Math.abs(g-o),v=Math.abs(m-l),x=Math.abs(u-h),w=Math.sqrt(p*p+v*v+x*x);let b=0;w<r&&(b=255),n[f++]=0,n[f++]=b,n[f++]=0,n[f++]=b*.5}return n}vox2mm(t,e){return Ae.vox2mm(t,e)}cloneVolume(t){return this.volumes[t].clone()}async loadDocumentFromUrl(t){const e=await Fh.loadFromUrl(t);await this.loadDocument(e)}async loadDocument(t){this.volumes=[],this.meshes=[],this.document=t,this.document.labels=this.document.labels?this.document.labels:[];const e={...tn,...t.opts};this.scene.pan2Dxyzmm=t.scene.pan2Dxyzmm?t.scene.pan2Dxyzmm:[0,0,0,1],this.document.opts=e,this.setClipPlane(this.scene.clipPlaneDepthAziElev),j.debug("load document",t),this.mediaUrlMap.clear(),this.createEmptyDrawing();const i=t.encodedImageBlobs;for(let r=0;r<t.imageOptionsArray.length;r++){const o=t.imageOptionsArray[r],l=i[r];if(l){"colorMap"in o&&(o.colormap=o.colorMap);const h=await ni.loadFromBase64({base64:l,...o});if(h){if(h.colormapLabel){const f=Object.keys(h.colormapLabel.lut).length,u=new Uint8ClampedArray(f);for(const m in h.colormapLabel.lut)u[m]=h.colormapLabel.lut[m];h.colormapLabel.lut=u}this.addVolume(h)}}}this.volumes.length>0&&(this.back=this.volumes[0]);for(const r of t.meshDataObjects??[]){const o={gl:this.gl,...r};r.offsetPt0&&(o.rgba255[3]=0,o.tris=new Uint32Array(r.offsetPt0)),j.debug(o);const l=new Na(o.pts,o.tris,o.name,o.rgba255,o.opacity,o.visible,this.gl,o.connectome,o.dpg,o.dps,o.dpv);r.offsetPt0&&(l.fiberGroupColormap=r.fiberGroupColormap,l.fiberColor=r.fiberColor,l.fiberDither=r.fiberDither,l.fiberRadius=r.fiberRadius,l.colormap=r.colormap),l.meshShaderIndex=o.meshShaderIndex,l.layers=o.layers,l.updateMesh(this.gl),j.debug(l),this.addMesh(l)}if(t.data.connectomes)for(const r of t.data.connectomes){const o=JSON.parse(r),l=this.loadConnectomeAsMesh(o);l.updateMesh(this.gl),this.addMesh(l)}this.createEmptyDrawing();const n=t.encodedDrawingBlob;if(n){const r=await Ae.b64toUint8(n);if(r){const o=this.back.dims;let l=o[1]*o[2]*o[3];if(r.length-352===l&&(l+=352),r.length!==l)throw new Error(`drawBitmap size does not match the texture dimensions (${o[1]}${o[2]}${o[3]}) ${l} != ${o[1]*o[2]*o[3]}.`);this.drawBitmap=r,this.refreshDrawing()}}return await this.setGradientOpacity(this.opts.gradientOpacity),await this.setVolumeRenderIllumination(this.opts.gradientAmount),this.updateGLVolume(),this.drawScene(),this.onDocumentLoaded(t),this}async generateLoadDocumentJavaScript(t,e){const i=this.json(),n=await Ae.compressToBase64String(JSON.stringify(i));return`
        ${e}

        async function saveNiivueAsHtml(pageName) {
          //get new docstring
          const docString = nv1.json();
          const html =
          document.getElementsByTagName("html")[0]
              .innerHTML.replace(base64, await NVUtilities.compressToBase64String(JSON.stringify(docString)));
          NVUtilities.download(html, pageName, "application/html");
        }

        var nv1 = new Niivue();
        await nv1.attachTo("${t}");
        var base64 = "${n}";
        NVUtilities.decompressBase64String(base64).then((jsonText) => {
          var json = JSON.parse(jsonText); // string -> JSON
          var doc = NVDocument.loadFromJSON(json);
          nv1.loadDocument(doc);
          nv1.updateGLVolume();
        });

      `}async generateHTML(t="gl1",e){return`<!DOCTYPE html>
        <html lang="en">
          <head>
            <meta charset="utf-8" />
            <meta http-equiv="X-UA-Compatible" content="IE=edge" />
            <meta name="viewport" content="width=device-width,initial-scale=1.0" />
            <title>Save as HTML</title>
            <style>
            html {
              height: auto;
              min-height: 100%;
              margin: 0;
            }
            body {
              display: flex;
              flex-direction: column;
              margin: 0;
              min-height: 100%;
              width: 100%;
              position: absolute;
              font-family: system-ui, Arial, Helvetica, sans-serif;
              background: #ffffff;
              color: black;
              user-select: none; /* Standard syntax */
            }
            header {
              margin: 10px;
            }
            main {
              flex: 1;
              background: #000000;
              position: relative;
            }
            footer {
              margin: 10px;
            }
            canvas {
              position: absolute;
              cursor: crosshair;
            }
            canvas:focus {
              outline: 0px;
            }
            div {
              display: table-row;
              background-color: blue;
            }
            </style>
          </head>
          <body>
            <noscript>niivue requires JavaScript.</noscript>
            <header>
            Save the current scene as HTML
            <button id="save">Save as HTML</button>
            </header>
            <main>
              <canvas id="gl1"></canvas>
            </main>
            <script type="module" async>
              ${await this.generateLoadDocumentJavaScript(t,e)}
              function saveAsHtml() {
                saveNiivueAsHtml("page.html");
              }
              // assign our event handler
              var button = document.getElementById("save");
              button.onclick = saveAsHtml;
            <\/script>
          </body>
        </html>`}async saveHTML(t="untitled.html",e="gl1",i){const n=await this.generateHTML(e,i);return Ae.download(n,t,"application/html")}json(){return this.document.opts=this.opts,this.document.scene=this.scene,this.document.volumes=this.volumes,this.document.meshes=this.meshes,this.drawScene(),this.document.previewImageDataURL=this.canvas.toDataURL(),this.document.json()}async saveDocument(t="untitled.nvd",e=!0){return this.document.title=t,j.debug("saveDocument",this.volumes[0]),this.drawScene(),this.document.previewImageDataURL=this.canvas.toDataURL(),this.document.volumes=this.volumes,this.document.meshes=this.meshes,this.document.download(t,e)}async loadImages(t){const e=[],i=[];for(const n of t)if("url"in n){const r=this.getFileExt(n.name?n.name:n.url);if(this.loaders[r]){const o=this.loaders[r].toExt.toUpperCase();Tn.includes(o)?i.push(n):e.push(n);continue}Tn.includes(r.toUpperCase())?i.push(n):e.push(n)}return e.length>0&&await this.loadVolumes(e),i.length>0&&await this.loadMeshes(i),this}async loadDicoms(t){if(!this.getDicomLoader())throw new Error("No dicom loader set. Please set a dicom loader before loading dicoms");this.drawScene(),this.volumes=[],this.gl.clearColor(0,0,0,1),this.gl.clear(this.gl.COLOR_BUFFER_BIT);const e=t.map(async n=>{let r=null;if(n.isManifest)r=await ni.fetchDicomData(n.url);else{const m=await fetch(n.url);if(!m.ok)throw new Error(`Failed to load file: ${m.statusText}`);const g=await m.arrayBuffer();r=[{name:n.url.split("/").pop(),data:g}]}const o=this.getDicomLoader().loader,l=await o(r);console.log(l);const h=l[0].name,f=l[0].data;return await ni.loadFromUrl({url:f,name:h})}),i=await Promise.all(e);return i.length===1?this.addVolume(i[0]):this.onDicomLoaderFinishedWithImages(i),this}async loadVolumes(t){return this.drawScene(),this.thumbnailVisible?(this.deferredVolumes=t,this):(this.volumes=[],this.gl.clearColor(0,0,0,1),this.gl.clear(this.gl.COLOR_BUFFER_BIT),await this.addVolumesFromUrl(t),this)}async addMeshFromUrl(t){const e=this.getFileExt(t.url);if(e==="JCON"||e==="JSON"){const r=await(await fetch(t.url,{})).json(),o=this.loadConnectomeAsMesh(r);return this.mediaUrlMap.set(o,t.url),this.onMeshAddedFromUrl(t,o),this.addMesh(o),o}const i=await Na.loadFromUrl({...t,gl:this.gl});return this.mediaUrlMap.set(i,t.url),this.onMeshAddedFromUrl(t,i),this.addMesh(i),i}async addMeshesFromUrl(t){const e=t.map(async n=>{const r=this.getFileExt(n.name||n.url);if(this.loaders[r]){let l=n.url;const h=this.loaders[r].toExt;let f=n.name||n.url;if(f=f.split("/").pop(),typeof n.url=="string"){const v=n.url;try{const x=await fetch(v);if(!x.ok)throw new Error(`Failed to load file: ${x.statusText}`);l=await x.arrayBuffer()}catch(x){throw new Error(`Failed to load url ${v}: ${x}`)}}const{positions:u,indices:m,colors:g=null}=await this.loaders[r].loader(l);n.name=`${f}.${h}`;const p=await Dn.createMZ3Async(u,m,!1,g);n.buffer=p}if(r==="JCON"||r==="JSON"){const h=await(await fetch(n.url,{})).json(),f=this.loadConnectomeAsMesh(h);return this.mediaUrlMap.set(f,n.url),this.onMeshAddedFromUrl(n,f),f}const o=await Na.loadFromUrl({...n,gl:this.gl});return this.mediaUrlMap.set(o,n.url),this.onMeshAddedFromUrl(n,o),o}),i=await Promise.all(e);for(let n=0;n<i.length;n++)this.addMesh(i[n]);return i}async loadMeshes(t){return this.drawScene(),this.thumbnailVisible?(this.deferredMeshes=t,this):(this.initialized,this.meshes=[],this.gl.clearColor(0,0,0,1),this.gl.clear(this.gl.COLOR_BUFFER_BIT),await this.addMeshesFromUrl(t),this.updateGLVolume(),this.drawScene(),this)}async loadConnectomeFromUrl(t,e={}){const n=await(await fetch(t,{headers:e})).json();return this.loadConnectome(n)}async loadFreeSurferConnectomeFromUrl(t,e={}){const n=await(await fetch(t,{headers:e})).json();return this.loadFreeSurferConnectome(n)}async loadFreeSurferConnectome(t){const e=Bl.convertFreeSurferConnectome(t);return this.loadConnectome(e)}handleNodeAdded(t){const e=t.detail.node,i=[1,1,1,1];this.addLabel(e.name,{textColor:i,bulletScale:1,bulletColor:i,lineWidth:0,lineColor:i,lineTerminator:"none",textScale:1},[e.x,e.y,e.z]),this.drawScene()}loadConnectomeAsMesh(t){let e=t;if("data_type"in t&&t.data_type==="fs_pointset")e=Bl.convertFreeSurferConnectome(t),j.warn("converted FreeSurfer connectome",e);else if("nodes"in t){const i=t.nodes;"names"in i&&"X"in i&&"Y"in i&&"Z"in i&&"Color"in i&&"Size"in i&&(e=Bl.convertLegacyConnectome(t),j.warn("converted legacy connectome",e))}else throw new Error("not a known connectome format");return new Bl(this.gl,e)}loadConnectome(t){this.drawScene(),this.meshes=[],this.gl.clearColor(0,0,0,1),this.gl.clear(this.gl.COLOR_BUFFER_BIT);const e=this.loadConnectomeAsMesh(t);return this.addMesh(e),this.drawScene(),this}createEmptyDrawing(){if(this.back===null||!this.back.dims||Math.min(Math.min(this.back.dims[1],this.back.dims[2]),this.back.dims[3])<1)return;const e=this.back.dims[1]*this.back.dims[2]*this.back.dims[3];this.drawBitmap=new Uint8Array(e),this.clickToSegmentGrowingBitmap=new Uint8Array(e),this.drawClearAllUndoBitmaps(),this.drawAddUndoBitmap(),this.drawTexture=this.r8Tex(this.drawTexture,Mn,this.back.dims,!0),this.refreshDrawing(!1)}r16Tex(t,e,i,n){t&&this.gl.deleteTexture(t),t=this.gl.createTexture(),this.gl.activeTexture(e),this.gl.bindTexture(this.gl.TEXTURE_3D,t),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_MIN_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_MAG_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_R,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,1),this.gl.texStorage3D(this.gl.TEXTURE_3D,1,this.gl.R16I,i[1],i[2],i[3]);const r=i[1]*i[2]*i[3];return n.length!==r&&(n=new Int16Array(r)),this.gl.texSubImage3D(this.gl.TEXTURE_3D,0,0,0,0,i[1],i[2],i[3],this.gl.RED_INTEGER,this.gl.SHORT,n),t}drawGrowCut(){if(!this.back||!this.back.dims)throw new Error("back not defined");const t=this.back.hdr,e=this.gl,i=t.dims[1]*t.dims[2]*t.dims[3];if(!this.drawBitmap||this.drawBitmap.length!==i){j.debug("bitmap dims are wrong");return}const n=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,n),e.disable(e.CULL_FACE),e.viewport(0,0,this.back.dims[1],this.back.dims[2]),e.disable(e.BLEND);let r=Mx(this.back);const o=this.r16Tex(null,Lx,this.back.dims,r);for(let T=1;T<i;T++)r[T]=this.drawBitmap[T];const l=this.r16Tex(null,Px,this.back.dims,r),h=this.r16Tex(null,zx,this.back.dims,r),f=1e4;for(let T=1;T<i;T++)r[T]>0&&(r[T]=f);const u=this.r16Tex(null,Ox,this.back.dims,r),m=this.r16Tex(null,kx,this.back.dims,r);e.bindVertexArray(this.genericVAO);const g=this.growCutShader;g.use(e);const p=128;e.uniform1i(g.uniforms.finalPass,0),e.uniform1i(g.uniforms.backTex,11);for(let T=0;T<p;T++){e.uniform1i(g.uniforms.labelTex,14),e.uniform1i(g.uniforms.strengthTex,12);for(let D=0;D<this.back.dims[3];D++){const R=1/this.back.dims[3]*(D+.5);e.uniform1f(g.uniforms.coordZ,R),e.framebufferTextureLayer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,h,0,D),e.framebufferTextureLayer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT1,m,0,D),e.drawBuffers([e.COLOR_ATTACHMENT0,e.COLOR_ATTACHMENT1]),e.checkFramebufferStatus(e.FRAMEBUFFER)!==e.FRAMEBUFFER_COMPLETE&&j.error("Incomplete framebuffer"),e.drawArrays(e.TRIANGLE_STRIP,0,4)}T===p-1&&e.uniform1i(g.uniforms.finalPass,1),e.uniform1i(g.uniforms.labelTex,15),e.uniform1i(g.uniforms.strengthTex,13);for(let D=0;D<this.back.dims[3];D++){const R=1/this.back.dims[3]*(D+.5);e.uniform1f(g.uniforms.coordZ,R),e.framebufferTextureLayer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,l,0,D),e.framebufferTextureLayer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT1,u,0,D),e.drawBuffers([e.COLOR_ATTACHMENT0,e.COLOR_ATTACHMENT1]),e.checkFramebufferStatus(e.FRAMEBUFFER)!==e.FRAMEBUFFER_COMPLETE&&j.error("Incomplete framebuffer"),e.drawArrays(e.TRIANGLE_STRIP,0,4)}}e.drawBuffers([e.COLOR_ATTACHMENT0]);const v=e.COLOR_ATTACHMENT1,x=l;e.readBuffer(v);const w=e.getParameter(e.IMPLEMENTATION_COLOR_READ_FORMAT),b=e.getParameter(e.IMPLEMENTATION_COLOR_READ_TYPE);(w!==e.RED_INTEGER||b!==e.SHORT)&&j.debug("readPixels will fail."),r=new Int16Array;const S=this.back.dims[1]*this.back.dims[2],C=new Int16Array(S);for(let T=0;T<this.back.dims[3];T++)e.framebufferTextureLayer(e.FRAMEBUFFER,v,x,0,T),e.readPixels(0,0,this.back.dims[1],this.back.dims[2],w,b,C),r=Int16Array.from([...r,...C]);let E=r[0];for(let T=0;T<r.length;T++)E=Math.max(E,r[T]);for(let T=1;T<i;T++)this.drawBitmap[T]=r[T];e.deleteTexture(o),e.deleteTexture(u),e.deleteTexture(m),e.deleteTexture(l),e.deleteTexture(h),e.bindVertexArray(this.unusedVAO),e.viewport(0,0,e.canvas.width,e.canvas.height),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteFramebuffer(n),this.drawAddUndoBitmap(),this.refreshDrawing(!0)}drawPt(t,e,i,n,r=null){var g;if(r===null&&(r=this.drawBitmap),!((g=this.back)!=null&&g.dims))throw new Error("back.dims not set");const o=this.back.dims[1],l=this.back.dims[2],h=this.back.dims[3];t=Math.min(Math.max(t,0),o-1),e=Math.min(Math.max(e,0),l-1),i=Math.min(Math.max(i,0),h-1),r[t+e*o+i*o*l]=n;const f=this.drawPenAxCorSag===0,u=this.drawPenAxCorSag===1,m=this.drawPenAxCorSag===2;if(this.opts.penSize>1){const p=Math.floor(this.opts.penSize/2);for(let v=-p;v<=p;v++)for(let x=-p;x<=p;x++)f?r[t+v+(e+x)*o+i*o*l]=n:u?r[t+v+e*o+(i+x)*o*l]=n:m&&(r[t+(e+x)*o+(i+v)*o*l]=n)}}drawPenLine(t,e,i){const n=Math.abs(t[0]-e[0]),r=Math.abs(t[1]-e[1]),o=Math.abs(t[2]-e[2]);let l=-1,h=-1,f=-1;e[0]>t[0]&&(l=1),e[1]>t[1]&&(h=1),e[2]>t[2]&&(f=1);let u=t[0],m=t[1],g=t[2];const p=e[0],v=e[1],x=e[2];if(n>=r&&n>=o){let w=2*r-n,b=2*o-n;for(;u!==p;)u+=l,w>=0&&(m+=h,w-=2*n),b>=0&&(g+=f,b-=2*n),w+=2*r,b+=2*o,this.drawPt(u,m,g,i)}else if(r>=n&&r>=o){let w=2*n-r,b=2*o-r;for(;m!==v;)m+=h,w>=0&&(u+=l,w-=2*r),b>=0&&(g+=f,b-=2*r),w+=2*n,b+=2*o,this.drawPt(u,m,g,i)}else{let w=2*r-o,b=2*n-o;for(;g!==x;)g+=f,w>=0&&(m+=h,w-=2*o),b>=0&&(u+=l,b-=2*o),w+=2*r,b+=2*n,this.drawPt(u,m,g,i)}}drawingBinaryDilationWithSeed(t,e=6){try{let i=function(b){return b[0]+b[1]*h+b[2]*f};const n=this.drawBitmap,r=this.back.dims[1],o=this.back.dims[2],l=this.back.dims[3],h=r,f=r*o,u=f*l,m=i(t);if(m<0||m>=u)throw new Error("Seed index is out of bounds.");const g=n[m];if(g===0)throw new Error("Seed voxel is not part of a filled cluster.");const p=n.slice();for(let b=0;b<u;b++)p[b]=p[b]===g?1:0;this.drawFloodFillCore(p,m,e);const v=n.slice(),x=[],w=[-f,f,-r,r,-1,1];x.push(...w),e>6&&x.push(-r-1,-r+1,r-1,r+1,-f-r,-f+r,-f-1,-f+1,f-r,f+r,f-1,f+1),e>18&&x.push(-f-r-1,-f-r+1,-f+r-1,-f+r+1,f-r-1,f-r+1,f+r-1,f+r+1);for(let b=0;b<u;b++)if(p[b]===2){const S=b%r,C=Math.floor(b%f/r),E=Math.floor(b/f);for(const T of x){const D=b+T;if(D<0||D>=u)continue;const R=D%r,N=Math.floor(D%f/r),M=Math.floor(D/f);Math.abs(R-S)>1||Math.abs(N-C)>1||Math.abs(M-E)>1||n[D]===0&&(v[D]=g)}}this.drawBitmap=v,this.drawAddUndoBitmap(),this.refreshDrawing(!0)}catch(i){j.error("Error in drawingBinaryDilationWithSeed:",i)}}drawFloodFillCore(t,e,i=6){var u;if(!((u=this.back)!=null&&u.dims))throw new Error("back.dims undefined");const n=[this.back.dims[1],this.back.dims[2],this.back.dims[3]],r=n[0],o=r*n[1];function l(m){return m[0]+m[1]*r+m[2]*o}function h(m){const g=Math.floor(m/o),p=Math.floor((m-g*o)/r);return[Math.floor(m%r),p,g]}const f=[];for(f.push(e),t[e]=2;f.length>0;){let m=function(v){const x=p.slice();if(x[0]+=v[0],x[1]+=v[1],x[2]+=v[2],x[0]<0||x[1]<0||x[2]<0||x[0]>=n[0]||x[1]>=n[1]||x[2]>=n[2])return;const w=l(x);t[w]===1&&(t[w]=2,f.push(w))};const g=f[0];f.shift();const p=h(g);m([0,0,-1]),m([0,0,1]),m([0,-1,0]),m([0,1,0]),m([-1,0,0]),m([1,0,0]),!(i<=6)&&(m([-1,-1,0]),m([1,1,0]),m([-1,1,0]),m([1,1,0]),m([0,-1,-1]),m([0,1,-1]),m([-1,0,-1]),m([1,0,-1]),m([0,-1,1]),m([0,1,1]),m([-1,0,1]),m([1,0,1]),!(i<=18)&&(m([-1,-1,-1]),m([1,-1,-1]),m([-1,1,-1]),m([1,1,-1]),m([-1,-1,1]),m([1,-1,1]),m([-1,1,1]),m([1,1,1])))}}drawFloodFill(t,e=0,i=0,n=NaN,r=NaN,o=6,l=Number.POSITIVE_INFINITY,h=!1,f=null,u=!1){var I;if(!this.drawBitmap&&(j.warn("drawFloodFill called without an initialized drawBitmap."),this.createEmptyDrawing(),!this.drawBitmap)){j.error("Failed to create drawing bitmap.");return}if(this.clickToSegmentIsGrowing&&!this.clickToSegmentGrowingBitmap){if(j.warn("drawFloodFill called in preview mode without initialized clickToSegmentGrowingBitmap."),this.drawBitmap)this.clickToSegmentGrowingBitmap=this.drawBitmap.slice();else{j.error("Cannot initialize growing bitmap as drawBitmap is null.");return}if(!this.clickToSegmentGrowingBitmap){j.error("Failed to create growing bitmap.");return}}if(f===null&&(f=this.drawBitmap),!f){j.error("drawFloodFill targetBitmap is null.");return}if(!((I=this.back)!=null&&I.dims))throw new Error("back.dims undefined");e=Math.abs(e);const m=[this.back.dims[1],this.back.dims[2],this.back.dims[3]];if(t[0]<0||t[1]<0||t[2]<0||t[0]>=m[0]||t[1]>=m[1]||t[2]>=m[2])return;const g=m[0],p=g*m[1],v=p*m[2],x=this.clickToSegmentIsGrowing?this.drawBitmap:f;if(!x){j.error("Could not determine original bitmap state.");return}const w=new Uint8Array(v).fill(0);let b=-1;h&&this.drawPenAxCorSag===0?b=2:h&&this.drawPenAxCorSag===1?b=1:h&&this.drawPenAxCorSag===2&&(b=0);function S(B){const U=Math.floor(B/p),z=Math.floor((B-U*p)/g);return[Math.floor(B%g),z,U]}function C(B){return B[0]+B[1]*g+B[2]*p}const E=B=>this.vox2mm(B,this.back.matRAS),T=E(t),D=l**2;function R(B){const U=S(B);if(b>=0&&U[b]!==t[b])return!1;const z=E(U);return(z[0]-T[0])**2+(z[1]-T[1])**2+(z[2]-T[2])**2<=D}const N=C(t),M=x[N];if(u&&M===0){j.debug("Grow/Erase Cluster tool requires starting on a masked voxel."),this.clickToSegmentIsGrowing&&this.clickToSegmentGrowingBitmap&&this.drawBitmap&&(this.clickToSegmentGrowingBitmap.set(this.drawBitmap),this.refreshDrawing(!0,!0));return}if(i===0&&M===e&&!u&&e!==0&&(j.debug("drawFloodFill selected voxel is already desired color"),!this.clickToSegmentIsGrowing))return;let V=NaN;if(u&&(i===Number.POSITIVE_INFINITY||i===Number.NEGATIVE_INFINITY)){const B=x.slice();for(let H=0;H<v;H++)B[H]=B[H]===M&&R(H)?1:0;if(B[N]!==1){j.error("Seed voxel could not be marked for cluster ID.");return}this.drawFloodFillCore(B,N,o);const U=this.volumes[0].img2RAS();let z=0,P=0;for(let H=0;H<v;H++)B[H]===2&&(z+=U[H],P++);V=P>0?z/P:U[N],j.debug(`Grow Cluster using mean intensity: ${V.toFixed(2)} from ${P} voxels.`);let K=-1/0,_=1/0;i===Number.POSITIVE_INFINITY&&(K=V),i===Number.NEGATIVE_INFINITY&&(_=V);for(let H=0;H<v;H++)if(B[H]===2)w[H]=1;else if(x[H]===0){const q=U[H];q>=K&&q<=_&&R(H)&&(w[H]=1)}e=M}else if(i===0)if(u&&e===0){j.debug(`Erase Cluster: Identifying cluster with color ${M}`);for(let B=0;B<v;B++)w[B]=x[B]===M&&R(B)?1:0}else for(let B=0;B<v;B++)x[B]===M&&R(B)&&M!==0&&(w[B]=1);else{const B=this.volumes[0].img2RAS();V=B[N];let U=-1/0,z=1/0;isFinite(n)&&isFinite(r)?(U=n,z=r):i===Number.POSITIVE_INFINITY?U=V:i===Number.NEGATIVE_INFINITY&&(z=V);for(let P=0;P<v;P++){const K=B[P];K>=U&&K<=z&&R(P)&&(w[P]=1)}e=x[N],e===0&&(e=this.opts.penValue,(e<1||!isFinite(e))&&(e=1))}if(w[N]!==1){let B=!1;if(u&&i!==0?M!==0&&(B=!0):(M!==0||e===0)&&(B=!0),B&&R(N))w[N]=1,j.debug("Forcing seed voxel to 1 in working buffer.");else{j.debug("Seed voxel not marked as candidate '1' and not valid originally."),this.clickToSegmentIsGrowing&&this.clickToSegmentGrowingBitmap&&this.drawBitmap&&this.clickToSegmentGrowingBitmap.set(this.drawBitmap);return}}this.drawFloodFillCore(w,N,o);for(let B=0;B<v;B++)w[B]===2?f[B]=e:this.clickToSegmentIsGrowing&&f===this.clickToSegmentGrowingBitmap&&(f[B]=x[B]);this.clickToSegmentIsGrowing?this.refreshDrawing(!0,!0):(this.drawAddUndoBitmap(),this.refreshDrawing(!0,!1))}drawPenFilled(){var S;const t=this.drawPenFillPts.length;if(t<2){this.drawPenFillPts=[];return}const e=this.drawPenAxCorSag;let i=0,n=1;if(e===1&&(n=2),e===2&&(i=1,n=2),!((S=this.back)!=null&&S.dims))throw new Error("back.dims undefined");const r=[this.back.dims[i+1],this.back.dims[n+1]],o=new Uint8Array(r[0]*r[1]);let l=1;function h(C,E){const T=Math.abs(C[0]-E[0]),D=Math.abs(C[1]-E[1]);o[C[0]+C[1]*r[0]]=l,o[E[0]+E[1]*r[0]]=l;let R=-1,N=-1;E[0]>C[0]&&(R=1),E[1]>C[1]&&(N=1);let M=C[0],V=C[1];const I=E[0],B=E[1];if(T>=D){let U=2*D-T;for(;M!==I;)M+=R,U>=0&&(V+=N,U-=2*T),U+=2*D,o[M+V*r[0]]=l}else{let U=2*T-D;for(;V!==B;)V+=N,U>=0&&(M+=R,U-=2*D),U+=2*T,o[M+V*r[0]]=l}}function f(C){const E=Math.min(Math.max(C[0],0),r[0]-1),T=Math.min(Math.max(C[1],0),r[1]-1);return[E,T]}const u=f([this.drawPenFillPts[0][i],this.drawPenFillPts[0][n]]);let m=[...u],g=[...u],p=u;for(let C=1;C<t;C++){let E=[this.drawPenFillPts[C][i],this.drawPenFillPts[C][n]];E=f(E),m=[Math.min(E[0],m[0]),Math.min(E[1],m[1])],g=[Math.max(E[0],g[0]),Math.max(E[1],g[1])],h(p,E),p=E}h(u,p);const v=1;m[0]=Math.max(0,m[0]-v),m[1]=Math.max(0,m[1]-v),g[0]=Math.min(r[0]-1,g[0]+v),g[1]=Math.min(r[1]-1,g[1]+v);for(let C=0;C<r[1];C++)for(let E=0;E<r[0];E++){if(E>=m[0]&&E<g[0]&&C>=m[1]&&C<=g[1])continue;const T=E+C*r[0];o[T]===0&&(o[T]=2)}const x=[];function w(C){if(C[0]<m[0]||C[1]<m[1]||C[0]>g[0]||C[1]>g[1])return;const E=C[0]+C[1]*r[0];o[E]===0&&(x.push(C),o[E]=2)}for(let C=m[0];C<=g[0];C++)w([C,m[1]]),w([C,g[1]]);for(let C=m[1]+1;C<=g[1]-1;C++)w([m[0],C]),w([g[0],C]);for(;x.length>0;){const C=x.shift();w([C[0]-1,C[1]]),w([C[0]+1,C[1]]),w([C[0],C[1]-1]),w([C[0],C[1]+1])}l=this.opts.penValue;const b=this.drawPenFillPts[0][3-(i+n)];if(!this.drawBitmap)throw new Error("drawBitmap undefined");if(e===0){const C=b*r[0]*r[1];for(let E=0;E<r[0]*r[1];E++)o[E]!==2&&(this.drawBitmap[E+C]=l)}else{let C=1;const E=this.back.dims[1]*this.back.dims[2];let T=b*this.back.dims[1];e===2&&(C=this.back.dims[1],T=b);let D=0;for(let R=0;R<r[1];R++)for(let N=0;N<r[0];N++)o[D]!==2&&(this.drawBitmap[N*C+R*E+T]=l),D++}if(!this.drawFillOverwrites&&this.drawUndoBitmaps[this.currentDrawUndoBitmap].length>0){const C=this.drawBitmap.length,E=$2(this.drawUndoBitmaps[this.currentDrawUndoBitmap],C);for(let T=0;T<C;T++)E[T]!==0&&(this.drawBitmap[T]=E[T])}this.drawPenFillPts=[],this.drawAddUndoBitmap(),this.refreshDrawing(!1)}closeDrawing(){this.drawClearAllUndoBitmaps(),this.rgbaTex(this.drawTexture,Mn,[2,2,2,2],!0),this.drawBitmap=null,this.clickToSegmentGrowingBitmap=null,this.drawScene()}refreshDrawing(t=!0,e=!1){var l;e&&(!this.opts.drawingEnabled||!this.opts.clickToSegment)&&(j.debug("refreshDrawing: Conditions not met for clickToSegment bitmap, using drawBitmap."),e=!1);const i=e?this.clickToSegmentGrowingBitmap:this.drawBitmap;!i&&!e&&this.clickToSegmentGrowingBitmap?j.warn("refreshDrawing: drawBitmap is null, but clickToSegmentGrowingBitmap exists. Check state."):!i&&e&&this.drawBitmap?(j.warn("refreshDrawing: clickToSegmentGrowingBitmap is null, falling back to drawBitmap."),e=!1):i||j.warn("refreshDrawing: Both bitmaps are null. Uploading empty data.");const n=e?this.clickToSegmentGrowingBitmap:this.drawBitmap;if(!((l=this.back)!=null&&l.dims)){j.warn("refreshDrawing: back.dims undefined, cannot refresh drawing texture yet.");return}const r=this.back.dims.slice(),o=this.back.dims[1]*this.back.dims[2]*this.back.dims[3];if(!n){j.warn(`refreshDrawing: Bitmap data source (${e?"growing":"main"}) is null. Cannot update texture.`),t&&this.drawScene();return}if(n.length===8?(r[1]=2,r[2]=2,r[3]=2):o!==n.length&&j.warn(`Drawing bitmap length (${n.length}) must match the background image (${o})`),this.gl.activeTexture(Mn),this.opts.is2DSliceShader){const h=this.frac2vox(this.scene.crosshairPos),f=Math.min(Math.max(h[2],0),r[3]-1),u=r[1]*r[2],m=f*u;j.debug(`refresh huge 2D drawing xyz ${r[1]}${r[2]}${r[3]} slice ${m}`),n.subarray(m,m+u),this.gl.bindTexture(this.gl.TEXTURE_2D,this.drawTexture),this.gl.texSubImage2D(this.gl.TEXTURE_2D,0,0,0,r[1],r[2],this.gl.RED,this.gl.UNSIGNED_BYTE,n)}else this.gl.bindTexture(this.gl.TEXTURE_3D,this.drawTexture),this.gl.texSubImage3D(this.gl.TEXTURE_3D,0,0,0,0,r[1],r[2],r[3],this.gl.RED,this.gl.UNSIGNED_BYTE,n);if(!this.drawTexture){j.error("refreshDrawing: drawTexture (GPU texture) is null.");return}t&&this.drawScene()}r8Tex2D(t,e,i,n=!1){if(t&&this.gl.deleteTexture(t),t=this.gl.createTexture(),this.gl.activeTexture(e),this.gl.bindTexture(this.gl.TEXTURE_2D,t),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_R,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,1),this.gl.texStorage2D(this.gl.TEXTURE_2D,1,this.gl.R8,i[1],i[2]),n){const r=new Uint8Array(i[1]*i[2]);this.gl.texSubImage2D(this.gl.TEXTURE_2D,0,0,0,i[1],i[2],this.gl.RED,this.gl.UNSIGNED_BYTE,r)}return t}r8Tex(t,e,i,n=!1){if(t&&this.gl.deleteTexture(t),t=this.gl.createTexture(),this.gl.activeTexture(e),this.gl.bindTexture(this.gl.TEXTURE_3D,t),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_MIN_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_MAG_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_R,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,1),this.gl.texStorage3D(this.gl.TEXTURE_3D,1,this.gl.R8,i[1],i[2],i[3]),n){const r=new Uint8Array(i[1]*i[2]*i[3]);this.gl.texSubImage3D(this.gl.TEXTURE_3D,0,0,0,0,i[1],i[2],i[3],this.gl.RED,this.gl.UNSIGNED_BYTE,r)}return t}rgbaTex2D(t,e,i,n=null,r=!0){if(t&&this.gl.deleteTexture(t),t=this.gl.createTexture(),this.gl.activeTexture(e),this.gl.bindTexture(this.gl.TEXTURE_2D,t),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,1),this.gl.texStorage2D(this.gl.TEXTURE_2D,1,this.gl.RGBA8,i[1],i[2]),n){let o=n;const l=i[1],h=i[2];if(r){o=new Uint8Array(n.length);const f=l*4;for(let u=0;u<h;u++){const m=u*f,g=(h-1-u)*f;o.set(n.subarray(m,m+f),g)}}this.gl.texSubImage2D(this.gl.TEXTURE_2D,0,0,0,l,h,this.gl.RGBA,this.gl.UNSIGNED_BYTE,o)}return t}rgbaTex(t,e,i,n=!1){if(t&&this.gl.deleteTexture(t),t=this.gl.createTexture(),this.gl.activeTexture(e),this.gl.bindTexture(this.gl.TEXTURE_3D,t),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_R,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,1),this.gl.texStorage3D(this.gl.TEXTURE_3D,1,this.gl.RGBA8,i[1],i[2],i[3]),n){const r=new Uint8Array(i[1]*i[2]*i[3]*4);this.gl.texSubImage3D(this.gl.TEXTURE_3D,0,0,0,0,i[1],i[2],i[3],this.gl.RGBA,this.gl.UNSIGNED_BYTE,r)}return t}rgba16Tex(t,e,i,n=!1){if(t&&this.gl.deleteTexture(t),t=this.gl.createTexture(),this.gl.activeTexture(e),this.gl.bindTexture(this.gl.TEXTURE_3D,t),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_MIN_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_MAG_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_R,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,2),this.gl.pixelStorei(this.gl.PACK_ALIGNMENT,2),this.gl.texStorage3D(this.gl.TEXTURE_3D,1,this.gl.RGBA16UI,i[1],i[2],i[3]),n){const r=new Uint16Array(i[1]*i[2]*i[3]*4);this.gl.texSubImage3D(this.gl.TEXTURE_3D,0,0,0,0,i[1],i[2],i[3],this.gl.RGBA_INTEGER,this.gl.UNSIGNED_SHORT,r)}return t}requestCORSIfNotSameOrigin(t,e){new URL(e,window.location.href).origin!==window.location.origin&&(t.crossOrigin="")}async loadPngAsTexture(t,e){return new Promise((i,n)=>{const r=new Image;r.onload=()=>{if(!this.bmpShader)return;let o;e===4?(this.bmpTexture!==null&&this.gl.deleteTexture(this.bmpTexture),this.bmpTexture=this.gl.createTexture(),o=this.bmpTexture,this.bmpTextureWH=r.width/r.height,this.gl.activeTexture(Vx),this.bmpShader.use(this.gl),this.gl.uniform1i(this.bmpShader.uniforms.bmpTexture,4)):e===5?(this.gl.activeTexture(im),this.matCapTexture!==null&&this.gl.deleteTexture(this.matCapTexture),this.matCapTexture=this.gl.createTexture(),o=this.matCapTexture):(this.fontShader.use(this.gl),this.gl.activeTexture(Fx),this.gl.uniform1i(this.fontShader.uniforms.fontTexture,3),this.fontTexture!==null&&this.gl.deleteTexture(this.fontTexture),this.fontTexture=this.gl.createTexture(),o=this.fontTexture),this.gl.bindTexture(this.gl.TEXTURE_2D,o),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,r),i(o),e!==4&&this.drawScene()},r.onerror=n,this.requestCORSIfNotSameOrigin(r,t),r.src=t})}async loadFontTexture(t){return this.loadPngAsTexture(t,3)}async loadBmpTexture(t){return this.loadPngAsTexture(t,4)}async loadMatCapTexture(t){return this.loadPngAsTexture(t,5)}initFontMets(){if(!this.fontMetrics)throw new Error("fontMetrics undefined");this.fontMets={distanceRange:this.fontMetrics.atlas.distanceRange,size:this.fontMetrics.atlas.size,mets:{}};for(let i=0;i<256;i++)this.fontMets.mets[i]={xadv:0,uv_lbwh:[0,0,0,0],lbwh:[0,0,0,0]};const t=this.fontMetrics.atlas.width,e=this.fontMetrics.atlas.height;for(let i=0;i<this.fontMetrics.glyphs.length;i++){const n=this.fontMetrics.glyphs[i],r=n.unicode;if(this.fontMets.mets[r].xadv=n.advance,n.planeBounds===void 0)continue;let o=n.atlasBounds.left/t,l=(e-n.atlasBounds.top)/e,h=(n.atlasBounds.right-n.atlasBounds.left)/t,f=(n.atlasBounds.top-n.atlasBounds.bottom)/e;this.fontMets.mets[r].uv_lbwh=[o,l,h,f],o=n.planeBounds.left,l=n.planeBounds.bottom,h=n.planeBounds.right-n.planeBounds.left,f=n.planeBounds.top-n.planeBounds.bottom,this.fontMets.mets[r].lbwh=[o,l,h,f]}}async loadFont(t=Q2,e=X2){await this.loadFontTexture(t);const i=await fetch(e);if(!i.ok)throw Error(i.statusText);const n=await i.text();this.fontMetrics=JSON.parse(n),this.initFontMets(),this.fontShader.use(this.gl),this.drawScene()}async loadDefaultMatCap(){return this.loadMatCapTexture(Sx)}async loadDefaultFont(){await this.loadFontTexture(this.DEFAULT_FONT_GLYPH_SHEET),this.fontMetrics=this.DEFAULT_FONT_METRICS,this.initFontMets()}async initText(){this.fontShader=new qe(this.gl,h3,f3),this.fontShader.use(this.gl),await this.loadDefaultFont(),await this.loadDefaultMatCap(),this.drawLoadingText(this.opts.loadingText)}meshShaderNameToNumber(t="Phong"){const e=t.toLowerCase();for(let i=0;i<this.meshShaders.length;i++)if(this.meshShaders[i].Name.toLowerCase()===e)return i}setMeshShader(t,e=2){let i=0;if(typeof e=="number"?i=e:i=this.meshShaderNameToNumber(e),i===void 0)throw new Error("shaderIndex undefined");i=Math.min(i,this.meshShaders.length-1),i=Math.max(i,0);const n=this.getMeshIndexByID(t);if(n>=this.meshes.length){j.debug("Unable to change shader until mesh is loaded (maybe you need async)");return}this.meshes[n].meshShaderIndex=i,this.updateGLVolume(),this.onMeshShaderChanged(n,i)}createCustomMeshShader(t,e="Custom"){if(!t)throw new Error("Need fragment shader");const i=this.meshShaderNameToNumber(e);i>=0&&(this.gl.deleteProgram(this.meshShaders[i].shader.program),this.meshShaders.splice(i,1));const n=new qe(this.gl,Uh,t);return n.use(this.gl),{Name:e,Frag:t,shader:n}}setCustomMeshShader(t="",e="Custom"){const i=this.createCustomMeshShader(t,e);return this.meshShaders.push(i),this.onCustomMeshShaderAdded(t,e),this.meshShaders.length-1}meshShaderNames(t=!0){const e=[];for(let i=0;i<this.meshShaders.length;i++)e.push(this.meshShaders[i].Name);return t===!0?e.sort():e}initRenderShader(t,e=0){t.use(this.gl),this.gl.uniform1i(t.uniforms.volume,0),this.gl.uniform1i(t.uniforms.colormap,1),this.gl.uniform1i(t.uniforms.overlay,2),this.gl.uniform1i(t.uniforms.drawing,7),this.gl.uniform1fv(t.uniforms.renderDrawAmbientOcclusion,[this.renderDrawAmbientOcclusion,1]),this.gl.uniform1f(t.uniforms.gradientAmount,e),this.gl.uniform1f(t.uniforms.silhouettePower,this.opts.renderSilhouette);const i=new Float32Array(256);for(let n=0;n<256;n++)this.opts.gradientOpacity===0?i[n]=1:i[n]=Math.pow(n/255,this.opts.gradientOpacity*8);this.gl.uniform1fv(this.gl.getUniformLocation(t.program,"gradientOpacity"),i)}async init(){const t=this.gl.getExtension("WEBGL_debug_renderer_info");if(t){const o=this.gl.getParameter(t.UNMASKED_VENDOR_WEBGL),l=this.gl.getParameter(t.UNMASKED_RENDERER_WEBGL);j.info("renderer vendor: ",o),j.info("renderer: ",l)}else j.info("debug_renderer_info unavailable");const e=this.gl.getParameter(this.gl.RENDERER);j.info("firefox renderer: ",e),this.gl.clearDepth(0),this.gl.enable(this.gl.CULL_FACE),this.gl.cullFace(this.gl.FRONT),this.gl.enable(this.gl.BLEND),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.volumeTexture=this.rgbaTex(this.volumeTexture,Sa,[2,2,2,2],!0),this.overlayTexture=this.rgbaTex(this.overlayTexture,Lh,[2,2,2,2],!0),this.drawTexture=this.r8Tex(this.drawTexture,Mn,[2,2,2,2],!0);const i=[1,1,0,1,0,0,0,1,0,0,0,0],n=this.gl;this.cuboidVertexBuffer=n.createBuffer(),n.bindBuffer(n.ARRAY_BUFFER,this.cuboidVertexBuffer),n.bufferData(n.ARRAY_BUFFER,new Float32Array(i),n.STATIC_DRAW),this.genericVAO=n.createVertexArray(),n.bindVertexArray(this.genericVAO),n.bindBuffer(n.ARRAY_BUFFER,this.cuboidVertexBuffer),n.enableVertexAttribArray(0),n.vertexAttribPointer(0,3,n.FLOAT,!1,0,0),n.bindVertexArray(this.unusedVAO),this.pickingMeshShader=new qe(n,Uh,C3),this.pickingMeshShader.use(n),this.pickingImageShader=new qe(n,Br,k3),this.pickingImageShader.use(n),n.uniform1i(this.pickingImageShader.uniforms.volume,0),n.uniform1i(this.pickingImageShader.uniforms.colormap,1),n.uniform1i(this.pickingImageShader.uniforms.overlay,2),n.uniform1i(this.pickingImageShader.uniforms.drawing,7),this.slice2DShader=new qe(n,Mh,t3),this.slice2DShader.use(n),n.uniform1i(this.slice2DShader.uniforms.volume,0),n.uniform1i(this.slice2DShader.uniforms.colormap,1),n.uniform1i(this.slice2DShader.uniforms.overlay,2),n.uniform1i(this.slice2DShader.uniforms.drawing,7),n.uniform1f(this.slice2DShader.uniforms.drawOpacity,this.drawOpacity),this.sliceMMShader=new qe(n,Mh,i3),this.sliceMMShader.use(n),n.uniform1i(this.sliceMMShader.uniforms.volume,0),n.uniform1i(this.sliceMMShader.uniforms.colormap,1),n.uniform1i(this.sliceMMShader.uniforms.overlay,2),n.uniform1i(this.sliceMMShader.uniforms.drawing,7),n.uniform1f(this.sliceMMShader.uniforms.drawOpacity,this.drawOpacity),this.sliceV1Shader=new qe(n,Mh,s3),this.sliceV1Shader.use(n),n.uniform1i(this.sliceV1Shader.uniforms.volume,0),n.uniform1i(this.sliceV1Shader.uniforms.colormap,1),n.uniform1i(this.sliceV1Shader.uniforms.overlay,2),n.uniform1i(this.sliceV1Shader.uniforms.drawing,7),n.uniform1f(this.sliceV1Shader.uniforms.drawOpacity,this.drawOpacity),this.orientCubeShader=new qe(n,P3,z3),this.orientCubeShaderVAO=n.createVertexArray(),n.bindVertexArray(this.orientCubeShaderVAO);const r=n.createBuffer();n.enableVertexAttribArray(0),n.enableVertexAttribArray(1),n.bindBuffer(n.ARRAY_BUFFER,r),n.bufferData(n.ARRAY_BUFFER,K3,n.STATIC_DRAW),n.vertexAttribPointer(0,3,n.FLOAT,!1,24,0),n.enableVertexAttribArray(1),n.vertexAttribPointer(1,3,n.FLOAT,!1,24,12),n.bindVertexArray(this.unusedVAO),this.rectShader=new qe(n,j2,Dh),this.rectShader.use(n),this.rectOutlineShader=new qe(n,j2,n3),this.rectOutlineShader.use(n),this.lineShader=new qe(n,o3,Dh),this.lineShader.use(n),this.line3DShader=new qe(n,l3,Dh),this.line3DShader.use(n),this.circleShader=new qe(n,d3,m3),this.circleShader.use(n),this.renderVolumeShader=new qe(n,Br,Jv),this.initRenderShader(this.renderVolumeShader),this.renderSliceShader=new qe(n,Br,Wv),this.initRenderShader(this.renderSliceShader),this.renderGradientShader=new qe(n,Br,$v),this.initRenderShader(this.renderGradientShader,.3),n.uniform1i(this.renderGradientShader.uniforms.matCap,5),n.uniform1i(this.renderGradientShader.uniforms.gradient,6),this.renderGradientValuesShader=new qe(n,Br,e3),this.initRenderShader(this.renderGradientValuesShader),n.uniform1i(this.renderGradientValuesShader.uniforms.matCap,5),n.uniform1i(this.renderGradientValuesShader.uniforms.gradient,6),this.renderShader=this.renderVolumeShader,this.colorbarShader=new qe(n,a3,r3),this.colorbarShader.use(n),n.uniform1i(this.colorbarShader.uniforms.colormap,1),this.blurShader=new qe(n,Fl,G3),this.sobelBlurShader=new qe(n,Fl,Y3),this.sobelFirstOrderShader=new qe(n,Fl,H3),this.sobelSecondOrderShader=new qe(n,Fl,q3),this.growCutShader=new qe(n,A3,v3),this.passThroughShader=new qe(n,_3,j3),this.orientShaderAtlasU=new qe(n,Ca,Nh.concat(Y2)),this.orientShaderAtlasI=new qe(n,Ca,G2.concat(Y2)),this.orientShaderU=new qe(n,Ca,Nh.concat(Rh)),this.orientShaderI=new qe(n,Ca,G2.concat(Rh)),this.orientShaderF=new qe(n,Ca,g3.concat(Rh)),this.orientShaderRGBU=new qe(n,Ca,Nh.concat(p3)),this.surfaceShader=new qe(n,x3,y3),this.surfaceShader.use(n),this.fiberShader=new qe(n,w3,b3),this.pickingImageShader.use(n);for(let o=0;o<this.meshShaders.length;o++){const l=this.meshShaders[o];l.Name==="Flat"?l.shader=new qe(n,O3,H2):l.shader=new qe(n,Uh,l.Frag),l.shader.use(n),l.shader.isMatcap=l.Name==="Matcap",l.shader.isMatcap&&n.uniform1i(l.shader.uniforms.matCap,5)}return this.bmpShader=new qe(n,c3,u3),await this.initText(),this.opts.thumbnail.length>0&&(await this.loadBmpTexture(this.opts.thumbnail),this.thumbnailVisible=!0),this.updateGLVolume(),this.initialized=!0,this.resizeListener(),this.drawScene(),this}gradientGL(t){const e=this.gl,i=[0,0,0,0,1,0,1,0,0,1,1,0],n=e.createVertexArray();e.bindVertexArray(n);const r=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,r),e.bufferData(e.ARRAY_BUFFER,new Float32Array(i),e.STATIC_DRAW),e.enableVertexAttribArray(0),e.vertexAttribPointer(0,3,e.FLOAT,!1,0,0);const o=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,o),e.disable(e.CULL_FACE),e.viewport(0,0,t.dims[1],t.dims[2]),e.disable(e.BLEND);const l=this.rgbaTex(null,nm,t.dims,!0),h=this.opts.gradientOrder===2?this.sobelBlurShader:this.blurShader;h.use(e),e.activeTexture(Sa),e.bindTexture(e.TEXTURE_3D,this.volumeTexture);const f=.7;e.uniform1i(h.uniforms.intensityVol,0),e.uniform1f(h.uniforms.dX,f/t.dims[1]),e.uniform1f(h.uniforms.dY,f/t.dims[2]),e.uniform1f(h.uniforms.dZ,f/t.dims[3]),e.bindVertexArray(n);for(let g=0;g<t.dims[3]-1;g++){const p=1/t.dims[3]*(g+.5);e.uniform1f(h.uniforms.coordZ,p),e.framebufferTextureLayer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,l,0,g);const v=e.checkFramebufferStatus(e.FRAMEBUFFER);v!==e.FRAMEBUFFER_COMPLETE&&j.error("framebuffer status: ",v),e.clear(e.DEPTH_BUFFER_BIT),e.drawArrays(e.TRIANGLE_STRIP,0,i.length/3)}const u=this.opts.gradientOrder===2?this.sobelSecondOrderShader:this.sobelFirstOrderShader;u.use(e),e.activeTexture(nm),e.bindTexture(e.TEXTURE_3D,l),e.uniform1i(u.uniforms.intensityVol,8);const m=.7;e.uniform1f(u.uniforms.dX,m/t.dims[1]),e.uniform1f(u.uniforms.dY,m/t.dims[2]),e.uniform1f(u.uniforms.dZ,m/t.dims[3]),this.opts.gradientOrder===2&&(e.uniform1f(u.uniforms.dX2,2*m/t.dims[1]),e.uniform1f(u.uniforms.dY2,2*m/t.dims[2]),e.uniform1f(u.uniforms.dZ2,2*m/t.dims[3])),e.uniform1f(u.uniforms.coordZ,.5),e.bindVertexArray(n),this.gradientTexture!==null&&e.deleteTexture(this.gradientTexture),this.gradientTexture=this.rgbaTex(this.gradientTexture,sm,t.dims);for(let g=0;g<t.dims[3]-1;g++){const p=1/t.dims[3]*(g+.5);e.uniform1f(u.uniforms.coordZ,p),e.framebufferTextureLayer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,this.gradientTexture,0,g);const v=e.checkFramebufferStatus(e.FRAMEBUFFER);v!==e.FRAMEBUFFER_COMPLETE&&j.error("framebuffer status: ",v),e.clear(e.DEPTH_BUFFER_BIT),e.drawArrays(e.TRIANGLE_STRIP,0,i.length/3)}e.deleteFramebuffer(o),e.deleteTexture(l),e.deleteBuffer(r),e.bindFramebuffer(e.FRAMEBUFFER,null)}updateGLVolume(){var i;let t=0;const e=this.volumes.length;this.refreshColormaps();for(let n=0;n<e;n++)this.volumes[n].toRAS&&(this.refreshLayers(this.volumes[n],t),t++);if(this.furthestVertexFromOrigin=0,e>0&&(this.furthestVertexFromOrigin=((i=this.volumeObject3D)==null?void 0:i.furthestVertexFromOrigin)??0),this.meshes)for(let n=0;n<this.meshes.length;n++)this.furthestVertexFromOrigin=Math.max(this.furthestVertexFromOrigin,this.meshes[n].furthestVertexFromOrigin);this.onVolumeUpdated&&this.onVolumeUpdated(),this.drawScene()}getDescriptives(t){const{layer:e=0,masks:i=[],drawingIsMask:n=!1,roiIsMask:r=!1,startVox:o=[0,0,0],endVox:l=[0,0,0]}=t;let h=null;const f=this.volumes[e].hdr,u=this.volumes[e].pixDimsRAS;let m=f.scl_slope;isNaN(m)&&(m=1);let g=f.scl_inter;isNaN(g)&&(g=1);const p=this.volumes[e].img,v=p.length,x=new Float32Array(v);for(let U=0;U<v;U++)x[U]=p[U]*m+g;const w=new Uint8Array(v);for(let U=0;U<v;U++)w[U]=1;if(i.length>0)for(let U=0;U<i.length;U++){const z=this.volumes[i[U]].img;if(z.length!==v){j.debug("Mask resolution does not match image. Skipping masking layer "+i[U]);continue}for(let P=0;P<v;P++)(z[P]===0||isNaN(z[P]))&&(w[P]=0)}else if(i.length<1&&n)for(let U=0;U<v;U++)(this.drawBitmap[U]===0||isNaN(this.drawBitmap[U]))&&(w[U]=0);else if(i.length<1&&r){w.fill(0);let U=-1;if(o[0]===l[0])U=0;else if(o[1]===l[1])U=1;else if(o[2]===l[2])U=2;else{console.error("Error: No constant dimension found.");return}const P=[0,1,2].filter(Ie=>Ie!==U),K=[];K[U]=o[U],K[P[0]]=(o[P[0]]+l[P[0]])/2,K[P[1]]=(o[P[1]]+l[P[1]])/2;const _=Math.abs(l[P[0]]-o[P[0]])/2,H=Math.abs(l[P[1]]-o[P[1]])/2,q=f.dims[1],se=f.dims[2],G=Math.max(0,Math.floor(K[P[0]]-_)),W=Math.min(f.dims[P[0]+1]-1,Math.ceil(K[P[0]]+_)),le=Math.max(0,Math.floor(K[P[1]]-H)),ce=Math.min(f.dims[P[1]+1]-1,Math.ceil(K[P[1]]+H)),fe=K[U];if(fe<0||fe>=f.dims[U+1]){console.error("Error: Constant dimension value is out of bounds.");return}for(let Ie=G;Ie<=W;Ie++)for(let Je=le;Je<=ce;Je++){const Ve=[];Ve[U]=fe,Ve[P[0]]=Ie,Ve[P[1]]=Je;const Xt=(Ve[P[0]]-K[P[0]])/_,ft=(Ve[P[1]]-K[P[1]])/H;if(Xt*Xt+ft*ft<=1){const Te=Ve[0],Xe=Ve[1],ui=Ve[2]*q*se+Xe*q+Te;w[ui]=1}}const ye=u[P[0]+1]*u[P[1]+1];h=w.reduce((Ie,Je)=>Ie+(Je===1?1:0),0)*ye;const He=_*u[P[0]+1],ve=H*u[P[1]+1];h=Math.PI*He*ve}let b=0,S=0,C=0,E=Number.NEGATIVE_INFINITY,T=Number.POSITIVE_INFINITY,D=0,R=0,N=0;for(let U=0;U<v;U++){if(w[U]<1)continue;const z=x[U];b++;let P=S+(z-S)/b;C=C+(z-S)*(z-P),S=P,z!==0&&(D++,P=R+(z-R)/D,N=N+(z-R)*(z-P),R=P,T=Math.min(z,E),E=Math.max(z,E))}const M=Math.sqrt(C/(b-1)),V=Math.sqrt(N/(D-1)),I=T,B=E;return b!==D&&(T=Math.min(0,E),E=Math.max(0,E)),{mean:S,stdev:M,nvox:b,volumeMM3:b*f.pixDims[1]*f.pixDims[2]*f.pixDims[3],volumeML:b*f.pixDims[1]*f.pixDims[2]*f.pixDims[3]*.001,min:T,max:E,meanNot0:R,stdevNot0:V,nvoxNot0:D,minNot0:I,maxNot0:B,cal_min:this.volumes[e].cal_min,cal_max:this.volumes[e].cal_max,robust_min:this.volumes[e].robust_min,robust_max:this.volumes[e].robust_max,area:h}}refreshLayers(t,e){var R;if(this.volumes.length<1)return;this.refreshColormaps();const i=t.hdr;let n=t.img;t.frame4D>0&&t.frame4D<t.nFrame4D&&(n=t.img.slice(t.frame4D*t.nVox3D,(t.frame4D+1)*t.nVox3D));const r=t.opacity;if(e>1&&r===0)return;let o=null;if(!this.back)throw new Error("back undefined");this.gl.bindVertexArray(this.unusedVAO),this.crosshairs3D&&(this.crosshairs3D.mm[0]=NaN);let l=Rt(t.toRAS);if(e===0){this.volumeObject3D=Ex(t,this.VOLUME_ID,this.gl),vi(l,l),this.back.matRAS=t.matRAS,this.back.dims=t.dimsRAS,this.back.pixDims=t.pixDimsRAS;const{volScale:N,vox:M}=this.sliceScale(!0);this.volScale=N,this.vox=M,this.volumeObject3D.scale=N,(i.dims[1]>this.uiData.max2D||i.dims[2]>this.uiData.max2D)&&j.error("Image dimensions exceed maximum texture size of hardware.");const I=i.dims[1]>this.uiData.max3D||i.dims[2]>this.uiData.max3D||i.dims[3]>this.uiData.max3D;if(I&&i.datatypeCode===2304&&i.dims[3]<2){j.info(`Large RGBA image (>${this.uiData.max3D}) requires Texture2D`),this.opts.is2DSliceShader=!0,o=this.rgbaTex2D(this.volumeTexture,Sa,t.dimsRAS,n);return}if(I){j.info(`Large scalar image (>${this.uiData.max3D}) requires Texture2D (${i.dims[1]}${i.dims[2]}${i.dims[3]})`);const U=i.dims[1]*i.dims[2],z=this.frac2vox(this.scene.crosshairPos),K=Math.min(Math.max(z[2],0),i.dims[3]-1)*U,_=new Uint8Array(U*4),H=new Uint32Array(_.buffer),q=Math.floor(t.opacity*255),se=255*i.scl_slope/(t.cal_max-t.cal_min),G=255*(i.scl_inter-t.cal_min)/(t.cal_max-t.cal_min),W=new Uint8Array(this.colormap(t.colormap)),le=new Uint32Array(W.buffer);let ce=-1;for(let fe=0;fe<U;fe++){const ye=n[fe+K]*se+G,me=Math.round(Math.min(255,Math.max(0,ye)));H[fe]=le[me],_[ce+=4]=q}this.opts.is2DSliceShader=!0,o=this.rgbaTex2D(this.volumeTexture,Sa,t.dimsRAS,_,!1);return}if(I&&j.warn(`dimensions exceed 3D limits ${i.dims}`),this.opts.is2DSliceShader=!1,o=this.rgbaTex(this.volumeTexture,Sa,t.dimsRAS),!this.renderShader)throw new Error("renderShader undefined");this.renderShader.use(this.gl),this.gl.uniform3fv(this.renderShader.uniforms.texVox,M),this.gl.uniform3fv(this.renderShader.uniforms.volScale,N);const B=this.pickingImageShader;B.use(this.gl),this.gl.uniform1i(B.uniforms.volume,0),this.gl.uniform1i(B.uniforms.colormap,1),this.gl.uniform1i(B.uniforms.overlay,2),this.gl.uniform3fv(B.uniforms.volScale,N),j.debug(this.volumeObject3D)}else{((R=this.back)==null?void 0:R.dims)===void 0&&j.error("Fatal error: Unable to render overlay: background dimensions not defined!");const N=this.mm2frac(t.mm000,0,!0);let M=this.mm2frac(t.mm100,0,!0),V=this.mm2frac(t.mm010,0,!0),I=this.mm2frac(t.mm001,0,!0);M=ct(M,M,N),V=ct(V,V,N),I=ct(I,I,N),l=Ri(M[0],V[0],I[0],N[0],M[1],V[1],I[1],N[1],M[2],V[2],I[2],N[2],0,0,0,1),vi(l,l),e===1?(o=this.rgbaTex(this.overlayTexture,Lh,this.back.dims),this.overlayTexture=o,this.overlayTextureID=o):o=this.overlayTextureID}const h=this.gl.createFramebuffer();this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,h),this.gl.disable(this.gl.CULL_FACE),this.gl.viewport(0,0,this.back.dims[1],this.back.dims[2]),this.gl.disable(this.gl.BLEND);const f=this.gl.createTexture();this.gl.activeTexture(Bx),this.gl.bindTexture(this.gl.TEXTURE_3D,f),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_MIN_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_MAG_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_R,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,1);let u=this.orientShaderU;if(!i)throw new Error("hdr undefined");if(!n)throw new Error("img undefined");if(i.datatypeCode===2)i.intent_code===1002&&(u=this.orientShaderAtlasU),this.gl.texStorage3D(this.gl.TEXTURE_3D,1,this.gl.R8UI,i.dims[1],i.dims[2],i.dims[3]),this.gl.texSubImage3D(this.gl.TEXTURE_3D,0,0,0,0,i.dims[1],i.dims[2],i.dims[3],this.gl.RED_INTEGER,this.gl.UNSIGNED_BYTE,n);else if(i.datatypeCode===4)u=this.orientShaderI,i.intent_code===1002&&(u=this.orientShaderAtlasI),this.gl.texStorage3D(this.gl.TEXTURE_3D,1,this.gl.R16I,i.dims[1],i.dims[2],i.dims[3]),this.gl.texSubImage3D(this.gl.TEXTURE_3D,0,0,0,0,i.dims[1],i.dims[2],i.dims[3],this.gl.RED_INTEGER,this.gl.SHORT,n);else if(i.datatypeCode===16)this.gl.texStorage3D(this.gl.TEXTURE_3D,1,this.gl.R32F,i.dims[1],i.dims[2],i.dims[3]),this.gl.texSubImage3D(this.gl.TEXTURE_3D,0,0,0,0,i.dims[1],i.dims[2],i.dims[3],this.gl.RED,this.gl.FLOAT,n),u=this.orientShaderF;else if(i.datatypeCode===64){let N=new Float32Array;N=Float32Array.from(n),this.gl.texStorage3D(this.gl.TEXTURE_3D,1,this.gl.R32F,i.dims[1],i.dims[2],i.dims[3]),this.gl.texSubImage3D(this.gl.TEXTURE_3D,0,0,0,0,i.dims[1],i.dims[2],i.dims[3],this.gl.RED,this.gl.FLOAT,N),u=this.orientShaderF}else i.datatypeCode===128?(u=this.orientShaderRGBU,u.use(this.gl),this.gl.uniform1i(u.uniforms.hasAlpha,0),this.gl.texStorage3D(this.gl.TEXTURE_3D,1,this.gl.RGB8UI,i.dims[1],i.dims[2],i.dims[3]),this.gl.texSubImage3D(this.gl.TEXTURE_3D,0,0,0,0,i.dims[1],i.dims[2],i.dims[3],this.gl.RGB_INTEGER,this.gl.UNSIGNED_BYTE,n)):i.datatypeCode===512?(i.intent_code===1002&&(u=this.orientShaderAtlasU),this.gl.texStorage3D(this.gl.TEXTURE_3D,1,this.gl.R16UI,i.dims[1],i.dims[2],i.dims[3]),this.gl.texSubImage3D(this.gl.TEXTURE_3D,0,0,0,0,i.dims[1],i.dims[2],i.dims[3],this.gl.RED_INTEGER,this.gl.UNSIGNED_SHORT,n)):i.datatypeCode===2304&&(u=this.orientShaderRGBU,u.use(this.gl),this.gl.uniform1i(u.uniforms.hasAlpha,1),this.gl.texStorage3D(this.gl.TEXTURE_3D,1,this.gl.RGBA8UI,i.dims[1],i.dims[2],i.dims[3]),this.gl.texSubImage3D(this.gl.TEXTURE_3D,0,0,0,0,i.dims[1],i.dims[2],i.dims[3],this.gl.RGBA_INTEGER,this.gl.UNSIGNED_BYTE,n));t.global_min===void 0&&t.calMinMax();let m=null;if(this.gl.bindVertexArray(this.genericVAO),e>1){if(!this.back.dims)throw new Error("back.dims undefined");m=this.rgbaTex(m,am,this.back.dims),this.gl.bindTexture(this.gl.TEXTURE_3D,m);const N=this.passThroughShader;N.use(this.gl),this.gl.uniform1i(N.uniforms.in3D,2);for(let M=0;M<this.back.dims[3];M++){const V=1/this.back.dims[3]*(M+.5);this.gl.uniform1f(N.uniforms.coordZ,V),this.gl.framebufferTextureLayer(this.gl.FRAMEBUFFER,this.gl.COLOR_ATTACHMENT0,m,0,M),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4)}}else m=this.rgbaTex(m,am,[2,2,2,2]);u.use(this.gl),this.gl.activeTexture(Ll);let g=null;if(t.colormapLabel!==null&&t.colormapLabel.lut.length>7){const N=t.colormapLabel.max-t.colormapLabel.min+1;g=this.createColormapTexture(g,1,N),this.gl.texSubImage2D(this.gl.TEXTURE_2D,0,0,0,N,1,this.gl.RGBA,this.gl.UNSIGNED_BYTE,t.colormapLabel.lut),this.gl.uniform1f(u.uniforms.cal_min,t.colormapLabel.min-.5),this.gl.uniform1f(u.uniforms.cal_max,t.colormapLabel.max+.5),this.gl.bindTexture(this.gl.TEXTURE_2D,g)}else this.gl.bindTexture(this.gl.TEXTURE_2D,this.colormapTexture),this.gl.uniform1f(u.uniforms.cal_min,t.cal_min),this.gl.uniform1f(u.uniforms.cal_max,t.cal_max);"alphaThreshold"in t&&(j.warn("alphaThreshold is deprecated: use colormapType"),t.alphaThreshold===!0&&(t.colormapType=2),t.alphaThreshold===!1&&(t.colormapType=1),delete t.alphaThreshold);const p=t.colormapType!==0?1:0,v=t.colormapType===2?1:0;this.gl.uniform1i(u.uniforms.isAlphaThreshold,v),this.gl.uniform1i(u.uniforms.isColorbarFromZero,p),this.gl.uniform1i(u.uniforms.isAdditiveBlend,this.opts.isAdditiveBlend?1:0);let x=Number.POSITIVE_INFINITY,w=Number.NEGATIVE_INFINITY;if(t.colormapNegative.length>0&&(x=Math.min(-t.cal_min,-t.cal_max),w=Math.max(-t.cal_min,-t.cal_max),isFinite(t.cal_minNeg)&&isFinite(t.cal_maxNeg)&&(x=Math.min(t.cal_minNeg,t.cal_maxNeg),w=Math.max(t.cal_minNeg,t.cal_maxNeg))),e>0&&this.overlayOutlineWidth>0){const N=t.cal_min,M=t.cal_max;let V=Math.min(N,M)<=0&&Math.max(N,M)>=0;!V&&x<w&&(V=x<=0&&w>=0),V&&j.error("issue1139: do not use overlayOutlineWidth when thresholds cross or touch zero")}if(!u)throw new Error("orientShader undefined");this.gl.uniform1f(u.uniforms.layer??null,e),this.gl.uniform1f(u.uniforms.cal_minNeg??null,x),this.gl.uniform1f(u.uniforms.cal_maxNeg??null,w),this.gl.bindTexture(this.gl.TEXTURE_3D,f),this.gl.uniform1i(u.uniforms.intensityVol??null,9),this.gl.uniform1i(u.uniforms.blend3D??null,10),this.gl.uniform1i(u.uniforms.colormap??null,1),this.gl.uniform1f(u.uniforms.scl_inter??null,i.scl_inter),this.gl.uniform1f(u.uniforms.scl_slope??null,i.scl_slope),this.gl.uniform1f(u.uniforms.opacity??null,r),this.gl.uniform1i(u.uniforms.modulationVol??null,7);let b=null;if(t.modulationImage!==null&&t.modulationImage>=0&&t.modulationImage<this.volumes.length){j.debug("modulating",this.volumes);const N=this.volumes[t.modulationImage].hdr;if(N.dims[1]===i.dims[1]&&N.dims[2]===i.dims[2]&&N.dims[3]===i.dims[3]){t.modulateAlpha?(this.gl.uniform1i(u.uniforms.modulation,2),this.gl.uniform1f(u.uniforms.opacity,1)):this.gl.uniform1i(u.uniforms.modulation,1),b=this.r8Tex(b,this.gl.TEXTURE7,i.dims,!0),this.gl.activeTexture(this.gl.TEXTURE7),this.gl.bindTexture(this.gl.TEXTURE_3D,b);const M=i.dims[1]*i.dims[2]*i.dims[3],V=new Uint8Array(M),I=this.volumes[t.modulationImage].cal_min,B=1/(this.volumes[t.modulationImage].cal_max-I),U=this.volumes[t.modulationImage].img.buffer;let z=new Uint8Array(U);switch(N.datatypeCode){case 4:z=new Int16Array(U);break;case 16:z=new Float32Array(U);break;case 64:z=new Float64Array(U);break;case 128:z=new Uint8Array(U);break;case 512:z=new Uint16Array(U);break}j.debug(this.volumes[t.modulationImage]);const P=this.volumes[t.modulationImage].colormapNegative.length>0;let K=this.volumes[t.modulationImage].cal_min,_=this.volumes[t.modulationImage].cal_max;isFinite(this.volumes[t.modulationImage].cal_minNeg)&&isFinite(this.volumes[t.modulationImage].cal_maxNeg)&&(K=this.volumes[t.modulationImage].cal_minNeg,_=this.volumes[t.modulationImage].cal_minNeg),K=Math.abs(K),_=Math.abs(_),K>_&&([K,_]=[_,K]);const H=1/(_-K);let q=Math.abs(t.modulateAlpha);q=Math.max(q,1);const se=this.volumes[t.modulationImage].frame4D*M;for(let G=0;G<M;G++){const W=z[G+se]*N.scl_slope+N.scl_inter;let le=(W-I)*B;P&&W<0&&(le=(Math.abs(W)-K)*H),le=Math.min(Math.max(le,0),1),le=Math.pow(le,q)*255,V[G]=le}this.gl.texSubImage3D(this.gl.TEXTURE_3D,0,0,0,0,i.dims[1],i.dims[2],i.dims[3],this.gl.RED,this.gl.UNSIGNED_BYTE,V)}else j.debug("Modulation image dimensions do not match target")}else this.gl.uniform1i(u.uniforms.modulation,0);if(this.gl.uniformMatrix4fv(u.uniforms.mtx,!1,l),!this.back.dims)throw new Error("back.dims undefined");let S=0;i.intent_code===1002&&(S=this.opts.atlasOutline),this.gl.uniform4fv(u.uniforms.xyzaFrac,[1/this.back.dims[1],1/this.back.dims[2],1/this.back.dims[3],S]),j.debug("back dims: ",this.back.dims);for(let N=0;N<this.back.dims[3];N++){const M=1/this.back.dims[3]*(N+.5);this.gl.uniform1f(u.uniforms.coordZ,M),this.gl.framebufferTextureLayer(this.gl.FRAMEBUFFER,this.gl.COLOR_ATTACHMENT0,o,0,N),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4)}if(this.gl.bindVertexArray(this.unusedVAO),this.gl.deleteTexture(f),this.gl.deleteTexture(b),this.gl.deleteTexture(m),this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),this.gl.deleteFramebuffer(h),e===0&&(this.volumeTexture=o,this.gradientTextureAmount>0?this.gradientGL(i):(this.gradientTexture!==null&&this.gl.deleteTexture(this.gradientTexture),this.gradientTexture=null)),!this.renderShader)throw new Error("renderShader undefined");this.renderShader.use(this.gl);const C=this.sliceScale(!0),E=C.vox,T=C.volScale;if(this.gl.uniform1f(this.renderShader.uniforms.overlays,this.overlays),this.gl.uniform4fv(this.renderShader.uniforms.clipPlaneColor,this.opts.clipPlaneColor),this.gl.uniform1f(this.renderShader.uniforms.clipThick,this.opts.clipThick),this.gl.uniform3fv(this.renderShader.uniforms.clipLo,this.opts.clipVolumeLow),this.gl.uniform3fv(this.renderShader.uniforms.clipHi,this.opts.clipVolumeHigh),this.gl.uniform1f(this.renderShader.uniforms.backOpacity,this.volumes[0].opacity),this.gl.uniform1f(this.renderShader.uniforms.renderOverlayBlend,this.opts.renderOverlayBlend),this.gl.uniform4fv(this.renderShader.uniforms.clipPlane,this.scene.clipPlane),this.gl.uniform3fv(this.renderShader.uniforms.texVox,E),this.gl.uniform3fv(this.renderShader.uniforms.volScale,T),!this.pickingImageShader)throw new Error("pickingImageShader undefined");this.pickingImageShader.use(this.gl),this.gl.uniform1f(this.pickingImageShader.uniforms.overlays,this.overlays.length),this.gl.uniform3fv(this.pickingImageShader.uniforms.texVox,E),this.gl.uniform3fv(this.pickingImageShader.uniforms.clipLo,this.opts.clipVolumeLow),this.gl.uniform3fv(this.pickingImageShader.uniforms.clipHi,this.opts.clipVolumeHigh);let D=this.sliceMMShader;if(this.opts.is2DSliceShader&&(D=this.slice2DShader),this.opts.isV1SliceShader&&(D=this.sliceV1Shader),!D)throw new Error("slice shader undefined");D.use(this.gl),this.gl.uniform1f(D.uniforms.overlays,this.overlays.length),this.gl.uniform1f(D.uniforms.drawOpacity,this.drawOpacity),g!==null&&(this.gl.deleteTexture(g),this.gl.activeTexture(Ll),this.gl.bindTexture(this.gl.TEXTURE_2D,this.colormapTexture)),this.gl.uniform1i(D.uniforms.drawing,7),this.gl.activeTexture(Mn),this.opts.is2DSliceShader?this.gl.bindTexture(this.gl.TEXTURE_2D,this.drawTexture):this.gl.bindTexture(this.gl.TEXTURE_3D,this.drawTexture),this.updateInterpolation(e)}colormaps(){return et.colormaps()}addColormap(t,e){et.addColormap(t,e)}setColormap(t,e){const i=this.getVolumeIndexByID(t);this.volumes[i].colormap=e,this.updateGLVolume()}idx(t,e,i,n){return i*n[0]*n[1]+e*n[0]+t}check_previous_slice(t,e,i,n,r,o,l,h){const f=new Uint32Array(27);let u=0;if(!r)return 0;const m=t[this.idx(i,n,r,o)];if(l>=6){const g=this.idx(i,n,r-1,o);m===t[g]&&(f[u++]=e[g])}if(l>=18){if(i){const g=this.idx(i-1,n,r-1,o);m===t[g]&&(f[u++]=e[g])}if(n){const g=this.idx(i,n-1,r-1,o);m===t[g]&&(f[u++]=e[g])}if(i<o[0]-1){const g=this.idx(i+1,n,r-1,o);m===t[g]&&(f[u++]=e[g])}if(n<o[1]-1){const g=this.idx(i,n+1,r-1,o);m===t[g]&&(f[u++]=e[g])}}if(l===26){if(i&&n){const g=this.idx(i-1,n-1,r-1,o);m===t[g]&&(f[u++]=e[g])}if(i<o[0]-1&&n){const g=this.idx(i+1,n-1,r-1,o);m===t[g]&&(f[u++]=e[g])}if(i&&n<o[1]-1){const g=this.idx(i-1,n+1,r-1,o);m===t[g]&&(f[u++]=e[g])}if(i<o[0]-1&&n<o[1]-1){const g=this.idx(i+1,n+1,r-1,o);m===t[g]&&(f[u++]=e[g])}}return u?(this.fill_tratab(h,f,u),f[0]):0}do_initial_labelling(t,e,i){let n=1;const r=8192;let o=r,l=new Uint32Array(o).fill(0);const h=new Uint32Array(e[0]*e[1]*e[2]).fill(0),f=new Uint32Array(27);for(let u=0;u<e[2];u++)for(let m=0;m<e[1];m++)for(let g=0;g<e[0];g++){let p=0;const v=t[this.idx(g,m,u,e)];if(v!==0){if(f[0]=this.check_previous_slice(t,h,g,m,u,e,i,l),f[0]&&(p+=1),i>=6){if(g){const x=this.idx(g-1,m,u,e);v===t[x]&&(f[p++]=h[x])}if(m){const x=this.idx(g,m-1,u,e);v===t[x]&&(f[p++]=h[x])}}if(i>=18){if(m&&g){const x=this.idx(g-1,m-1,u,e);v===t[x]&&(f[p++]=h[x])}if(m&&g<e[0]-1){const x=this.idx(g+1,m-1,u,e);v===t[x]&&(f[p++]=h[x])}}if(p)h[this.idx(g,m,u,e)]=f[0],this.fill_tratab(l,f,p);else{if(h[this.idx(g,m,u,e)]=n,n>=o){o+=r;const x=new Uint32Array(o);x.set(l),l=x}l[n-1]=n,n++}}}for(let u=0;u<n-1;u++){let m=u;for(;l[m]!==m+1;)m=l[m]-1;l[u]=m+1}return[n-1,l,h]}fill_tratab(t,e,i){let n=0;const r=new Uint32Array(i+5).fill(0);let l=2147483647;for(let h=0;h<i;h++){let f=e[h];for(n=0;t[f-1]!==f;)if(f=t[f-1],n++,n>100){j.info(`
Ooh no!!`);break}r[h]=f,l=Math.min(l,f)}for(let h=0;h<i;h++)t[r[h]-1]=l}translate_labels(t,e,i,n){const r=e[0]*e[1]*e[2];let o=0;const l=new Uint32Array(r).fill(0);for(let u=0;u<n;u++)o=Math.max(o,i[u]);const h=new Uint32Array(o).fill(0);let f=0;for(let u=0;u<r;u++)t[u]&&(h[i[t[u]-1]-1]||(f+=1,h[i[t[u]-1]-1]=f),l[u]=h[i[t[u]-1]-1]);return[f,l]}largest_original_cluster_labels(t,e,i){const n=t.length,r=new Uint32Array(e+1).fill(0),o=new Uint32Array(e+1).fill(0);for(let f=0;f<n;f++){const u=t[f],m=i[f];r[m]=u,o[m]++}let l=0;for(let f=0;f<e+1;f++){const u=r[f];l=Math.max(l,u);for(let m=0;m<e+1;m++)m!==f&&u===r[m]&&(o[f]<o[m]||o[f]===o[m]&&f<m)&&(r[f]=0)}const h=new Uint32Array(n).fill(0);for(let f=0;f<n;f++)h[f]=r[i[f]];return[l,h]}bwlabel(t,e,i=26,n=!1,r=!1){const o=Date.now(),l=e[0]*e[1]*e[2],h=new Uint32Array(l).fill(0);if(![6,18,26].includes(i))return j.info("bwlabel: conn must be 6, 18 or 26."),[0,h];if(e[0]<2||e[1]<2||e[2]<1)return j.info("bwlabel: img must be 2 or 3-dimensional"),[0,h];if(n)for(let v=0;v<l;v++)t[v]!==0&&(h[v]=1);else h.set(t);let[f,u,m]=this.do_initial_labelling(h,e,i);u===void 0&&(u=new Uint32Array);const[g,p]=this.translate_labels(m,e,u,f);if(j.info(i+" neighbor clustering into "+g+" regions in "+(Date.now()-o)+"ms"),r){const[v,x]=this.largest_original_cluster_labels(h,g,p);return[v,x]}return[g,p]}async createConnectedLabelImage(t,e=26,i=!1,n=!1){var m,g;const r=this.getVolumeIndexByID(t),o=Uint32Array.from(((m=this.volumes[r].dims)==null?void 0:m.slice(1,4))??[]),l=Uint32Array.from(((g=this.volumes[r].img)==null?void 0:g.slice())??[]),[h,f]=this.bwlabel(l,o,e,i,n),u=this.volumes[r].clone();u.opacity=.5,u.colormap="random";for(let p=0;p<u.img.length;p++)u.img[p]=f[p];return u.cal_min=0,u.cal_max=h,u}async scalecropUint8(t,e=0,i=255,n,r){const o=t.length,l=new Uint8Array(o);for(let h=0;h<o;h++){let f=t[h];f=e+r*(f-n),f=Math.max(f,e),f=Math.min(f,i),l[h]=f}return l}async scalecropFloat32(t,e=0,i=1,n,r){const o=t.length,l=new Float32Array(o);for(let h=0;h<o;h++){let f=t[h];f=e+r*(f-n),f=Math.max(f,e),f=Math.min(f,i),l[h]=f}return l}getScale(t,e=0,i=255,n=0,r=.999){let o=t.global_min,l=t.global_max;if(t.hdr.datatypeCode===2)return[o,1];if((!isFinite(n)||!isFinite(r))&&isFinite(t.cal_min)&&isFinite(t.cal_max)&&t.cal_max>t.cal_min){o=t.cal_min,l=t.cal_max;const C=(i-e)/(l-o);return j.info(" Robust Rescale:  min: "+o+"  max: "+l+" scale: "+C),console.log("Robust Rescale:  min: "+o+"  max: "+l+" scale: "+C),[o,C]}const h=t.img,f=t.hdr.dims[1]*t.hdr.dims[2]*t.hdr.dims[3];if(t.hdr.scl_slope!==1||t.hdr.scl_inter!==0){const C=t.img,E=new Float32Array(t.img.length);for(let T=0;T<f;T++)E[T]=C[T]*t.hdr.scl_slope+t.hdr.scl_inter}if(o<0&&j.warn("WARNING: Input image has value(s) below 0.0 !"),j.info(" Input:    min: "+o+"  max: "+l),n===0&&r===1)return[o,1];let u=0;for(let C=0;C<f;C++)Math.abs(h[C])>=1e-15&&u++;const m=1e3,g=(l-o)/m,p=new Array(m).fill(0);for(let C=0;C<f;C++){const E=h[C];let T=Math.floor((E-o)/g);T=Math.min(T,m-1),p[T]++}const v=new Array(m).fill(0);v[0]=p[0];for(let C=1;C<m;C++)v[C]=v[C-1]+p[C];let x=Math.floor(n*f),w=0;for(;w<m&&!(v[w]>=x);)w++;const b=o;for(o=w*g+b,x=f-Math.floor((1-r)*u),w=0;w<m-1&&!(v[w+1]>=x);)w++;l=w*g+b;let S=1;return o!==l&&(S=(i-e)/(l-o)),j.info(" Rescale:  min: "+o+"  max: "+l+" scale: "+S),[o,S]}conformVox2Vox(t,e,i=256,n=1,r=!1){const o=e.flat(),l=Ri(o[0],o[1],o[2],o[3],o[4],o[5],o[6],o[7],o[8],o[9],o[10],o[11],o[12],o[13],o[14],o[15]),h=ut(t[1]/2,t[2]/2,t[3]/2,1),f=cs(),u=Ge();Ni(u,l),qt(f,h,u);const m=he(f[0],f[1],f[2]),g=he(n,n,n);let p=Ri(-1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1);r&&(p=Ri(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)),Ni(p,p);const v=ut(i,i,i,1),x=Ge();v2(x,p,g);const w=ut(v[0],v[1],v[2],1);qt(w,w,x),A5(w,w,.5);const b=ot();ct(b,m,he(w[0],w[1],w[2]));const S=Ge();Ni(S,x),S[3]=b[0],S[7]=b[1],S[11]=b[2];const C=Ge();vi(C,S);const E=Ge();Rm(E,l,C);const T=Ge();return vi(T,E),[S,E,T]}async createNiftiArray(t=[256,256,256],e=[1,1,1],i=[1,0,0,-128,0,1,0,-128,0,0,1,-128,0,0,0,1],n=2,r=new Uint8Array){return await ni.createNiftiArray(t,e,i,n,r)}async niftiArray2NVImage(t=new Uint8Array){return await ni.loadFromUrl({url:t})}async loadFromUrl(t){return await ni.loadFromUrl({url:t})}async conform(t,e=!1,i=!0,n=!1,r=!1){const h=this.conformVox2Vox(t.hdr.dims,t.hdr.affine.flat(),256,1,e),f=h[0],u=h[2],m=256*256*256,g=new Float32Array(m),p=new Float32Array(t.img),v=t.hdr.dims[1]*t.hdr.dims[2]*t.hdr.dims[3];if(t.hdr.scl_slope!==1||t.hdr.scl_inter!==0)for(let I=0;I<v;I++)p[I]=p[I]*t.hdr.scl_slope+t.hdr.scl_inter;const x=t.hdr.dims[1],w=t.hdr.dims[2],b=t.hdr.dims[3],S=x*w;let C=-1;function E(I,B,U){return I+B*x+U*S}const T=u[0],D=u[4],R=u[8];if(i)for(let I=0;I<256;I++)for(let B=0;B<256;B++){const U=B*u[1]+I*u[2]+u[3],z=B*u[5]+I*u[6]+u[7],P=B*u[9]+I*u[10]+u[11];for(let K=0;K<256;K++){const _=K*T+U,H=K*D+z,q=K*R+P,se=Math.floor(_),G=Math.floor(H),W=Math.floor(q);if(C++,se<0||G<0||W<0)continue;const le=Math.ceil(_),ce=Math.ceil(H),fe=Math.ceil(q);if(le>=x||ce>=w||fe>=b)continue;const ye=_-se,me=H-G,He=q-W,ve=1-ye,ze=1-me,Ie=1-He,Je=E(se,G,W);let Ve=0;Ve+=p[Je]*ve*ze*Ie,Ve+=p[Je+S]*ve*ze*He,Ve+=p[Je+x]*ve*me*Ie,Ve+=p[Je+x+S]*ve*me*He,Ve+=p[Je+1]*ye*ze*Ie,Ve+=p[Je+1+S]*ye*ze*He,Ve+=p[Je+1+x]*ye*me*Ie,Ve+=p[Je+1+x+S]*ye*me*He,g[C]=Ve}}else for(let I=0;I<256;I++)for(let B=0;B<256;B++){const U=B*u[1]+I*u[2]+u[3],z=B*u[5]+I*u[6]+u[7],P=B*u[9]+I*u[10]+u[11];for(let K=0;K<256;K++){const _=Math.round(K*T+U),H=Math.round(K*D+z),q=Math.round(K*R+P);C++,!(_<0||H<0||q<0)&&(_>=x||H>=w||q>=b||(g[C]=p[E(_,H,q)]))}}let N=0;r&&(N=NaN);let M=new Uint8Array;if(n){const I=await this.getScale(t,0,1,N),B=await this.scalecropFloat32(g,0,1,I[0],I[1]);M=await this.createNiftiArray([256,256,256],[1,1,1],Array.from(f),16,new Uint8Array(B.buffer))}else{const I=await this.getScale(t,0,255,N),B=await this.scalecropUint8(g,0,255,I[0],I[1]);M=await this.createNiftiArray([256,256,256],[1,1,1],Array.from(f),2,B)}return await this.niftiArray2NVImage(M)}setRenderDrawAmbientOcclusion(t){if(!this.renderShader)throw new Error("renderShader undefined");this.renderDrawAmbientOcclusion=t,this.renderShader.use(this.gl),this.gl.uniform1fv(this.renderShader.uniforms.renderDrawAmbientOcclusion,[this.renderDrawAmbientOcclusion,1]),this.drawScene()}setColorMap(t,e){this.setColormap(t,e)}setColormapNegative(t,e){const i=this.getVolumeIndexByID(t);this.volumes[i].colormapNegative=e,this.updateGLVolume()}setModulationImage(t,e,i=0){const n=this.getVolumeIndexByID(t);let r=null;e.length>0&&(r=this.getVolumeIndexByID(e)),this.volumes[n].modulationImage=r,this.volumes[n].modulateAlpha=i,this.updateGLVolume()}setGamma(t=1){this.scene.gamma=t,et.gamma=t,this.updateGLVolume()}async loadDeferred4DVolumes(t){const e=this.getVolumeIndexByID(t),i=this.volumes[e];if(i.nTotalFrame4D<=i.nFrame4D)return;i.nTotalFrame4D=i.nFrame4D;let n;i.fileObject?n=await ni.loadFromFile({file:i.fileObject}):n=await ni.loadFromUrl({url:i.url}),n&&(i.img=n.img.slice(),i.nTotalFrame4D=n.nTotalFrame4D,i.nFrame4D=n.nFrame4D,this.updateGLVolume())}setFrame4D(t,e){const i=this.getVolumeIndexByID(t),n=this.volumes[i];e>n.nFrame4D-1&&(e=n.nFrame4D-1),e<0&&(e=0),e!==n.frame4D&&(n.frame4D=e,this.updateGLVolume(),this.onFrameChange(n,e),this.createOnLocationChange())}getFrame4D(t){const e=this.getVolumeIndexByID(t);return this.volumes[e].frame4D}colormapFromKey(t){return et.colormapFromKey(t)}colormap(t="",e=!1){return et.colormap(t,e)}createColormapTexture(t=null,e=0,i=256){return t!==null&&this.gl.deleteTexture(t),e<1||i<1?null:(t=this.gl.createTexture(),this.gl.activeTexture(Ll),this.gl.bindTexture(this.gl.TEXTURE_2D,t),this.gl.texStorage2D(this.gl.TEXTURE_2D,1,this.gl.RGBA8,i,e),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_R,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,1),t)}addColormapList(t="",e=NaN,i=NaN,n=!1,r=!1,o=!0,l=!1){t.length<1&&(o=!1),this.colormapLists.push({name:t,min:e,max:i,isColorbarFromZero:n,negative:r,visible:o,invert:l})}refreshColormaps(){if(this.colormapLists=[],this.volumes.length<1&&this.meshes.length<1)return;const t=this.volumes.length;if(t>0)for(let o=0;o<t;o++){const l=this.volumes[o],h=Vh(l.cal_min,l.cal_max,l.cal_minNeg,l.cal_maxNeg),f=l.colormapType!==0;this.addColormapList(l.colormapNegative,h[0],h[1],f,!0,l.colorbarVisible,l.colormapInvert),this.addColormapList(l.colormap,l.cal_min,l.cal_max,f,!1,l.colorbarVisible,l.colormapInvert)}const e=this.meshes.length;if(e>0)for(let o=0;o<e;o++){const l=this.meshes[o];if(!l.colorbarVisible)continue;const h=l.layers.length;if("edgeColormap"in l&&"edges"in l&&l.edges!==void 0){const f=Vh(l.edgeMin,l.edgeMax,NaN,NaN);this.addColormapList(l.edgeColormapNegative,f[0],f[1],!1,!0,!0,l.colormapInvert),this.addColormapList(l.edgeColormap,l.edgeMin,l.edgeMax,!1,!1,!0,l.colormapInvert)}if(!(h<1))for(let f=0;f<h;f++){const u=this.meshes[o].layers[f];if(!u.colorbarVisible||u.colormap.length<1)continue;const m=u.colormapType!==0,g=Vh(u.cal_min,u.cal_max,u.cal_minNeg,u.cal_maxNeg);this.addColormapList(u.colormapNegative,g[0],g[1],m,!0,!0,u.colormapInvert),this.addColormapList(u.colormap,u.cal_min,u.cal_max,m,!1,!0,u.colormapInvert)}}const i=this.colormapLists.length;if(i<1)return;this.colormapTexture=this.createColormapTexture(this.colormapTexture,i+1);let n=new Uint8ClampedArray;function r(o){const l=new Uint8ClampedArray(n.length+o.length);l.set(n),l.set(o,n.length),n=l}for(let o=0;o<i;o++)r(Array.from(this.colormap(this.colormapLists[o].name,this.colormapLists[o].invert)));return r(Array.from(this.drawLut.lut)),this.gl.texSubImage2D(this.gl.TEXTURE_2D,0,0,0,256,i+1,this.gl.RGBA,this.gl.UNSIGNED_BYTE,n),this}sliceScale(t=!1){var o;let e=this.screenFieldOfViewMM(0);t&&(e=this.screenFieldOfViewVox(0));const i=Math.max(e[0],Math.max(e[1],e[2])),n=[e[0]/i,e[1]/i,e[2]/i];if(!((o=this.back)!=null&&o.dims))throw new Error("back.dims undefined");const r=[this.back.dims[1],this.back.dims[2],this.back.dims[3]];return{volScale:n,vox:r,longestAxis:i,dimsMM:e}}tileIndex(t,e){for(let i=0;i<this.screenSlices.length;i++){const n=this.screenSlices[i].leftTopWidthHeight;if(t>n[0]&&e>n[1]&&t<n[0]+n[2]&&e<n[1]+n[3])return i}return-1}inRenderTile(t,e){const i=this.tileIndex(t,e);return i>=0&&this.screenSlices[i].axCorSag===4?i:-1}sliceScroll3D(t=0){if(t!==0){if(this.volumes.length>0&&this.scene.clipPlaneDepthAziElev[0]<1.8){const e=this.scene.clipPlaneDepthAziElev.slice();return t>0&&(e[0]=Math.min(1.5,e[0]+.025)),t<0&&(e[0]=Math.max(-1.5,e[0]-.025)),e[0]!==this.scene.clipPlaneDepthAziElev[0]?(this.scene.clipPlaneDepthAziElev=e,this.setClipPlane(this.scene.clipPlaneDepthAziElev)):void 0}t>0&&(this.scene.volScaleMultiplier=Math.min(2,this.scene.volScaleMultiplier*1.1)),t<0&&(this.scene.volScaleMultiplier=Math.max(.5,this.scene.volScaleMultiplier*.9)),this.drawScene()}}deleteThumbnail(){this.bmpTexture&&(this.gl.deleteTexture(this.bmpTexture),this.bmpTexture=null,this.thumbnailVisible=!1)}inGraphTile(t,e){if(this.graph.opacity<=0||this.volumes.length<1||this.volumes[0].nFrame4D<1||!this.graph.plotLTWH||this.graph.plotLTWH[2]<1||this.graph.plotLTWH[3]<1)return!1;const i=[(t-this.graph.LTWH[0])/this.graph.LTWH[2],(e-this.graph.LTWH[1])/this.graph.LTWH[3]];return i[0]>0&&i[1]>0&&i[0]<=1&&i[1]<=1}updateBitmapFromClickToSegment(){if(this.clickToSegmentGrowingBitmap===null||this.drawBitmap===null||this.clickToSegmentGrowingBitmap.length!==this.drawBitmap.length)return;const t=this.drawBitmap.length;for(let e=0;e<t;e++)this.drawBitmap[e]=this.clickToSegmentGrowingBitmap[e]}sumBitmap(t){let e=0;for(let i=0;i<t.length;i++)e+=t[i];return e}doClickToSegment(t){const{tileIndex:e}=t;if(e<0||e>=this.screenSlices.length){j.warn(`Invalid tileIndex ${e} received in doClickToSegment.`);return}const i=this.screenSlices[e].axCorSag;if(i>2){j.warn("ClickToSegment attempted on non-2D slice tile.");return}const n=this.screenXY2TextureFrac(this.clickToSegmentXY[0],this.clickToSegmentXY[1],e,!1);if(n[0]<0){j.debug("Click location outside valid texture fraction for the tile.");return}const r=this.frac2vox(n),o=this.opts.clickToSegmentPercent;let l=this.back.getValue(r[0],r[1],r[2]);this.opts.clickToSegmentAutoIntensity&&(o!==0&&(l===0&&(l=.01),this.opts.clickToSegmentIntensityMax=l*(1+o),this.opts.clickToSegmentIntensityMin=l*(1-o)),l>(this.back.cal_min+this.back.cal_max)*.5?this.opts.clickToSegmentBright=!0:this.opts.clickToSegmentBright=!1);const h=this.opts.clickToSegmentBright?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY;this.drawPenAxCorSag=i;const f=this.clickToSegmentIsGrowing?this.clickToSegmentGrowingBitmap:this.drawBitmap;if(!f){if(j.error("Target bitmap for flood fill is null."),this.clickToSegmentIsGrowing){if(this.drawBitmap||this.createEmptyDrawing(),!this.drawBitmap)return;this.clickToSegmentGrowingBitmap=this.drawBitmap.slice()}else if(this.createEmptyDrawing(),!this.drawBitmap)return;j.warn("Initialized missing bitmap in doClickToSegment.")}if(this.drawFloodFill([r[0],r[1],r[2]],this.opts.penValue,h,this.opts.clickToSegmentIntensityMin,this.opts.clickToSegmentIntensityMax,this.opts.floodFillNeighbors,this.opts.clickToSegmentMaxDistanceMM,this.opts.clickToSegmentIs2D,f),!this.clickToSegmentIsGrowing&&(j.debug("Applying clickToSegment mask to drawBitmap."),this.drawBitmap?(this.refreshDrawing(!1,!1),this.drawScene()):j.error("Cannot refresh drawing after click-to-segment apply, drawBitmap is null."),this.drawBitmap)){const u=this.getDescriptives({layer:0,masks:[],drawingIsMask:!0});this.onClickToSegment({mL:u.volumeML,mm3:u.volumeMM3})}this.createOnLocationChange(i)}mouseClick(t,e,i=0,n=!0){if(t*=this.uiData.dpr,e*=this.uiData.dpr,this.canvas.focus(),this.thumbnailVisible){this.thumbnailVisible=!1,Promise.all([this.loadVolumes(this.deferredVolumes),this.loadMeshes(this.deferredMeshes)]).catch(r=>{throw r});return}if(this.inGraphTile(t,e)){if(!this.graph.plotLTWH)throw new Error("plotLTWH undefined");const r=[(t-this.graph.plotLTWH[0])/this.graph.plotLTWH[2],(e-this.graph.plotLTWH[1])/this.graph.plotLTWH[3]];if(r[0]>0&&r[1]>0&&r[0]<=1&&r[1]<=1){const o=Math.round(r[0]*(this.volumes[0].nFrame4D-1));this.setFrame4D(this.volumes[0].id,o);return}r[0]>.5&&r[1]>1&&this.loadDeferred4DVolumes(this.volumes[0].id).catch(o=>{throw o});return}if(this.inRenderTile(t,e)>=0){this.sliceScroll3D(i),this.drawScene();return}if(!(this.screenSlices.length<1||this.gl.canvas.height<1||this.gl.canvas.width<1))for(let r=0;r<this.screenSlices.length;r++){const o=this.screenSlices[r].axCorSag;if(this.drawPenAxCorSag>=0&&this.drawPenAxCorSag!==o||o>2&&!this.opts.clickToSegment&&i===0)continue;const l=this.screenXY2TextureFrac(t,e,r,!0);if(!(l[0]<0)){if(i!==0||!n){if(!n){o<=2&&(this.scene.crosshairPos[2-o]=i,this.drawScene(),this.createOnLocationChange(o));return}const h=i<0?-1:1,f=[0,0,0];o<=2&&(f[2-o]=h,this.moveCrosshairInVox(f[0],f[1],f[2]));return}if(this.opts.isForceMouseClickToVoxelCenters?this.scene.crosshairPos=jr(this.vox2frac(this.frac2vox(l))):this.scene.crosshairPos=jr(l),this.opts.drawingEnabled){const h=this.frac2vox(this.scene.crosshairPos);if(!isFinite(this.opts.penValue)||this.opts.penValue<0||Object.is(this.opts.penValue,-0)){let f=0,u=Math.abs(this.opts.penValue);const m=!0;Object.is(this.opts.penValue,-0)?(f=0,u=0,j.debug("Erase Cluster selected")):(f=this.opts.penValue,j.debug("Intensity Grow selected",f)),this.drawFloodFill(h,u,f,NaN,NaN,this.opts.floodFillNeighbors,Number.POSITIVE_INFINITY,!1,this.drawBitmap,m),this.drawScene(),this.createOnLocationChange(o);return}else if(this.opts.clickToSegment){o<=2&&(this.clickToSegmentIsGrowing=!1,this.doClickToSegment({x:this.clickToSegmentXY[0],y:this.clickToSegmentXY[1],tileIndex:r})),this.createOnLocationChange(o);return}else{if(isNaN(this.drawPenLocation[0]))this.drawPenAxCorSag=o,this.drawPenFillPts=[],this.drawPt(...h,this.opts.penValue);else{if(h[0]===this.drawPenLocation[0]&&h[1]===this.drawPenLocation[1]&&h[2]===this.drawPenLocation[2]){this.drawScene(),this.createOnLocationChange(o);return}this.drawPenLine(h,this.drawPenLocation,this.opts.penValue)}this.drawPenLocation=h,this.opts.isFilledPen&&this.drawPenFillPts.push(h),this.refreshDrawing(!1,!1)}}this.drawScene(),this.createOnLocationChange(o);return}}}drawRuler(){let t=[],e=[];for(let m=0;m<this.screenSlices.length;m++)if(this.screenSlices[m].axCorSag!==4&&this.screenSlices[m].fovMM.length>1){e=this.screenSlices[m].leftTopWidthHeight,t=this.screenSlices[m].fovMM;break}if(e.length<4)return;const n=100/t[0]*e[2],r=Math.max(Math.round(n*.1),2),o=Math.floor(e[0]+.5*e[2]-.5*n),l=Number(this.opts.rulerWidth),h=Math.floor(e[1]+e[3]-r)+.5*l,f=[o,h,o+n,h];let u=[0,0,0,1];this.opts.rulerColor[0]+this.opts.rulerColor[1]+this.opts.rulerColor[2]<.8&&(u=[1,1,1,1]),this.drawRuler10cm(f,u,l+1),this.drawRuler10cm(f,this.opts.rulerColor,l)}drawRuler10cm(t,e,i=1){if(!this.lineShader)throw new Error("lineShader undefined");this.gl.bindVertexArray(this.genericVAO),this.lineShader.use(this.gl),this.gl.uniform4fv(this.lineShader.uniforms.lineColor,e),this.gl.uniform2fv(this.lineShader.uniforms.canvasWidthHeight,[this.gl.canvas.width,this.gl.canvas.height]),this.gl.uniform1f(this.lineShader.uniforms.thickness,i),this.gl.uniform4fv(this.lineShader.uniforms.startXYendXY,t),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4);const n=-.1*(t[0]-t[2]),r=t[1]-Math.floor(.5*this.opts.rulerWidth),o=Math.floor(r-.35*n),l=Math.floor(r-.7*n);for(let h=0;h<11;h++){let f=t[0]+h*n;f=Math.max(f,t[0]+.5*i),f=Math.min(f,t[2]-.5*i);const u=[f,r,f,o];h%5===0&&(u[3]=l),this.gl.uniform4fv(this.lineShader.uniforms.startXYendXY,u),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4)}this.gl.bindVertexArray(this.unusedVAO)}screenXY2mm(t,e,i=-1){let n;for(let r=0;r<this.screenSlices.length;r++){let o=r;if(i>=0&&(o=i),this.screenSlices[o].axCorSag>2)continue;const h=this.screenSlices[o].leftTopWidthHeight;if(t<h[0]||e<h[1]||t>h[0]+h[2]||e>h[1]+h[3]||(n=this.screenXY2TextureFrac(t,e,o,!1),n[0]<0))continue;const f=this.frac2mm(n);return ut(f[0],f[1],f[2],o)}return ut(NaN,NaN,NaN,NaN)}dragForPanZoom(t){const e=this.screenXY2mm(t[2],t[3]);if(isNaN(e[0]))return;const i=this.screenXY2mm(t[0],t[1],e[3]);if(isNaN(i[0])||isNaN(e[0])||isNaN(e[3]))return;const n=cs(),r=this.uiData.pan2DxyzmmAtMouseDown[3];v5(n,e,i),this.scene.pan2Dxyzmm[0]=this.uiData.pan2DxyzmmAtMouseDown[0]+r*n[0],this.scene.pan2Dxyzmm[1]=this.uiData.pan2DxyzmmAtMouseDown[1]+r*n[1],this.scene.pan2Dxyzmm[2]=this.uiData.pan2DxyzmmAtMouseDown[2]+r*n[2],this.canvas.focus()}dragForCenterButton(t){this.dragForPanZoom(t)}dragForSlicer3D(t){let e=this.uiData.pan2DxyzmmAtMouseDown[3];const i=t[3]-t[1];e+=i*.01,e=Math.max(e,.1),e=Math.min(e,10);const r=this.scene.pan2Dxyzmm[3]-e;this.opts.yoke3Dto2DZoom&&(this.scene.volScaleMultiplier=e),this.scene.pan2Dxyzmm[3]=e;const o=this.frac2mm(this.scene.crosshairPos);this.scene.pan2Dxyzmm[0]+=r*o[0],this.scene.pan2Dxyzmm[1]+=r*o[1],this.scene.pan2Dxyzmm[2]+=r*o[2]}drawMeasurementTool(t){function e(f,u,m,g,p){const v=f-m,x=u-g;if(v===0&&x===0)return{origin:[m+p,g],terminus:[m+p,g]};const w=Math.sqrt(v*v+x*x),b=p*v/w,S=p*x/w;return{origin:[f+b,u+S],terminus:[m-b,g-S]}}const i=this.gl;if(i.bindVertexArray(this.genericVAO),i.depthFunc(i.ALWAYS),i.enable(i.BLEND),i.blendFunc(i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA),!this.lineShader)throw new Error("lineShader undefined");this.lineShader.use(this.gl),i.uniform4fv(this.lineShader.uniforms.lineColor,this.opts.rulerColor),i.uniform2fv(this.lineShader.uniforms.canvasWidthHeight,[i.canvas.width,i.canvas.height]),i.uniform1f(this.lineShader.uniforms.thickness,this.opts.rulerWidth),i.uniform4fv(this.lineShader.uniforms.startXYendXY,t),i.drawArrays(i.TRIANGLE_STRIP,0,4);const n=this.opts.measureLineColor;n[3]=1,i.uniform4fv(this.lineShader.uniforms.lineColor,n);const r=this.opts.rulerWidth;i.uniform1f(this.lineShader.uniforms.thickness,r*2);let o=[t[0],t[1]-r,t[0],t[1]+r];i.uniform4fv(this.lineShader.uniforms.startXYendXY,o),i.drawArrays(i.TRIANGLE_STRIP,0,4),o=[t[2],t[3]-r,t[2],t[3]+r],i.uniform4fv(this.lineShader.uniforms.startXYendXY,o),i.drawArrays(i.TRIANGLE_STRIP,0,4);let l=this.canvasPos2frac([t[0],t[1]]),h=this.canvasPos2frac([t[2],t[3]]);if(l[0]>=0&&h[0]>=0){const f=this.frac2mm(l);l=he(f[0],f[1],f[2]);const u=this.frac2mm(h);h=he(u[0],u[1],u[2]);const m=ot();y2(m,l,h);const g=Qr(m);let p=2;g>9&&(p=1),g>99&&(p=0);let v=g.toFixed(p);this.opts.showMeasureUnits&&(v=`${v} mm`);let x=t;const[w,b,S,C]=t,{origin:E,terminus:T}=e(w,b,S,C,30);switch(this.opts.measureTextJustify){case"start":x=[...E,...E.map(D=>D+1)];break;case"end":x=x=[...T,...T.map(D=>D+1)];break;default:x=t;break}this.drawTextBetween(x,v,this.opts.measureTextHeight/this.opts.textHeight,this.opts.measureTextColor)}i.bindVertexArray(this.unusedVAO)}drawRect(t,e=[1,0,0,-1]){if(e[3]<0&&(e=this.opts.crosshairColor),!this.rectShader)throw new Error("rectShader undefined");this.opts.selectionBoxIsOutline?(this.drawCircle(t,e,.1),this.rectOutlineShader.use(this.gl),this.gl.enable(this.gl.BLEND),this.gl.uniform1f(this.rectOutlineShader.uniforms.thickness,this.opts.selectionBoxLineThickness),this.gl.uniform4fv(this.rectOutlineShader.uniforms.lineColor,e),this.gl.uniform2fv(this.rectOutlineShader.uniforms.canvasWidthHeight,[this.gl.canvas.width,this.gl.canvas.height]),this.gl.uniform4f(this.rectOutlineShader.uniforms.leftTopWidthHeight,t[0],t[1],t[2],t[3]),this.gl.bindVertexArray(this.genericVAO),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),this.gl.bindVertexArray(this.unusedVAO)):(this.rectShader.use(this.gl),this.gl.enable(this.gl.BLEND),this.gl.uniform4fv(this.rectShader.uniforms.lineColor,e),this.gl.uniform2fv(this.rectShader.uniforms.canvasWidthHeight,[this.gl.canvas.width,this.gl.canvas.height]),this.gl.uniform4f(this.rectShader.uniforms.leftTopWidthHeight,t[0],t[1],t[2],t[3]),this.gl.bindVertexArray(this.genericVAO),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),this.gl.bindVertexArray(this.unusedVAO))}drawCircle(t,e=this.opts.fontColor,i=1){if(!this.circleShader)throw new Error("circleShader undefined");this.circleShader.use(this.gl),this.gl.enable(this.gl.BLEND),this.gl.uniform4fv(this.circleShader.uniforms.circleColor,e),this.gl.uniform2fv(this.circleShader.uniforms.canvasWidthHeight,[this.gl.canvas.width,this.gl.canvas.height]),this.gl.uniform4f(this.circleShader.uniforms.leftTopWidthHeight,t[0],t[1],t[2],t[3]),this.gl.uniform1f(this.circleShader.uniforms.fillPercent,i),this.gl.uniform4fv(this.circleShader.uniforms.circleColor,e),this.gl.bindVertexArray(this.genericVAO),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),this.gl.bindVertexArray(this.unusedVAO)}drawSelectionBox(t){if(this.opts.dragMode===6){this.drawCircle(t,this.opts.selectionBoxColor,.1);return}this.drawRect(t,this.opts.selectionBoxColor)}effectiveCanvasHeight(){return this.gl.canvas.height-this.colorbarHeight}effectiveCanvasWidth(){return this.gl.canvas.width-this.getLegendPanelWidth()}getAllLabels(){const n=this.meshes.filter(o=>o.type==="connectome").flatMap(o=>o.nodes).map(o=>o.label).filter(o=>o!==void 0);return[...this.document.labels,...n]}getConnectomeLabels(){const n=this.meshes.filter(h=>h.type==="connectome").flatMap(h=>h.nodes).map(h=>h.label).filter(h=>h!==void 0),r=this.document.labels.filter(h=>h.anchor==null||h.anchor===0),o=new Set(n);for(const h of r)o.add(h);const l=this.meshes.filter(h=>h.type==="mesh");for(let h=0;h<l.length;h++)for(let f=0;f<l[h].layers.length;f++)if(l[h].layers[f].labels)for(let u=0;u<l[h].layers[f].labels.length;u++)o.add(l[h].layers[f].labels[u]);return Array.from(o)}getBulletMarginWidth(){let t=0;const e=this.getConnectomeLabels();if(e.length===0)return 0;const i=e.length===1?e[0].style.bulletScale:e.reduce((o,l)=>o.style.bulletScale>l.style.bulletScale?o:l).style.bulletScale,n=e.length===1?e[0]:e.reduce((o,l)=>{const h=this.opts.textHeight*this.gl.canvas.height*o.style.textScale,f=this.opts.textHeight*this.gl.canvas.height*l.style.textScale;return this.textHeight(h,o.text)>this.textHeight(f,l.text)?o:l}),r=this.opts.textHeight*this.gl.canvas.height*n.style.textScale;return t=this.textHeight(r,n.text)*i,t+=r,t}getLegendPanelWidth(){const t=this.getConnectomeLabels();if(!this.opts.showLegend||t.length===0)return 0;const i=this.opts.textHeight*this.gl.canvas.height*1;let n=0;const r=t.reduce((f,u)=>{const m=this.opts.textHeight*this.gl.canvas.height*f.style.textScale,g=this.opts.textHeight*this.gl.canvas.height*u.style.textScale;return this.textWidth(m,f.text)>this.textWidth(g,u.text)?f:u}),o=this.opts.textHeight*this.gl.canvas.height*r.style.textScale,l=this.textWidth(o,r.text),h=this.getBulletMarginWidth();return l&&(n=h+l,n+=i*2),n>=this.gl.canvas.width?0:n}getLegendPanelHeight(){const t=this.getConnectomeLabels();let e=0;const i=this.opts.textHeight*this.gl.canvas.height;for(const n of t){const r=this.opts.textHeight*this.gl.canvas.height*n.style.textScale,o=this.textHeight(r,n.text);e+=o}return e&&(e+=i/2*(t.length+1)),e}reserveColorbarPanel(){let t=Math.max(this.opts.textHeight,.01);t=t*Math.min(this.gl.canvas.height,this.gl.canvas.width);const e=3*t,n=(this.opts.colorbarWidth>0&&this.opts.colorbarWidth<=1?this.opts.colorbarWidth:1)*this.gl.canvas.width,r=[(this.gl.canvas.width-n)/2,this.gl.canvas.height-e,n,e];return this.colorbarHeight=r[3]+1,r}drawColorbarCore(t=0,e=[0,0,0,0],i=!1,n=0,r=1,o){if(e[2]<=0||e[3]<=0)return;let l=Math.max(this.opts.textHeight,.01);l=l*Math.min(this.gl.canvas.height,this.gl.canvas.width);let h=l;const f=3*l;let u=l;if(e[3]<f){if(e[3]<3)return;h=1,u=e[3]-2}this.gl.disable(this.gl.DEPTH_TEST),this.colorbarHeight=e[3]+1;const m=[e[0]+h,e[1],e[2]-2*h,u],g=[m[0]-1,m[1]-1,m[2]+2,m[3]+2];if(this.opts.showColorbarBorder&&this.drawRect(g,this.opts.crosshairColor),!this.colorbarShader)throw new Error("colorbarShader undefined");this.colorbarShader.use(this.gl),this.gl.activeTexture(Ll),this.gl.bindTexture(this.gl.TEXTURE_2D,this.colormapTexture),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.NEAREST);const p=t;if(this.gl.uniform1f(this.colorbarShader.uniforms.layer,p),this.gl.uniform2fv(this.colorbarShader.uniforms.canvasWidthHeight,[this.gl.canvas.width,this.gl.canvas.height]),this.gl.disable(this.gl.CULL_FACE),i){const R=[m[0]+m[2],m[1],-m[2],m[3]];this.gl.uniform4fv(this.colorbarShader.uniforms.leftTopWidthHeight,R)}else this.gl.uniform4fv(this.colorbarShader.uniforms.leftTopWidthHeight,m);this.gl.bindVertexArray(this.genericVAO),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),this.gl.bindVertexArray(this.unusedVAO),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR);let v=0;if(o&&r<0&&i?(v=r,r=0):o&&n>0&&(v=n,n=0),n===r||l<1)return;const x=Math.abs(r-n);let[w,b]=W2(n,r);b<n&&(b+=w);function S(R){return R.toFixed(6).replace(/\.?0*$/,"")}let C=b;const E=[0,m[1]+m[3]-l*.5,2,l*.75],T=E[1]+E[3],D=1;for(;C<=r;){E[0]=m[0]+(C-n)/x*m[2],this.drawRect(E);const R=S(D*C);this.drawTextBelow([E[0],T],R),C+=w}if(v!==0){const R=[m[0]+(v-n)/x*m[2],m[1]-m[3]*.25,2,m[3]*1.5];this.drawRect(R)}}drawColorbar(){const t=this.colormapLists,e=t.length;if(e<1)return;let i=0;for(let h=0;h<e;h++)t[h].visible&&i++;if(i<1)return;let n=this.reserveColorbarPanel(),r=Math.max(this.opts.textHeight,.01);r=r*Math.min(this.gl.canvas.height,this.gl.canvas.width);const o=3*r;let l=n[2]/i;(n[2]<=0||n[3]<=0)&&(l=this.gl.canvas.width/i,n=[0,this.gl.canvas.height-o,l,o]),n[2]=l;for(let h=0;h<e;h++)t[h].visible&&(this.drawColorbarCore(h,n,t[h].negative,t[h].min,t[h].max,t[h].isColorbarFromZero),n[0]+=l)}textWidth(t,e){if(!e)return 0;let i=0;const n=new TextEncoder().encode(e);for(let r=0;r<e.length;r++)i+=t*this.fontMets.mets[n[r]].xadv;return i}textHeight(t,e){if(!e)return 0;const i=new Set(Array.from(e)),n=new TextEncoder().encode(Array.from(i).join("")),o=Object.values(this.fontMets.mets).filter((l,h)=>n.includes(h)).reduce((l,h)=>l.lbwh[3]>h.lbwh[3]?l:h).lbwh[3];return t*o}drawChar(t,e,i){if(!this.fontShader)throw new Error("fontShader undefined");const n=this.fontMets.mets[i],r=t[0]+e*n.lbwh[0],o=-(e*n.lbwh[1]),l=e*n.lbwh[2],h=e*n.lbwh[3],f=t[1]+(o-h)+e;return this.gl.uniform4f(this.fontShader.uniforms.leftTopWidthHeight,r,f,l,h),this.gl.uniform4fv(this.fontShader.uniforms.uvLeftTopWidthHeight,n.uv_lbwh),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),e*n.xadv}drawLoadingText(t){if(t){if(!this.canvas)throw new Error("canvas undefined");this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height),this.gl.enable(this.gl.CULL_FACE),this.gl.enable(this.gl.BLEND),this.drawTextBelow([this.canvas.width/2,this.canvas.height/2],t,3)}}drawText(t,e,i=1,n=null){if(this.opts.textHeight<=0)return;if(!this.fontShader)throw new Error("fontShader undefined");this.fontShader.use(this.gl);const r=this.opts.textHeight*Math.min(this.gl.canvas.height,this.gl.canvas.width)*i;this.gl.enable(this.gl.BLEND),this.gl.uniform2f(this.fontShader.uniforms.canvasWidthHeight,this.gl.canvas.width,this.gl.canvas.height),n===null&&(n=this.opts.fontColor),this.gl.uniform4fv(this.fontShader.uniforms.fontColor,n);let o=r/this.fontMets.size*this.fontMets.distanceRange;o=Math.max(o,1),this.gl.uniform1f(this.fontShader.uniforms.screenPxRange,o);const l=new TextEncoder().encode(e);this.gl.bindVertexArray(this.genericVAO);for(let h=0;h<e.length;h++)t[0]+=this.drawChar(t,r,l[h]);this.gl.bindVertexArray(this.unusedVAO)}drawTextRight(t,e,i=1,n=null){this.opts.textHeight<=0||(t[1]-=.5*this.opts.textHeight*this.gl.canvas.height,this.drawText(t,e,i,n))}drawTextLeft(t,e,i=1,n=null){if(this.opts.textHeight<=0)return;const r=this.opts.textHeight*this.gl.canvas.height*i;t[0]-=this.textWidth(r,e),t[1]-=.5*r,this.drawText(t,e,i,n)}drawTextRightBelow(t,e,i=1,n=null){this.opts.textHeight<=0||this.drawText(t,e,i,n)}drawTextBetween(t,e,i=1,n=null){if(this.opts.textHeight<=0)return;const r=[(t[0]+t[2])*.5,(t[1]+t[3])*.5],o=this.opts.textHeight*this.gl.canvas.height*i,l=this.textWidth(o,e);r[0]-=.5*l,r[1]-=.5*o;const h=[r[0]-1,r[1]-1,l+2,o+2];let f=n;f===null&&(f=this.opts.crosshairColor),f&&f[0]+f[1]+f[2]>.8?f=[0,0,0,.5]:f=[1,1,1,.5],this.drawRect(h,f),this.drawText(r,e,i,n)}drawTextBelow(t,e,i=1,n=null){if(this.opts.textHeight<=0)return;if(!this.canvas)throw new Error("canvas undefined");let r=this.opts.textHeight*this.gl.canvas.height*i,o=this.textWidth(r,e);o>this.canvas.width&&(i*=(this.canvas.width-2)/o,r=this.opts.textHeight*this.gl.canvas.height*i,o=this.textWidth(r,e)),t[0]-=.5*this.textWidth(r,e),t[0]=Math.max(t[0],1),t[0]=Math.min(t[0],this.canvas.width-o-1),this.drawText(t,e,i,n)}updateInterpolation(t,e=!1){let i=this.gl.LINEAR;!e&&this.opts.isNearestInterpolation&&(i=this.gl.NEAREST),t===0?this.gl.activeTexture(Sa):this.gl.activeTexture(Lh),this.opts.is2DSliceShader?(this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,i),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,i)):(this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_MIN_FILTER,i),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_MAG_FILTER,i))}setAtlasOutline(t){this.opts.atlasOutline=t,this.updateGLVolume(),this.drawScene()}setInterpolation(t){this.opts.isNearestInterpolation=t;const e=this.volumes.length;if(!(e<1)){for(let i=0;i<e;i++)this.updateInterpolation(i);this.drawScene()}}calculateMvpMatrix2D(t,e,i,n=1/0,r=0,o=0,l=0,h){this.gl.viewport(t[0],this.gl.canvas.height-(t[1]+t[3]),t[2],t[3]);let u=e[0],m=i[0],g=[u,e[1]],p=[m-u,i[1]-e[1]];h&&(g=[i[0],e[1]],p=[e[0]-i[0],i[1]-e[1]],u=-i[0],m=-e[0]);const v=2*Math.max(Math.abs(e[2]),Math.abs(i[2])),x=Ge();let w=.01,b=v*8;if(n!==1/0){let R=h;l===0&&(o===0||o===180)&&(R=!R);let N=v*1.8-r;R||(N=v*1.8+r),w=N-n,b=N+n}Rl(x,u,m,e[1],i[1],w,b);const S=Ge();S[0]=-1;const C=he(0,0,-v*1.8);Ta(S,S,C),Dl(S,S,en(270-l)),Nl(S,S,en(o-180));const E=Ge();vi(E,S);const T=Ge();Ni(T,E);const D=Ge();return sn(D,x,S),{modelViewProjectionMatrix:D,modelMatrix:S,normalMatrix:T,leftTopMM:g,fovMM:p}}swizzleVec3MM(t,e){return e===1?t=si(t,[0,2,1]):e===2&&(t=si(t,[1,2,0])),t}screenFieldOfViewVox(t=0){const e=jr(this.volumeObject3D.fieldOfViewDeObliqueMM);return this.swizzleVec3MM(e,t)}screenFieldOfViewMM(t=0,e=!1){if(this.volumes.length<1){let h=he(this.extentsMin[0],this.extentsMin[1],this.extentsMin[2]),f=he(this.extentsMax[0],this.extentsMax[1],this.extentsMax[2]);h=this.swizzleVec3MM(h,t),f=this.swizzleVec3MM(f,t);const u=ot();return ct(u,f,h),u}if(!e&&!this.opts.isSliceMM)return this.screenFieldOfViewVox(t);const i=this.volumeObject3D.extentsMin,n=this.volumeObject3D.extentsMax;let r=he(i[0],i[1],i[2]),o=he(n[0],n[1],n[2]);r=this.swizzleVec3MM(r,t),o=this.swizzleVec3MM(o,t);const l=ot();return ct(l,o,r),l}screenFieldOfViewExtendedVox(t=0){const e=this.volumes[0].extentsMinOrtho,i=this.volumes[0].extentsMaxOrtho;let n=he(e[0],e[1],e[2]),r=he(i[0],i[1],i[2]);const o=Ge();n=this.swizzleVec3MM(n,t),r=this.swizzleVec3MM(r,t);const l=ot();return ct(l,r,n),{mnMM:n,mxMM:r,rotation:o,fovMM:l}}screenFieldOfViewExtendedMM(t=0){if(this.volumes.length<1){let h=he(this.extentsMin[0],this.extentsMin[1],this.extentsMin[2]),f=he(this.extentsMax[0],this.extentsMax[1],this.extentsMax[2]);const u=Ge();h=this.swizzleVec3MM(h,t),f=this.swizzleVec3MM(f,t);const m=ot();return ct(m,f,h),{mnMM:h,mxMM:f,rotation:u,fovMM:m}}if(!this.volumeObject3D)throw new Error("volumeObject3D undefined");const e=this.volumeObject3D.extentsMin,i=this.volumeObject3D.extentsMax;let n=he(e[0],e[1],e[2]),r=he(i[0],i[1],i[2]);const o=Ge();n=this.swizzleVec3MM(n,t),r=this.swizzleVec3MM(r,t);const l=ot();return ct(l,r,n),{mnMM:n,mxMM:r,rotation:o,fovMM:l}}drawSliceOrientationText(t,e,i=[NaN,NaN]){this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height);let n="S";e===0&&(n="A");let r=this.opts.isRadiologicalConvention?"R":"L";if(e===2&&(r=this.opts.sagittalNoseLeft?"A":"P"),this.opts.isCornerOrientationText){this.drawTextRightBelow([t[0],t[1]],r+n);return}let o=!0,l=!0;if(!isNaN(i[0])){const h=this.opts.textHeight*this.gl.canvas.height+2;i[1]>h&&(this.drawTextBelow([t[0]+t[2]*.5,t[1]+i[1]-h],n),o=!1);const f=this.textWidth(h,r)+2;i[0]>f&&(this.drawTextRight([t[0]+i[0]-f,t[1]+t[3]*.5],r),l=!1)}o&&this.drawTextBelow([t[0]+t[2]*.5,t[1]],n),l&&this.drawTextRight([t[0],t[1]+t[3]*.5],r)}xyMM2xyzMM(t,e){let i=2;t===1&&(i=1),t===2&&(i=0);let n=[0,0,0],r=[1,1,0],o=[1,0,1];n[i]=e,r[i]=e,o[i]=e,n=this.frac2mm(n),r=this.frac2mm(r),o=this.frac2mm(o),n=this.swizzleVec3MM(he(n[0],n[1],n[2]),t),r=this.swizzleVec3MM(he(r[0],r[1],r[2]),t),o=this.swizzleVec3MM(he(o[0],o[1],o[2]),t);const l=(r[0]-n[0])*(o[1]-n[1])-(o[0]-n[0])*(r[1]-n[1]);let h=(r[0]-n[0])*(o[2]-n[2])-(o[0]-n[0])*(r[2]-n[2]);h/=l;let f=(r[1]-n[1])*(o[2]-n[2])-(o[1]-n[1])*(r[2]-n[2]);f/=l;const u=[0,0,0,0,0];return u[0]=n[0],u[1]=n[1],u[2]=n[2],u[3]=f,u[4]=h,u}draw2DMain(t,e,i=NaN){let n=new Float32Array([0,0,0]);this.volumes.length>0&&(n=new Float32Array(this.volumes[0].frac2mm.slice()));let r=this.screenFieldOfViewExtendedMM(e),o=Ge();!this.opts.isSliceMM&&this.volumes.length>0&&(n=new Float32Array(this.volumes[0].frac2mmOrtho.slice()),o=Rt(this.volumes[0].mm2ortho),r=this.screenFieldOfViewExtendedVox(e));let l=this.opts.isRadiologicalConvention&&e<2;i===1/0||i===-1/0?(l=i!==1/0,e===1&&(l=!l)):this.opts.sagittalNoseLeft&&e===2&&(l=!l);let h=0,f=0;e===2?f=l?90:-90:e===1?f=l?180:0:(f=l?180:0,h=l?-90:90);const u=this.gl;let m=!1;if(t[2]===0||t[3]===0){m=!0;const b=u.canvas.width/r.fovMM[0],S=u.canvas.height/r.fovMM[1],C=Math.min(b,S),E=b/C,T=S/C;r.fovMM[0]*=E,r.fovMM[1]*=T;let D=(r.mnMM[0]+r.mxMM[0])*.5;r.mnMM[0]=D-r.fovMM[0]*.5,r.mxMM[0]=D+r.fovMM[0]*.5,D=(r.mnMM[1]+r.mxMM[1])*.5,r.mnMM[1]=D-r.fovMM[1]*.5,r.mxMM[1]=D+r.fovMM[1]*.5,t=[0,0,u.canvas.width,u.canvas.height]}if(isNaN(i)){const b=this.scene.pan2Dxyzmm,S=this.swizzleVec3MM(he(b[0],b[1],b[2]),e),C=this.scene.pan2Dxyzmm[3];r.mnMM[0]-=S[0],r.mxMM[0]-=S[0],r.mnMM[1]-=S[1],r.mxMM[1]-=S[1],r.mnMM[0]/=C,r.mxMM[0]/=C,r.mnMM[1]/=C,r.mxMM[1]/=C}let g=2;e===1&&(g=1),e===2&&(g=0);let p=this.scene.crosshairPos[g],v=this.frac2mm(this.scene.crosshairPos);!isNaN(i)&&i!==1/0&&i!==-1/0&&(v=this.frac2mm([.5,.5,.5]),v[g]=i,p=this.mm2frac(v)[g]);const x=v[g];u.clear(u.DEPTH_BUFFER_BIT);let w=this.calculateMvpMatrix2D(t,r.mnMM,r.mxMM,1/0,0,f,h,l);if(i===1/0||i===-1/0){const b=t.slice();this.draw3D(t,w.modelViewProjectionMatrix,w.modelMatrix,w.normalMatrix,f,h);const S=this.screenSlices[this.screenSlices.length-1];S.leftTopWidthHeight=b,S.axCorSag=e,S.sliceFrac=1/0,S.AxyzMxy=this.xyMM2xyzMM(e,p),S.leftTopMM=w.leftTopMM,S.fovMM=w.fovMM;return}if(u.enable(u.DEPTH_TEST),u.blendFunc(u.SRC_ALPHA,u.ONE_MINUS_SRC_ALPHA),u.disable(u.BLEND),u.depthFunc(u.GREATER),u.disable(u.CULL_FACE),this.volumes.length>0){let b=this.sliceMMShader;if(this.opts.is2DSliceShader&&(b=this.slice2DShader),this.opts.isV1SliceShader&&(b=this.sliceV1Shader),!b)throw new Error("slice Shader undefined");b.use(this.gl),u.uniform1f(b.uniforms.overlayOutlineWidth,this.overlayOutlineWidth),u.uniform1f(b.uniforms.overlayAlphaShader,this.overlayAlphaShader),u.uniform1i(b.uniforms.isAlphaClipDark,this.isAlphaClipDark?1:0),u.uniform1i(b.uniforms.backgroundMasksOverlays,this.backgroundMasksOverlays),u.uniform1f(b.uniforms.drawOpacity,this.drawOpacity),u.enable(u.BLEND),u.blendFunc(u.SRC_ALPHA,u.ONE_MINUS_SRC_ALPHA),u.uniform1f(b.uniforms.opacity,this.volumes[0].opacity),u.uniform1i(b.uniforms.axCorSag,e),u.uniform1f(b.uniforms.slice,p),u.uniformMatrix4fv(b.uniforms.frac2mm,!1,n),u.uniformMatrix4fv(b.uniforms.mvpMtx,!1,w.modelViewProjectionMatrix.slice()),u.bindVertexArray(this.genericVAO),u.drawArrays(u.TRIANGLE_STRIP,0,4),u.bindVertexArray(this.unusedVAO),this.screenSlices.push({leftTopWidthHeight:t,axCorSag:e,sliceFrac:p,AxyzMxy:this.xyMM2xyzMM(e,p),leftTopMM:w.leftTopMM,screen2frac:[],fovMM:w.fovMM})}if(isNaN(i)&&this.drawCrosshairs3D(!0,1,w.modelViewProjectionMatrix,!0,this.opts.isSliceMM),this.opts.meshThicknessOn2D>0){this.opts.meshThicknessOn2D!==1/0&&(w=this.calculateMvpMatrix2D(t,r.mnMM,r.mxMM,this.opts.meshThicknessOn2D,x,f,h,l));const b=Rt(w.modelViewProjectionMatrix);sn(b,b,o),this.drawMesh3D(!0,1,b,w.modelMatrix,w.normalMatrix)}isNaN(i)&&this.drawCrosshairs3D(!1,.15,w.modelViewProjectionMatrix,!0,this.opts.isSliceMM),m&&this.opts.isOrientationTextVisible&&this.drawSliceOrientationText(t,e),this.readyForSync=!0}draw2D(t,e,i=NaN,n=[NaN,NaN]){const r=[NaN,NaN];if(n[0]===1/0){const o=this.sliceScale().volScale;let l=this.scaleSlice(o[0],o[1],[0,0],[t[2],t[3]]);e===1&&(l=this.scaleSlice(o[0],o[2],[0,0],[t[2],t[3]])),e===2&&(l=this.scaleSlice(o[1],o[2],[0,0],[t[2],t[3]])),n[0]=l[2],n[1]=l[3]}if(isNaN(n[0]))this.draw2DMain(t,e,i);else{const o=t.slice();r[0]=Math.floor(.5*(o[2]-n[0])),r[1]=Math.floor(.5*(o[3]-n[1])),o[0]+=r[0],o[1]+=r[1],o[2]=n[0],o[3]=n[1],this.draw2DMain(o,e,i)}i===1/0||i===-1/0||e===4||t[2]!==0&&t[3]!==0&&this.opts.isOrientationTextVisible&&this.drawSliceOrientationText(t,e,r)}calculateMvpMatrix(t,e=[0,0,0,0],i,n){(e[2]===0||e[3]===0)&&(e=[0,0,this.gl.canvas.width,this.gl.canvas.height]);const r=e[2]/e[3];let o=this.furthestFromPivot;const l=this.pivot3D,h=Ge();o=.8*o/this.scene.volScaleMultiplier,r<1?Rl(h,-o,o,-o/r,o/r,o*.01,o*8):Rl(h,-o*r,o*r,-o,o,o*.01,o*8);const f=Ge();f[0]=-1;const u=he(0,0,-o*1.8);Ta(f,f,u),this.position&&Ta(f,f,this.position),Dl(f,f,en(270-n)),Nl(f,f,en(i-180)),Ta(f,f,[-l[0],-l[1],-l[2]]);const m=Ge();vi(m,f);const g=Ge();Ni(g,m);const p=Ge();return sn(p,h,f),[p,f,g]}calculateModelMatrix(t,e){if(!this.back)throw new Error("back undefined");const i=Ge();if(i[0]=-1,Dl(i,i,en(270-e)),Nl(i,i,en(t-180)),this.back.obliqueRAS){const n=Rt(this.back.obliqueRAS);sn(i,i,n)}return i}calculateRayDirection(t,e){const i=this.calculateModelMatrix(t,e),n=Ri(1,0,0,0,0,-1,0,0,0,0,-1,0,0,0,0,1),r=Ge();sn(r,n,i);const o=Ge();vi(o,r);const l=ut(0,0,-1,1);qt(l,l,o);const h=he(l[0],l[1],l[2]);Hi(h,h);const f=5e-5;return Math.abs(h[0])<f&&(h[0]=f),Math.abs(h[1])<f&&(h[1]=f),Math.abs(h[2])<f&&(h[2]=f),h}sceneExtentsMinMax(t=!0){let e=he(0,0,0),i=he(0,0,0);if(this.volumes.length>0){if(!this.volumeObject3D)throw new Error("volumeObject3D undefined");e=he(this.volumeObject3D.extentsMin[0],this.volumeObject3D.extentsMin[1],this.volumeObject3D.extentsMin[2]),i=he(this.volumeObject3D.extentsMax[0],this.volumeObject3D.extentsMax[1],this.volumeObject3D.extentsMax[2]),t||(e=he(this.volumes[0].extentsMinOrtho[0],this.volumes[0].extentsMinOrtho[1],this.volumes[0].extentsMinOrtho[2]),i=he(this.volumes[0].extentsMaxOrtho[0],this.volumes[0].extentsMaxOrtho[1],this.volumes[0].extentsMaxOrtho[2]))}if(this.meshes.length>0){if(this.volumes.length<1){const r=this.meshes[0].extentsMin,o=this.meshes[0].extentsMax;e=he(r[0],r[1],r[2]),i=he(o[0],o[1],o[2])}for(let r=0;r<this.meshes.length;r++){const o=this.meshes[r].extentsMin,l=this.meshes[r].extentsMax,h=he(o[0],o[1],o[2]);ef(e,e,h);const f=he(l[0],l[1],l[2]);tf(i,i,f)}}const n=ot();return ct(n,i,e),[e,i,n]}setPivot3D(){const[t,e]=this.sceneExtentsMinMax(),i=ot();Fn(i,t,e),f5(i,i,.5),this.pivot3D=[i[0],i[1],i[2]],ct(i,e,t),this.extentsMin=t,this.extentsMax=e,this.furthestFromPivot=rn(i)*.5}getMaxVols(){if(this.volumes.length<1)return 0;let t=0;for(let e=0;e<this.volumes.length;e++)t=Math.max(t,this.volumes[e].nFrame4D);return t}detectPartialllyLoaded4D(){if(this.volumes.length<1)return!1;for(let t=0;t<this.volumes.length;t++)if(this.volumes[t].nFrame4D<this.volumes[t].hdr.dims[4])return!0;return!1}drawGraph(){if(this.getMaxVols()<2)return;const t=this.graph;let e=0;if(this.graph.autoSizeMultiplanar&&this.opts.sliceType===3)for(let q=0;q<this.screenSlices.length;q++){const se=this.screenSlices[q].axCorSag;if(se===0&&(e=this.screenSlices[q].leftTopWidthHeight[1]),se!==2)continue;const G=this.screenSlices[q].leftTopWidthHeight.slice();G[1]===e?(t.LTWH[0]=G[0]+G[2],t.LTWH[1]=G[1]):(t.LTWH[0]=G[0],t.LTWH[1]=G[1]+G[3]),t.LTWH[2]=G[2],t.LTWH[3]=G[2]}if(t.opacity<=0||t.LTWH[2]<=5||t.LTWH[3]<=5||Math.floor(t.LTWH[0]+t.LTWH[2])>this.gl.canvas.width||Math.floor(t.LTWH[1]+t.LTWH[3])>this.gl.canvas.height)return;t.backColor=[.15,.15,.15,t.opacity],t.lineColor=[1,1,1,1],this.opts.backColor[0]+this.opts.backColor[1]+this.opts.backColor[2]>1.5&&(t.backColor=[.95,.95,.95,t.opacity],t.lineColor=[0,0,0,1]);const i=.2,n=.3;t.lineColor[3]=i,t.textColor=t.lineColor.slice(),t.textColor[3]=1,t.lineThickness=3,t.gridLineThickness=1,t.lineAlpha=1,t.lines=[];const r=[];if(t.vols.length<1)this.volumes[0]!=null&&r.push(0);else for(let q=0;q<t.vols.length;q++){const se=t.vols[q];this.volumes[se]==null||this.volumes[se].nFrame4D<2||r.push(se)}if(r.length<1)return;const o=this.volumes[r[0]].nFrame4D;if(this.graph.selectedColumn=this.volumes[r[0]].frame4D,o<2){j.debug("Unable to generate a graph: Selected volume is 3D not 4D");return}for(let q=0;q<r.length;q++){t.lines[q]=[];const se=this.frac2vox(this.scene.crosshairPos),G=this.volumes[r[q]];let W=G.nFrame4D;W=Math.min(W,o);for(let le=0;le<W;le++){const ce=G.getValue(se[0],se[1],se[2],le);t.lines[q].push(ce)}}t.lineRGB=[[.8,0,0],[0,.7,0],[0,0,.9],[.7,.7,0],[.8,0,.8],[0,.7,.7],[.6,.6,.6],[0,0,0]];let l=t.lines[0][0],h=t.lines[0][0];for(let q=0;q<t.lines.length;q++)for(let se=0;se<t.lines[q].length;se++){const G=t.lines[q][se];l=Math.min(G,l),h=Math.max(G,h)}const f=this.volumes[r[0]].cal_min,u=this.volumes[r[0]].cal_max;if(t.isRangeCalMinMax&&f<u&&isFinite(f)&&isFinite(u)&&(l=f,h=u),t.normalizeValues&&h>l){const q=h-l;for(let se=0;se<t.lines.length;se++)for(let G=0;G<t.lines[se].length;G++){const W=t.lines[se][G];t.lines[se][G]=(W-l)/q}l=0,h=1}l>=h&&(h=l+1),this.drawRect(t.LTWH,t.backColor);const[m,g,p]=W2(l,h),v=Math.max(0,-1*Math.floor(Math.log(m)/Math.log(10)));l=Math.min(g,l),h=Math.max(p,h);function x(q){return q.toFixed(6).replace(/\.?0*$/,"")}const w=Math.min(t.LTWH[2],t.LTWH[3]);let E=16*Math.pow(w/480,.5);E<12&&(E=0);const T=E/(this.opts.textHeight*this.gl.canvas.height);let D=0,R=g;if(E>0)for(;R<=h;){const q=R.toFixed(v),se=this.textWidth(E,q);D=Math.max(se,D),R+=m}const N=.05,M=Math.abs(t.LTWH[2]),V=Math.abs(t.LTWH[3]),I=[t.LTWH[0]+N*M+D,t.LTWH[1]+N*V,t.LTWH[2]-D-2*N*M,t.LTWH[3]-E-2.5*N*V];this.graph.LTWH=t.LTWH,this.graph.plotLTWH=I,this.drawRect(I,this.opts.backColor);const B=h-l,U=I[3]/B,z=I[2]/(t.lines[0].length-1),P=I[1]+I[3];R=g+.5*m;const K=t.lineColor.slice();for(K[3]=.5*t.lineColor[3];R<=h;){const q=P-(R-l)*U;this.drawLine([I[0],q,I[0]+I[2],q],t.gridLineThickness,K),R+=m}R=g;const _=.5*t.gridLineThickness;for(;R<=h;){const q=P-(R-l)*U;this.drawLine([I[0]-_,q,I[0]+I[2]+t.gridLineThickness,q],t.gridLineThickness,t.lineColor);const se=R.toFixed(v);E>0&&this.drawTextLeft([I[0]-6,q],se,T,t.textColor),R+=m}let H=1;for(;t.lines[0].length/H>20;)H*=5;for(let q=0;q<t.lines[0].length;q+=H){const se=q*z+I[0];let G=t.gridLineThickness;if(q%2===1)G*=.5,this.drawLine([se,I[1],se,I[1]+I[3]],G,K);else{const W=x(q);E>0&&this.drawTextBelow([se,2+I[1]+I[3]],W,T,t.textColor),this.drawLine([se,I[1],se,I[1]+I[3]],G,t.lineColor)}}for(let q=0;q<t.lines.length;q++){let se=[1,0,0,t.lineAlpha];q<t.lineRGB.length&&(se=[t.lineRGB[q][0],t.lineRGB[q][1],t.lineRGB[q][2],t.lineAlpha]);for(let G=1;G<t.lines[q].length;G++){const W=(G-1)*z,le=G*z,ce=(t.lines[q][G-1]-l)*U,fe=(t.lines[q][G]-l)*U,ye=[I[0]+W,I[1]+I[3]-ce,I[0]+le,I[1]+I[3]-fe];this.drawLine(ye,t.lineThickness,se)}}if(t.selectedColumn>=0&&t.selectedColumn<t.lines[0].length){const q=t.selectedColumn*z+I[0];this.drawLine([q,I[1],q,I[1]+I[3]],t.lineThickness,[t.lineRGB[0][0],t.lineRGB[0][1],t.lineRGB[0][2],n])}E>0&&t.LTWH[1]+t.LTWH[3]>I[1]+I[3]+E*2.4&&this.drawTextBelow([I[0]+.5*I[2],I[1]+I[3]+E*1.2],"Volume",T,t.textColor),this.detectPartialllyLoaded4D()&&this.drawTextBelow([I[0]+I[2],I[1]+I[3]+E*.5],"...",T,t.textColor)}depthPicker(t,e){if(!this.uiData.mouseDepthPicker)return;this.uiData.mouseDepthPicker=!1;const i=this.gl,n=this.mousePos[0]*t[2]/t[2],r=i.canvas.height-this.mousePos[1]*t[3]/t[3]-1,o=new Uint8Array(4);if(i.readPixels(n,r,1,1,i.RGBA,i.UNSIGNED_BYTE,o),this.selectedObjectId=o[3],this.selectedObjectId===this.VOLUME_ID){this.scene.crosshairPos=new Float32Array(o.slice(0,3)).map(g=>g/255);return}const l=Nx(o);if(l>1)return;const h=(this.mousePos[0]-t[0])/t[2],f=(i.canvas.height-this.mousePos[1]-t[1])/t[3],u=Dx(h,f,l,e),m=this.mm2frac(u,0,!0);m[0]<0||m[0]>1||m[1]<0||m[1]>1||m[2]<0||m[2]>1||(this.scene.crosshairPos=this.mm2frac(u,0,!0))}drawImage3D(t,e,i){if(this.volumes.length===0)return;const n=this.gl,r=this.calculateRayDirection(e,i),o=this.volumeObject3D;if(o){n.enable(n.BLEND),n.blendFunc(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA),n.enable(n.CULL_FACE),n.cullFace(n.FRONT);let l=this.renderShader;if(this.uiData.mouseDepthPicker&&(l=this.pickingImageShader),l.use(this.gl),n.uniform1i(l.uniforms.backgroundMasksOverlays,this.backgroundMasksOverlays),this.gradientTextureAmount>0){n.activeTexture(sm),n.bindTexture(n.TEXTURE_3D,this.gradientTexture);const h=this.calculateModelMatrix(e,i),f=Ge();vi(f,h);const u=Ge();Ni(u,f),n.uniformMatrix4fv(l.uniforms.normMtx,!1,u)}this.drawBitmap&&this.drawBitmap.length>8?n.uniform2f(l.uniforms.renderDrawAmbientOcclusionXY,this.renderDrawAmbientOcclusion,this.drawOpacity):n.uniform2f(l.uniforms.renderDrawAmbientOcclusionXY,this.renderDrawAmbientOcclusion,0),n.uniformMatrix4fv(l.uniforms.mvpMtx,!1,t),n.uniformMatrix4fv(l.uniforms.matRAS,!1,this.back.matRAS),n.uniform3fv(l.uniforms.rayDir,r),this.gradientTextureAmount<0?n.uniform4fv(l.uniforms.clipPlane,[this.scene.crosshairPos[0],this.scene.crosshairPos[1],this.scene.crosshairPos[2],30]):n.uniform4fv(l.uniforms.clipPlane,this.scene.clipPlane),n.uniform1f(l.uniforms.drawOpacity,1),n.bindVertexArray(o.vao),n.drawElements(o.mode,o.indexCount,n.UNSIGNED_SHORT,0),n.bindVertexArray(this.unusedVAO)}}drawOrientationCube(t,e=0,i=0){if(!this.opts.isOrientCube)return;const n=.05*Math.min(t[2],t[3]);if(n<5)return;const r=this.gl;r.enable(r.CULL_FACE),r.cullFace(r.BACK),this.orientCubeShader.use(this.gl),r.bindVertexArray(this.orientCubeShaderVAO);const o=Ge(),l=Ge();Rl(l,0,r.canvas.width,0,r.canvas.height,-10*n,10*n);let h=0;t[1]===0&&(h=r.canvas.height-this.effectiveCanvasHeight()),Ta(o,o,[1.8*n+t[0],h+1.8*n+t[1],0]),v2(o,o,[n,n,n]),Dl(o,o,en(270-i)),Nl(o,o,en(-e));const f=Ge();sn(f,l,o),r.uniformMatrix4fv(this.orientCubeShader.uniforms.u_matrix,!1,f),r.drawArrays(r.TRIANGLE_STRIP,0,168),r.bindVertexArray(this.unusedVAO),this.gl.disable(this.gl.CULL_FACE)}createOnLocationChange(t=NaN){const[e,i,n]=this.sceneExtentsMinMax(!0),r=Math.max(Math.max(n[0],n[1]),n[2]);function o(g){return Math.max(0,-Math.ceil(Math.log10(Math.abs(g))))}let l=o(r*.001);const h=this.frac2mm(this.scene.crosshairPos,0,!0);function f(g,p=0){return parseFloat(g.toFixed(p))}let u=f(h[0],l)+""+f(h[1],l)+""+f(h[2],l);if(this.volumes.length>0&&this.volumes[0].nFrame4D>0&&(u+=""+f(this.volumes[0].frame4D)),this.volumes.length>0){let g=" = ";for(let x=0;x<this.volumes.length;x++){const w=this.volumes[x].mm2vox(h);let b=this.volumes[x].getValue(w[0],w[1],w[2],this.volumes[x].frame4D);if(l=3,this.volumes[x].colormapLabel!==null){const S=Math.round(b);S>=0&&S<this.volumes[x].colormapLabel.labels.length?g+=this.volumes[x].colormapLabel.labels[S]:g+="undefined("+f(b,l)+")"}else g+=f(b,l);this.volumes[x].imaginary&&(b=this.volumes[x].getValue(w[0],w[1],w[2],this.volumes[x].frame4D,!0),b>=0&&(g+="+"),g+=f(b,l)),g+="   "}u+=g;const p=this.back.dimsRAS,v=p[1]*p[2]*p[3];if(this.drawBitmap&&this.drawBitmap.length===v){const x=this.frac2vox(this.scene.crosshairPos),w=x[0]+x[1]*p[1]+x[2]*p[1]*p[2];u+=" "+this.drawLut.labels[this.drawBitmap[w]]}}const m={mm:this.frac2mm(this.scene.crosshairPos,0,!0),axCorSag:t,vox:this.frac2vox(this.scene.crosshairPos),frac:this.scene.crosshairPos,xy:[this.mousePos[0],this.mousePos[1]],values:this.volumes.map(g=>{const p=this.frac2mm(this.scene.crosshairPos,0,!0),v=g.mm2vox(p),x=g.getValue(v[0],v[1],v[2],g.frame4D);return{name:g.name,value:x,id:g.id,mm:p,vox:v}}),string:u};this.onLocationChange(m)}addLabel(t,e,i,n,r){const o={textColor:this.opts.legendTextColor,textScale:1,textAlignment:"left",lineWidth:0,lineColor:this.opts.legendTextColor,lineTerminator:"none",bulletScale:0,bulletColor:this.opts.legendTextColor},l=e?{...o,...e}:{...o},h=new xf(t,{...l},i,n,r);return this.document.labels.push(h),h}calculateScreenPoint(t,e,i){const n=cs();return qt(n,[...t,1],e),n[3]!==0&&(n[0]=(n[0]/n[3]+1)*.5*i[2],n[1]=(1-n[1]/n[3])*.5*i[3],n[2]/=n[3],n[0]+=i[0],n[1]+=i[1]),n}getLabelAtPoint(t){const i=this.opts.textHeight*Math.min(this.gl.canvas.height,this.gl.canvas.width)*1,n=this.opts.textHeight*this.gl.canvas.height*1;for(const u of this.document.labels){if(u.anchor==null||u.anchor===0)continue;const m=this.opts.textHeight*this.gl.canvas.height*u.style.textScale,g=this.textHeight(m,u.text),p=this.textWidth(m,u.text);if(!(u.anchor&1&&t[0]>p)&&!(u.anchor&2&&(t[0]<(this.gl.canvas.width-p)/2||t[0]>(this.gl.canvas.width+p)/2))&&!(u.anchor&4&&t[0]<this.gl.canvas.width-p)&&!(u.anchor&8&&(t[1]<n/2||t[1]>g+n/2))&&!(u.anchor&16&&(t[1]<(this.gl.canvas.height-g-n)/2||t[1]>(this.gl.canvas.height+g-n/2)/2))&&!(u.anchor&32&&(t[1]<this.gl.canvas.height-g-n||t[1]>this.gl.canvas.height-n/2)))return u}j.debug("screenPoint",t);const r=this.getLegendPanelHeight(),o=this.getLegendPanelWidth(),l=this.gl.canvas.width-o;let h=(this.canvas.height-r)/2;if(j.debug("panelrect",l,h,l+o,h+r),t[0]<l||t[1]<h||t[0]>l+o||t[1]>h+r)return null;const f=this.getConnectomeLabels();for(const u of f){const m=this.opts.textHeight*this.gl.canvas.height*u.style.textScale,g=this.textHeight(m,u.text);if(t[1]>=h&&t[1]<=h+g+i/2)return u;h+=g,h+=i/2}return null}drawLabelLine(t,e,i,n,r=!1){const o=Array.isArray(t.points)&&Array.isArray(t.points[0])?t.points:[t.points];for(const l of o){const h=this.calculateScreenPoint(l,i,n);r?this.drawDottedLine([...e,h[0],h[1]],t.style.lineWidth,t.style.lineColor):this.draw3DLine(e,[h[0],h[1],h[2]],t.style.lineWidth,t.style.lineColor)}}draw3DLabel(t,e,i,n,r,o,l){const h=t.text,f=e[0],u=e[1],m=this.opts.textHeight*Math.min(this.gl.canvas.height,this.gl.canvas.width)*1,g=this.textHeight(t.style.textScale,h)*m;if(t.style.lineWidth>0&&Array.isArray(t.points)&&this.drawLabelLine(t,[f,u+g],i,n,l),t.style.bulletScale){const x=t.style.bulletScale*g,w=g-x,b=u+w/2+x/2,S=f+(r-x)/2;this.drawCircle([S,b,x,x],t.style.bulletColor)}let p=f;if(o)if(t.style.textAlignment!=="left"){const x=this.textWidth(t.style.textScale,t.text)*m;if(t.style.textAlignment==="right")p=f+o-m*1.5-x;else{const w=o-(r||m);p+=(w-x)/2}}else p+=r;const v=t.style.textScale;this.drawText([p,u],h,v,t.style.textColor)}draw3DLabels(t,e,i=!1){const n=this.getConnectomeLabels();if(!this.opts.showLegend||n.length===0)return;if(!this.canvas)throw new Error("canvas undefined");const r=this.gl;r.disable(r.CULL_FACE),r.viewport(0,0,this.canvas.width,this.canvas.height);const o=this.getLegendPanelHeight();o>this.canvas.height&&j.debug("Legend may overflow screen size");const l=this.opts.textHeight*Math.min(this.gl.canvas.height,this.gl.canvas.width),h=this.getBulletMarginWidth(),f=this.getLegendPanelWidth(),u=r.canvas.width-f;let m=(this.canvas.height-o)/2;this.drawRect([r.canvas.width-f,m,f-l,o],this.opts.legendBackgroundColor);const g=r.getParameter(r.BLEND),p=r.getParameter(r.DEPTH_FUNC);i||(r.disable(r.BLEND),r.depthFunc(r.GREATER));for(const v of n){this.draw3DLabel(v,[u,m],t,e,h,f,i);const x=this.opts.textHeight*this.gl.canvas.height*v.style.textScale,w=this.textHeight(x,v.text);m+=w,m+=l/2}i||(r.depthFunc(p),g&&r.enable(r.BLEND))}drawAnchoredLabels(){const t=this.opts.textHeight*Math.min(this.gl.canvas.height,this.gl.canvas.width)*1,e=this.document.labels.filter(i=>i.anchor!=null&&i.anchor!==0);for(const i of e){const n=i.text,r=this.textHeight(i.style.textScale,n)*t,o=this.textWidth(i.style.textScale,n)*t;let l,h;const u=this.opts.textHeight*this.gl.canvas.height*1,m=u;let g=u/4,p=0,v=0;i.anchor&1&&(l=0),i.anchor&4&&(l=this.canvas.width-o,p-=u/4),i.anchor&2&&(l=(this.canvas.width-o)/2,p-=u/4,g+=u/4),i.anchor&8&&(h=0),i.anchor&16&&(h=(this.canvas.height-r-u)/2,v-=u/4),i.anchor&32&&(h=this.canvas.height-r-u,v-=u/4),this.drawRect([l+p,h+v,o+g,r+m],i.style.backgroundColor),this.draw3DLabel(i,[l,h])}}draw3D(t=[0,0,0,0],e=null,i=null,n=null,r=null,o=0){const l=r!==null;this.setPivot3D(),l||(r=this.scene.renderAzimuth,o=this.scene.renderElevation);const h=this.gl;e===null&&([e,i,n]=this.calculateMvpMatrix(null,t,r,o));let f=[...t];if(t[2]===0||t[3]===0?(t=[0,0,h.canvas.width,h.canvas.height],f=[...t],this.screenSlices.push({leftTopWidthHeight:t,axCorSag:4,sliceFrac:0,AxyzMxy:[],leftTopMM:[],fovMM:[J2(i),0]})):(this.screenSlices.push({leftTopWidthHeight:t.slice(),axCorSag:4,sliceFrac:0,AxyzMxy:[],leftTopMM:[],fovMM:[J2(i),0]}),t[1]=h.canvas.height-t[3]-t[1]),h.enable(h.DEPTH_TEST),h.depthFunc(h.ALWAYS),h.depthMask(!0),h.clearDepth(0),this.draw3DLabels(e,f,!1),h.viewport(t[0],t[1],t[2],t[3]),this.volumes.length>0&&(this.updateInterpolation(0,!0),this.updateInterpolation(1,!0),this.drawImage3D(e,r,o)),this.updateInterpolation(0),this.updateInterpolation(1),l||this.drawCrosshairs3D(!0,1,e),this.drawMesh3D(!0,1,e,i,n),this.uiData.mouseDepthPicker){this.depthPicker(t,e),this.createOnLocationChange(),this.draw3D(t,e,i,n,r,o);return}this.opts.meshXRay>0&&this.drawMesh3D(!1,this.opts.meshXRay,e,i,n),this.draw3DLabels(e,f,!1),h.viewport(t[0],t[1],t[2],t[3]),l||this.drawCrosshairs3D(!1,.15,e),h.viewport(0,0,h.canvas.width,h.canvas.height),this.drawOrientationCube(t,r,o);const u="azimuth: "+this.scene.renderAzimuth.toFixed(0)+" elevation: "+this.scene.renderElevation.toFixed(0);return this.readyForSync=!0,this.sync(),this.draw3DLabels(e,f,!0),u}drawMesh3D(t=!0,e=1,i,n,r){if(this.meshes.length<1)return;const o=this.gl;i||([i,n,r]=this.calculateMvpMatrix(this.volumeObject3D,void 0,this.scene.renderAzimuth,this.scene.renderElevation)),o.enable(o.DEPTH_TEST),o.blendFunc(o.SRC_ALPHA,o.ONE_MINUS_SRC_ALPHA),o.disable(o.BLEND),o.depthFunc(o.GREATER),o.disable(o.CULL_FACE),t?o.depthFunc(o.GREATER):(o.enable(o.BLEND),o.depthFunc(o.ALWAYS),o.enable(o.CULL_FACE)),o.cullFace(o.BACK);let l=this.meshShaders[0].shader,h=!1;for(let f=0;f<this.meshes.length;f++){if(this.meshes[f].visible===!1||this.meshes[f].opacity<=0)continue;let u=e;if(t&&(u=this.meshes[f].opacity,o.depthFunc(o.GREATER),o.depthMask(!0),u<1?(o.depthMask(!1),o.enable(o.DEPTH_TEST),o.enable(o.BLEND),o.cullFace(o.BACK),o.blendFunc(o.SRC_ALPHA,o.ONE_MINUS_SRC_ALPHA)):(o.enable(o.DEPTH_TEST),o.disable(o.BLEND))),l=this.meshShaders[this.meshes[f].meshShaderIndex].shader,this.uiData.mouseDepthPicker&&(l=this.pickingMeshShader),l.use(this.gl),o.uniformMatrix4fv(l.uniforms.mvpMtx,!1,i),o.uniformMatrix4fv(l.uniforms.normMtx,!1,r),o.uniform1f(l.uniforms.opacity,u),!(this.meshes[f].indexCount<3)){if(this.meshes[f].offsetPt0&&(this.meshes[f].fiberSides<3||this.meshes[f].fiberRadius<=0)){h=!0;continue}l.isMatcap&&(o.activeTexture(im),o.bindTexture(o.TEXTURE_2D,this.matCapTexture)),o.bindVertexArray(this.meshes[f].vao),o.drawElements(o.TRIANGLES,this.meshes[f].indexCount,o.UNSIGNED_INT,0),o.bindVertexArray(this.unusedVAO)}}if(o.depthMask(!0),!h){o.enable(o.BLEND),o.depthFunc(o.ALWAYS);return}l=this.fiberShader,l.use(this.gl),o.uniformMatrix4fv(l.uniforms.mvpMtx,!1,i),o.uniform1f(l.uniforms.opacity,e);for(let f=0;f<this.meshes.length;f++)this.meshes[f].indexCount<3||this.meshes[f].offsetPt0&&(this.meshes[f].fiberSides>=3&&this.meshes[f].fiberRadius>0||(o.bindVertexArray(this.meshes[f].vaoFiber),o.drawElements(o.LINE_STRIP,this.meshes[f].indexCount,o.UNSIGNED_INT,0),o.bindVertexArray(this.unusedVAO)));o.enable(o.BLEND),o.depthFunc(o.ALWAYS),this.readyForSync=!0}drawCrosshairs3D(t=!0,e=1,i=null,n=!1,r=!0){var v,x;if(!this.opts.show3Dcrosshair&&!n||this.opts.crosshairWidth<=0&&n)return;const o=this.gl,l=this.frac2mm(this.scene.crosshairPos,0,r);let h=1;const[f,u,m]=this.sceneExtentsMinMax(r);if(this.volumes.length>0){if(!this.back)throw new Error("back undefined");h=.5*Math.min(Math.min(this.back.pixDims[1],this.back.pixDims[2]),this.back.pixDims[3])}else(m[0]<50||m[0]>1e3)&&(h=m[0]*.02);if(h*=this.opts.crosshairWidth,((v=this.opts)==null?void 0:v.crosshairWidthUnit)==="percent"&&(h=m[0]*this.opts.crosshairWidth*.5*.01),((x=this.opts)==null?void 0:x.crosshairWidthUnit)==="mm"&&(h=this.opts.crosshairWidth*.5),(this.crosshairs3D===null||this.crosshairs3D.mm[0]!==l[0]||this.crosshairs3D.mm[1]!==l[1]||this.crosshairs3D.mm[2]!==l[2])&&(this.crosshairs3D!==null&&(o.deleteBuffer(this.crosshairs3D.indexBuffer),o.deleteBuffer(this.crosshairs3D.vertexBuffer)),this.crosshairs3D=Bn.generateCrosshairs(this.gl,1,l,f,u,h,20,this.opts.crosshairGap),this.crosshairs3D.mm=l),!this.surfaceShader)throw new Error("surfaceShader undefined");const g=this.surfaceShader;g.use(this.gl),i==null&&([i]=this.calculateMvpMatrix(this.crosshairs3D,void 0,this.scene.renderAzimuth,this.scene.renderElevation)),o.uniformMatrix4fv(g.uniforms.mvpMtx,!1,i),o.disable(o.CULL_FACE),o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,this.crosshairs3D.indexBuffer),o.enable(o.DEPTH_TEST);const p=[...this.opts.crosshairColor];t?(o.disable(o.BLEND),o.depthFunc(o.GREATER)):(o.enable(o.BLEND),o.blendFunc(o.SRC_ALPHA,o.ONE_MINUS_SRC_ALPHA),o.depthFunc(o.ALWAYS)),p[3]=e,o.uniform4fv(g.uniforms.surfaceColor,p),o.bindVertexArray(this.crosshairs3D.vao),o.drawElements(o.TRIANGLES,this.crosshairs3D.indexCount,o.UNSIGNED_INT,0),o.bindVertexArray(this.unusedVAO)}mm2frac(t,e=0,i=!1){if(this.volumes.length<1){const n=he(.1,.5,.5),[r,o,l]=this.sceneExtentsMinMax();return n[0]=(t[0]-r[0])/l[0],n[1]=(t[1]-r[1])/l[1],n[2]=(t[2]-r[2])/l[2],isFinite(n)||(isFinite(n[0])||(n[0]=.5),isFinite(n[1])||(n[1]=.5),isFinite(n[2])||(n[2]=.5),this.meshes.length<1&&j.error("mm2frac() not finite: objects not (yet) loaded.")),n}return this.volumes[e].convertMM2Frac(t,i||this.opts.isSliceMM)}vox2frac(t,e=0){return this.volumes[e].convertVox2Frac(t)}frac2vox(t,e=0){return this.volumes.length<=e?[0,0,0]:this.volumes[e].convertFrac2Vox(t)}moveCrosshairInVox(t,e,i){const n=this.frac2vox(this.scene.crosshairPos),r=n[2];n[0]+=t,n[1]+=e,n[2]+=i,n[0]=Bh(n[0],0,this.volumes[0].dimsRAS[1]-1),n[1]=Bh(n[1],0,this.volumes[0].dimsRAS[2]-1),n[2]=Bh(n[2],0,this.volumes[0].dimsRAS[3]-1),this.scene.crosshairPos=this.vox2frac(n),this.createOnLocationChange(),this.opts.is2DSliceShader&&r!==n[2]&&(this.updateGLVolume(),this.refreshDrawing(!1)),this.drawScene()}frac2mm(t,e=0,i=!1){const n=ut(t[0],t[1],t[2],1);if(this.volumes.length>0)return this.volumes[e].convertFrac2MM(t,i||this.opts.isSliceMM);{const[r,o]=this.sceneExtentsMinMax(),l=(h,f,u)=>h*(1-u)+f*u;n[0]=l(r[0],o[0],t[0]),n[1]=l(r[1],o[1],t[1]),n[2]=l(r[2],o[2],t[2])}return n}screenXY2TextureFrac(t,e,i,n=!0){const r=he(-1,-1,-1),o=this.screenSlices[i].axCorSag;if(o>2)return r;const l=this.screenSlices[i].leftTopWidthHeight.slice();let h=!1;l[2]<0&&(h=!0,l[0]+=l[2],l[2]=-l[2]);let f=(t-l[0])/l[2];h&&(f=1-f);const u=1-(e-l[1])/l[3];if(f<0||f>1||u<0||u>1||this.screenSlices[i].AxyzMxy.length<4)return r;let m=he(0,0,0);m[0]=this.screenSlices[i].leftTopMM[0]+f*this.screenSlices[i].fovMM[0],m[1]=this.screenSlices[i].leftTopMM[1]+u*this.screenSlices[i].fovMM[1];const g=this.screenSlices[i].AxyzMxy;m[2]=g[2]+g[4]*(m[1]-g[1])-g[3]*(m[0]-g[0]),o===1&&(m=si(m,[0,2,1])),o===2&&(m=si(m,[2,0,1]));const p=this.mm2frac(m);return n&&(p[0]<0||p[0]>1||p[1]<0||p[1]>1||p[2]<0||p[2]>1)?r:p}canvasPos2frac(t){for(let e=0;e<this.screenSlices.length;e++){const i=this.screenXY2TextureFrac(t[0],t[1],e);if(i[0]>=0)return i}return[-1,-1,-1]}scaleSlice(t,e,i=[0,0],n=[0,0]){const r=n[0]===0?this.effectiveCanvasWidth()-i[0]:n[0]-i[0],o=n[1]===0?this.effectiveCanvasHeight()-i[1]:n[1]-i[1];let l=r/t;e*l>o&&(l=o/e);const h=t*l,f=e*l;return[(r-h)*.5,(o-f)*.5,h,f,l]}drawThumbnail(){if(!this.bmpShader)throw new Error("bmpShader undefined");this.bmpShader.use(this.gl),this.gl.uniform2f(this.bmpShader.uniforms.canvasWidthHeight,this.gl.canvas.width,this.gl.canvas.height);let t=this.gl.canvas.height,e=this.gl.canvas.height*this.bmpTextureWH;e>this.gl.canvas.width&&(t=this.gl.canvas.width/this.bmpTextureWH,e=this.gl.canvas.width);const i=(this.gl.canvas.width-e)/2,n=(this.gl.canvas.height-t)/2;this.gl.uniform4f(this.bmpShader.uniforms.leftTopWidthHeight,i,n,e,t),this.gl.bindVertexArray(this.genericVAO),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),this.gl.bindVertexArray(this.unusedVAO)}drawLine(t,e=1,i=[1,0,0,-1]){if(this.gl.bindVertexArray(this.genericVAO),!this.lineShader)throw new Error("lineShader undefined");this.lineShader.use(this.gl),i[3]<0&&(i=this.opts.crosshairColor),this.gl.uniform4fv(this.lineShader.uniforms.lineColor,i),this.gl.uniform2fv(this.lineShader.uniforms.canvasWidthHeight,[this.gl.canvas.width,this.gl.canvas.height]),this.gl.uniform1f(this.lineShader.uniforms.thickness,e),this.gl.uniform4fv(this.lineShader.uniforms.startXYendXY,t),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),this.gl.bindVertexArray(this.unusedVAO)}draw3DLine(t,e,i=1,n=[1,0,0,-1]){if(this.gl.bindVertexArray(this.genericVAO),!this.line3DShader)throw new Error("line3DShader undefined");this.line3DShader.use(this.gl),n[3]<0&&(n=this.opts.crosshairColor),this.gl.uniform4fv(this.line3DShader.uniforms.lineColor,n),this.gl.uniform2fv(this.line3DShader.uniforms.canvasWidthHeight,[this.gl.canvas.width,this.gl.canvas.height]),this.gl.uniform1f(this.line3DShader.uniforms.thickness,i),this.gl.uniform2fv(this.line3DShader.uniforms.startXY,t),this.gl.uniform3fv(this.line3DShader.uniforms.endXYZ,e),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),this.gl.bindVertexArray(this.unusedVAO)}drawDottedLine(t,e=1,i=[1,0,0,-1]){if(this.gl.bindVertexArray(this.genericVAO),!this.lineShader)throw new Error("lineShader undefined");this.lineShader.use(this.gl);const n=i[3]<0?[...this.opts.crosshairColor]:[...i];n[3]=.3;const r=b2(t[2]-t[0],t[3]-t[1]),o=C2(r);w5(r,r);const h=this.opts.textHeight*Math.min(this.gl.canvas.height,this.gl.canvas.width)*1;y5(r,r,h/2);const f=C2(r);let u=Math.floor(o/f);o%f&&u++;const m=[t[0],t[1]];this.gl.uniform4fv(this.lineShader.uniforms.lineColor,n),this.gl.uniform2fv(this.lineShader.uniforms.canvasWidthHeight,[this.gl.canvas.width,this.gl.canvas.height]),this.gl.uniform1f(this.lineShader.uniforms.thickness,e);for(let g=0;g<u-1;g++){if(g%2){m[0]+=r[0],m[1]+=r[1];continue}const p=[m[0],m[1],m[0]+r[0],m[1]+r[1]];this.gl.uniform4fv(this.lineShader.uniforms.startXYendXY,p),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),m[0]+=r[0],m[1]+=r[1]}this.gl.bindVertexArray(this.unusedVAO)}drawGraphLine(t,e=[1,0,0,.5],i=2){this.drawLine(t,i,e)}drawCrossLinesMM(t,e,i,n,r){if(t<0||this.screenSlices.length<=t)return;const o=this.screenSlices[t];let l=o.sliceFrac;l===1/0&&j.debug("Rendering approximate cross lines in world view mode"),l===1/0&&(l=.5);let f=n.slice(),u=r.slice();const m=Math.max(1,this.opts.crosshairWidth);e===1&&(f=i.slice()),e===2&&(f=i.slice(),u=n.slice());function g(p){const v=b2(0,0);return v[0]=o.leftTopWidthHeight[0]+(p[0]-o.leftTopMM[0])/o.fovMM[0]*o.leftTopWidthHeight[2],v[1]=o.leftTopWidthHeight[1]+o.leftTopWidthHeight[3]-(p[1]-o.leftTopMM[1])/o.fovMM[1]*o.leftTopWidthHeight[3],v}if(f.length>0&&e===0){const p=l,v=1;for(let x=0;x<f.length;x++){const w=this.frac2mm([.5,.5,.5]);w[v]=f[x];let b=this.mm2frac(w);b=b[v];let S=this.frac2mm([0,b,p]);S=si(S,[0,1,2]);let C=this.frac2mm([1,b,p]);C=si(C,[0,1,2]),S=g(S),C=g(C),this.drawLine([S[0],S[1],C[0],C[1]],m)}}if(f.length>0&&e===1){const p=l,v=2;for(let x=0;x<f.length;x++){const w=this.frac2mm([.5,.5,.5]);w[v]=f[x];let b=this.mm2frac(w);b=b[v];let S=this.frac2mm([0,p,b]);S=si(S,[0,2,1]);let C=this.frac2mm([1,p,b]);C=si(C,[0,2,1]),S=g(S),C=g(C),this.drawLine([S[0],S[1],C[0],C[1]],m)}}if(f.length>0&&e===2){const p=l,v=2;for(let x=0;x<f.length;x++){const w=this.frac2mm([.5,.5,.5]);w[v]=f[x];let b=this.mm2frac(w);b=b[v];let S=this.frac2mm([p,0,b]);S=si(S,[1,2,0]);let C=this.frac2mm([p,1,b]);C=si(C,[1,2,0]),S=g(S),C=g(C),this.drawLine([S[0],S[1],C[0],C[1]],m)}}if(u.length>0&&e===0){const p=l,v=0;for(let x=0;x<u.length;x++){const w=this.frac2mm([.5,.5,.5]);w[v]=u[x];let b=this.mm2frac(w);b=b[v];let S=this.frac2mm([b,0,p]);S=si(S,[0,1,2]);let C=this.frac2mm([b,1,p]);C=si(C,[0,1,2]),S=g(S),C=g(C),this.drawLine([S[0],S[1],C[0],C[1]],m)}}if(u.length>0&&e===1){const p=l,v=0;for(let x=0;x<u.length;x++){const w=this.frac2mm([.5,.5,.5]);w[v]=u[x];let b=this.mm2frac(w);b=b[v];let S=this.frac2mm([b,p,0]);S=si(S,[0,2,1]);let C=this.frac2mm([b,p,1]);C=si(C,[0,2,1]),S=g(S),C=g(C),this.drawLine([S[0],S[1],C[0],C[1]],m)}}if(u.length>0&&e===2){const p=l,v=1;for(let x=0;x<u.length;x++){const w=this.frac2mm([.5,.5,.5]);w[v]=u[x];let b=this.mm2frac(w);b=b[v];let S=this.frac2mm([p,b,0]);S=si(S,[1,2,0]);let C=this.frac2mm([p,b,1]);C=si(C,[1,2,0]),S=g(S),C=g(C),this.drawLine([S[0],S[1],C[0],C[1]],m)}}}drawCrossLines(t,e,i,n,r){if(t<0||this.screenSlices.length<=t)return;if(this.opts.isSliceMM)return this.drawCrossLinesMM(t,e,i,n,r);if(this.screenSlices[t].sliceFrac===1/0)return this.drawCrossLinesMM(t,e,i,n,r);const o=this.screenSlices[t];let l=n.slice(),h=r.slice();if(e===1&&(l=i.slice()),e===2&&(l=i.slice(),h=n.slice()),l.length>0){const f=o.leftTopWidthHeight.slice();let u=2;e===0&&(u=1);const m=this.frac2mm([.5,.5,.5]);for(let g=0;g<l.length;g++){m[u]=l[g];const p=this.mm2frac(m);this.drawRect([f[0],f[1]+f[3]-p[u]*f[3],f[2],1])}}if(h.length>0){const f=o.leftTopWidthHeight.slice(),u=o.fovMM[0]<0;let m=0;e===2&&(m=1);const g=this.frac2mm([.5,.5,.5]);for(let p=0;p<h.length;p++){g[m]=h[p];const v=this.mm2frac(g);u?this.drawRect([f[0]+(f[2]-v[m]*f[2]),f[1],1,f[3]]):this.drawRect([f[0]+v[m]*f[2],f[1],1,f[3]])}}}drawMosaic(t){var p;this.screenSlices=[];const e=this.screenFieldOfViewMM(0,!0),i=this.screenFieldOfViewMM(0);t=t.replaceAll(";"," ;").trim();const n=[],r=[],o=[],l=t.split(/\s+/);let h=1;const f=this.opts.textHeight;let u=0,m=0,g=0;(p=this.volumes[0])!=null&&p.dims||(g=Math.ceil(this.opts.tileMargin*.3));for(let v=0;v<2;v++){let x=!1,w=!1;x=!1;let b=0,S=0,C=0,E=0,T=!1,D=0,R=0,N=0,M=0;for(let B=0;B<l.length;B++){const U=l[B];if(U.includes("X")){w=!0;continue}if(U.includes("L")){T=!U.includes("-");continue}if(U.includes("H")){B++,R=Math.max(0,Math.min(1,parseFloat(l[B]))),R=Math.abs(R);continue}if(U.includes("V")){B++;continue}if(U.includes("A")){D=0;continue}if(U.includes("C")){D=1;continue}if(U.includes("S")){D=2;continue}if(U.includes("R")){x=!0;continue}U.includes(";")&&(C+=b,E=Math.max(E,S+N),b=0,S=0),M=N,R>0&&!x&&(M=Math.round(M*(1-R))),j.debug(`slice ${B} width with overlap ${M} pixels`),S+=M,M=0;const z=parseFloat(U);if(isNaN(z))continue;let P=0,K=i;if(x&&(K=e),D===2?M=K[1]:M=K[0],D===0?P=K[1]:P=K[2],v===0)x||(D===0&&n.push(z),D===1&&r.push(z),D===2&&o.push(z));else{const _=[u+h*S,m+h*C,h*M,h*P];if(this.opts.textHeight=T?f:0,x){let H=z<0?-1/0:1/0;Object.is(z,-0)&&(H=-1/0),this.draw2D(_,D,H)}else this.draw2D(_,D,z);w&&this.drawCrossLines(this.screenSlices.length-1,D,n,r,o),x=!1,w=!1}N=M,S+=g,b=Math.max(b,P)}if(C+=b,E=Math.max(E,S+N),E<=0||C<=0)break;const V=(this.gl.canvas.width-2*this.opts.tileMargin-g)/E,I=(this.effectiveCanvasHeight()-2*this.opts.tileMargin)/C;h=Math.min(V,I),this.opts.centerMosaic?(u=Math.floor(.5*(this.gl.canvas.width-E*h)),m=Math.floor(.5*(this.effectiveCanvasHeight()-C*h))):(u=this.opts.tileMargin,m=this.opts.tileMargin)}this.opts.textHeight=f}calculateWidthHeight(t,e,i,n){let r,o;switch(t){case 0:r=e[0],o=e[1];break;case 1:r=e[0],o=e[2];break;case 2:r=e[1],o=e[2];break;default:return[i,n]}const l=r/o,h=i/n;let f,u;return l>h?(f=i,u=i/l):(u=n,f=n*l),[f,u]}drawSceneCore(){var r,o,l;if(!this.initialized)return;if(this.colorbarHeight=0,this.gl.clearColor(this.opts.backColor[0],this.opts.backColor[1],this.opts.backColor[2],this.opts.backColor[3]),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT),this.bmpTexture&&this.thumbnailVisible){this.drawThumbnail();return}let t="";if(this.volumes.length===0||typeof this.volumes[0].dims>"u"){if(this.meshes.length>0){if(this.sliceMosaicString.length>0){this.opts.isColorbar&&this.reserveColorbarPanel(),this.drawMosaic(this.sliceMosaicString),this.opts.isColorbar&&this.drawColorbar();return}this.screenSlices=[],this.draw3D(),this.opts.isColorbar&&this.drawColorbar();return}this.drawLoadingText(this.opts.loadingText);return}if(this.uiData.isDragging&&this.scene.clipPlaneDepthAziElev[0]<1.8&&this.inRenderTile(this.uiData.dragStart[0],this.uiData.dragStart[1])>=0){const h=this.uiData.dragStart[0]-this.uiData.dragEnd[0],f=this.uiData.dragStart[1]-this.uiData.dragEnd[1],u=this.uiData.dragClipPlaneStartDepthAziElev.slice();if(u[1]-=h,u[1]=u[1]%360,u[2]+=f,u[1]!==this.scene.clipPlaneDepthAziElev[1]||u[2]!==this.scene.clipPlaneDepthAziElev[2])return this.scene.clipPlaneDepthAziElev=u,this.setClipPlane(this.scene.clipPlaneDepthAziElev)}if(this.sliceMosaicString.length<1&&this.opts.sliceType===4){this.opts.isColorbar&&this.reserveColorbarPanel(),this.screenSlices=[],this.draw3D(),this.opts.isColorbar&&this.drawColorbar();return}this.opts.isColorbar&&this.reserveColorbarPanel();const e=this.getMaxVols(),i=this.opts.sliceType===3&&e>1&&this.graph.autoSizeMultiplanar&&this.graph.opacity>0;if(this.sliceMosaicString.length>0)this.drawMosaic(this.sliceMosaicString);else{const h=[0,0];let f=!1;if(this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height),this.screenSlices=[],this.customLayout&&this.customLayout.length>0){this.screenSlices=[],this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height);const{volScale:u}=this.sliceScale(),m=[this.effectiveCanvasWidth(),this.effectiveCanvasHeight()];for(const g of this.customLayout){const{sliceType:p,position:v,sliceMM:x}=g,w=v.slice();if(v[0]>=0&&v[0]<=1&&v[2]<=1&&(w[0]=v[0]*m[0],w[2]=v[2]*m[0]),v[1]>=0&&v[1]<=1&&v[3]<=1&&(w[1]=v[1]*m[1],w[3]=v[3]*m[1]),w[0]+w[2]>m[0]&&(j.warn("adjusting slice width because it would have been clipped"),w[2]=m[0]-w[0]),w[1]+w[3]>m[1]&&(j.warn("adjusting slice height because it would have been clipped"),w[3]=m[1]-w[1]),p===4)this.draw3D(w);else if(p===0||p===1||p===2){const b=this.calculateWidthHeight(p,u,w[2],w[3]);this.draw2D(w,p,x??NaN,b)}}}else if(this.opts.sliceType===0)this.draw2D([0,0,0,0],0);else if(this.opts.sliceType===1)this.draw2D([0,0,0,0],1);else if(this.opts.sliceType===2)this.draw2D([0,0,0,0],2);else{let u=function(q,se){return[(q-1)*x+q*w,(se-1)*x+se*w]},m=!1;this.opts.multiplanarForceRender?(m=!0,this.opts.multiplanarForceRender?this.opts.multiplanarShowRender=1:this.opts.multiplanarShowRender=2,delete this.opts.multiplanarForceRender):this.opts.multiplanarShowRender===1&&(m=!0);const g=isFinite(this.drawPenLocation[0])&&this.opts.drawingEnabled,{volScale:p}=this.sliceScale(),v=p.slice();this.opts.multiplanarEqualSize&&(p[0]=1,p[1]=1,p[2]=1),typeof this.opts.multiplanarPadPixels!="number"&&j.debug("multiplanarPadPixels must be numeric");const x=parseFloat(`${this.opts.multiplanarPadPixels}`);let w=this.opts.tileMargin;w<0&&(w=2*(2+Math.ceil(Math.max(this.opts.textHeight,.01)*Math.min(this.gl.canvas.height,this.gl.canvas.width))));let b=[this.effectiveCanvasWidth(),this.effectiveCanvasHeight()];this.opts.heroImageFraction>0&&this.opts.heroImageFraction<1&&(m=!1,f=!0,b[0]>b[1]&&this.opts.multiplanarLayout!==3?h[0]=b[0]*this.opts.heroImageFraction:h[1]=b[1]*this.opts.heroImageFraction,b=[b[0]-h[0],b[1]-h[1]]);const S=this.scaleSlice(p[0]+p[1],p[1]+p[2],u(2,2),b),C=Math.max(Math.max(p[1],p[2]),p[0]),E=this.scaleSlice(p[0]+p[0]+p[1],Math.max(p[1],p[2]),u(3,1),b),T=this.scaleSlice(p[0]+p[0]+p[1]+C,Math.max(p[1],p[2]),u(4,1),b),D=this.scaleSlice(C,p[1]+p[2]+p[2],u(1,3),b),R=this.scaleSlice(C,p[1]+p[2]+p[2]+C,u(1,4),b);let N=!g&&(e<2||!i),M=!1,V=!1,I=!1;this.opts.multiplanarLayout===1?M=!0:this.opts.multiplanarLayout===2?V=!0:this.opts.multiplanarLayout===3?I=!0:D[4]>E[4]&&D[4]>S[4]?M=!0:E[4]>S[4]?I=!0:V=!0;let B=S;if(M?(B=D,!f&&(m||this.opts.multiplanarShowRender===2&&R[4]>=D[4])?B=R:N=!1):I&&(B=E,!f&&(m||this.opts.multiplanarShowRender===2&&T[4]>=E[4])?B=T:N=!1),f){const q=h[0]===0?this.effectiveCanvasWidth():h[0],se=h[1]===0?this.effectiveCanvasHeight():h[1];if(((r=this.opts)==null?void 0:r.heroSliceType)===0||((o=this.opts)==null?void 0:o.heroSliceType)===1||((l=this.opts)==null?void 0:l.heroSliceType)===2)this.draw2D([0,0,q,se],this.opts.heroSliceType,NaN,[1/0,1/0]);else{const G=B.slice(),W=this.effectiveCanvasWidth();q===W&&(G[0]=0),this.draw3D([G[0],0,q,se])}B[0]+=h[0],B[1]+=h[1],N=!1}const U=p[0]*B[4]+w,z=p[1]*B[4]+w,P=p[2]*B[4]+w,K=v[0]*B[4],_=v[1]*B[4],H=v[2]*B[4];if(M){if(this.draw2D([B[0],B[1],U,z],0,NaN,[K,_]),this.draw2D([B[0],B[1]+z+x,U,P],1,NaN,[K,H]),this.draw2D([B[0],B[1]+z+x+P+x,z,P],2,NaN,[_,H]),N){const q=C*B[4];this.draw3D([B[0],B[1]+z+P+P+x*3,q,q])}}else if(I){if(this.draw2D([B[0],B[1],U,z],0,NaN,[K,_]),this.draw2D([B[0]+U+x,B[1],U,P],1,NaN,[K,H]),this.draw2D([B[0]+U+U+x*2,B[1],z,P],2,NaN,[_,H]),N){const q=C*B[4];this.draw3D([B[0]+U+U+z+x*3,B[1],q,q])}}else V&&(m||(N=!1),this.opts.multiplanarShowRender===2&&(N=!0),f&&(N=!1),this.draw2D([B[0],B[1]+P+x,U,z],0,NaN,[K,_]),this.draw2D([B[0],B[1],U,P],1,NaN,[K,H]),this.draw2D([B[0]+U+x,B[1],z,P],2,NaN,[_,H]),N&&this.draw3D([B[0]+U+x,B[1]+P+x,z,z]))}}if(this.opts.isRuler&&this.drawRuler(),this.opts.isColorbar&&this.drawColorbar(),i&&this.drawGraph(),this.uiData.isDragging){if(this.uiData.mouseButtonCenterDown){this.dragForCenterButton([this.uiData.dragStart[0],this.uiData.dragStart[1],this.uiData.dragEnd[0],this.uiData.dragEnd[1]]);return}if(this.opts.dragMode===4){this.dragForSlicer3D([this.uiData.dragStart[0],this.uiData.dragStart[1],this.uiData.dragEnd[0],this.uiData.dragEnd[1]]);return}if(this.opts.dragMode===3){this.dragForPanZoom([this.uiData.dragStart[0],this.uiData.dragStart[1],this.uiData.dragEnd[0],this.uiData.dragEnd[1]]);return}if(this.inRenderTile(this.uiData.dragStart[0],this.uiData.dragStart[1])>=0)return;if(this.opts.dragMode===2){this.drawMeasurementTool([this.uiData.dragStart[0],this.uiData.dragStart[1],this.uiData.dragEnd[0],this.uiData.dragEnd[1]]);return}const h=Math.abs(this.uiData.dragStart[0]-this.uiData.dragEnd[0]),f=Math.abs(this.uiData.dragStart[1]-this.uiData.dragEnd[1]);this.drawSelectionBox([Math.min(this.uiData.dragStart[0],this.uiData.dragEnd[0]),Math.min(this.uiData.dragStart[1],this.uiData.dragEnd[1]),h,f]);return}const n=this.frac2mm([this.scene.crosshairPos[0],this.scene.crosshairPos[1],this.scene.crosshairPos[2]]);return t=n[0].toFixed(2)+""+n[1].toFixed(2)+""+n[2].toFixed(2),this.readyForSync=!0,this.sync(),this.drawAnchoredLabels(),t}drawScene(){if(this.isBusy){this.needsRefresh=!0;return}this.isBusy=!1,this.needsRefresh=!1;let t=this.drawSceneCore();return this._gl!==null&&this.gl.finish(),this.needsRefresh&&(t=this.drawScene()),t}get gl(){if(!this._gl)throw new Error("unable to get WebGL context. Maybe the browser doesn't support WebGL2.");return this._gl}set gl(t){this._gl=t}};async function Zh(t){try{const e=await fetch(t);if(!e.ok)throw new Error(`HTTP ${e.status}: ${e.statusText}`);return await e.json()}catch(e){throw console.error(`Fetch failed for ${t}:`,e),new Error(e)}}async function mg(){const t=localStorage.getItem("authToken");if(!t)return console.log("No token found"),!1;try{const e=await fetch("/api/refresh-token",{method:"POST",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"}});if(e.ok){const i=await e.json();return localStorage.setItem("authToken",i.token),console.log("Token refreshed successfully"),!0}else return console.error("Failed to refresh token:",e.status),!1}catch(e){return console.error("Error refreshing token:",e),!1}}function gg(t){return JSON.parse(atob(t.split(".")[1]))}function Wh(t){try{const e=gg(t),i=Math.floor(Date.now()/1e3);return e.exp>i}catch(e){return console.error("Invalid token:",e),!1}}async function _x(t,e,i){if(!t||!Wh(t)&&!mg())return null;try{const n=await fetch("/api/start-game-session",{method:"POST",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"},body:JSON.stringify({mode:e,atlas:i})});if(!n.ok){console.error("Failed to online game session on the backend.");const o=await n.json();return alert(o.message||"Failed to start game session."),null}const r=await n.json();return{sessionToken:r.sessionToken,sessionId:r.sessionId}}catch(n){return console.error("Error starting online game session:",n),alert("An error occurred while starting online game session. Please try again later."),null}}function jx({t,callback:e,currentLanguage:i,atlasRegions:n,askedAtlas:r,gameMode:o,preloadedAtlas:l,preloadedBackgroundMNI:h,viewerOptions:f,loadEnforcer:u,isLoggedIn:m,authToken:g}){const[E,T]=ie.useState(!1),[D,R]=ie.useState(!0),[N,M]=ie.useState(!1),[V,I]=ie.useState(0),[B,U]=ie.useState(0),[z,P]=ie.useState(0),[K,_]=ie.useState(0),[H,q]=ie.useState(0),[se,G]=ie.useState(0),W=ie.useRef(0),[le,ce]=ie.useState(0),[fe,ye]=ie.useState("00:00"),[me,He]=ie.useState(0),ve=ie.useRef(null),ze=ie.useRef(null),Ie=ie.useRef([]),Je=ie.useRef([]),[Ve,Xt]=ie.useState(null),[ft,Ui]=ie.useState({visible:!1,text:"",x:0,y:0}),Te=ie.useRef(null),Xe=ie.useRef(null),re=ie.useRef(new yf({show3Dcrosshair:!0,backColor:[0,0,0,1],crosshairColor:[1,1,1,1]})),ui=ie.useRef(null),Ut=ie.useRef(null),Ii=ie.useRef(null),$i=ie.useRef(null),us=ie.useRef(null),on=ie.useRef(null),[Fi,xi]=ie.useState(!1),Tt=ie.useRef(null),hi=ie.useRef(null),[It,Vi]=ie.useState(!1),Zt=ie.useRef(null),[Ne,Ye]=ie.useState(!1),pt=ie.useRef(null),[bt,At]=ie.useState(0);ie.useEffect(()=>{Ba(),Ds()},[]),ie.useEffect(()=>{const pe=we=>{we.code==="Space"&&(we.preventDefault(),qi()),we.code==="Escape"&&N&&o==="navigation"&&(we.preventDefault(),Wt()),we.key==="Escape"&&Fi&&xi(!1),we.key==="Escape"&&It&&Vi(!1),we.key==="Escape"&&Ne&&Ye(!1)};return document.addEventListener("keydown",pe),()=>{document.removeEventListener("keydown",pe)}},[N]);const qi=()=>{Ut.current&&!Ut.current.disabled&&N&&o!=="navigation"&&Ki()},Ba=()=>{re.current.attachTo("gl1").then(()=>{T(!0),re.current.setInterpolation(!0),re.current.opts.crosshairGap=0,re.current.opts.dragMode=re.current.dragModes.slicer3D,re.current.opts.yoke3Dto2DZoom=!0,Oa()})},ln=()=>{if(re.current&&r&&l&&h){for(let pe=1;pe<re.current.volumes.length;pe++)re.current.removeVolume(re.current.volumes[pe]);re.current.volumes.length==0&&re.current.addVolume(h),re.current.addVolume(l),re.current.setClipPlane([2,270,0]),re.current.opts.isSliceMM=!0}};function Bi(pe,we){const De=[];for(;De.length<pe;){var dt=Math.floor(Math.random()*we)+1;De.indexOf(dt)===-1&&De.push(dt)}return De}const cn=async()=>{var pe,we,De,dt,vt,_t;try{if(!r)return;const Ft=Kr[r];if(Te.current=await Zh("assets/atlas/descr/"+i+"/"+Ft.json),re.current&&re.current.volumes.length>1&&Te.current){re.current.volumes[1].setColormapLabel(Te.current),re.current.volumes[1].setColormapLabel({R:Bi(((pe=Te.current.labels)==null?void 0:pe.length)||0,255),G:Bi(((we=Te.current.labels)==null?void 0:we.length)||0,255),B:Bi(((De=Te.current.labels)==null?void 0:De.length)||0,255),A:Array(1).fill(0).concat(Array((((dt=Te.current.labels)==null?void 0:dt.length)||0)-1).fill(255)),I:Array.from(Array(((vt=Te.current.labels)==null?void 0:vt.length)||0).keys()),labels:Te.current.labels||[]}),Xe.current=((_t=re.current.volumes[1].colormapLabel)==null?void 0:_t.lut)||new Uint8ClampedArray,re.current.setOpacity(1,f.displayOpacity),re.current.updateGLVolume();const Ue=re.current.volumes[1].getVolumeData(),Ke=[...new Set(Ue.filter(xt=>xt>0).map(xt=>Math.round(xt)))];if(Ie.current=Ke.filter(xt=>{var Mt,Ct;return((Ct=(Mt=Te.current)==null?void 0:Mt.labels)==null?void 0:Ct[xt])!==void 0&&Number.isInteger(xt)}),console.log(`Atlas: ${Ft.name}`),console.log("Atlas Data Sample:",Ue.slice(0,10)),console.log("Data Regions (rounded):",Ke),console.log("Valid Regions:",Ie),Ie.current&&console.log("Valid Region Labels:",Ie.current.map(xt=>{var Mt,Ct;return(Ct=(Mt=Te.current)==null?void 0:Mt.labels)==null?void 0:Ct[xt]})),Ie.current.length===0){if(console.warn(`No valid regions found in ${Ft.name} data.`),Ie.current=Object.keys(Te.current.labels||[]).map(Number).filter(xt=>xt>0&&Number.isInteger(xt)),Ie.current.length===0)throw new Error(`No valid regions available for ${Ft.name}`);console.warn("Fallback to cmap.labels keys:",Ie)}}}catch(Ft){console.error(`Failed to load atlas data for ${r}:`,Ft),e.setHeaderText(t("error_loading_data",{atlas:r}))}};ie.useEffect(()=>{Ds()},[l,h,E,o,r,u]);const Ds=async()=>{l&&h&&E?(R(!1),ln(),await cn(),On()):R(!0)};ie.useEffect(()=>{W.current=se},[se]);const La=()=>{ve.current=null,ze.current=null,He(0),I(0),_(0),q(0),G(0),Je.current=[],Xt(null),e.setHeaderTextMode("normal"),e.setHeaderText(t(o==="navigation"?"click_to_identify":"not_started")),o==="navigation"?(e.setHeaderScore(""),e.setHeaderStreak(""),e.setHeaderErrors("")):o==="practice"?(e.setHeaderScore(t("correct_label")+": 0"),e.setHeaderErrors("0"),e.setHeaderStreak("")):o==="streak"?(e.setHeaderScore(t("correct_label")+": 0"),e.setHeaderErrors("0"),e.setHeaderStreak("0")):o==="time-attack"&&(e.setHeaderScore(t("score_label")+": 0"),e.setHeaderErrors("0"),e.setHeaderStreak("")),Ut.current&&(Ut.current.disabled=!0),Xe.current&&re.current&&re.current.volumes.length>1&&re.current.volumes[1].colormapLabel&&(re.current.volumes[1].colormapLabel.lut=new Uint8ClampedArray(Xe.current.slice()),re.current.updateGLVolume()),$i.current&&(clearInterval($i.current),$i.current=null),ft&&Ui({...ft,visible:!1}),xi(!1),Vi(!1),Ye(!1),re.current&&(Oa(),re.current.drawScene())},On=()=>{M(!0),La(),_x(g,o||"practice",r||"aal").then(pe=>{pe?(us.current=pe.sessionToken,on.current=pe.sessionId,console.log("Online session started:",pe)):console.warn("Failed to start online session, proceeding in offline mode."),console.log("is logged in, starting session")}).catch(pe=>{console.error("Error starting online session:",pe)}).finally(()=>{if(o==="time-attack"){if(!us.current)if(Ie.current.length>=18)Ie.current.sort(()=>.5-Math.random()),Ie.current=Ie.current.slice(0,18),console.log("Selected 18 regions for Time Attack:",Ie);else if(Ie.current.length>0)console.warn(`Not enough regions for Time Attack (18 required), using all ${Ie.current.length} available regions.`),Ie.current.sort(()=>.5-Math.random());else{console.error("No valid regions available for Time Attack!"),e.setHeaderText(t("no_regions_available")||"No regions available.");return}go()}Pn(),At(pe=>pe+1)})};function go(){Ii.current=Date.now(),kn(),$i.current=setInterval(()=>{kn()},500)}const kn=()=>{const pe=Math.floor(((Ii.current||Date.now())+1e5-Date.now())/1e3),we=Math.floor(pe/60).toString().padStart(2,"0"),De=(pe%60).toString().padStart(2,"0");e.setHeaderTime(`${we}:${De}`),pe<=0&&Ns()};function Ns(){$i.current&&clearInterval($i.current);const pe=Math.floor(((Ii.current||Date.now())+100*1e3-Date.now())/1e3),we=Math.floor((Date.now()-(Ii.current||0))/1e3);(we%60).toString().padStart(2,"0"),U(Math.round(V+(pe>0?pe*1:0))),P(we),Ye(!0),e.setHeaderTextMode("success"),M(!1),ze.current=null,Ut.current&&(Ut.current.disabled=!0)}const Pn=async()=>{let pe=-1;if(m)try{const we=await fetch("/api/get-next-region",{method:"POST",headers:{Authorization:`Bearer ${g}`,"Content-Type":"application/json"},body:JSON.stringify({sessionId:on.current,sessionToken:us.current})});if(!we.ok){const dt=await we.json();return console.error("Failed to get next region:",dt.message||"Unknown error"),!1}const De=await we.json();if(De.regionId>=0)pe=De.regionId;else return console.warn("No valid region ID received from server."),!1}catch(we){return console.error("Error occured during next region fetching:",we),!1}else if(o==="time-attack"&&Je.current&&Je.current.length>=18){Ns();return}else if(Ie.current&&Ie.current.length===0){console.warn("No valid regions available for target selection"),La();return}else if(Ie.current&&Je.current){let we=Ie.current.filter(De=>!Je.current.includes(De));console.log("avail",we.length),we.length!==0&&(pe=we[Math.floor(Math.random()*we.length)],(o==="time-attack"||o==="streak")&&Je.current.push(pe))}if(pe===-1)if(console.warn("No available regions for target selection in the remaining set."),o==="time-attack"){Ns();return}else if(o==="streak"){ce(W.current),G(0),Vi(!0);return}else{La();return}ve.current=pe,ve.current&&(At(we=>we+1),ze.current=null,o=="practice"&&He(0),Xe.current&&re.current&&(re.current.volumes[1].colormapLabel&&(re.current.volumes[1].colormapLabel.lut=new Uint8ClampedArray(Xe.current.slice())),re.current.updateGLVolume(),re.current.drawScene()))};ie.useEffect(()=>{Ve?zt():Xe.current&&re.current&&re.current.volumes.length>1&&re.current.volumes[1].colormapLabel&&(re.current.volumes[1].colormapLabel.lut=Xe.current,re.current.updateGLVolume(),re.current.drawScene())},[Ve]);const po=pe=>{var Ue,Ke,xt,Mt,Ct;if(!re.current||!re.current.gl||!re.current.volumes[1]||!Te.current||!N||!ui.current)return;const we=pe.type==="touchstart",De=we?pe.touches[0]:pe,dt=we?{...pe,layerX:pe.touches[0].clientX,layerY:pe.touches[0].clientY,offsetX:pe.touches[0].clientX,offsetY:pe.touches[0].clientY}:pe,vt=ui.current.getBoundingClientRect(),_t=De.clientX-vt.left,Ft=De.clientY-vt.top;if(_t>=0&&_t<vt.width&&Ft>=0&&Ft<vt.height){const yi=re.current.getNoPaddingNoBorderCanvasRelativeMousePosition(dt,re.current.gl.canvas);if(!yi)return;const ka=re.current.canvasPos2frac([yi.x*(((Ue=re.current.uiData)==null?void 0:Ue.dpr)??1),yi.y*(((Ke=re.current.uiData)==null?void 0:Ke.dpr)??1)]);if(ka[0]>=0){const Ao=re.current.frac2mm(ka),hs=re.current.volumes[1].mm2vox(Array.from(Ao)),es=Math.round(re.current.volumes[1].getValue(hs[0],hs[1],hs[2]));isFinite(es)&&es>0&&es in(((xt=Te.current)==null?void 0:xt.labels)??[])?(ze.current=Array.from(hs),o==="navigation"?(e.setHeaderText(((Mt=Te.current.labels)==null?void 0:Mt[es])||t("no_region_selected")),Xt(es),ft&&Ui({...ft,visible:!1}),re.current.opts.crosshairColor=[1,1,1,1],re.current.drawScene()):(Ut.current&&(Ut.current.disabled=!1),re.current.opts.crosshairColor=[1,1,1,1],re.current.drawScene()),console.log(`Clicked voxel: ${hs}, Region ID: ${es}, Region Name: ${((Ct=Te.current.labels)==null?void 0:Ct[es])||t("unknown_region")}`)):(ze.current=null,o==="navigation"?(e.setHeaderText(t("no_region_selected")),Xt(null)):Ut.current&&(Ut.current.disabled=!0),console.log(`Clicked voxel: ${hs}, Invalid or background region ID: ${es}`))}}},Ki=async()=>{var _t,Ft;if(!ze.current||!N||!ve.current){console.warn("Cannot validate guess:",{selectedVoxel:ze,isGameRunning:N,currentTarget:ve});return}let pe=null,we=!1,De=null;if(m)try{const Ue=localStorage.getItem("authToken"),xt=await(await fetch("/api/validate-region",{method:"POST",headers:{Authorization:`Bearer ${Ue}`,"Content-Type":"application/json"},body:JSON.stringify({sessionId:on.current,sessionToken:us.current,coordinates:ze.current})})).json();pe=xt.isCorrect,we=xt.endgame,De=xt.voxelValue}catch(Ue){return console.error("Error occured during region validation:",Ue),!1}else De=Math.round(re.current.volumes[1].getValue(ze.current[0],ze.current[1],ze.current[2])),pe=De===ve.current;const dt=Te.current&&((_t=Te.current.labels)!=null&&_t[ve.current])?Te.current.labels[ve.current]:t("unknown_region"),vt=De&&Te.current&&((Ft=Te.current.labels)!=null&&Ft[De])?Te.current.labels[De]:t("unknown_region");if(pe)_(Ue=>Ue+1),o==="time-attack"&&I(Ue=>Ue+50),o==="streak"&&G(Ue=>Ue+1),He(o==="practice"?0:Ue=>Ue+1),e.setHeaderTextMode("success"),Xe.current&&re.current&&re.current.volumes.length>1&&re.current.volumes[1].colormapLabel&&(re.current.volumes[1].colormapLabel.lut=Xe.current,re.current.updateGLVolume(),re.current.drawScene()),ze.current=null,Ut.current&&(Ut.current.disabled=!0),setTimeout(()=>{Pn()},100);else{if(q(Ue=>Ue+1),He(Ue=>Ue+1),o==="practice"){const Ue=t("incorrect",{region:vt});e.setHeaderText(Ue),e.setHeaderTextMode("failure"),console.log(`Incorrect guess: ${vt} (ID: ${De}), Expected: ${dt} (ID: ${ve})`),console.log(me,3),me>=2&&Xt(ve.current),setTimeout(()=>{const Ke=t("find")||"Find: ";e.setHeaderText(Ke+dt),e.setHeaderTextMode("normal")},3e3)}else if(o==="time-attack"){let Ue=0;if(!m){if(Te.current&&Te.current.labels&&Te.current.centers){const Mt=Te.current.centers?Te.current.centers[ve.current]:null,Ct=Te.current.centers&&De?Te.current.centers[De]:null;if(Mt&&Ct){const yi=Math.sqrt(Math.pow(Mt[0]-Ct[0],2)+Math.pow(Mt[1]-Ct[1],2)+Math.pow(Mt[2]-Ct[2],2));Ue=50*(1-Math.min(yi,100)/100),Ue=Math.max(0,Ue),console.log("Time Attack Error:"),console.log(`  Target Region ID: ${ve} (${dt}), Clicked Region ID: ${De} (${vt})`),console.log(`  Correct Center: ${Mt}`),console.log(`  Clicked Center: ${Ct}`),console.log(`  Calculated Distance: ${yi.toFixed(2)} mm`),console.log(`  Points earned for this error: ${Ue.toFixed(2)}`)}else console.warn(`Center data missing for region ${ve} or ${De}. Cannot calculate distance-based score.`),Ue=0}}I(Mt=>Mt+Ue);const Ke=t("incorrect_prefix")||"Incorrect! It's ",xt=Math.round(Ue)>0?` (+${Ue.toFixed(1)} pts)`:" (+0 pts)";e.setHeaderText(Ke+vt+"!"+xt),e.setHeaderTextMode("failure"),At(Mt=>Mt+1),setTimeout(()=>{Pn()},100)}else o==="streak"&&(ce(W.current),G(0),Vi(!0),e.setHeaderTextMode("failure"),M(!1));ze.current=null,Ut.current&&(Ut.current.disabled=!0),o!=="practice"&&At(Ue=>Ue+1)}if(we){if(o==="time-attack")Ns();else if(o==="streak"){ce(W.current),G(0),Vi(!0);return}}};function zt(){var pe;if(!(o==="navigation"&&Ve===0))if(console.log("highlightRegionFluorescentYellow called with regionId:",Ve),Xe.current&&re.current&&Ve&&Ve*4<Xe.current.length){const we=Xe.current.slice();for(let De=0;De<we.length/4;De++)(De!==0||r==="aal"||r==="glasser"||r==="destrieux"||r==="schaefer")&&(we[De*4+3]=0);we[Ve*4+0]=255,we[Ve*4+1]=255,we[Ve*4+2]=0,we[Ve*4+3]=255,re.current.volumes[1].colormapLabel&&(re.current.volumes[1].colormapLabel.lut=new Uint8ClampedArray(we)),re.current.updateGLVolume(),re.current.drawScene()}else console.error("Cannot highlight region:",{clut:!!Xe.current,nv1:!!re.current,highlightedRegion:Ve,lutLength:(pe=Xe.current)==null?void 0:pe.length})}const Wt=()=>{N&&o==="navigation"&&(Xe.current&&re.current&&re.current.volumes.length>1&&re.current.volumes[1].colormapLabel&&(re.current.volumes[1].colormapLabel.lut=Xe.current,re.current.updateGLVolume(),re.current.drawScene()),e.setHeaderText(t("click_to_identify")),ze.current=null,Xt(null),ft&&Ui({...ft,visible:!1}),re.current.opts.crosshairColor=[1,1,1,1],re.current.drawScene())},Rs=()=>{var pe,we,De;if(o==="time-attack"?e.setHeaderScore(t("score_label")+`: ${Math.round(V)}`):(o==="streak"||o==="practice")&&e.setHeaderScore(t("correct_label")+`: ${K}`),(o==="time-attack"||o==="streak"||o==="practice")&&e.setHeaderErrors(`${H}`),o==="streak"&&e.setHeaderStreak(`${se}`),o==="navigation")e.setHeaderText(Ve?((we=(pe=Te.current)==null?void 0:pe.labels)==null?void 0:we[Ve])||t("no_region_selected"):t("click_to_identify"));else if(ve.current!==null&&Te.current&&Te.current.labels&&Te.current.labels[ve.current]){const dt=t("find")||"Find: ";o==="time-attack"?e.setHeaderText(`${me}/18 - ${dt}${Te.current.labels[ve.current]}`):e.setHeaderText(dt+Te.current.labels[ve.current]),console.log(`Displaying target: ${Te.current.labels[ve.current]} (ID: ${ve.current})`)}else e.setHeaderText(t("find")+t("unknown_region")),console.error(`No label for currentTarget ${ve}`,(De=Te.current)==null?void 0:De.labels)},zn=pe=>{if(!N||!ui.current||!re.current||o!=="navigation"||Ve!==null){Ui({...ft,visible:!1});return}const we=ui.current.getBoundingClientRect(),De=pe.pageX,dt=pe.clientY-we.top,vt=re.current.getNoPaddingNoBorderCanvasRelativeMousePosition(pe,re.current.gl.canvas);if(De>=0&&De<we.width&&dt>=0&&dt<we.height&&vt&&Te.current&&Te.current.labels&&re.current.uiData&&re.current.uiData.dpr){const _t=re.current.canvasPos2frac([vt.x*re.current.uiData.dpr,vt.y*re.current.uiData.dpr]);if(_t[0]>=0){const Ft=re.current.frac2mm(_t),Ue=re.current.volumes[1].mm2vox(Array.from(Ft)),Ke=Math.round(re.current.volumes[1].getValue(Ue[0],Ue[1],Ue[2]));isFinite(Ke)&&Ke>0&&Ke in Te.current.labels?Ui({visible:!0,text:Te.current.labels[Ke]||t("unknown_region"),x:De+10,y:dt+10}):Ui({...ft,visible:!1})}}else Ui({...ft,visible:!1})};ie.useEffect(()=>{Rs()},[V,K,H,se,o,ve.current,Ve,bt]),ie.useEffect(()=>{const pe=we=>{Fi&&Tt.current&&hi.current&&!hi.current.contains(we.target)&&!Tt.current.contains(we.target)&&xi(!1),It&&Zt.current&&!Zt.current.contains(we.target)&&Vi(!1),Ne&&pt.current&&!pt.current.contains(we.target)&&Ye(!1)};return document.addEventListener("click",pe),()=>{document.removeEventListener("click",pe)}},[Fi]);const Oa=()=>{re.current&&(f.displayType==="Axial"&&re.current.setSliceType(re.current.sliceTypeAxial),f.displayType==="Coronal"&&re.current.setSliceType(re.current.sliceTypeCoronal),f.displayType==="Sagittal"&&re.current.setSliceType(re.current.sliceTypeSagittal),f.displayType==="Render"&&(re.current.setSliceType(re.current.sliceTypeRender),re.current.setClipPlane(re.current.meshes.length>0?[-.1,270,0]:[2,270,0])),f.displayType==="MultiPlanar"&&(re.current.opts.multiplanarShowRender=Ua.NEVER,re.current.setSliceType(re.current.sliceTypeMultiplanar)),f.displayType==="MultiPlanarRender"&&(re.current.opts.multiplanarShowRender=Ua.ALWAYS,re.current.setSliceType(re.current.sliceTypeMultiplanar)),re.current.volumes.length>1&&re.current.setOpacity(1,f.displayAtlas?f.displayOpacity:0),re.current.opts.isRadiologicalConvention=f.radiologicalOrientation,re.current.updateGLVolume())};return ie.useEffect(()=>{Oa()},[f]),L.jsxs("div",{className:"page-container",children:[ft.visible&&L.jsx("div",{className:"region-tooltip",style:{position:"absolute",left:ft.x,top:ft.y},children:ft.text}),D&&L.jsx("div",{className:"loading-screen"}),L.jsx("canvas",{id:"gl1",onClick:po,onTouchStart:po,onMouseMove:zn,onMouseLeave:zn,ref:ui}),L.jsxs("div",{className:"button-container",children:[L.jsx("button",{className:"return-button",onClick:()=>e.gotoPage("welcome"),children:t("return_button")}),o=="navigation"&&L.jsx("button",{className:"return-button",onClick:Wt,children:t("restore_color")}),o!="navigation"&&L.jsxs("button",{className:"guess-button",ref:Ut,onClick:Ki,children:[L.jsx("span",{className:"confirm-text",children:t("confirm_guess")}),L.jsx("span",{className:"space-text",children:t("space_key")})]})]}),Fi&&L.jsx("div",{id:"help-overlay",className:"help-overlay",children:L.jsxs("div",{className:"help-content",ref:Tt,children:[L.jsx("button",{id:"close-help",className:"close-button",onClick:()=>xi(!1),children:""}),L.jsx("h2",{children:t("viewer_help_title")}),L.jsx("div",{id:"help-mode-description",dangerouslySetInnerHTML:{__html:(()=>{switch(o){case"navigation":return t("viewer_help_navigation");case"practice":return t("viewer_help_practice");case"streak":return t("viewer_help_streak");case"time-attack":return t("viewer_help_time_attack");default:return t("viewer_help_general")}})()}}),L.jsxs("section",{children:[L.jsx("h3",{children:t("viewer_controls_title")}),L.jsx("p",{children:t("viewer_controls_text")})]})]})}),L.jsx("div",{ref:hi,children:L.jsx("button",{id:"help-button",className:"help-button",onClick:()=>xi(!0),children:L.jsx("i",{className:"fas fa-question"})})}),It&&L.jsx("div",{id:"streak-end-overlay",className:"streak-overlay",children:L.jsxs("div",{className:"overlay-content",ref:Zt,children:[L.jsx("h2",{children:t("streak_ended_title")}),L.jsxs("p",{children:[L.jsx("span",{children:t("streak_ended_score")}),L.jsx("span",{id:"final-streak",className:"streak-number",children:le})]}),L.jsxs("div",{className:"overlay-buttons",children:[L.jsx("button",{id:"go-back-menu-button-streak",className:"home-button",onClick:()=>e.gotoPage("welcome"),children:L.jsx("i",{className:"fas fa-home"})}),L.jsx("button",{id:"restart-button-streak",className:"restart-button",onClick:()=>{Vi(!1),On()},children:L.jsx("i",{className:"fas fa-sync-alt"})})]})]})}),Ne&&L.jsx("div",{id:"time-attack-end-overlay",className:"time-attack-overlay",children:L.jsxs("div",{className:"overlay-content",ref:pt,children:[L.jsx("h2",{children:t("time_attack_ended_title")}),L.jsxs("p",{children:[L.jsx("span",{children:t("time_attack_ended_time")}),L.jsx("span",{id:"final-time-attack-time",children:z})]}),L.jsx("p",{children:L.jsx("span",{children:t("time_attack_ended_score")})}),L.jsxs("div",{className:"score-progress-bar w3-light-grey w3-round",children:[L.jsx("div",{id:"time-attack-score-bar",className:"w3-container w3-round w3-blue",style:{width:B/1e3*100+"%"},children:B}),L.jsx("span",{className:"progress-label progress-label-med",children:Math.round(1e3*.5)}),L.jsx("span",{className:"progress-label progress-label-max",children:Math.round(1e3*1)})]}),L.jsxs("div",{className:"overlay-buttons",children:[L.jsx("button",{id:"go-back-menu-button-time-attack",className:"home-button",onClick:()=>e.gotoPage("welcome"),children:L.jsx("i",{className:"fas fa-home"})}),L.jsx("button",{id:"restart-button-time-attack",className:"restart-button",onClick:()=>{Ye(!1),On()},children:L.jsx("i",{className:"fas fa-sync-alt"})})]})]})})]})}function Gx({t,callback:e}){const i=ie.useRef(null),n=ie.useRef(null),r=ie.useRef(null),[o,l]=ie.useState(!1),[h,f]=ie.useState(""),[u,m]=ie.useState(""),[g,p]=ie.useState(""),[v,x]=ie.useState(""),w=async S=>{var T,D;S.preventDefault();const C=(T=i.current)==null?void 0:T.value.trim(),E=(D=n.current)==null?void 0:D.value.trim();if(f(""),!C||!E){f(t("error_empty_fields"));return}try{const R=await fetch("/api/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:C,password:E})}),N=await R.json();R.ok?(f(""),m(t("login_success")),e.loginWithToken(N.token),e.gotoPage("welcome")):f(N.message||t("login_failed"))}catch(R){console.error("Error during login:",R),f(t("server_error"))}},b=async()=>{var C;const S=(C=r.current)==null?void 0:C.value.trim();if(document.getElementById("recovery-message"),p(""),!S){p(t("error_empty_email"));return}try{const E=await fetch("/api/password-recovery",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:S})}),T=await E.json();E.ok?T.preverified?(alert(T.redirect_url),window.location.href=T.redirect_url):x(t("recovery_email_sent")):p(T.message||t("recovery_failed"))}catch(E){console.error("Error during password recovery:",E),p(t("server_error"))}};return L.jsx(L.Fragment,{children:L.jsxs("div",{className:"page-container",children:[L.jsx("form",{id:"login_form",onSubmit:w,children:L.jsxs("div",{className:"login-box",children:[L.jsx("h2",{children:t("login_mode")}),L.jsxs("table",{className:"login-element",children:[L.jsxs("tr",{children:[L.jsx("td",{children:L.jsx("label",{id:"username-label",htmlFor:"username",children:t("login_username")})}),L.jsx("td",{children:L.jsx("input",{type:"text",id:"username",name:"username",ref:i,required:!0})})]}),L.jsxs("tr",{children:[L.jsx("td",{children:L.jsx("label",{id:"password-label",htmlFor:"password",children:t("login_password")})}),L.jsx("td",{children:L.jsx("input",{type:"password",id:"password",name:"password",ref:n,required:!0})})]}),h!=""&&L.jsx("tr",{children:L.jsx("td",{colSpan:2,id:"login_error",children:h})}),u!=""&&L.jsx("tr",{children:L.jsx("td",{colSpan:2,id:"login_success",children:u})})]}),L.jsx("button",{type:"submit",children:t("login_button")}),L.jsx("a",{id:"registration_link",onClick:()=>e.gotoPage("register"),children:t("registration_link")}),L.jsx("a",{id:"forgot_password_link",onClick:()=>l(!0),children:t("forgot_password_link")})]})}),o&&L.jsx("div",{id:"password-recovery-modal",className:"modal",children:L.jsxs("div",{className:"modal-content",children:[L.jsx("span",{className:"close-button",id:"close-password-recovery",children:""}),L.jsx("h2",{children:t("password_recovery_title")}),L.jsx("p",{children:t("password_recovery_instructions")}),L.jsx("input",{type:"email",id:"recovery-email",className:"form-field",placeholder:t("enter_your_email"),required:!0,ref:r}),L.jsx("button",{id:"send-recovery-email",className:"form-button",onClick:()=>b(),children:t("send_recovery_email")}),g&&L.jsx("p",{id:"recovery_error",className:"recovery-message",children:g}),v&&L.jsx("p",{id:"recovery_success",className:"recovery-message",children:v})]})})]})})}function Yx({t,callback:e}){const i=ie.useRef(null),n=ie.useRef(null),r=ie.useRef(null),o=ie.useRef(null),l=ie.useRef(null),h=ie.useRef(null),[f,u]=ie.useState(""),[m,g]=ie.useState(""),p=async v=>{var V,I,B,U,z,P;v.preventDefault();const x=(V=i.current)==null?void 0:V.value,w=(I=n.current)==null?void 0:I.value,b=(B=r.current)==null?void 0:B.value,S=(U=o.current)==null?void 0:U.value,C=(z=l.current)==null?void 0:z.value,E=(P=h.current)==null?void 0:P.value,T=/^[^\s@]+@[^\s@]+\.[^\s@]+$/,D={min:8},R=[];R.push("(?=.*[a-z])"),R.push("(?=.*[A-Z])"),R.push("(?=.*\\d)"),R.push("(?=.*[@$!%*?&])");const N=new RegExp(`^${R.join("")}.{${D.min},}$`);if(!x||!w||!b||!S||!C||!E){u(t("error_empty_fields"));return}else{if(!T.test(w.trim())){u(t("error_invalid_email"));return}if(N.test(C)){if(C!==E){u(t("error_password_mismatch"));return}}else{u(t("error_password_complexity"));return}}const M={username:x.trim(),email:w.trim(),firstname:b.trim(),lastname:S.trim(),password:C.trim()};try{const K=await fetch("/api/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(M)}),_=await K.json();K.ok?_.preverified?(u(""),g(t("register_success_no_verification")),setTimeout(()=>{e.gotoPage("login")},2e3)):(u(""),g(t("register_success"))):u(_.message||t("register_failed"))}catch(K){console.error("Error submitting the form:",K),u(t("server_error"))}};return L.jsx("div",{className:"page-container",children:L.jsx("form",{id:"register_form",onSubmit:p,children:L.jsxs("div",{className:"register-box",children:[L.jsx("h2",{children:t("register_mode")}),L.jsxs("table",{className:"login-element",children:[L.jsxs("tr",{children:[L.jsx("td",{children:L.jsx("label",{id:"username-label",htmlFor:"username",children:t("login_username")})}),L.jsx("td",{children:L.jsx("input",{type:"text",id:"username",name:"username",ref:i,required:!0})})]}),L.jsxs("tr",{children:[L.jsx("td",{children:L.jsx("label",{id:"email-label",htmlFor:"email",children:t("login_email")})}),L.jsx("td",{children:L.jsx("input",{type:"email",id:"email",name:"email",ref:n,required:!0})})]}),L.jsxs("tr",{children:[L.jsx("td",{children:L.jsx("label",{id:"firstname-label",htmlFor:"firstname",children:t("login_firstname")})}),L.jsx("td",{children:L.jsx("input",{type:"text",id:"firstname",name:"firstname",ref:r,required:!0})})]}),L.jsxs("tr",{children:[L.jsx("td",{children:L.jsx("label",{id:"lastname-label",htmlFor:"lastname",children:t("login_lastname")})}),L.jsx("td",{children:L.jsx("input",{type:"text",id:"lastname",name:"lastname",ref:o,required:!0})})]}),L.jsxs("tr",{children:[L.jsx("td",{children:L.jsx("label",{id:"password-label",htmlFor:"password",children:t("login_password")})}),L.jsx("td",{children:L.jsx("input",{type:"password",id:"password",name:"password",ref:l,required:!0})})]}),L.jsx("tr",{children:L.jsx("td",{colSpan:2,id:"password-helper",className:"password-helper",children:t("password_helper")})}),L.jsxs("tr",{children:[L.jsx("td",{children:L.jsx("label",{id:"confirm_password-label",htmlFor:"confirm_password",children:t("login_confirm_password")})}),L.jsx("td",{children:L.jsx("input",{type:"password",id:"confirm_password",name:"confirm_password",ref:h,required:!0})})]}),f!=""&&L.jsx("tr",{children:L.jsx("td",{colSpan:2,id:"register_error",children:f})}),m!=""&&L.jsx("tr",{children:L.jsx("td",{colSpan:2,id:"register_success",children:m})})]}),m==""&&L.jsx("button",{type:"submit",children:t("register_button")})]})})})}function Hx({t,callback:e}){return L.jsx(L.Fragment,{children:L.jsx("div",{children:"Placeholder for email validation"})})}function qx({t,callback:e}){return L.jsxs("div",{id:"unlogged-landing-page",className:"landing-content",children:[L.jsxs("div",{className:"welcome-section",children:[L.jsx("h2",{className:"welcome-message",children:t("welcome_unlogged")}),L.jsx("p",{"data-i18n":"welcome_text_unlogged",children:t("welcome_text_unlogged")})]}),L.jsx("div",{className:"sign-in-panel",children:L.jsxs("div",{className:"sign-in-options-container",children:[L.jsx("button",{className:"option-button sign-in-button",onClick:()=>e.gotoPage("login"),children:t("sign_in")}),L.jsx("button",{className:"option-button sign-up-button",onClick:()=>e.gotoPage("register"),children:t("sign_up")}),L.jsx("button",{className:"option-button continue-button",onClick:()=>e.activateGuestMode(),children:t("no_sign_in")})]})})]})}function Kx({t,callback:e,authToken:i}){const[n,r]=ie.useState({}),[o,l]=ie.useState(!0),[h,f]=ie.useState(null);return ie.useEffect(()=>{(async()=>{if(!i){f(t("not_logged_in_error")),l(!1);return}try{const m=await fetch("/api/user/best-scores",{headers:{Authorization:`Bearer ${i}`}});if(!m.ok)throw new Error(`HTTP error! status: ${m.status}`);const g=await m.json(),p={};g.forEach(v=>{p[v.mode]||(p[v.mode]={}),p[v.mode][v.atlas]=v}),r(p)}catch(m){console.error("Failed to fetch best scores:",m),f(t("error_fetching_stats")+m.message)}finally{l(!1)}})()},[i,t]),o?L.jsx("div",{className:"stats-container",children:t("loading_stats")}):h?L.jsx("div",{className:"stats-container stats-error",children:h}):Object.keys(n).length===0?L.jsx("div",{className:"stats-container",children:t("no_stats_yet")}):L.jsxs("div",{className:"stats-container",children:[L.jsx("h1",{children:t("your_best_scores")}),Object.entries(n).map(([u,m])=>L.jsxs("div",{className:"stats-mode-section",children:[L.jsx("h2",{children:t(`${u}_mode`)})," ",Object.entries(m).map(([g,p])=>L.jsxs("div",{className:"stats-item",children:[L.jsx("h3",{dangerouslySetInnerHTML:{__html:t(`${g}_info`)}}),L.jsxs("p",{children:[t("score"),": **",p.score,"**"]}),u!=="streak"&&L.jsxs(L.Fragment,{children:[L.jsxs("p",{children:[t("accuracy"),": **",(p.accuracy*100).toFixed(2),"%**"]}),L.jsxs("p",{children:[t("duration"),": **",p.duration,"** ",t("seconds")]})]})]},`${u}-${g}`))]},u))]})}function Qx({t,callback:e}){const[i,n]=ie.useState(!1);ie.useRef(null);const r=ie.useRef(null),o=ie.useRef(null),[l,h]=ie.useState(""),[f,u]=ie.useState(""),[m,g]=ie.useState(null),[p,v]=ie.useState(null);ie.useEffect(()=>{x()},[]);const x=async()=>{const b=new URLSearchParams(window.location.search),S=b.get("token"),C=b.get("id");g(C),v(S),(!S||!C)&&h(t("error_invalid_token"));try{const E=await fetch("/api/validate-reset-token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:C,token:S})}),T=await E.json();E.ok?n(!0):h(t("error_invalid_token"))}catch(E){console.error("Error validating token:",E),h(t("server_error"))}},w=async b=>{var R,N;b.preventDefault();const S=(R=r.current)==null?void 0:R.value,C=(N=o.current)==null?void 0:N.value;console.log(S,C);const E={min:8},T=[];T.push("(?=.*[a-z])"),T.push("(?=.*[A-Z])"),T.push("(?=.*\\d)"),T.push("(?=.*[@$!%*?&])");const D=new RegExp(`^${T.join("")}.{${E.min},}$`);if(!S||!C){h(t("error_empty_fields"));return}if(S!==C){h(t("error_password_mismatch"));return}if(!D.test(S)){h(t("error_password_complexity"));return}if(!p||!m){h(t("error_invalid_token"));return}try{const M=await fetch("/api/reset-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:m,token:p,password:S})}),V=await M.json();M.ok?(u(t("password_reset_success")),e.loginWithToken(V.token),e.gotoPage("welcome")):h(V.message||t("password_reset_failed"))}catch(M){console.error("Error resetting password:",M),h(t("server_error"))}};return L.jsx("div",{className:"page-container",children:L.jsx("form",{id:"reset-password-form",onSubmit:w,children:L.jsxs("div",{className:"register-box",children:[L.jsx("h2",{children:t("reset_password_header")}),L.jsxs("table",{className:"login-element",children:[i&&L.jsxs("tr",{className:"password-reset-units",children:[L.jsx("td",{children:L.jsx("label",{id:"password-label",htmlFor:"password",children:t("new_password_label")})}),L.jsx("td",{children:L.jsx("input",{type:"password",id:"password",name:"password",required:!0,ref:r})})]}),i&&L.jsx("tr",{className:"password-reset-units",children:L.jsx("td",{colSpan:2,id:"password-helper",className:"password-helper",children:t("password_helper")})}),i&&L.jsxs("tr",{className:"password-reset-units",children:[L.jsx("td",{children:L.jsx("label",{id:"confirm_password-label",htmlFor:"confirm_password",children:t("login_confirm_password")})}),L.jsx("td",{children:L.jsx("input",{type:"password",id:"confirm_password",name:"confirm_password",required:!0,ref:o})})]}),l&&L.jsx("tr",{children:L.jsx("td",{colSpan:2,id:"recovery_error",className:"recovery-message",children:l})}),f&&L.jsx("tr",{children:L.jsx("td",{colSpan:2,id:"recovery_success",className:"recovery-message",children:f})})]}),i&&L.jsx("button",{type:"submit",className:"password-reset-units",children:t("reset_password_button")})]})})})}function Xx({t,callback:e,authToken:i}){const n=ie.useRef(null),r=ie.useRef(null),o=ie.useRef(null),l=ie.useRef(null),h=ie.useRef(null),f=ie.useRef(null),[u,m]=ie.useState(""),[g,p]=ie.useState("");ie.useEffect(()=>{v()},[]);const v=async()=>{try{const w=await fetch("/api/user-info",{method:"GET",headers:{Authorization:`Bearer ${localStorage.getItem("authToken")}`,"Content-Type":"application/json"}}),b=await w.json();w.ok?(n.current&&(n.current.value=b.user.username),r.current&&(r.current.value=b.user.email),o.current&&(o.current.value=b.user.firstname),l.current&&(l.current.value=b.user.lastname)):m(b.message||t("error_loading_user_info"))}catch(w){console.error("Error loading user info:",w),m(t("server_error"))}},x=async w=>{var M,V,I,B;w.preventDefault();const b=(M=o.current)==null?void 0:M.value,S=(V=l.current)==null?void 0:V.value,C=(I=h.current)==null?void 0:I.value,E=(B=f.current)==null?void 0:B.value;m("");const T={min:8},D=[];D.push("(?=.*[a-z])"),D.push("(?=.*[A-Z])"),D.push("(?=.*\\d)"),D.push("(?=.*[@$!%*?&])");const R=new RegExp(`^${D.join("")}.{${T.min},}$`);if(!b||!S){m(t("error_empty_fields"));return}else if(C&&!R.test(C)){m(t("error_password_complexity"));return}else if(C!==E){m(t("error_password_mismatch"));return}let N={firstname:b.trim(),lastname:S.trim()};C&&(N.password=C.trim());try{const U=await fetch("/api/config-user",{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("authToken")}`,"Content-Type":"application/json"},body:JSON.stringify(N)}),z=await U.json();U.ok?p(t("reconfigure_success")):m(z.message||t("reconfigure_failed"))}catch(U){console.error("Error submitting the form:",U),m(t("server_error"))}};return L.jsx("div",{className:"page-container",children:L.jsx("form",{id:"reconfigure_form",onSubmit:x,children:L.jsxs("div",{className:"register-box",children:[L.jsx("h2",{children:t("reconfigure_mode")}),L.jsxs("table",{className:"login-element",children:[L.jsxs("tr",{children:[L.jsx("td",{children:L.jsx("label",{id:"username-label",htmlFor:"username",children:t("login_username")})}),L.jsx("td",{children:L.jsx("input",{type:"text",id:"username",name:"username",ref:n,disabled:!0})})]}),L.jsxs("tr",{children:[L.jsx("td",{children:L.jsx("label",{id:"email-label",htmlFor:"email",children:t("login_email")})}),L.jsx("td",{children:L.jsx("input",{type:"email",id:"email",name:"email",ref:r,disabled:!0})})]}),L.jsxs("tr",{children:[L.jsx("td",{children:L.jsx("label",{id:"firstname-label",htmlFor:"firstname",children:t("login_firstname")})}),L.jsx("td",{children:L.jsx("input",{type:"text",id:"firstname",name:"firstname",required:!0,ref:o})})]}),L.jsxs("tr",{children:[L.jsx("td",{children:L.jsx("label",{id:"lastname-label",htmlFor:"email",children:t("login_lastname")})}),L.jsx("td",{children:L.jsx("input",{type:"text",id:"lastname",name:"lastname",required:!0,ref:l})})]}),L.jsxs("tr",{children:[L.jsx("td",{children:L.jsx("label",{id:"password-label",htmlFor:"password",children:t("login_password")})}),L.jsx("td",{children:L.jsx("input",{type:"password",id:"password",name:"password",ref:h})})]}),L.jsx("tr",{children:L.jsx("td",{colSpan:2,className:"password-helper",children:t("password-helper-leaveempty")})}),L.jsx("tr",{children:L.jsx("td",{colSpan:2,id:"password-helper",className:"password-helper",children:t("password_helper")})}),L.jsxs("tr",{children:[L.jsx("td",{children:L.jsx("label",{id:"confirm_password-label",htmlFor:"confirm_password",children:t("login_confirm_password")})}),L.jsx("td",{children:L.jsx("input",{type:"password",id:"confirm_password",name:"confirm_password",ref:f})})]}),u&&L.jsx("tr",{children:L.jsx("td",{colSpan:2,id:"reconfigure_error",children:u})}),g&&L.jsx("tr",{children:L.jsx("td",{colSpan:2,id:"reconfigure_success",children:g})})]}),L.jsx("button",{type:"submit",children:t("reconfigure_button")})]})})})}const Re=t=>typeof t=="string",kr=()=>{let t,e;const i=new Promise((n,r)=>{t=n,e=r});return i.resolve=t,i.reject=e,i},om=t=>t==null?"":""+t,Zx=(t,e,i)=>{t.forEach(n=>{e[n]&&(i[n]=e[n])})},Wx=/###/g,lm=t=>t&&t.indexOf("###")>-1?t.replace(Wx,"."):t,cm=t=>!t||Re(t),qr=(t,e,i)=>{const n=Re(e)?e.split("."):e;let r=0;for(;r<n.length-1;){if(cm(t))return{};const o=lm(n[r]);!t[o]&&i&&(t[o]=new i),Object.prototype.hasOwnProperty.call(t,o)?t=t[o]:t={},++r}return cm(t)?{}:{obj:t,k:lm(n[r])}},um=(t,e,i)=>{const{obj:n,k:r}=qr(t,e,Object);if(n!==void 0||e.length===1){n[r]=i;return}let o=e[e.length-1],l=e.slice(0,e.length-1),h=qr(t,l,Object);for(;h.obj===void 0&&l.length;)o=`${l[l.length-1]}.${o}`,l=l.slice(0,l.length-1),h=qr(t,l,Object),h!=null&&h.obj&&typeof h.obj[`${h.k}.${o}`]<"u"&&(h.obj=void 0);h.obj[`${h.k}.${o}`]=i},Jx=(t,e,i,n)=>{const{obj:r,k:o}=qr(t,e,Object);r[o]=r[o]||[],r[o].push(i)},Wl=(t,e)=>{const{obj:i,k:n}=qr(t,e);if(i&&Object.prototype.hasOwnProperty.call(i,n))return i[n]},$x=(t,e,i)=>{const n=Wl(t,i);return n!==void 0?n:Wl(e,i)},pg=(t,e,i)=>{for(const n in e)n!=="__proto__"&&n!=="constructor"&&(n in t?Re(t[n])||t[n]instanceof String||Re(e[n])||e[n]instanceof String?i&&(t[n]=e[n]):pg(t[n],e[n],i):t[n]=e[n]);return t},Ea=t=>t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");var ey={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};const ty=t=>Re(t)?t.replace(/[&<>"'\/]/g,e=>ey[e]):t;class iy{constructor(e){this.capacity=e,this.regExpMap=new Map,this.regExpQueue=[]}getRegExp(e){const i=this.regExpMap.get(e);if(i!==void 0)return i;const n=new RegExp(e);return this.regExpQueue.length===this.capacity&&this.regExpMap.delete(this.regExpQueue.shift()),this.regExpMap.set(e,n),this.regExpQueue.push(e),n}}const sy=[" ",",","?","!",";"],ny=new iy(20),ay=(t,e,i)=>{e=e||"",i=i||"";const n=sy.filter(l=>e.indexOf(l)<0&&i.indexOf(l)<0);if(n.length===0)return!0;const r=ny.getRegExp(`(${n.map(l=>l==="?"?"\\?":l).join("|")})`);let o=!r.test(t);if(!o){const l=t.indexOf(i);l>0&&!r.test(t.substring(0,l))&&(o=!0)}return o},Jh=(t,e,i=".")=>{if(!t)return;if(t[e])return Object.prototype.hasOwnProperty.call(t,e)?t[e]:void 0;const n=e.split(i);let r=t;for(let o=0;o<n.length;){if(!r||typeof r!="object")return;let l,h="";for(let f=o;f<n.length;++f)if(f!==o&&(h+=i),h+=n[f],l=r[h],l!==void 0){if(["string","number","boolean"].indexOf(typeof l)>-1&&f<n.length-1)continue;o+=f-o+1;break}r=l}return r},Zr=t=>t==null?void 0:t.replace("_","-"),ry={type:"logger",log(t){this.output("log",t)},warn(t){this.output("warn",t)},error(t){this.output("error",t)},output(t,e){var i,n;(n=(i=console==null?void 0:console[t])==null?void 0:i.apply)==null||n.call(i,console,e)}};class Jl{constructor(e,i={}){this.init(e,i)}init(e,i={}){this.prefix=i.prefix||"i18next:",this.logger=e||ry,this.options=i,this.debug=i.debug}log(...e){return this.forward(e,"log","",!0)}warn(...e){return this.forward(e,"warn","",!0)}error(...e){return this.forward(e,"error","")}deprecate(...e){return this.forward(e,"warn","WARNING DEPRECATED: ",!0)}forward(e,i,n,r){return r&&!this.debug?null:(Re(e[0])&&(e[0]=`${n}${this.prefix} ${e[0]}`),this.logger[i](e))}create(e){return new Jl(this.logger,{prefix:`${this.prefix}:${e}:`,...this.options})}clone(e){return e=e||this.options,e.prefix=e.prefix||this.prefix,new Jl(this.logger,e)}}var ls=new Jl;class ac{constructor(){this.observers={}}on(e,i){return e.split(" ").forEach(n=>{this.observers[n]||(this.observers[n]=new Map);const r=this.observers[n].get(i)||0;this.observers[n].set(i,r+1)}),this}off(e,i){if(this.observers[e]){if(!i){delete this.observers[e];return}this.observers[e].delete(i)}}emit(e,...i){this.observers[e]&&Array.from(this.observers[e].entries()).forEach(([r,o])=>{for(let l=0;l<o;l++)r(...i)}),this.observers["*"]&&Array.from(this.observers["*"].entries()).forEach(([r,o])=>{for(let l=0;l<o;l++)r.apply(r,[e,...i])})}}class hm extends ac{constructor(e,i={ns:["translation"],defaultNS:"translation"}){super(),this.data=e||{},this.options=i,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.options.ignoreJSONStructure===void 0&&(this.options.ignoreJSONStructure=!0)}addNamespaces(e){this.options.ns.indexOf(e)<0&&this.options.ns.push(e)}removeNamespaces(e){const i=this.options.ns.indexOf(e);i>-1&&this.options.ns.splice(i,1)}getResource(e,i,n,r={}){var u,m;const o=r.keySeparator!==void 0?r.keySeparator:this.options.keySeparator,l=r.ignoreJSONStructure!==void 0?r.ignoreJSONStructure:this.options.ignoreJSONStructure;let h;e.indexOf(".")>-1?h=e.split("."):(h=[e,i],n&&(Array.isArray(n)?h.push(...n):Re(n)&&o?h.push(...n.split(o)):h.push(n)));const f=Wl(this.data,h);return!f&&!i&&!n&&e.indexOf(".")>-1&&(e=h[0],i=h[1],n=h.slice(2).join(".")),f||!l||!Re(n)?f:Jh((m=(u=this.data)==null?void 0:u[e])==null?void 0:m[i],n,o)}addResource(e,i,n,r,o={silent:!1}){const l=o.keySeparator!==void 0?o.keySeparator:this.options.keySeparator;let h=[e,i];n&&(h=h.concat(l?n.split(l):n)),e.indexOf(".")>-1&&(h=e.split("."),r=i,i=h[1]),this.addNamespaces(i),um(this.data,h,r),o.silent||this.emit("added",e,i,n,r)}addResources(e,i,n,r={silent:!1}){for(const o in n)(Re(n[o])||Array.isArray(n[o]))&&this.addResource(e,i,o,n[o],{silent:!0});r.silent||this.emit("added",e,i,n)}addResourceBundle(e,i,n,r,o,l={silent:!1,skipCopy:!1}){let h=[e,i];e.indexOf(".")>-1&&(h=e.split("."),r=n,n=i,i=h[1]),this.addNamespaces(i);let f=Wl(this.data,h)||{};l.skipCopy||(n=JSON.parse(JSON.stringify(n))),r?pg(f,n,o):f={...f,...n},um(this.data,h,f),l.silent||this.emit("added",e,i,n)}removeResourceBundle(e,i){this.hasResourceBundle(e,i)&&delete this.data[e][i],this.removeNamespaces(i),this.emit("removed",e,i)}hasResourceBundle(e,i){return this.getResource(e,i)!==void 0}getResourceBundle(e,i){return i||(i=this.options.defaultNS),this.getResource(e,i)}getDataByLanguage(e){return this.data[e]}hasLanguageSomeTranslations(e){const i=this.getDataByLanguage(e);return!!(i&&Object.keys(i)||[]).find(r=>i[r]&&Object.keys(i[r]).length>0)}toJSON(){return this.data}}var Ag={processors:{},addPostProcessor(t){this.processors[t.name]=t},handle(t,e,i,n,r){return t.forEach(o=>{var l;e=((l=this.processors[o])==null?void 0:l.process(e,i,n,r))??e}),e}};const fm={},dm=t=>!Re(t)&&typeof t!="boolean"&&typeof t!="number";class $l extends ac{constructor(e,i={}){super(),Zx(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],e,this),this.options=i,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.logger=ls.create("translator")}changeLanguage(e){e&&(this.language=e)}exists(e,i={interpolation:{}}){const n={...i};if(e==null)return!1;const r=this.resolve(e,n);return(r==null?void 0:r.res)!==void 0}extractFromKey(e,i){let n=i.nsSeparator!==void 0?i.nsSeparator:this.options.nsSeparator;n===void 0&&(n=":");const r=i.keySeparator!==void 0?i.keySeparator:this.options.keySeparator;let o=i.ns||this.options.defaultNS||[];const l=n&&e.indexOf(n)>-1,h=!this.options.userDefinedKeySeparator&&!i.keySeparator&&!this.options.userDefinedNsSeparator&&!i.nsSeparator&&!ay(e,n,r);if(l&&!h){const f=e.match(this.interpolator.nestingRegexp);if(f&&f.length>0)return{key:e,namespaces:Re(o)?[o]:o};const u=e.split(n);(n!==r||n===r&&this.options.ns.indexOf(u[0])>-1)&&(o=u.shift()),e=u.join(r)}return{key:e,namespaces:Re(o)?[o]:o}}translate(e,i,n){let r=typeof i=="object"?{...i}:i;if(typeof r!="object"&&this.options.overloadTranslationOptionHandler&&(r=this.options.overloadTranslationOptionHandler(arguments)),typeof options=="object"&&(r={...r}),r||(r={}),e==null)return"";Array.isArray(e)||(e=[String(e)]);const o=r.returnDetails!==void 0?r.returnDetails:this.options.returnDetails,l=r.keySeparator!==void 0?r.keySeparator:this.options.keySeparator,{key:h,namespaces:f}=this.extractFromKey(e[e.length-1],r),u=f[f.length-1];let m=r.nsSeparator!==void 0?r.nsSeparator:this.options.nsSeparator;m===void 0&&(m=":");const g=r.lng||this.language,p=r.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if((g==null?void 0:g.toLowerCase())==="cimode")return p?o?{res:`${u}${m}${h}`,usedKey:h,exactUsedKey:h,usedLng:g,usedNS:u,usedParams:this.getUsedParamsDetails(r)}:`${u}${m}${h}`:o?{res:h,usedKey:h,exactUsedKey:h,usedLng:g,usedNS:u,usedParams:this.getUsedParamsDetails(r)}:h;const v=this.resolve(e,r);let x=v==null?void 0:v.res;const w=(v==null?void 0:v.usedKey)||h,b=(v==null?void 0:v.exactUsedKey)||h,S=["[object Number]","[object Function]","[object RegExp]"],C=r.joinArrays!==void 0?r.joinArrays:this.options.joinArrays,E=!this.i18nFormat||this.i18nFormat.handleAsObject,T=r.count!==void 0&&!Re(r.count),D=$l.hasDefaultValue(r),R=T?this.pluralResolver.getSuffix(g,r.count,r):"",N=r.ordinal&&T?this.pluralResolver.getSuffix(g,r.count,{ordinal:!1}):"",M=T&&!r.ordinal&&r.count===0,V=M&&r[`defaultValue${this.options.pluralSeparator}zero`]||r[`defaultValue${R}`]||r[`defaultValue${N}`]||r.defaultValue;let I=x;E&&!x&&D&&(I=V);const B=dm(I),U=Object.prototype.toString.apply(I);if(E&&I&&B&&S.indexOf(U)<0&&!(Re(C)&&Array.isArray(I))){if(!r.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");const z=this.options.returnedObjectHandler?this.options.returnedObjectHandler(w,I,{...r,ns:f}):`key '${h} (${this.language})' returned an object instead of string.`;return o?(v.res=z,v.usedParams=this.getUsedParamsDetails(r),v):z}if(l){const z=Array.isArray(I),P=z?[]:{},K=z?b:w;for(const _ in I)if(Object.prototype.hasOwnProperty.call(I,_)){const H=`${K}${l}${_}`;D&&!x?P[_]=this.translate(H,{...r,defaultValue:dm(V)?V[_]:void 0,joinArrays:!1,ns:f}):P[_]=this.translate(H,{...r,joinArrays:!1,ns:f}),P[_]===H&&(P[_]=I[_])}x=P}}else if(E&&Re(C)&&Array.isArray(x))x=x.join(C),x&&(x=this.extendTranslation(x,e,r,n));else{let z=!1,P=!1;!this.isValidLookup(x)&&D&&(z=!0,x=V),this.isValidLookup(x)||(P=!0,x=h);const _=(r.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&P?void 0:x,H=D&&V!==x&&this.options.updateMissing;if(P||z||H){if(this.logger.log(H?"updateKey":"missingKey",g,u,h,H?V:x),l){const W=this.resolve(h,{...r,keySeparator:!1});W&&W.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let q=[];const se=this.languageUtils.getFallbackCodes(this.options.fallbackLng,r.lng||this.language);if(this.options.saveMissingTo==="fallback"&&se&&se[0])for(let W=0;W<se.length;W++)q.push(se[W]);else this.options.saveMissingTo==="all"?q=this.languageUtils.toResolveHierarchy(r.lng||this.language):q.push(r.lng||this.language);const G=(W,le,ce)=>{var ye;const fe=D&&ce!==x?ce:_;this.options.missingKeyHandler?this.options.missingKeyHandler(W,u,le,fe,H,r):(ye=this.backendConnector)!=null&&ye.saveMissing&&this.backendConnector.saveMissing(W,u,le,fe,H,r),this.emit("missingKey",W,u,le,x)};this.options.saveMissing&&(this.options.saveMissingPlurals&&T?q.forEach(W=>{const le=this.pluralResolver.getSuffixes(W,r);M&&r[`defaultValue${this.options.pluralSeparator}zero`]&&le.indexOf(`${this.options.pluralSeparator}zero`)<0&&le.push(`${this.options.pluralSeparator}zero`),le.forEach(ce=>{G([W],h+ce,r[`defaultValue${ce}`]||V)})}):G(q,h,V))}x=this.extendTranslation(x,e,r,v,n),P&&x===h&&this.options.appendNamespaceToMissingKey&&(x=`${u}${m}${h}`),(P||z)&&this.options.parseMissingKeyHandler&&(x=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${u}${m}${h}`:h,z?x:void 0,r))}return o?(v.res=x,v.usedParams=this.getUsedParamsDetails(r),v):x}extendTranslation(e,i,n,r,o){var f,u;if((f=this.i18nFormat)!=null&&f.parse)e=this.i18nFormat.parse(e,{...this.options.interpolation.defaultVariables,...n},n.lng||this.language||r.usedLng,r.usedNS,r.usedKey,{resolved:r});else if(!n.skipInterpolation){n.interpolation&&this.interpolator.init({...n,interpolation:{...this.options.interpolation,...n.interpolation}});const m=Re(e)&&(((u=n==null?void 0:n.interpolation)==null?void 0:u.skipOnVariables)!==void 0?n.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);let g;if(m){const v=e.match(this.interpolator.nestingRegexp);g=v&&v.length}let p=n.replace&&!Re(n.replace)?n.replace:n;if(this.options.interpolation.defaultVariables&&(p={...this.options.interpolation.defaultVariables,...p}),e=this.interpolator.interpolate(e,p,n.lng||this.language||r.usedLng,n),m){const v=e.match(this.interpolator.nestingRegexp),x=v&&v.length;g<x&&(n.nest=!1)}!n.lng&&r&&r.res&&(n.lng=this.language||r.usedLng),n.nest!==!1&&(e=this.interpolator.nest(e,(...v)=>(o==null?void 0:o[0])===v[0]&&!n.context?(this.logger.warn(`It seems you are nesting recursively key: ${v[0]} in key: ${i[0]}`),null):this.translate(...v,i),n)),n.interpolation&&this.interpolator.reset()}const l=n.postProcess||this.options.postProcess,h=Re(l)?[l]:l;return e!=null&&(h!=null&&h.length)&&n.applyPostProcessor!==!1&&(e=Ag.handle(h,e,i,this.options&&this.options.postProcessPassResolved?{i18nResolved:{...r,usedParams:this.getUsedParamsDetails(n)},...n}:n,this)),e}resolve(e,i={}){let n,r,o,l,h;return Re(e)&&(e=[e]),e.forEach(f=>{if(this.isValidLookup(n))return;const u=this.extractFromKey(f,i),m=u.key;r=m;let g=u.namespaces;this.options.fallbackNS&&(g=g.concat(this.options.fallbackNS));const p=i.count!==void 0&&!Re(i.count),v=p&&!i.ordinal&&i.count===0,x=i.context!==void 0&&(Re(i.context)||typeof i.context=="number")&&i.context!=="",w=i.lngs?i.lngs:this.languageUtils.toResolveHierarchy(i.lng||this.language,i.fallbackLng);g.forEach(b=>{var S,C;this.isValidLookup(n)||(h=b,!fm[`${w[0]}-${b}`]&&((S=this.utils)!=null&&S.hasLoadedNamespace)&&!((C=this.utils)!=null&&C.hasLoadedNamespace(h))&&(fm[`${w[0]}-${b}`]=!0,this.logger.warn(`key "${r}" for languages "${w.join(", ")}" won't get resolved as namespace "${h}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),w.forEach(E=>{var R;if(this.isValidLookup(n))return;l=E;const T=[m];if((R=this.i18nFormat)!=null&&R.addLookupKeys)this.i18nFormat.addLookupKeys(T,m,E,b,i);else{let N;p&&(N=this.pluralResolver.getSuffix(E,i.count,i));const M=`${this.options.pluralSeparator}zero`,V=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(p&&(T.push(m+N),i.ordinal&&N.indexOf(V)===0&&T.push(m+N.replace(V,this.options.pluralSeparator)),v&&T.push(m+M)),x){const I=`${m}${this.options.contextSeparator}${i.context}`;T.push(I),p&&(T.push(I+N),i.ordinal&&N.indexOf(V)===0&&T.push(I+N.replace(V,this.options.pluralSeparator)),v&&T.push(I+M))}}let D;for(;D=T.pop();)this.isValidLookup(n)||(o=D,n=this.getResource(E,b,D,i))}))})}),{res:n,usedKey:r,exactUsedKey:o,usedLng:l,usedNS:h}}isValidLookup(e){return e!==void 0&&!(!this.options.returnNull&&e===null)&&!(!this.options.returnEmptyString&&e==="")}getResource(e,i,n,r={}){var o;return(o=this.i18nFormat)!=null&&o.getResource?this.i18nFormat.getResource(e,i,n,r):this.resourceStore.getResource(e,i,n,r)}getUsedParamsDetails(e={}){const i=["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"],n=e.replace&&!Re(e.replace);let r=n?e.replace:e;if(n&&typeof e.count<"u"&&(r.count=e.count),this.options.interpolation.defaultVariables&&(r={...this.options.interpolation.defaultVariables,...r}),!n){r={...r};for(const o of i)delete r[o]}return r}static hasDefaultValue(e){const i="defaultValue";for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&i===n.substring(0,i.length)&&e[n]!==void 0)return!0;return!1}}class mm{constructor(e){this.options=e,this.supportedLngs=this.options.supportedLngs||!1,this.logger=ls.create("languageUtils")}getScriptPartFromCode(e){if(e=Zr(e),!e||e.indexOf("-")<0)return null;const i=e.split("-");return i.length===2||(i.pop(),i[i.length-1].toLowerCase()==="x")?null:this.formatLanguageCode(i.join("-"))}getLanguagePartFromCode(e){if(e=Zr(e),!e||e.indexOf("-")<0)return e;const i=e.split("-");return this.formatLanguageCode(i[0])}formatLanguageCode(e){if(Re(e)&&e.indexOf("-")>-1){let i;try{i=Intl.getCanonicalLocales(e)[0]}catch{}return i&&this.options.lowerCaseLng&&(i=i.toLowerCase()),i||(this.options.lowerCaseLng?e.toLowerCase():e)}return this.options.cleanCode||this.options.lowerCaseLng?e.toLowerCase():e}isSupportedCode(e){return(this.options.load==="languageOnly"||this.options.nonExplicitSupportedLngs)&&(e=this.getLanguagePartFromCode(e)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(e)>-1}getBestMatchFromCodes(e){if(!e)return null;let i;return e.forEach(n=>{if(i)return;const r=this.formatLanguageCode(n);(!this.options.supportedLngs||this.isSupportedCode(r))&&(i=r)}),!i&&this.options.supportedLngs&&e.forEach(n=>{if(i)return;const r=this.getScriptPartFromCode(n);if(this.isSupportedCode(r))return i=r;const o=this.getLanguagePartFromCode(n);if(this.isSupportedCode(o))return i=o;i=this.options.supportedLngs.find(l=>{if(l===o)return l;if(!(l.indexOf("-")<0&&o.indexOf("-")<0)&&(l.indexOf("-")>0&&o.indexOf("-")<0&&l.substring(0,l.indexOf("-"))===o||l.indexOf(o)===0&&o.length>1))return l})}),i||(i=this.getFallbackCodes(this.options.fallbackLng)[0]),i}getFallbackCodes(e,i){if(!e)return[];if(typeof e=="function"&&(e=e(i)),Re(e)&&(e=[e]),Array.isArray(e))return e;if(!i)return e.default||[];let n=e[i];return n||(n=e[this.getScriptPartFromCode(i)]),n||(n=e[this.formatLanguageCode(i)]),n||(n=e[this.getLanguagePartFromCode(i)]),n||(n=e.default),n||[]}toResolveHierarchy(e,i){const n=this.getFallbackCodes((i===!1?[]:i)||this.options.fallbackLng||[],e),r=[],o=l=>{l&&(this.isSupportedCode(l)?r.push(l):this.logger.warn(`rejecting language code not found in supportedLngs: ${l}`))};return Re(e)&&(e.indexOf("-")>-1||e.indexOf("_")>-1)?(this.options.load!=="languageOnly"&&o(this.formatLanguageCode(e)),this.options.load!=="languageOnly"&&this.options.load!=="currentOnly"&&o(this.getScriptPartFromCode(e)),this.options.load!=="currentOnly"&&o(this.getLanguagePartFromCode(e))):Re(e)&&o(this.formatLanguageCode(e)),n.forEach(l=>{r.indexOf(l)<0&&o(this.formatLanguageCode(l))}),r}}const gm={zero:0,one:1,two:2,few:3,many:4,other:5},pm={select:t=>t===1?"one":"other",resolvedOptions:()=>({pluralCategories:["one","other"]})};class oy{constructor(e,i={}){this.languageUtils=e,this.options=i,this.logger=ls.create("pluralResolver"),this.pluralRulesCache={}}addRule(e,i){this.rules[e]=i}clearCache(){this.pluralRulesCache={}}getRule(e,i={}){const n=Zr(e==="dev"?"en":e),r=i.ordinal?"ordinal":"cardinal",o=JSON.stringify({cleanedCode:n,type:r});if(o in this.pluralRulesCache)return this.pluralRulesCache[o];let l;try{l=new Intl.PluralRules(n,{type:r})}catch{if(!Intl)return this.logger.error("No Intl support, please use an Intl polyfill!"),pm;if(!e.match(/-|_/))return pm;const f=this.languageUtils.getLanguagePartFromCode(e);l=this.getRule(f,i)}return this.pluralRulesCache[o]=l,l}needsPlural(e,i={}){let n=this.getRule(e,i);return n||(n=this.getRule("dev",i)),(n==null?void 0:n.resolvedOptions().pluralCategories.length)>1}getPluralFormsOfKey(e,i,n={}){return this.getSuffixes(e,n).map(r=>`${i}${r}`)}getSuffixes(e,i={}){let n=this.getRule(e,i);return n||(n=this.getRule("dev",i)),n?n.resolvedOptions().pluralCategories.sort((r,o)=>gm[r]-gm[o]).map(r=>`${this.options.prepend}${i.ordinal?`ordinal${this.options.prepend}`:""}${r}`):[]}getSuffix(e,i,n={}){const r=this.getRule(e,n);return r?`${this.options.prepend}${n.ordinal?`ordinal${this.options.prepend}`:""}${r.select(i)}`:(this.logger.warn(`no plural rule found for: ${e}`),this.getSuffix("dev",i,n))}}const Am=(t,e,i,n=".",r=!0)=>{let o=$x(t,e,i);return!o&&r&&Re(i)&&(o=Jh(t,i,n),o===void 0&&(o=Jh(e,i,n))),o},Oh=t=>t.replace(/\$/g,"$$$$");class ly{constructor(e={}){var i;this.logger=ls.create("interpolator"),this.options=e,this.format=((i=e==null?void 0:e.interpolation)==null?void 0:i.format)||(n=>n),this.init(e)}init(e={}){e.interpolation||(e.interpolation={escapeValue:!0});const{escape:i,escapeValue:n,useRawValueToEscape:r,prefix:o,prefixEscaped:l,suffix:h,suffixEscaped:f,formatSeparator:u,unescapeSuffix:m,unescapePrefix:g,nestingPrefix:p,nestingPrefixEscaped:v,nestingSuffix:x,nestingSuffixEscaped:w,nestingOptionsSeparator:b,maxReplaces:S,alwaysFormat:C}=e.interpolation;this.escape=i!==void 0?i:ty,this.escapeValue=n!==void 0?n:!0,this.useRawValueToEscape=r!==void 0?r:!1,this.prefix=o?Ea(o):l||"{{",this.suffix=h?Ea(h):f||"}}",this.formatSeparator=u||",",this.unescapePrefix=m?"":g||"-",this.unescapeSuffix=this.unescapePrefix?"":m||"",this.nestingPrefix=p?Ea(p):v||Ea("$t("),this.nestingSuffix=x?Ea(x):w||Ea(")"),this.nestingOptionsSeparator=b||",",this.maxReplaces=S||1e3,this.alwaysFormat=C!==void 0?C:!1,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){const e=(i,n)=>(i==null?void 0:i.source)===n?(i.lastIndex=0,i):new RegExp(n,"g");this.regexp=e(this.regexp,`${this.prefix}(.+?)${this.suffix}`),this.regexpUnescape=e(this.regexpUnescape,`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`),this.nestingRegexp=e(this.nestingRegexp,`${this.nestingPrefix}(.+?)${this.nestingSuffix}`)}interpolate(e,i,n,r){var v;let o,l,h;const f=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{},u=x=>{if(x.indexOf(this.formatSeparator)<0){const C=Am(i,f,x,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(C,void 0,n,{...r,...i,interpolationkey:x}):C}const w=x.split(this.formatSeparator),b=w.shift().trim(),S=w.join(this.formatSeparator).trim();return this.format(Am(i,f,b,this.options.keySeparator,this.options.ignoreJSONStructure),S,n,{...r,...i,interpolationkey:b})};this.resetRegExp();const m=(r==null?void 0:r.missingInterpolationHandler)||this.options.missingInterpolationHandler,g=((v=r==null?void 0:r.interpolation)==null?void 0:v.skipOnVariables)!==void 0?r.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:x=>Oh(x)},{regex:this.regexp,safeValue:x=>this.escapeValue?Oh(this.escape(x)):Oh(x)}].forEach(x=>{for(h=0;o=x.regex.exec(e);){const w=o[1].trim();if(l=u(w),l===void 0)if(typeof m=="function"){const S=m(e,o,r);l=Re(S)?S:""}else if(r&&Object.prototype.hasOwnProperty.call(r,w))l="";else if(g){l=o[0];continue}else this.logger.warn(`missed to pass in variable ${w} for interpolating ${e}`),l="";else!Re(l)&&!this.useRawValueToEscape&&(l=om(l));const b=x.safeValue(l);if(e=e.replace(o[0],b),g?(x.regex.lastIndex+=l.length,x.regex.lastIndex-=o[0].length):x.regex.lastIndex=0,h++,h>=this.maxReplaces)break}}),e}nest(e,i,n={}){let r,o,l;const h=(f,u)=>{const m=this.nestingOptionsSeparator;if(f.indexOf(m)<0)return f;const g=f.split(new RegExp(`${m}[ ]*{`));let p=`{${g[1]}`;f=g[0],p=this.interpolate(p,l);const v=p.match(/'/g),x=p.match(/"/g);(((v==null?void 0:v.length)??0)%2===0&&!x||x.length%2!==0)&&(p=p.replace(/'/g,'"'));try{l=JSON.parse(p),u&&(l={...u,...l})}catch(w){return this.logger.warn(`failed parsing options string in nesting for key ${f}`,w),`${f}${m}${p}`}return l.defaultValue&&l.defaultValue.indexOf(this.prefix)>-1&&delete l.defaultValue,f};for(;r=this.nestingRegexp.exec(e);){let f=[];l={...n},l=l.replace&&!Re(l.replace)?l.replace:l,l.applyPostProcessor=!1,delete l.defaultValue;let u=!1;if(r[0].indexOf(this.formatSeparator)!==-1&&!/{.*}/.test(r[1])){const m=r[1].split(this.formatSeparator).map(g=>g.trim());r[1]=m.shift(),f=m,u=!0}if(o=i(h.call(this,r[1].trim(),l),l),o&&r[0]===e&&!Re(o))return o;Re(o)||(o=om(o)),o||(this.logger.warn(`missed to resolve ${r[1]} for nesting ${e}`),o=""),u&&(o=f.reduce((m,g)=>this.format(m,g,n.lng,{...n,interpolationkey:r[1].trim()}),o.trim())),e=e.replace(r[0],o),this.regexp.lastIndex=0}return e}}const cy=t=>{let e=t.toLowerCase().trim();const i={};if(t.indexOf("(")>-1){const n=t.split("(");e=n[0].toLowerCase().trim();const r=n[1].substring(0,n[1].length-1);e==="currency"&&r.indexOf(":")<0?i.currency||(i.currency=r.trim()):e==="relativetime"&&r.indexOf(":")<0?i.range||(i.range=r.trim()):r.split(";").forEach(l=>{if(l){const[h,...f]=l.split(":"),u=f.join(":").trim().replace(/^'+|'+$/g,""),m=h.trim();i[m]||(i[m]=u),u==="false"&&(i[m]=!1),u==="true"&&(i[m]=!0),isNaN(u)||(i[m]=parseInt(u,10))}})}return{formatName:e,formatOptions:i}},vm=t=>{const e={};return(i,n,r)=>{let o=r;r&&r.interpolationkey&&r.formatParams&&r.formatParams[r.interpolationkey]&&r[r.interpolationkey]&&(o={...o,[r.interpolationkey]:void 0});const l=n+JSON.stringify(o);let h=e[l];return h||(h=t(Zr(n),r),e[l]=h),h(i)}},uy=t=>(e,i,n)=>t(Zr(i),n)(e);class hy{constructor(e={}){this.logger=ls.create("formatter"),this.options=e,this.init(e)}init(e,i={interpolation:{}}){this.formatSeparator=i.interpolation.formatSeparator||",";const n=i.cacheInBuiltFormats?vm:uy;this.formats={number:n((r,o)=>{const l=new Intl.NumberFormat(r,{...o});return h=>l.format(h)}),currency:n((r,o)=>{const l=new Intl.NumberFormat(r,{...o,style:"currency"});return h=>l.format(h)}),datetime:n((r,o)=>{const l=new Intl.DateTimeFormat(r,{...o});return h=>l.format(h)}),relativetime:n((r,o)=>{const l=new Intl.RelativeTimeFormat(r,{...o});return h=>l.format(h,o.range||"day")}),list:n((r,o)=>{const l=new Intl.ListFormat(r,{...o});return h=>l.format(h)})}}add(e,i){this.formats[e.toLowerCase().trim()]=i}addCached(e,i){this.formats[e.toLowerCase().trim()]=vm(i)}format(e,i,n,r={}){const o=i.split(this.formatSeparator);if(o.length>1&&o[0].indexOf("(")>1&&o[0].indexOf(")")<0&&o.find(h=>h.indexOf(")")>-1)){const h=o.findIndex(f=>f.indexOf(")")>-1);o[0]=[o[0],...o.splice(1,h)].join(this.formatSeparator)}return o.reduce((h,f)=>{var g;const{formatName:u,formatOptions:m}=cy(f);if(this.formats[u]){let p=h;try{const v=((g=r==null?void 0:r.formatParams)==null?void 0:g[r.interpolationkey])||{},x=v.locale||v.lng||r.locale||r.lng||n;p=this.formats[u](h,x,{...m,...r,...v})}catch(v){this.logger.warn(v)}return p}else this.logger.warn(`there was no format function for ${u}`);return h},e)}}const fy=(t,e)=>{t.pending[e]!==void 0&&(delete t.pending[e],t.pendingCount--)};class dy extends ac{constructor(e,i,n,r={}){var o,l;super(),this.backend=e,this.store=i,this.services=n,this.languageUtils=n.languageUtils,this.options=r,this.logger=ls.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=r.maxParallelReads||10,this.readingCalls=0,this.maxRetries=r.maxRetries>=0?r.maxRetries:5,this.retryTimeout=r.retryTimeout>=1?r.retryTimeout:350,this.state={},this.queue=[],(l=(o=this.backend)==null?void 0:o.init)==null||l.call(o,n,r.backend,r)}queueLoad(e,i,n,r){const o={},l={},h={},f={};return e.forEach(u=>{let m=!0;i.forEach(g=>{const p=`${u}|${g}`;!n.reload&&this.store.hasResourceBundle(u,g)?this.state[p]=2:this.state[p]<0||(this.state[p]===1?l[p]===void 0&&(l[p]=!0):(this.state[p]=1,m=!1,l[p]===void 0&&(l[p]=!0),o[p]===void 0&&(o[p]=!0),f[g]===void 0&&(f[g]=!0)))}),m||(h[u]=!0)}),(Object.keys(o).length||Object.keys(l).length)&&this.queue.push({pending:l,pendingCount:Object.keys(l).length,loaded:{},errors:[],callback:r}),{toLoad:Object.keys(o),pending:Object.keys(l),toLoadLanguages:Object.keys(h),toLoadNamespaces:Object.keys(f)}}loaded(e,i,n){const r=e.split("|"),o=r[0],l=r[1];i&&this.emit("failedLoading",o,l,i),!i&&n&&this.store.addResourceBundle(o,l,n,void 0,void 0,{skipCopy:!0}),this.state[e]=i?-1:2,i&&n&&(this.state[e]=0);const h={};this.queue.forEach(f=>{Jx(f.loaded,[o],l),fy(f,e),i&&f.errors.push(i),f.pendingCount===0&&!f.done&&(Object.keys(f.loaded).forEach(u=>{h[u]||(h[u]={});const m=f.loaded[u];m.length&&m.forEach(g=>{h[u][g]===void 0&&(h[u][g]=!0)})}),f.done=!0,f.errors.length?f.callback(f.errors):f.callback())}),this.emit("loaded",h),this.queue=this.queue.filter(f=>!f.done)}read(e,i,n,r=0,o=this.retryTimeout,l){if(!e.length)return l(null,{});if(this.readingCalls>=this.maxParallelReads){this.waitingReads.push({lng:e,ns:i,fcName:n,tried:r,wait:o,callback:l});return}this.readingCalls++;const h=(u,m)=>{if(this.readingCalls--,this.waitingReads.length>0){const g=this.waitingReads.shift();this.read(g.lng,g.ns,g.fcName,g.tried,g.wait,g.callback)}if(u&&m&&r<this.maxRetries){setTimeout(()=>{this.read.call(this,e,i,n,r+1,o*2,l)},o);return}l(u,m)},f=this.backend[n].bind(this.backend);if(f.length===2){try{const u=f(e,i);u&&typeof u.then=="function"?u.then(m=>h(null,m)).catch(h):h(null,u)}catch(u){h(u)}return}return f(e,i,h)}prepareLoading(e,i,n={},r){if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),r&&r();Re(e)&&(e=this.languageUtils.toResolveHierarchy(e)),Re(i)&&(i=[i]);const o=this.queueLoad(e,i,n,r);if(!o.toLoad.length)return o.pending.length||r(),null;o.toLoad.forEach(l=>{this.loadOne(l)})}load(e,i,n){this.prepareLoading(e,i,{},n)}reload(e,i,n){this.prepareLoading(e,i,{reload:!0},n)}loadOne(e,i=""){const n=e.split("|"),r=n[0],o=n[1];this.read(r,o,"read",void 0,void 0,(l,h)=>{l&&this.logger.warn(`${i}loading namespace ${o} for language ${r} failed`,l),!l&&h&&this.logger.log(`${i}loaded namespace ${o} for language ${r}`,h),this.loaded(e,l,h)})}saveMissing(e,i,n,r,o,l={},h=()=>{}){var f,u,m,g,p;if((u=(f=this.services)==null?void 0:f.utils)!=null&&u.hasLoadedNamespace&&!((g=(m=this.services)==null?void 0:m.utils)!=null&&g.hasLoadedNamespace(i))){this.logger.warn(`did not save key "${n}" as the namespace "${i}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");return}if(!(n==null||n==="")){if((p=this.backend)!=null&&p.create){const v={...l,isUpdate:o},x=this.backend.create.bind(this.backend);if(x.length<6)try{let w;x.length===5?w=x(e,i,n,r,v):w=x(e,i,n,r),w&&typeof w.then=="function"?w.then(b=>h(null,b)).catch(h):h(null,w)}catch(w){h(w)}else x(e,i,n,r,h,v)}!e||!e[0]||this.store.addResource(e[0],i,n,r)}}}const xm=()=>({debug:!1,initAsync:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:t=>{let e={};if(typeof t[1]=="object"&&(e=t[1]),Re(t[1])&&(e.defaultValue=t[1]),Re(t[2])&&(e.tDescription=t[2]),typeof t[2]=="object"||typeof t[3]=="object"){const i=t[3]||t[2];Object.keys(i).forEach(n=>{e[n]=i[n]})}return e},interpolation:{escapeValue:!0,format:t=>t,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0},cacheInBuiltFormats:!0}),ym=t=>{var e,i;return Re(t.ns)&&(t.ns=[t.ns]),Re(t.fallbackLng)&&(t.fallbackLng=[t.fallbackLng]),Re(t.fallbackNS)&&(t.fallbackNS=[t.fallbackNS]),((i=(e=t.supportedLngs)==null?void 0:e.indexOf)==null?void 0:i.call(e,"cimode"))<0&&(t.supportedLngs=t.supportedLngs.concat(["cimode"])),typeof t.initImmediate=="boolean"&&(t.initAsync=t.initImmediate),t},Ol=()=>{},my=t=>{Object.getOwnPropertyNames(Object.getPrototypeOf(t)).forEach(i=>{typeof t[i]=="function"&&(t[i]=t[i].bind(t))})};class Wr extends ac{constructor(e={},i){if(super(),this.options=ym(e),this.services={},this.logger=ls,this.modules={external:[]},my(this),i&&!this.isInitialized&&!e.isClone){if(!this.options.initAsync)return this.init(e,i),this;setTimeout(()=>{this.init(e,i)},0)}}init(e={},i){this.isInitializing=!0,typeof e=="function"&&(i=e,e={}),e.defaultNS==null&&e.ns&&(Re(e.ns)?e.defaultNS=e.ns:e.ns.indexOf("translation")<0&&(e.defaultNS=e.ns[0]));const n=xm();this.options={...n,...this.options,...ym(e)},this.options.interpolation={...n.interpolation,...this.options.interpolation},e.keySeparator!==void 0&&(this.options.userDefinedKeySeparator=e.keySeparator),e.nsSeparator!==void 0&&(this.options.userDefinedNsSeparator=e.nsSeparator);const r=u=>u?typeof u=="function"?new u:u:null;if(!this.options.isClone){this.modules.logger?ls.init(r(this.modules.logger),this.options):ls.init(null,this.options);let u;this.modules.formatter?u=this.modules.formatter:u=hy;const m=new mm(this.options);this.store=new hm(this.options.resources,this.options);const g=this.services;g.logger=ls,g.resourceStore=this.store,g.languageUtils=m,g.pluralResolver=new oy(m,{prepend:this.options.pluralSeparator,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),u&&(!this.options.interpolation.format||this.options.interpolation.format===n.interpolation.format)&&(g.formatter=r(u),g.formatter.init(g,this.options),this.options.interpolation.format=g.formatter.format.bind(g.formatter)),g.interpolator=new ly(this.options),g.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},g.backendConnector=new dy(r(this.modules.backend),g.resourceStore,g,this.options),g.backendConnector.on("*",(p,...v)=>{this.emit(p,...v)}),this.modules.languageDetector&&(g.languageDetector=r(this.modules.languageDetector),g.languageDetector.init&&g.languageDetector.init(g,this.options.detection,this.options)),this.modules.i18nFormat&&(g.i18nFormat=r(this.modules.i18nFormat),g.i18nFormat.init&&g.i18nFormat.init(this)),this.translator=new $l(this.services,this.options),this.translator.on("*",(p,...v)=>{this.emit(p,...v)}),this.modules.external.forEach(p=>{p.init&&p.init(this)})}if(this.format=this.options.interpolation.format,i||(i=Ol),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){const u=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);u.length>0&&u[0]!=="dev"&&(this.options.lng=u[0])}!this.services.languageDetector&&!this.options.lng&&this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach(u=>{this[u]=(...m)=>this.store[u](...m)}),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach(u=>{this[u]=(...m)=>(this.store[u](...m),this)});const h=kr(),f=()=>{const u=(m,g)=>{this.isInitializing=!1,this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),h.resolve(g),i(m,g)};if(this.languages&&!this.isInitialized)return u(null,this.t.bind(this));this.changeLanguage(this.options.lng,u)};return this.options.resources||!this.options.initAsync?f():setTimeout(f,0),h}loadResources(e,i=Ol){var o,l;let n=i;const r=Re(e)?e:this.language;if(typeof e=="function"&&(n=e),!this.options.resources||this.options.partialBundledLanguages){if((r==null?void 0:r.toLowerCase())==="cimode"&&(!this.options.preload||this.options.preload.length===0))return n();const h=[],f=u=>{if(!u||u==="cimode")return;this.services.languageUtils.toResolveHierarchy(u).forEach(g=>{g!=="cimode"&&h.indexOf(g)<0&&h.push(g)})};r?f(r):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach(m=>f(m)),(l=(o=this.options.preload)==null?void 0:o.forEach)==null||l.call(o,u=>f(u)),this.services.backendConnector.load(h,this.options.ns,u=>{!u&&!this.resolvedLanguage&&this.language&&this.setResolvedLanguage(this.language),n(u)})}else n(null)}reloadResources(e,i,n){const r=kr();return typeof e=="function"&&(n=e,e=void 0),typeof i=="function"&&(n=i,i=void 0),e||(e=this.languages),i||(i=this.options.ns),n||(n=Ol),this.services.backendConnector.reload(e,i,o=>{r.resolve(),n(o)}),r}use(e){if(!e)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!e.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return e.type==="backend"&&(this.modules.backend=e),(e.type==="logger"||e.log&&e.warn&&e.error)&&(this.modules.logger=e),e.type==="languageDetector"&&(this.modules.languageDetector=e),e.type==="i18nFormat"&&(this.modules.i18nFormat=e),e.type==="postProcessor"&&Ag.addPostProcessor(e),e.type==="formatter"&&(this.modules.formatter=e),e.type==="3rdParty"&&this.modules.external.push(e),this}setResolvedLanguage(e){if(!(!e||!this.languages)&&!(["cimode","dev"].indexOf(e)>-1)){for(let i=0;i<this.languages.length;i++){const n=this.languages[i];if(!(["cimode","dev"].indexOf(n)>-1)&&this.store.hasLanguageSomeTranslations(n)){this.resolvedLanguage=n;break}}!this.resolvedLanguage&&this.languages.indexOf(e)<0&&this.store.hasLanguageSomeTranslations(e)&&(this.resolvedLanguage=e,this.languages.unshift(e))}}changeLanguage(e,i){this.isLanguageChangingTo=e;const n=kr();this.emit("languageChanging",e);const r=h=>{this.language=h,this.languages=this.services.languageUtils.toResolveHierarchy(h),this.resolvedLanguage=void 0,this.setResolvedLanguage(h)},o=(h,f)=>{f?this.isLanguageChangingTo===e&&(r(f),this.translator.changeLanguage(f),this.isLanguageChangingTo=void 0,this.emit("languageChanged",f),this.logger.log("languageChanged",f)):this.isLanguageChangingTo=void 0,n.resolve((...u)=>this.t(...u)),i&&i(h,(...u)=>this.t(...u))},l=h=>{var m,g;!e&&!h&&this.services.languageDetector&&(h=[]);const f=Re(h)?h:h&&h[0],u=this.store.hasLanguageSomeTranslations(f)?f:this.services.languageUtils.getBestMatchFromCodes(Re(h)?[h]:h);u&&(this.language||r(u),this.translator.language||this.translator.changeLanguage(u),(g=(m=this.services.languageDetector)==null?void 0:m.cacheUserLanguage)==null||g.call(m,u)),this.loadResources(u,p=>{o(p,u)})};return!e&&this.services.languageDetector&&!this.services.languageDetector.async?l(this.services.languageDetector.detect()):!e&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect.length===0?this.services.languageDetector.detect().then(l):this.services.languageDetector.detect(l):l(e),n}getFixedT(e,i,n){const r=(o,l,...h)=>{let f;typeof l!="object"?f=this.options.overloadTranslationOptionHandler([o,l].concat(h)):f={...l},f.lng=f.lng||r.lng,f.lngs=f.lngs||r.lngs,f.ns=f.ns||r.ns,f.keyPrefix!==""&&(f.keyPrefix=f.keyPrefix||n||r.keyPrefix);const u=this.options.keySeparator||".";let m;return f.keyPrefix&&Array.isArray(o)?m=o.map(g=>`${f.keyPrefix}${u}${g}`):m=f.keyPrefix?`${f.keyPrefix}${u}${o}`:o,this.t(m,f)};return Re(e)?r.lng=e:r.lngs=e,r.ns=i,r.keyPrefix=n,r}t(...e){var i;return(i=this.translator)==null?void 0:i.translate(...e)}exists(...e){var i;return(i=this.translator)==null?void 0:i.exists(...e)}setDefaultNamespace(e){this.options.defaultNS=e}hasLoadedNamespace(e,i={}){if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;const n=i.lng||this.resolvedLanguage||this.languages[0],r=this.options?this.options.fallbackLng:!1,o=this.languages[this.languages.length-1];if(n.toLowerCase()==="cimode")return!0;const l=(h,f)=>{const u=this.services.backendConnector.state[`${h}|${f}`];return u===-1||u===0||u===2};if(i.precheck){const h=i.precheck(this,l);if(h!==void 0)return h}return!!(this.hasResourceBundle(n,e)||!this.services.backendConnector.backend||this.options.resources&&!this.options.partialBundledLanguages||l(n,e)&&(!r||l(o,e)))}loadNamespaces(e,i){const n=kr();return this.options.ns?(Re(e)&&(e=[e]),e.forEach(r=>{this.options.ns.indexOf(r)<0&&this.options.ns.push(r)}),this.loadResources(r=>{n.resolve(),i&&i(r)}),n):(i&&i(),Promise.resolve())}loadLanguages(e,i){const n=kr();Re(e)&&(e=[e]);const r=this.options.preload||[],o=e.filter(l=>r.indexOf(l)<0&&this.services.languageUtils.isSupportedCode(l));return o.length?(this.options.preload=r.concat(o),this.loadResources(l=>{n.resolve(),i&&i(l)}),n):(i&&i(),Promise.resolve())}dir(e){var r,o;if(e||(e=this.resolvedLanguage||(((r=this.languages)==null?void 0:r.length)>0?this.languages[0]:this.language)),!e)return"rtl";const i=["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"],n=((o=this.services)==null?void 0:o.languageUtils)||new mm(xm());return i.indexOf(n.getLanguagePartFromCode(e))>-1||e.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(e={},i){return new Wr(e,i)}cloneInstance(e={},i=Ol){const n=e.forkResourceStore;n&&delete e.forkResourceStore;const r={...this.options,...e,isClone:!0},o=new Wr(r);if((e.debug!==void 0||e.prefix!==void 0)&&(o.logger=o.logger.clone(e)),["store","services","language"].forEach(h=>{o[h]=this[h]}),o.services={...this.services},o.services.utils={hasLoadedNamespace:o.hasLoadedNamespace.bind(o)},n){const h=Object.keys(this.store.data).reduce((f,u)=>(f[u]={...this.store.data[u]},f[u]=Object.keys(f[u]).reduce((m,g)=>(m[g]={...f[u][g]},m),f[u]),f),{});o.store=new hm(h,r),o.services.resourceStore=o.store}return o.translator=new $l(o.services,r),o.translator.on("*",(h,...f)=>{o.emit(h,...f)}),o.init(r,i),o.translator.options=r,o.translator.backendConnector.services.utils={hasLoadedNamespace:o.hasLoadedNamespace.bind(o)},o}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}const ri=Wr.createInstance();ri.createInstance=Wr.createInstance;ri.createInstance;ri.dir;ri.init;ri.loadResources;ri.reloadResources;ri.use;ri.changeLanguage;ri.getFixedT;ri.t;ri.exists;ri.setDefaultNamespace;ri.hasLoadedNamespace;ri.loadNamespaces;ri.loadLanguages;function gy({t,callback:e,currentLanguage:i,atlasRegions:n,askedRegion:r,askedAtlas:o,preloadedAtlas:l,preloadedBackgroundMNI:h,viewerOptions:f,loadEnforcer:u}){const m=ie.useRef(new yf({show3Dcrosshair:!0,backColor:[0,0,0,1],crosshairColor:[1,1,1,1]})),[g,p]=ie.useState(!1),[v,x]=ie.useState(!0),[w,b]=ie.useState(!1),S=ie.useRef(null),C=ie.useRef(null);ie.useEffect(()=>{const R=N=>{w&&S.current&&C.current&&!C.current.contains(N.target)&&!S.current.contains(N.target)&&b(!1)};return document.addEventListener("click",R),()=>{document.removeEventListener("click",R)}},[w]);async function E(){if(!r||!o||!h||!l||!g){console.error("Invalid regionId or atlas");return}try{const R=Kr[o];m.current.meshes=[],m.current.updateGLVolume();const N=await Zh("assets/atlas/descr/"+i+"/"+R.json);for(let U=1;U<m.current.volumes.length;U++)m.current.removeVolume(m.current.volumes[U]);for(let U=1;U<m.current.meshes.length;U++)m.current.removeMesh(m.current.meshes[U]);let M=!1,V=!1,I="",B="";if(o==="xtract"&&isFinite(r)&&r in N.labels){I=(await Zh("assets/atlas/descr/en/"+R.json)).labels[r].replace(/\s+/g,"_"),B=`assets/atlas/TOM_trackings/${I}.tck`;try{(await fetch(B,{method:"HEAD"})).ok&&(M=!0)}catch(z){console.log(`Tractography not available for ${I}:`,z)}}if(m.current.volumes.length==0&&m.current.addVolume(h),M||m.current.addVolume(l),M)try{await m.current.loadMeshes([{url:B,rgba255:[0,255,255,255]}]),m.current.meshes.length>0&&(m.current.meshes[0].colormap="blue",m.current.meshes[0].fiberColor="Local"),console.log(`Loaded tractography: ${B}`),V=!0}catch(U){console.error(`Failed to load tractography for ${I}:`,U),e.setHeaderText(t("error_loading_data",{atlas:R.name})),m.current.addVolume(l),M=!1}if(!M&&m.current.volumes.length>1){m.current.volumes[1].setColormapLabel(N);const U=Object.keys(N.labels).length,z=new Uint8Array(U*4);for(let P=0;P<U;P++)P===r&&isFinite(r)&&r in N.labels?(z[P*4+0]=43,z[P*4+1]=111,z[P*4+2]=161,z[P*4+3]=255):z[P*4+3]=0;m.current.volumes[1]&&m.current.volumes[1].colormapLabel&&(m.current.volumes[1].colormapLabel.lut=new Uint8ClampedArray(z)),m.current.setOpacity(1,f.displayOpacity),m.current.updateGLVolume()}m.current.setClipPlane(V?[-.1,270,0]:[2,270,0]),m.current.opts.isSliceMM=!0,isFinite(r)&&r in N.labels?e.setHeaderText(`${N.labels[r]||"Unknown"} (${R.name})`):(e.setHeaderText(t("error_loading_data",{atlas:R.name})),console.error(`Invalid region ID: ${r}`)),m.current.drawScene()}catch(R){console.error(`Failed to update visualization for ${o}:`,R),e.setHeaderText(t("error_loading_data",{atlas:o})),m.current.volumes.length>0&&m.current.drawScene()}}const T=()=>{l&&h&&g?(x(!1),E()):x(!0)},D=()=>{m.current.attachTo("gl1").then(()=>{p(!0),m.current.setInterpolation(!0),m.current.opts.crosshairGap=0,m.current.opts.multiplanarShowRender=Ua.ALWAYS,m.current.opts.dragMode=m.current.dragModes.slicer3D,m.current.opts.yoke3Dto2DZoom=!0,m.current.opts.isRadiologicalConvention=f.radiologicalOrientation})};return ie.useEffect(()=>{D(),T()},[]),ie.useEffect(()=>{T()},[l,h,g,r,o,u]),ie.useEffect(()=>{m.current&&(f.displayType==="Axial"&&m.current.setSliceType(m.current.sliceTypeAxial),f.displayType==="Coronal"&&m.current.setSliceType(m.current.sliceTypeCoronal),f.displayType==="Sagittal"&&m.current.setSliceType(m.current.sliceTypeSagittal),f.displayType==="Render"&&(m.current.setSliceType(m.current.sliceTypeRender),m.current.setClipPlane(m.current.meshes.length>0?[-.1,270,0]:[2,270,0])),f.displayType==="MultiPlanar"&&(m.current.opts.multiplanarShowRender=Ua.NEVER,m.current.setSliceType(m.current.sliceTypeMultiplanar)),f.displayType==="MultiPlanarRender"&&(m.current.opts.multiplanarShowRender=Ua.ALWAYS,m.current.setSliceType(m.current.sliceTypeMultiplanar)),m.current.volumes.length>1&&m.current.setOpacity(1,f.displayAtlas?f.displayOpacity:0),m.current.opts.isRadiologicalConvention=f.radiologicalOrientation,m.current.updateGLVolume())},[f]),L.jsxs("div",{className:"page-container",children:[v&&L.jsx("div",{className:"loading-screen",children:"Chargement..."}),L.jsx("canvas",{id:"gl1"}),L.jsx("div",{className:"button-container",children:L.jsx("button",{id:"return-button",className:"return-button",onClick:()=>e.gotoPage("welcome"),children:t("return_button")})}),w&&L.jsx("div",{id:"help-overlay",className:"help-overlay",children:L.jsxs("div",{className:"help-content",ref:S,children:[L.jsx("button",{id:"close-help",className:"close-button",onClick:()=>b(!1),children:""}),L.jsx("h2",{children:t("help_title")}),L.jsxs("section",{children:[L.jsx("h3",{children:t("neurotheka_principle_title")}),L.jsx("p",{children:t("neurotheka_principle_text")})]}),L.jsxs("section",{children:[L.jsx("h3",{children:t("neurotheka_navigation_title")}),L.jsx("p",{children:t("neurotheka_navigation_text")})]}),L.jsxs("section",{children:[L.jsx("h3",{children:t("viewer_controls_title")}),L.jsx("p",{children:t("viewer_controls_text")})]})]})}),L.jsx("div",{ref:C,children:L.jsx("button",{id:"help-button",className:"help-button",onClick:()=>b(!0),children:L.jsx("i",{className:"fas fa-question"})})})]})}function py(){const t=new yf,[e,i]=ie.useState(localStorage.getItem("guestMode")=="true"||!1),[n,r]=ie.useState(!1),[o,l]=ie.useState(localStorage.getItem("authToken")||""),[h,f]=ie.useState(()=>{const Ne=new URLSearchParams(window.location.search);return Ne.get("validate")?"validate":Ne.get("resetpwd")?"resetpwd":""}),[u,m]=ie.useState(""),[g,p]=ie.useState(""),[v,x]=ie.useState([]),{t:w,i18n:b}=a5(),[S,C]=ie.useState(b.language),E=Ne=>{C(Ne),b.changeLanguage(Ne)},T=ie.useRef(null),[D,R]=ie.useState(null),[N,M]=ie.useState("success"),[V,I]=ie.useState(null),[B,U]=ie.useState(null),[z,P]=ie.useState(null),[K,_]=ie.useState(null),[H,q]=ie.useState(null),se=ie.useRef(""),[G,W]=ie.useState(0),[le,ce]=ie.useState(""),[fe,ye]=ie.useState(""),[me,He]=ie.useState(""),[ve,ze]=ie.useState(""),[Ie,Je]=ie.useState(""),[Ve,Xt]=ie.useState(""),[ft,Ui]=ie.useState({displayType:"MultiPlanarRender",radiologicalOrientation:!0,displayAtlas:!0,displayOpacity:.6}),[Te,Xe]=ie.useState(!1),re=ie.useRef(null),ui=ie.useRef(null),Ut=Ne=>{f(Ne)};function Ii(){const Ye=window.location.hash.replace(/^#\/?/,"").split("/"),pt=Ye[0]||"welcome";if(pt==="neurotheka"){const bt=Ye[1]||null,At=Ye[2]?Number(Ye[2]):null;bt&&At&&It({id:At,atlas:bt})}else if(pt==="singleplayer"){const bt=Ye[1]||null,At=Ye[2]||null;bt&&At&&Vi(At,bt)}else f(pt)}const $i=Ne=>{Tt(),f(Ne),ce(""),ye("normal"),window.location.hash=`#/${Ne}`},us=()=>{i(!0),localStorage.setItem("guestMode","true"),f("welcome")};ie.useEffect(()=>{const Ne=document.getElementById("root");Ne&&(Ne.style.opacity="1");const Ye=document.getElementById("loading-screen");Ye&&(Ye.style.display="none"),o&&Wh(o)&&(i(!1),r(!0)),t.loadFromUrl("assets/atlas/mni152.nii.gz").then(At=>{I(At)}).catch(At=>{console.error("Error loading NIfTI file:",At),Fi("error_loading_atlas",!1,{atlas:B}),I(null)}),Ii();const bt=()=>{Ii()};return window.addEventListener("hashchange",bt),()=>window.removeEventListener("hashchange",bt)},[]),ie.useEffect(()=>{on()},[S]);async function on(){const Ne=[];for(const[Ye,{json:pt,name:bt}]of Object.entries(Kr))try{const At="assets/atlas/descr/"+S+"/"+pt,qi=await fetch(At);if(!qi.ok)throw new Error(`HTTP ${qi.status} for ${Ye}`);const Ba=await qi.json(),ln=Object.entries(Ba.labels).filter(([Bi])=>Number(Bi)>0&&Number.isInteger(Number(Bi))).map(([Bi,cn])=>({id:Number(Bi),name:String(cn)||`Region ${Bi}`,atlas:Ye,atlasName:bt}));Ne.push(...ln),console.log(`Loaded ${ln.length} regions for ${Ye} (${bt})`)}catch(At){console.error(`Failed to load labels for ${Ye}:`,At),Fi("error_loading_atlas",!1,{atlas:bt})}console.log("Total regions loaded:",v.length),Ne.length===0?(Fi("no_regions_loaded"),x([])):x(Ne)}const Fi=(Ne,Ye,pt={})=>{M("error"),R(w(Ne,pt)),setTimeout(()=>{R("")},3e3)},xi=async Ne=>{localStorage.setItem("authToken",Ne),l(Ne),r(!0)},Tt=async()=>{o&&(Wh(o)?(r(!0),mg()):(r(!1),localStorage.removeItem("authToken"),l(""),Fi("invalid_token")))},hi=()=>{localStorage.removeItem("authToken"),l(""),r(!1)},It=Ne=>{Tt(),se.current="neurotheka",ce(w("loading")),U(Ne.atlas),_(Ne.id),W(Ye=>Ye+1),window.location.hash=`#/neurotheka/${Ne.atlas}/${Ne.id}`};ie.useEffect(()=>{B&&f(se.current)},[B,K,G,H]);const Vi=(Ne,Ye)=>{se.current="singleplayer",Tt(),ce(w("loading")),U(Ne),q(Ye),W(pt=>pt+1),window.location.hash=`#/singleplayer/${Ye}/${Ne}`};ie.useEffect(()=>{if(B){const Ne=Kr[B];if(Ne){const Ye="assets/atlas/nii/"+Ne.nii;ni.loadFromUrl({url:Ye}).then(pt=>{P(pt)}).catch(pt=>{console.error("Error loading NIfTI file:",pt),Fi("error_loading_atlas",!1,{atlas:B}),P(null)})}}},[B]),ie.useEffect(()=>{if(n){i(!1),localStorage.setItem("guestMode","false");const Ne=gg(o);m(Ne.firstname||w("default_user")),p(Ne.lastname||"")}},[n]),ie.useEffect(()=>{const Ne=Ye=>{Te&&re.current&&ui.current&&!ui.current.contains(Ye.target)&&!re.current.contains(Ye.target)&&Xe(!1)};return document.addEventListener("click",Ne),()=>{document.removeEventListener("click",Ne)}},[Te]);const Zt={startGame:Ut,gotoPage:$i,handleChangeLanguage:E,activateGuestMode:us,setIsLoggedIn:r,loginWithToken:xi,logout:hi,openNeurotheka:It,setHeaderText:ce,setHeaderTextMode:ye,setHeaderScore:He,setHeaderErrors:ze,setHeaderStreak:Je,setHeaderTime:Xt,setViewerOption:Ui,launchSinglePlayerGame:Vi};return L.jsxs(L.Fragment,{children:[L.jsx(zA,{currentLanguage:S,currentPage:h,atlasRegions:v,isLoggedIn:n,t:w,callback:Zt,userFirstName:u,userLastName:g,headerText:le,headerTextMode:fe,headerScore:me,headerErrors:ve,headerStreak:Ie,headerTime:Ve,viewerOptions:ft}),h==="welcome"&&L.jsxs(L.Fragment,{children:[!e&&!n&&L.jsx(qx,{t:w,callback:Zt}),(e||n)&&L.jsx(jA,{t:w,callback:Zt,atlasRegions:v})]}),h==="singleplayer"&&L.jsx(jx,{t:w,callback:Zt,currentLanguage:S,atlasRegions:v,askedAtlas:B,gameMode:H,preloadedAtlas:z,preloadedBackgroundMNI:V,viewerOptions:ft,loadEnforcer:G,isLoggedIn:n,authToken:o}),h==="login"&&L.jsx(Gx,{t:w,callback:Zt}),h==="register"&&L.jsx(Yx,{t:w,callback:Zt}),h==="validate"&&L.jsx(Hx,{t:w,callback:Zt}),h==="resetpwd"&&L.jsx(Qx,{t:w,callback:Zt}),h==="config"&&L.jsx(Xx,{t:w,callback:Zt,authToken:o}),h==="stats"&&L.jsx(Kx,{t:w,callback:Zt,authToken:o}),D&&L.jsx("div",{id:"notification",ref:T,className:N,children:D}),h==="neurotheka"&&L.jsx(gy,{t:w,callback:Zt,currentLanguage:S,atlasRegions:v,askedAtlas:B,askedRegion:K,preloadedAtlas:z,preloadedBackgroundMNI:V,viewerOptions:ft,loadEnforcer:G}),h==="welcome"&&L.jsxs(L.Fragment,{children:[Te&&L.jsx("div",{id:"help-overlay",className:"help-overlay",children:L.jsxs("div",{className:"help-content",ref:re,children:[L.jsx("button",{id:"close-help",className:"close-button",onClick:()=>Xe(!1),children:""}),L.jsx("h2",{"data-i18n":"help_title",children:"Help"}),L.jsxs("section",{children:[L.jsx("h3",{children:w("help_presentation_title")}),L.jsx("p",{children:w("help_presentation_text")})]}),L.jsxs("section",{children:[L.jsx("h3",{children:w("help_atlases_title")}),L.jsx("p",{dangerouslySetInnerHTML:{__html:w("help_atlases_text")}})]}),L.jsxs("section",{children:[L.jsx("h3",{children:w("help_modes_title")}),L.jsx("p",{dangerouslySetInnerHTML:{__html:w("help_modes_navigation")}}),L.jsx("p",{dangerouslySetInnerHTML:{__html:w("help_modes_practice")}}),L.jsx("p",{dangerouslySetInnerHTML:{__html:w("help_modes_streak")}}),L.jsx("p",{dangerouslySetInnerHTML:{__html:w("help_modes_time_attack")}})]})]})}),L.jsx("div",{ref:ui,children:L.jsx("button",{id:"help-button",className:"help-button",onClick:()=>Xe(!0),children:L.jsx("i",{className:"fas fa-question"})})})]})]})}const Ay="NeuroGuessr",vy="NeuroGlossary",xy="Loading...",yy="Search regions (e.g., Thalamus, Frontal Pole...)",wy="Options",by="Axial",Cy="Sagittal",Sy="Coronal",Ey="Render",Ty="A+C+S",My="A+C+S+R",Dy="Radiological",Ny="Colored Atlas",Ry="Atlas Opacity",Uy="Return",Iy="Restore Color (Esc)",Fy="Confirm Guess",Vy="(space)",By="Select Atlas",Ly="User access",Oy="Select Game Mode",ky="Cortical Regions",Py="Subcortical Regions",zy="White Matter Tracts",_y="Functional Networks",jy="Cerebral Arteries",Gy="Login",Yy="Logout",Hy="to access multiplayer mode",qy="",Ky="Navigation",Qy="Identify brain regions",Xy="Practice",Zy="Learn with feedback",Wy="Streak",Jy="Singleplayer",$y="Multiplayer",ew="Test consecutive accuracy",tw="Time Attack",iw="Race against time",sw="Play",nw="Target",aw="Score",rw="Correct",ow="Errors",lw="Streak",cw="Time",uw="Not Started",hw="Click to identify a region",fw="No region selected",dw="Game Over! Accuracy: {accuracy}%, Time: {minutes}m {seconds}s",mw="Previous Game - Accuracy: {accuracy}%, Time: {minutes}m {seconds}s",gw="Previous Streak: {streak} regions",pw="Find:",Aw="It's {{region}} !",vw="Game Over !",xw="Your score :",yw="The region you were looking for was : ",ww="You clicked on : ",bw="Time Attack Over !",Cw="Time : ",Sw="Score : ",Ew="No atlases available for this category.",Tw="Failed to load regions for {atlas}.",Mw="No atlas regions loaded. Search disabled.",Dw="Error: Failed to load {atlas} data",Nw="Error: Failed to initialize visualization",Rw="Tissue classes <span class='atlas-description'>Tissue types (CSF, WM, GM)</span>",Uw="AAL <span class='atlas-description'>Automated Anatomical Labeling</span>",Iw="Desikan <span class='atlas-description'>Gyral Parcellation</span>",Fw="Destrieux <span class='atlas-description'>Gyral-sulcal parcellation</span>",Vw="Allen Brain Reference Atlas <span class='atlas-description'>Gyral parcellation on ICMB2009</span>",Bw="Glasser <span class='atlas-description'>Multimodal cortical parcellation</span>",Lw="Yeo's 7 networks <span class='atlas-description'>7 resting-state functional networks</span>",Ow="Yeo's 17 networks <span class='atlas-description'>17 resting-state functional networks</span>",kw="Subcortical <span class='atlas-description'>Deep brain structures</span>",Pw="Cerebellum <span class='atlas-description'>Cerebellar regions</span>",zw="Thalamus <span class='atlas-description'>Thalamic nuclei</span>",_w="Amygdala/Hippocampus <span class='atlas-description'>Amygdala/Hippocampus subfields</span>",jw="JHU <span class='atlas-description'>JHU's White matter tracts</span>",Gw="Territories <span class='atlas-description'>Cerebral Arteries Territories</span>",Yw="White Matter <span class='atlas-description'>FSL's White matter tracts</span>",Hw="Select Language",qw="Help & Information",Kw="About NeuroGuessr",Qw="NeuroGuessr is an interactive web application designed to help you learn and test your knowledge of brain anatomy using various atlases. Explore different regions, identify structures, and challenge yourself with various game modes.",Xw="Atlases Used",Zw=`[html]NeuroGuessr utilizes several publicly available brain atlases. These include:<br><ul><li><b>AAL3:</b> Automated anatomical parcellation of the MNI single-subject T1 volume. [doi:10.1109/42.712135], [doi:10.1006/nimg.2001.0978]</li><li><b>Harvard-Oxford:</b> Probabilistic anatomical regions derived from structural data. ([doi:10.1016/j.schres.2005.11.020], [10.1016/j.neuroimage.2006.01.021], [10.1176/appi.ajp.162.7.1256], [10.1016/j.biopsych.2006.06.027])</li><li><b>Subcortical Registration:</b> Basal ganglia, red nucleus, amygdala, and hippocampus. <a href='https://www.nature.com/articles/s41597-019-0217-0' target='_blank'>https://www.nature.com/articles/s41597-019-0217-0</a></li><li><b>Cerebellum:</b> Cerebellar Atlas in MNI152 space (FSL). (Diedrichsen J. et al., 2009 & 2011)</li><li><b>Thalamus nuclei</b></li><li><b>Hippocampus & Amygdala:</b> Subfields.</li><li><b>Functional Networks:</b> Resting state functional networks (Thomas Yeo, 7 and 17 networks).</li><li><b>White Matter (XTRACT):</b> FSL's white matter tracts.</li><li><b>White Matter (JHU):</b> "Tract probability maps...". DOI <a href='https://doi.org/10.1016/j.neuroimage.2007.07.053' target='_blank'>https://doi.org/10.1016/j.neuroimage.2007.07.053</a></li><li><b>Arterial Atlas:</b> Brain arterial territories based on stroke lesion distributions. <a href='https://www.nature.com/articles/s41597-0' target='_blank'>https://www.nature.com/articles/s41597-0</a></li></ul>`,Ww="Game Modes Explained",Jw="<b>Navigation:</b> In this mode, you can freely explore the selected atlas. Click on different brain regions to see their names. This mode is ideal for learning",$w="<b>Practice:</b> Practice mode presents you with a target brain region, and you must click on the correct area in the visualization. You receive immediate feedback on whether your guess was correct or incorrect, helping you to learn through trial and error.",eb="<b>Streak:</b> Challenge yourself to identify as many brain regions correctly in a row as possible. The game continues as long as you make correct guesses. An incorrect guess ends the streak.",tb="<b>Time Attack:</b> Test your speed and accuracy in identifying brain regions. The goal is to identify all regions of an atlas in the shortest time possible, without making any errors!",ib="Viewer Help",sb="Navigation Controls",nb="Use the mouse to interact with the brain visualization. Click and drag to rotate the 3D render or pan the 2D slices. Scroll to zoom in and out. Use the dropdown menu in the top right to change the view (Axial, Coronal, Sagittal, Render, Multiplanar) and toggle options like Radiological convention and Atlas visibility.",ab="This is the main viewer page where you interact with the brain atlas. The specific game mode you selected on the index page will determine the objective and rules.",rb="<b>Navigation Mode:</b> Explore the brain atlas freely. Click on any region to see its name and information. Use the 'Restore Color' button or press 'Esc' to reset the colors after clicking on a region.",ob="<b>Practice Mode:</b> Your goal is to identify the brain region displayed as the 'Target'. Click on the corresponding region in the visualization, and click on 'Confirm guess' button (or press 'Space' key). You will receive immediate feedback on whether your guess was correct or incorrect. If you make multiple incorrect guesses for the same target, the correct region will be highlighted to help you learn.",lb="<b>Streak Mode:</b> In this mode, you must correctly identify a series of brain regions. Each correct guess increases your streak count. An incorrect guess will end your streak, and your final streak score will be displayed.",cb="<b>Time Attack Mode:</b> Test your speed and accuracy in identifying brain regions. The goal is to identify all regions of an atlas in the shortest time possible, without making any errors!",ub="Principle of NeuroGlossary",hb="NeuroGlossary allows you to search for a specific brain region and visualize it isolated within a standard T1w template (MNI152).",fb="Navigation in NeuroGlossary",db="Use the search bar at the top to find a brain region by name. Click on a suggestion to load the region. Use the view options dropdown to change the display (Axial, Coronal, Sagittal, Render, Multiplanar) and adjust the atlas opacity.",mb="Search for a region to visualize",gb="No matching regions found",pb="Unknown Region",Ab="Welcome !",vb="Sign in or Register to start playing NeuroGuessr",xb="Sign in",yb="No account ? Sign up",wb="Continue without signing in",bb="Not yet registered? Click here to register",Cb="Forgot your password? Click here to reset it",Sb="Register",Eb="Login",Tb="Username",Mb="Email",Db="First Name",Nb="Last Name",Rb="Password",Ub="Confirm Password",Ib="My statistics",Fb="Register",Vb="My Account",Bb="Password must be at least 8 characters long and contain at least one uppercase letter, one lowercase letter, one number, and one special character.",Lb="Please fill in all fields.",Ob="Please enter a valid email address.",kb="Passwords do not match.",Pb="Password does not meet complexity requirements.",zb="Login successful! Redirecting...",_b="Login failed. Please check your credentials.",jb="Registration successful! Please check your mailbox to confirm your email address...",Gb="Registration successful! You can now log in.",Yb="Registration failed. Please try again.",Hb="Server error. Please try again later.",qb="Welcome {{firstname}} !",Kb="User",Qb="You have been logged out successfully.",Xb="Password Recovery",Zb="Enter your email address to receive a password reset link.",Wb="Send Email",Jb="Please enter your email address.",$b="Enter your email address",e6="A password reset link has been sent to your email.",t6="Failed to send password reset email. Please try again.",i6="Reset Password",s6="New Password",n6="Reset Password",a6="The reset link is invalid or has expired.",r6="Your password has been reset successfully.",o6="Failed to reset password. Please try again.",l6="Setup",c6="Account parameters",u6="Save",h6="Setup",f6="Configuration successful!",d6="Configuration failed. Please try again.",m6="Your best scores",g6={app_title:Ay,neuroglossaire_title:vy,loading:xy,search_placeholder:yy,view_options:wy,axial:by,sagittal:Cy,coronal:Sy,render:Ey,multiplanar:Ty,multiplanar_render:My,radiological:Dy,colored_atlas:Ny,atlas_opacity:Ry,return_button:Uy,restore_color:Iy,confirm_guess:Fy,space_key:Vy,select_atlas:By,user_access_mode:Ly,select_game_mode:Oy,cortical_regions:ky,subcortical_regions:Py,white_matter_tracts:zy,functional_networks:_y,cerebral_arteries:jy,login_mode:Gy,logout_mode:Yy,login_description:Hy,logout_description:qy,navigation_mode:Ky,navigation_description:Qy,practice_mode:Xy,practice_description:Zy,streak_mode:Wy,single_player_button:Jy,multiplayer_button:$y,streak_description:ew,time_attack_mode:tw,time_attack_description:iw,play_button:sw,target_label:nw,score_label:aw,correct_label:rw,errors_label:ow,streak_label:lw,time_label:cw,not_started:uw,click_to_identify:hw,no_region_selected:fw,game_over:dw,previous_game:mw,previous_streak:gw,find:pw,incorrect:Aw,streak_ended_title:vw,streak_ended_score:xw,streak_ended_correct_region:yw,streak_ended_your_guess:ww,time_attack_ended_title:bw,time_attack_ended_time:Cw,time_attack_ended_score:Sw,no_atlas_message:Ew,error_loading_atlas:Tw,no_regions_loaded:Mw,error_loading_data:Dw,error_initializing:Nw,tissues_info:Rw,"harvard-oxford_info":"Harvard-Oxford <span class='atlas-description'>Probabilistic anatomical regions</span>",aal_info:Uw,desikan_info:Iw,destrieux_info:Fw,allen_info:Vw,glasser_info:Bw,yeo7_info:Lw,yeo17_info:Ow,subcortical_info:kw,cerebellum_info:Pw,thalamus_info:zw,hippoamyg_info:_w,jhu_info:jw,territories_info:Gw,xtract_info:Yw,select_language:Hw,help_title:qw,help_presentation_title:Kw,help_presentation_text:Qw,help_atlases_title:Xw,help_atlases_text:Zw,help_modes_title:Ww,help_modes_navigation:Jw,help_modes_practice:$w,help_modes_streak:eb,help_modes_time_attack:tb,viewer_help_title:ib,viewer_controls_title:sb,viewer_controls_text:nb,viewer_help_general:ab,viewer_help_navigation:rb,viewer_help_practice:ob,viewer_help_streak:lb,viewer_help_time_attack:cb,neurotheka_principle_title:ub,neurotheka_principle_text:hb,neurotheka_navigation_title:fb,neurotheka_navigation_text:db,search_to_visualize:mb,no_search_results:gb,unknown_region:pb,welcome_unlogged:Ab,welcome_text_unlogged:vb,sign_in:xb,sign_up:yb,no_sign_in:wb,registration_link:bb,forgot_password_link:Cb,register_mode:Sb,login_button:Eb,login_username:Tb,login_email:Mb,login_firstname:Db,login_lastname:Nb,login_password:Rb,login_confirm_password:Ub,my_stats:Ib,register_button:Fb,account_settings:Vb,password_helper:Bb,error_empty_fields:Lb,error_invalid_email:Ob,error_password_mismatch:kb,error_password_complexity:Pb,login_success:zb,login_failed:_b,register_success:jb,register_success_no_verification:Gb,register_failed:Yb,server_error:Hb,welcome_message:qb,default_user:Kb,logout_success:Qb,password_recovery_title:Xb,password_recovery_instructions:Zb,send_recovery_email:Wb,error_empty_email:Jb,enter_your_email:$b,recovery_email_sent:e6,recovery_failed:t6,reset_password_header:i6,new_password_label:s6,reset_password_button:n6,error_invalid_token:a6,password_reset_success:r6,password_reset_failed:o6,config_mode:l6,config_description:c6,reconfigure_button:u6,reconfigure_mode:h6,"password-helper-leaveempty":"Leave empty to keep the same password",reconfigure_success:f6,reconfigure_failed:d6,your_best_scores:m6},p6="NeuroGuessr",A6="NeuroGlossaire",v6="Chargement...",x6="Rechercher des rgions (par ex., Thalamus, Ple Frontal...)",y6="Options",w6="Axial",b6="Sagittal",C6="Coronal",S6="Vue 3D",E6="A+C+S",T6="A+C+S+R",M6="Radiologique",D6="Atlas",N6="Opacit",R6="Retour",U6="Recolorer (chap)",I6="Confirmer",F6=" (espace)",V6="Slectionner un atlas",B6="Accs utilisateur",L6="Slectionner un mode de jeu",O6="Rgions Corticales",k6="Rgions Sous-corticales",P6="Faisceaux de Matire Blanche",z6="Rseaux Fonctionnels",_6="Artres Crbrales",j6="Solo",G6="Multi-joueur",Y6="S'identifier",H6="Se dconnecter",q6="pour accder au mode multijoueur",K6="",Q6="Navigation",X6="Identifier les rgions crbrales",Z6="Pratique",W6="Apprendre les diffrentes rgions",J6="Srie",$6="Maximum conscutif",e8="Contre-la-Montre",t8="Mimimum de temps",i8="Jouer",s8="Cible",n8="Score",a8="Correct",r8="Erreurs",o8="Srie",l8="Temps",c8="Non Commenc",u8="Cliquer pour identifier une rgion",h8="Aucune rgion slectionne",f8="Termin ! Prcision : {accuracy}%, Temps : {minutes}m {seconds}s",d8="Jeu Prcdent - Prcision : {accuracy}%, Temps : {minutes}m {seconds}s",m8="Srie Prcdente : {streak} rgions",g8="Trouver : ",p8="Vous avez cliqu sur {{region}} !",A8="Srie Termine ! Vous avez obtenu {streak}  la suite.",v8="Srie Termine!",x8="Votre score :",y8="La rgion que vous cherchiez tait : ",w8="Vous avez cliqu sur : ",b8="Contre la montre Termin !",C8="Temps : ",S8="Score : ",E8="Aucun atlas disponible pour cette catgorie.",T8="chec du chargement des rgions pour {atlas}.",M8="Aucune rgion d'atlas charge. Recherche dsactive.",D8="Erreur : chec du chargement des donnes de {atlas}",N8="Erreur : chec de l'initialisation de la visualisation",R8="Tissus <span class='atlas-description'>Types de tissus (LCS, MB, MG)</span>",U8="AAL <span class='atlas-description'>tiquetage Anatomique Automatis</span>",I8="Desikan <span class='atlas-description'>Parcellation Gyrale</span>",F8="Allen <span class='atlas-description'>Parcellisation gyrale</span>",V8="Destrieux <span class='atlas-description'>Parcellisation sulco-gyrale</span>",B8="Glasser <span class='atlas-description'>Parcellation corticale multimodale</span>",L8="7 rseaux fonctionnels <span class='atlas-description'>Les 7 rseaux fonctionnels</span>",O8="17 rseaux fonctionnels <span class='atlas-description'>Les 17 rseaux fonctionnels</span>",k8="Noyaux gris <span class='atlas-description'>Structures crbrales profondes</span>",P8="Cervelet <span class='atlas-description'>Rgions crbelleuses</span>",z8="Thalamus <span class='atlas-description'>Noyaux thalamiques</span>",_8="Amygdale/Hippocampe <span class='atlas-description'>Sous-champs de l'amygdale/hippocampe</span>",j8="JHU <span class='atlas-description'>Faisceaux de matire blanche (JHU)</span>",G8="Territoires <span class='atlas-description'>Territoires des artres crbrales</span>",Y8="Matire Blanche <span class='atlas-description'><Faisceaux de matire blanche (FSL)</span>",H8="Slectionner la Langue",q8="Aide et Informations",K8=" Propos de NeuroGuessr",Q8="NeuroGuessr est une application web conue pour vous aider  apprendre et  tester vos connaissances en anatomie crbrale. Explorez diffrentes rgions, identifiez des structures et mettez-vous au dfi avec diffrents modes de jeu.",X8="Atlas Utiliss",Z8=`[html]NeuroGuessr utilise plusieurs atlas crbraux. Ceux-ci comprennent :<br><ul><li><b>AAL3 :</b> Parcellation anatomique automatise du volume T1 MNI pour sujet unique. [doi:10.1109/42.712135], [doi:10.1006/nimg.2001.0978]</li><li><b>Harvard-Oxford :</b> Rgions anatomiques probabilistes drives de donnes structurelles. ([doi:10.1016/j.schres.2005.11.020], [10.1016/j.neuroimage.2006.01.021], [10.1176/appi.ajp.162.7.1256], [10.1016/j.biopsych.2006.06.027])</li><li><b>Enregistrement Sous-cortical :</b> Ganglions de la base, noyau rouge, amygdale et hippocampe. <a href='https://www.nature.com/articles/s41597-019-0217-0' target='_blank'>https://www.nature.com/articles/s41597-019-0217-0</a></li><li><b>Cervelet :</b> Atlas Crbelleux dans l'espace MNI152 (FSL). (Diedrichsen J. et al., 2009 & 2011)</li><li><b>Noyaux thalamiques</b></li><li><b>Hippocampe & Amygdale :</b> Sous-champs.</li><li><b>Rseaux Fonctionnels :</b> Rseaux fonctionnels au repos (Thomas Yeo, 7 et 17 rseaux).</li><li><b>Matire Blanche (XTRACT) :</b> Faisceaux de matire blanche de FSL.</li><li><b>Matire Blanche (JHU) :</b> "Tract probability maps...". DOI <a href='https://doi.org/10.1016/j.neuroimage.2007.07.053' target='_blank'>https://doi.org/10.1016/j.neuroimage.2007.07.053</a></li><li><b>Atlas Artriel :</b> Territoires des artres crbrales bass sur la distribution des lsions d'AVC. <a href='https://www.nature.com/articles/s41597-0' target='_blank'>https://www.nature.com/articles/s41597-0</a></li></ul>`,W8="Explication des Modes de Jeu",J8="<b>Navigation :</b> Dans ce mode, vous pouvez explorer librement l'atlas slectionn. Cliquez sur diffrentes rgions crbrales pour voir leurs noms. Ce mode est idal pour l'apprentissage.",$8="<b>Pratique :</b> Le mode Pratique vous prsente une rgion crbrale cible, et vous devez cliquer sur la zone correcte dans la visualisation. Vous recevez un retour immdiat sur la justesse ou l'erreur de votre supposition, ce qui vous aide  apprendre par essais et erreurs.",eC="<b>Srie :</b> Mettez-vous au dfi d'identifier correctement autant de rgions crbrales d'affile que possible. Le jeu continue tant que vos suppositions sont correctes. Une supposition incorrecte met fin  la srie.",tC="<b>Contre-la-Montre :</b> Testez votre vitesse et votre prcision en identifiant les rgions crbrales. L'objectif est d'identifier correctement toute les rgions d'un atlas en un minimum de temps, sans erreurs !",iC="Aide",sC="Commandes de Navigation",nC="Cliquez et faites glisser pour faire pivoter le rendu 3D ou dplacer les coupes 2D. Utiliser la molette de la souris pour zoomer. Utilisez le menu droulant en haut  droite pour changer la vue (Axiale, Coronale, Sagittale, Rendu, Multiplanaire) et activer/dsactiver des options comme la convention Radiologique et la visibilit de l'Atlas.",aC="Le mode de jeu spcifique que vous avez slectionn sur la page d'accueil dterminera l'objectif et les rgles.",rC="<b>Mode Navigation :</b> Explorez librement l'atlas. Cliquez sur n'importe quelle rgion pour voir son nom. Utilisez le bouton 'Recolorer' ou appuyez sur 'chap' pour rinitialiser les couleurs aprs avoir cliqu sur une rgion.",oC="<b>Mode Pratique :</b> Votre objectif est d'identifier la rgion crbrale affiche comme 'Cible'. Cliquez sur la rgion correspondante dans la visualisation et cliquez sur 'Valider' (ou appuyez sur la touche espace). Vous recevrez un retour immdiat sur la justesse ou l'erreur de votre supposition. Si vous faites plusieurs suppositions incorrectes pour la mme cible, la rgion correcte sera mise en vidence pour vous aider  apprendre.",lC="<b>Mode Srie :</b> Dans ce mode, vous devez identifier correctement une srie de rgions crbrales. Chaque supposition correcte augmente votre score de srie. Une supposition incorrecte mettra fin  votre srie, et votre score final de srie sera affich.",cC="<b>Mode Contre-la-Montre :</b> Testez votre vitesse et votre prcision en identifiant les rgions crbrales. L'objectif est d'identifier correctement toute les rgions d'un atlas en un minimum de temps, sans erreurs !",uC="NeuroGlossaire",hC="NeuroGlossaire vous permet de rechercher une rgion crbrale spcifique et de la visualiser isolment dans un modle T1w standard (MNI152-ICBM2009).",fC="Navigation dans NeuroGlossaire",dC="Utilisez la barre de recherche en haut pour trouver une rgion crbrale par nom. Cliquez sur une suggestion pour charger la rgion. Utilisez le menu droulant des options pour modifier l'affichage (Axial, Coronale, Sagittale, Rendu, Multiplanaire) et ajuster l'opacit de l'atlas.",mC="Rechercher une rgion  visualiser",gC="Aucune rgion correspondante trouve",pC="Rgion Inconnue",AC="Bienvenue !",vC="Connectez-vous ou crez un compte pour jouer  NeuroGuessr",xC="S'identifier",yC="Crer un compte",wC="Continuer sans compte",bC="Pas encore de compte? Cliquez ici pour vous inscrire",CC="Mot de passe oubli? Cliquez ici pour le rinitialiser",SC="S'inscrire",EC="S'identifier",TC="Nom utilisateur",MC="Mes statistiques",DC="Email",NC="Prnom",RC="Nom",UC="Mot de passe",IC="Confirmer mot de passe",FC="Mon Compte",VC="S'inscrire",BC="Le mot de passe doit contenir au moins 8 caractres, une majuscule, une minuscule, un chiffre et un caractre spcial.",LC="Veuillez remplir tous les champs.",OC="Veuillez entrer une adresse e-mail valide.",kC="Les mots de passe ne correspondent pas.",PC="Le mot de passe ne respecte pas les exigences de complexit.",zC="Connexion russie !",_C="Nom d'utilisateur ou mot de passe invalide.",jC="Inscription russie ! Merci de vrifier votre boite email pour confirmer votre inscription.",GC="Inscription russie ! Vous pouvez maintenant vous connecter.",YC="chec de l'inscription. Veuillez ressayer.",HC="Une erreur s'est produite. Veuillez ressayer plus tard.",qC="Bienvenue {{firstname}} !",KC="Utilisateur",QC="Vous avez t dconnect avec succs.",XC="Rcupration de mot de passe",ZC="Entrez votre adresse e-mail pour recevoir un lien de rinitialisation.",WC="Envoyer un e-mail",JC="Veuillez entrer votre adresse e-mail.",$C="Entrez votre adresse e-mail",eS="Un lien de rinitialisation a t envoy  votre adresse e-mail.",tS="chec de l'envoi de l'e-mail de rinitialisation. Veuillez ressayer.",iS="Rinitialiser le mot de passe",sS="Nouveau mot de passe",nS="Rinitialiser le mot de passe",aS="Le lien de rinitialisation est invalide ou a expir.",rS="Votre mot de passe a t rinitialis avec succs.",oS="chec de la rinitialisation du mot de passe. Veuillez ressayer.",lS="Configuration",cS="Paramtres de votre compte",uS="Enregistrer",hS="Configuration",fS="Configuration russie !",dS="chec de la configuration. Veuillez ressayer.",mS="Vos statistiques personnelles",gS={app_title:p6,neuroglossaire_title:A6,loading:v6,search_placeholder:x6,view_options:y6,axial:w6,sagittal:b6,coronal:C6,render:S6,multiplanar:E6,multiplanar_render:T6,radiological:M6,colored_atlas:D6,atlas_opacity:N6,return_button:R6,restore_color:U6,confirm_guess:I6,space_key:F6,select_atlas:V6,user_access_mode:B6,select_game_mode:L6,cortical_regions:O6,subcortical_regions:k6,white_matter_tracts:P6,functional_networks:z6,cerebral_arteries:_6,single_player_button:j6,multiplayer_button:G6,login_mode:Y6,logout_mode:H6,login_description:q6,logout_description:K6,navigation_mode:Q6,navigation_description:X6,practice_mode:Z6,practice_description:W6,streak_mode:J6,streak_description:$6,time_attack_mode:e8,time_attack_description:t8,play_button:i8,target_label:s8,score_label:n8,correct_label:a8,errors_label:r8,streak_label:o8,time_label:l8,not_started:c8,click_to_identify:u8,no_region_selected:h8,game_over:f8,previous_game:d8,previous_streak:m8,find:g8,incorrect:p8,streak_ended:A8,streak_ended_title:v8,streak_ended_score:x8,streak_ended_correct_region:y8,streak_ended_your_guess:w8,time_attack_ended_title:b8,time_attack_ended_time:C8,time_attack_ended_score:S8,no_atlas_message:E8,error_loading_atlas:T8,no_regions_loaded:M8,error_loading_data:D8,error_initializing:N8,tissues_info:R8,"harvard-oxford_info":"Harvard-Oxford <span class='atlas-description'>Rgions anatomiques</span>",aal_info:U8,desikan_info:I8,allen_info:F8,destrieux_info:V8,glasser_info:B8,yeo7_info:L8,yeo17_info:O8,subcortical_info:k8,cerebellum_info:P8,thalamus_info:z8,hippoamyg_info:_8,jhu_info:j8,territories_info:G8,xtract_info:Y8,select_language:H8,help_title:q8,help_presentation_title:K8,help_presentation_text:Q8,help_atlases_title:X8,help_atlases_text:Z8,help_modes_title:W8,help_modes_navigation:J8,help_modes_practice:$8,help_modes_streak:eC,help_modes_time_attack:tC,viewer_help_title:iC,viewer_controls_title:sC,viewer_controls_text:nC,viewer_help_general:aC,viewer_help_navigation:rC,viewer_help_practice:oC,viewer_help_streak:lC,viewer_help_time_attack:cC,neurotheka_principle_title:uC,neurotheka_principle_text:hC,neurotheka_navigation_title:fC,neurotheka_navigation_text:dC,search_to_visualize:mC,no_search_results:gC,unknown_region:pC,welcome_unlogged:AC,welcome_text_unlogged:vC,sign_in:xC,sign_up:yC,no_sign_in:wC,registration_link:bC,forgot_password_link:CC,register_mode:SC,login_button:EC,login_username:TC,my_stats:MC,login_email:DC,login_firstname:NC,login_lastname:RC,login_password:UC,login_confirm_password:IC,account_settings:FC,register_button:VC,password_helper:BC,error_empty_fields:LC,error_invalid_email:OC,error_password_mismatch:kC,error_password_complexity:PC,login_success:zC,login_failed:_C,register_success:jC,register_success_no_verification:GC,register_failed:YC,server_error:HC,welcome_message:qC,default_user:KC,logout_success:QC,password_recovery_title:XC,password_recovery_instructions:ZC,send_recovery_email:WC,error_empty_email:JC,enter_your_email:$C,recovery_email_sent:eS,recovery_failed:tS,reset_password_header:iS,new_password_label:sS,reset_password_button:nS,error_invalid_token:aS,password_reset_success:rS,password_reset_failed:oS,config_mode:lS,config_description:cS,reconfigure_button:uS,reconfigure_mode:hS,"password-helper-leaveempty":"Laissez vide pour conserver le mme mot de passe",reconfigure_success:fS,reconfigure_failed:dS,your_best_scores:mS};ri.use(e5).init({resources:{en:{translation:g6},fr:{translation:gS}},lng:"fr",fallbackLng:"en",interpolation:{escapeValue:!1}});LA.createRoot(document.getElementById("root")).render(L.jsx(ie.StrictMode,{children:L.jsx(py,{})}));
